(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    943533,      22159]
NotebookOptionsPosition[    859097,      21120]
NotebookOutlinePosition[    859536,      21137]
CellTagsIndexPosition[    859493,      21134]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.817130100401026*^9, 3.817130101776217*^9}, {
  3.8171301826541986`*^9, 3.817130223905025*^9}, {3.823771767954212*^9, 
  3.823771768425559*^9}, {3.82398152089357*^9, 3.823981521501109*^9}, {
  3.8377704427877073`*^9, 3.8377704437155695`*^9}, {3.872906709246356*^9, 
  3.8729067101573877`*^9}, {3.878091242458455*^9, 3.87809124436303*^9}, {
  3.8840053842749157`*^9, 3.884005384852964*^9}, {3.8854822794978533`*^9, 
  3.88548228013315*^9}, {3.885579505501091*^9, 3.885579506978468*^9}, {
  3.885579584402999*^9, 3.88557958498462*^9}, {3.892533178684475*^9, 
  3.8925331803801003`*^9}, {3.892533538160111*^9, 3.8925335386352377`*^9}, {
  3.8925340444404583`*^9, 3.892534045154641*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"823c1823-80bb-4317-9801-664ac87fa463"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.885475042826622*^9, 3.8854750465560713`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1c6ab6d1-11d7-4145-97be-f84f8b338dec"],

Cell[BoxData["\<\"/Users/yaniv/Dropbox (Cambridge \
University)/Fisher_paper/Code\"\>"], "Output",
 CellChangeTimes->{
  3.885475046852738*^9, 3.885475082340993*^9, 3.885482282671186*^9, 
   3.885496625155119*^9, 3.885508414208889*^9, 3.8855369598808393`*^9, 
   3.8855404385577927`*^9, 3.885554336047214*^9, 3.885579588518188*^9, 
   3.885622409780636*^9, 3.8856269093955717`*^9, 3.885628693872889*^9, {
   3.886932891390924*^9, 3.886932898675222*^9}, 3.8877362574511347`*^9, 
   3.887879160971655*^9, 3.887883277754623*^9, 3.887891207728037*^9, 
   3.888350659395628*^9, 3.888659715681346*^9, 3.888921909757738*^9, 
   3.8890924838876534`*^9, 3.8906668522238903`*^9, 3.8925340504814577`*^9, 
   3.8925502028496847`*^9, 3.892667137273728*^9, 3.8931570261487617`*^9, 
   3.8931764925213947`*^9, 3.893771874081099*^9, 3.893792713714827*^9, 
   3.8937977141884613`*^9, 3.89382518242188*^9, 3.893827855039571*^9, 
   3.8938307427462473`*^9, 3.893843198451416*^9, 3.893867236598385*^9, 
   3.893874088897743*^9, 3.894194706884837*^9, 3.8949949213817673`*^9, 
   3.895058282714645*^9, 3.895473984837617*^9, 3.895474239970498*^9, 
   3.895474548417512*^9, 3.8956042032735777`*^9, 3.8959982362871647`*^9, 
   3.896276557045903*^9, 3.8962784088008204`*^9, 3.896294168108906*^9, 
   3.8962980377557497`*^9, 3.896326907254706*^9, 3.896412828028481*^9, 
   3.897998364491972*^9, 3.897998524472974*^9, 3.897998568432144*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"b25fa543-ed61-4240-acf2-70f45b057d4c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary functions", "Section",
 CellChangeTimes->{{3.872243858930273*^9, 3.872243868435338*^9}, {
  3.887892061115245*^9, 
  3.88789206451372*^9}},ExpressionUUID->"6da3f3ee-8d86-45eb-b6bc-\
d552c8ab1573"],

Cell[CellGroupData[{

Cell["Background cosmology, shift sizes and k- scales", "Subsection",
 CellChangeTimes->{{3.872243973359868*^9, 3.872243984189864*^9}, {
   3.872245313086465*^9, 3.8722453166613083`*^9}, {3.872301285671451*^9, 
   3.872301294719632*^9}, 3.8733807212083473`*^9, {3.878318538489427*^9, 
   3.878318539269065*^9}},ExpressionUUID->"a5c007d7-7101-42fc-9b63-\
d15c58f3fd3a"],

Cell["Background Cosmology", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5b634a7e-33c7-4460-a438-9faf5a5eb844"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lnAsback", "=", "3.044"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nsback", " ", "=", " ", "0.965"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hback", "=", "0.673"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]bback", " ", "=", " ", "0.02237"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]cback", " ", "=", " ", "0.1203"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Nu]back", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]kback", " ", "=", " ", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.872243994465603*^9, 3.872243999082917*^9}, 
   3.872754846437354*^9, 3.8727631457542686`*^9, {3.8727704092049522`*^9, 
   3.8727704275204773`*^9}, {3.873384840005163*^9, 3.87338484401303*^9}, {
   3.8744016442351437`*^9, 3.8744016720514183`*^9}, 3.8783184055803823`*^9, {
   3.8783185123129377`*^9, 3.878318525426997*^9}, {3.885480215977109*^9, 
   3.885480216170197*^9}, {3.893771868948242*^9, 3.893771870321492*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"74bf43fe-2a87-46b8-8c1a-75b72c0e3ad5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Omega]mback", " ", "=", " ", 
   RowBox[{"\[Omega]cback", "+", "\[Omega]bback", "+", 
    FractionBox["m\[Nu]back", "93.14"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]cback", " ", "=", " ", 
   RowBox[{"\[Omega]cback", "/", 
    SuperscriptBox["hback", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"\[CapitalOmega]mback", " ", "=", " ", 
    RowBox[{"\[Omega]mback", "/", 
     SuperscriptBox["hback", "2"]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]bback", " ", "=", " ", 
   RowBox[{"\[Omega]bback", "/", 
    SuperscriptBox["hback", "2"]}]}], ";"}]}], "Input",
 CellChangeTimes->{3.878318528803252*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"6dc81fff-1d9b-44dd-972f-f57ac115d48d"],

Cell["Shift sizes", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.8783184127722816`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0e65e27b-0f3f-43db-a77f-2c15c3e8cc79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalDelta]lnAs", " ", "=", " ", "0.1"}], ";", " ", 
  RowBox[{"\[CapitalDelta]h", " ", "=", " ", "0.02"}], ";", " ", 
  RowBox[{"\[CapitalDelta]\[CapitalOmega]m", "=", "0.04"}], ";", " ", 
  RowBox[{"\[CapitalDelta]\[Omega]b", " ", "=", " ", "0.02"}], ";", " ", 
  RowBox[{"\[CapitalDelta]ns", " ", "=", " ", "0.02"}], ";", " ", 
  RowBox[{"\[CapitalDelta]m\[Nu]", "=", "0.25"}], ";", " ", 
  RowBox[{"\[CapitalDelta]\[CapitalOmega]k", " ", "=", " ", "0.05"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shifts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[CapitalDelta]lnAs", ",", 
     RowBox[{"\[CapitalDelta]ns", " ", "nsback"}], ",", 
     RowBox[{"\[CapitalDelta]h", " ", "hback"}], ",", 
     RowBox[{"\[CapitalDelta]\[CapitalOmega]m", " ", "\[CapitalOmega]mback"}],
      ",", 
     RowBox[{"\[CapitalDelta]\[Omega]b", " ", "\[Omega]bback"}], ",", 
     RowBox[{"\[CapitalDelta]m\[Nu]", " ", "m\[Nu]back"}], ",", 
     "\[CapitalDelta]\[CapitalOmega]k"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.872301296496416*^9, 3.87230129713034*^9}, {
  3.872302103187516*^9, 3.8723021319625883`*^9}, {3.872302820932755*^9, 
  3.872302855487823*^9}, {3.8727634664033127`*^9, 3.8727634669611883`*^9}, {
  3.878318422846517*^9, 3.878318439552721*^9}, {3.885480190777376*^9, 
  3.88548019978369*^9}, {3.8962765596330347`*^9, 3.896276559758947*^9}, {
  3.8962783941224737`*^9, 3.896278394636612*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"e3f884af-a3c9-481c-9f5b-3930a8fa1d0c"],

Cell["k-scales ", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318432491783*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0ea6c699-f0f9-4282-a52b-0c6755ac7849"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kr", "=", 
   FractionBox["knl", "2.8`"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"km", "=", "knl"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kM", "=", "knl"}], ";"}]}], "Input",
 CellChangeTimes->{{3.878822681480423*^9, 3.878822722359337*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"7f93c02c-fe83-4360-8823-8e36cfedbfab"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "NL"], TraditionalForm]],ExpressionUUID->
  "4b0fbfb9-399c-47f7-a61c-eb3fdedf0611"],
 "-parameters"
}], "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318432491783*^9}, {
  3.878318945316238*^9, 3.8783189562727127`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"f86619d9-16b0-4ced-9734-1b42bc554395"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fnlfix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fNLloc", "->", "0"}], ",", 
     RowBox[{"fNLeq", "->", "0"}], ",", 
     RowBox[{"fNLorth", "->", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873384861769166*^9, 3.873384918446978*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"c781a137-383e-4181-97e0-cbf0a2127094"],

Cell[BoxData[
 RowBox[{
  RowBox[{"paramfix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]c", "->", "1.68"}], ",", 
     RowBox[{"p", "->", " ", "8.52"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8733865833740892`*^9, 3.873386609936618*^9}, 
   3.8734252686097918`*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"34626481-4763-4a98-972f-a9d9b6154296"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fnlcoefs", "=", " ", 
   RowBox[{"fnlfix", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873384892457265*^9, 3.873384906659267*^9}, {
  3.87432349733311*^9, 3.874323502813931*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"6eb38468-5138-48ca-ace6-5345ef1863c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["EFT-parameters and import best-fit", "Subsection",
 CellChangeTimes->{{3.872245345438307*^9, 3.872245351639902*^9}, {
   3.87229737932854*^9, 3.872297379961549*^9}, 
   3.872299977952301*^9},ExpressionUUID->"7a5c0b7b-1376-4880-a1a7-\
1ad3d2f54d50"],

Cell["Parameters", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
  3.878318564396934*^9, 3.8783185665840807`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"b7f3a44d-bee4-485e-bf6d-864d4f02f2be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BAllcoefs", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "b1", ",", "c2", ",", "b3", ",", "b4", ",", "c4", ",", "b6", ",", "b7", 
     ",", "b8", ",", "b9", ",", "b10", ",", "b11", ",", "Bc1", ",", "Bc2", 
     ",", "Bc3", ",", "Bc4", ",", "Be1", ",", "Be2", ",", "ce2", ",", "Bc5", 
     ",", "Bc6", ",", "Bc7", ",", "Bc8", ",", "Bc9", ",", "Bc10", ",", "Bc11",
      ",", "Bc12", ",", "Bc13", ",", "Bc14", ",", "Bd1", ",", "Bd2", ",", 
     "Bd3", ",", "Be3", ",", "Be4", ",", "Be5", ",", "Be6", ",", "Be7", ",", 
     "Be8", ",", "Be9", ",", "Be10", ",", "Be11", ",", "Be12"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.871017359569654*^9, 3.8710173714738207`*^9}, {
   3.872838505123824*^9, 3.87283853172659*^9}, {3.872838588954315*^9, 
   3.872838592103488*^9}, 3.8728584096569557`*^9, {3.874323545740271*^9, 
   3.874323546785005*^9}, {3.8954739032374268`*^9, 3.895473905393549*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"3c8fea00-2363-4327-a8d9-5ed95c59f1af"],

Cell["Parameter fixing", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
  3.878318564396934*^9, 3.8783185665840807`*^9}, {3.885477075454322*^9, 
  3.885477076402401*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"638642a1-b797-4341-9fa6-c79bce52d216"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfixBOSS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b1", "\[Rule]", "1.9391`"}], ",", 
     RowBox[{"c2", "\[Rule]", "1.1447`"}], ",", 
     RowBox[{"b3", "\[Rule]", 
      RowBox[{"-", "0.374`"}]}], ",", 
     RowBox[{"b4", "\[Rule]", "0.1276`"}], ",", 
     RowBox[{"c4", "\[Rule]", 
      RowBox[{"-", "0.2895`"}]}], ",", 
     RowBox[{"b6", "\[Rule]", 
      RowBox[{"-", "0.3487`"}]}], ",", 
     RowBox[{"b7", "\[Rule]", "0.2234`"}], ",", 
     RowBox[{"b8", "\[Rule]", 
      RowBox[{"-", "0.2972`"}]}], ",", 
     RowBox[{"b9", "\[Rule]", "0.0148`"}], ",", 
     RowBox[{"b10", "\[Rule]", "0.0428`"}], ",", 
     RowBox[{"b11", "\[Rule]", "0.0356`"}], ",", 
     RowBox[{"Bc1", "\[Rule]", "5.4605`"}], ",", 
     RowBox[{"Bc2", "\[Rule]", 
      RowBox[{"-", "1.5439`"}]}], ",", 
     RowBox[{"Bc3", "\[Rule]", "1.3081`"}], ",", 
     RowBox[{"Bc4", "\[Rule]", 
      RowBox[{"-", "0.4785`"}]}], ",", 
     RowBox[{"Bc5", "\[Rule]", "0.1054`"}], ",", 
     RowBox[{"Bc6", "\[Rule]", "0.8713`"}], ",", 
     RowBox[{"Bc7", "\[Rule]", 
      RowBox[{"-", "0.4555`"}]}], ",", 
     RowBox[{"Bc8", "\[Rule]", "0.4442`"}], ",", 
     RowBox[{"Bc9", "\[Rule]", 
      RowBox[{"-", "0.4152`"}]}], ",", 
     RowBox[{"Bc10", "\[Rule]", 
      RowBox[{"-", "0.65`"}]}], ",", 
     RowBox[{"Bc11", "\[Rule]", 
      RowBox[{"-", "0.0881`"}]}], ",", 
     RowBox[{"Bc12", "\[Rule]", 
      RowBox[{"-", "0.3731`"}]}], ",", 
     RowBox[{"Bc13", "\[Rule]", 
      RowBox[{"-", "0.1642`"}]}], ",", 
     RowBox[{"Bc14", "\[Rule]", 
      RowBox[{"-", "0.1958`"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885476297316709*^9, 3.885476308205892*^9}, {
  3.885476531825411*^9, 3.885476534332635*^9}, {3.885476584732235*^9, 
  3.8854765849782333`*^9}, {3.895473887747778*^9, 3.895473888340447*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"64d369d8-b6c2-4ca1-9fa9-166acaa85eb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfixstochBOSS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Be1", "\[Rule]", "1.6922`"}], ",", 
     RowBox[{"Be2", "\[Rule]", "0.9091`"}], ",", 
     RowBox[{"ce2", "\[Rule]", "0.5548`"}], ",", 
     RowBox[{"Be3", "\[Rule]", "0.0737`"}], ",", 
     RowBox[{"Be4", "\[Rule]", 
      RowBox[{"-", "0.1381`"}]}], ",", 
     RowBox[{"Be5", "\[Rule]", "6.0673`"}], ",", 
     RowBox[{"Be6", "\[Rule]", 
      RowBox[{"-", "0.0932`"}]}], ",", 
     RowBox[{"Be7", "\[Rule]", 
      RowBox[{"-", "0.9702`"}]}], ",", 
     RowBox[{"Be8", "\[Rule]", "0.2617`"}], ",", 
     RowBox[{"Be9", "\[Rule]", "0.2638`"}], ",", 
     RowBox[{"Be10", "\[Rule]", 
      RowBox[{"-", "0.1526`"}]}], ",", 
     RowBox[{"Be11", "\[Rule]", "0.427`"}], ",", 
     RowBox[{"Be12", "\[Rule]", 
      RowBox[{"-", "0.4322`"}]}], ",", 
     RowBox[{"Bd1", "\[Rule]", "5.4`"}], ",", 
     RowBox[{"Bd2", "\[Rule]", 
      RowBox[{"-", "0.721`"}]}], ",", 
     RowBox[{"Bd3", "\[Rule]", 
      RowBox[{"-", "0.4266`"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885476350545994*^9, 3.885476355253351*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"727cb9d1-26bc-4813-9c41-e2f34fa2c6b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfixstochBOSSNS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Be1", "\[Rule]", "0"}], ",", 
     RowBox[{"Be2", "\[Rule]", "0.9091`"}], ",", 
     RowBox[{"ce2", "\[Rule]", "0.5548`"}], ",", 
     RowBox[{"Be3", "\[Rule]", "0.0737`"}], ",", 
     RowBox[{"Be4", "\[Rule]", 
      RowBox[{"-", "0.1381`"}]}], ",", 
     RowBox[{"Be5", "\[Rule]", "6.0673`"}], ",", 
     RowBox[{"Be6", "\[Rule]", 
      RowBox[{"-", "0.0932`"}]}], ",", 
     RowBox[{"Be7", "\[Rule]", 
      RowBox[{"-", "0.9702`"}]}], ",", 
     RowBox[{"Be8", "\[Rule]", "0.2617`"}], ",", 
     RowBox[{"Be9", "\[Rule]", "0.2638`"}], ",", 
     RowBox[{"Be10", "\[Rule]", 
      RowBox[{"-", "0.1526`"}]}], ",", 
     RowBox[{"Be11", "\[Rule]", "0.427`"}], ",", 
     RowBox[{"Be12", "\[Rule]", 
      RowBox[{"-", "0.4322`"}]}], ",", 
     RowBox[{"Bd1", "\[Rule]", "5.4`"}], ",", 
     RowBox[{"Bd2", "\[Rule]", 
      RowBox[{"-", "0.721`"}]}], ",", 
     RowBox[{"Bd3", "\[Rule]", 
      RowBox[{"-", "0.4266`"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885484546980486*^9, 3.8854845494898987`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0b136008-a9a4-458d-98c3-b3d459fbd43b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfixstoch", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Be1", "\[Rule]", "0.9999999999999999`"}], ",", 
     RowBox[{"Be2", "\[Rule]", "0.5372296418863018`"}], ",", 
     RowBox[{"ce2", "\[Rule]", "0.32785722727809946`"}], ",", 
     RowBox[{"Be3", "\[Rule]", "0.04355277154000709`"}], ",", 
     RowBox[{"Be4", "\[Rule]", 
      RowBox[{"-", "0.0816097388015601`"}]}], ",", 
     RowBox[{"Be5", "\[Rule]", "3.585450892329512`"}], ",", 
     RowBox[{"Be6", "\[Rule]", 
      RowBox[{"-", "0.05507623212386243`"}]}], ",", 
     RowBox[{"Be7", "\[Rule]", 
      RowBox[{"-", "0.5733364850490485`"}]}], ",", 
     RowBox[{"Be8", "\[Rule]", "0.15465075050230467`"}], ",", 
     RowBox[{"Be9", "\[Rule]", "0.1558917385651814`"}], ",", 
     RowBox[{"Be10", "\[Rule]", 
      RowBox[{"-", "0.09017846590237562`"}]}], ",", 
     RowBox[{"Be11", "\[Rule]", "0.25233423945160144`"}], ",", 
     RowBox[{"Be12", "\[Rule]", 
      RowBox[{"-", "0.2554071622739629`"}]}], ",", 
     RowBox[{"Bd1", "\[Rule]", "3.1911121616830163`"}], ",", 
     RowBox[{"Bd2", "\[Rule]", 
      RowBox[{"-", "0.4260725682543434`"}]}], ",", 
     RowBox[{"Bd3", "\[Rule]", 
      RowBox[{"-", "0.25209786077295826`"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885476358949025*^9, 3.885476396160882*^9}, {
  3.885476467017571*^9, 3.885476468651724*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"b9977b93-b479-4e9b-b062-18b6eb20b16d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfixstochNS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Be1", "\[Rule]", "0"}], ",", 
     RowBox[{"Be2", "\[Rule]", "0.5372296418863018`"}], ",", 
     RowBox[{"ce2", "\[Rule]", "0.32785722727809946`"}], ",", 
     RowBox[{"Be3", "\[Rule]", "0.04355277154000709`"}], ",", 
     RowBox[{"Be4", "\[Rule]", 
      RowBox[{"-", "0.0816097388015601`"}]}], ",", 
     RowBox[{"Be5", "\[Rule]", "3.585450892329512`"}], ",", 
     RowBox[{"Be6", "\[Rule]", 
      RowBox[{"-", "0.05507623212386243`"}]}], ",", 
     RowBox[{"Be7", "\[Rule]", 
      RowBox[{"-", "0.5733364850490485`"}]}], ",", 
     RowBox[{"Be8", "\[Rule]", "0.15465075050230467`"}], ",", 
     RowBox[{"Be9", "\[Rule]", "0.1558917385651814`"}], ",", 
     RowBox[{"Be10", "\[Rule]", 
      RowBox[{"-", "0.09017846590237562`"}]}], ",", 
     RowBox[{"Be11", "\[Rule]", "0.25233423945160144`"}], ",", 
     RowBox[{"Be12", "\[Rule]", 
      RowBox[{"-", "0.2554071622739629`"}]}], ",", 
     RowBox[{"Bd1", "\[Rule]", "3.1911121616830163`"}], ",", 
     RowBox[{"Bd2", "\[Rule]", 
      RowBox[{"-", "0.4260725682543434`"}]}], ",", 
     RowBox[{"Bd3", "\[Rule]", 
      RowBox[{"-", "0.25209786077295826`"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8854770189465427`*^9, 3.885477020652141*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"efcd3ba2-779a-457b-b65d-122d6cb52eff"],

Cell["\<\
Change  bestfit to new linear bias (this is an approximation, where we assume \
all biases rescale like the linear one) also we do not evolve stochastic \
terms in time\
\>", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
   3.878318564396934*^9, 3.8783185665840807`*^9}, {3.8783189236834927`*^9, 
   3.8783189249818363`*^9}, {3.878319312638801*^9, 3.878319318630226*^9}, {
   3.878319791587068*^9, 3.8783198013821087`*^9}, 3.87838553656479*^9, {
   3.878385625344995*^9, 3.878385670715609*^9}, {3.885476990533882*^9, 
   3.885476999363811*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ad7e2d75-ca1d-4691-a8b2-c742aa18e6b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfixn", "[", 
   RowBox[{"newb1_", ",", "stoch_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"bfixBOSS", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bfixBOSS", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], 
        FractionBox["newb1", 
         RowBox[{"b1", "/.", "bfixBOSS"}]]}], ")"}]}], "]"}], ",", "stoch", 
    ",", "fnlfix", ",", "paramfix"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8854766804582243`*^9, 3.8854767935927963`*^9}, {
  3.885476878633026*^9, 3.885476878930846*^9}, {3.885476912177162*^9, 
  3.885476921651593*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"7b252ab2-4250-4aa7-858e-47c795cb402d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"shiftedbfix", "[", 
    RowBox[{"spec_", ",", "stoch_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"bfixn", "[", 
      RowBox[{
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"7", ",", "i"}], "]"}], "]"}], ",", "stoch"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"spec", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.88547688858877*^9, 3.8854768889177628`*^9}, {
  3.885476926361569*^9, 3.8854769749438057`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"f5c006ec-597f-4983-82b5-4e581cec625a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Manipulate Plin for IR-resummation and decomposition", "Subsection",
 CellChangeTimes->{{3.8233042400860405`*^9, 3.8233042459302764`*^9}, {
  3.824151839020433*^9, 3.8241518404922485`*^9}, {3.8242467352903733`*^9, 
  3.8242467397239637`*^9}, {3.82647160679583*^9, 3.826471608039091*^9}, {
  3.872298445684614*^9, 
  3.8722984570430613`*^9}},ExpressionUUID->"25c66ec3-ab31-460d-89cd-\
dfa993773da1"],

Cell[CellGroupData[{

Cell["IR resummation functions", "Subsubsection",
 CellChangeTimes->{{3.872298461378528*^9, 
  3.872298466623674*^9}},ExpressionUUID->"bb0fc1a5-4674-4140-8484-\
e851d4cf3e0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ho", "=", 
   RowBox[{"1", "/", "2998"}]}], " ", ";"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"c5daa864-2799-4c5b-bca9-c9a3a2bf8039"],

Cell[BoxData[
 RowBox[{"Clear", "[", "ss", "]"}]], "Input",
 CellChangeTimes->{{3.887879436127686*^9, 3.8878794401910477`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"2166fd91-f669-4e58-baae-5ebee4562eeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tcmb", "=", "2.728"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alph", "[", 
    RowBox[{"\[Omega]mo_", ",", "\[Omega]bo_"}], "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"0.328", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"431", " ", "\[Omega]mo"}], "]"}], 
     FractionBox["\[Omega]bo", "\[Omega]mo"]}], "+", 
    RowBox[{"0.38", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"22.3", "  ", "\[Omega]mo"}], " ", "]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["\[Omega]bo", "\[Omega]mo"], ")"}], "2"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"h_", ",", "\[Omega]mo_", ",", "\[Omega]bo_"}], "]"}], ":=", 
   RowBox[{"44.5", 
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"9.83", "/", 
       RowBox[{"(", "\[Omega]mo", ")"}]}], "]"}], 
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"10", 
        SuperscriptBox[
         RowBox[{"(", "\[Omega]bo", ")"}], "0.75"]}]}]]], "h"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gamma", "[", 
    RowBox[{"k_", ",", "h_", ",", "\[Omega]mo_", ",", "\[Omega]bo_"}], "]"}], 
   ":=", 
   RowBox[{
    FractionBox["\[Omega]mo", "h"], "  ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"alph", "[", 
       RowBox[{"\[Omega]mo", ",", "\[Omega]bo"}], "]"}], "+", 
      FractionBox[
       RowBox[{"1", "-", 
        RowBox[{"alph", "[", 
         RowBox[{"\[Omega]mo", ",", "\[Omega]bo"}], "]"}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"0.43", " ", 
           RowBox[{"ss", "[", 
            RowBox[{"h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], "]"}], " ", 
           "k"}], ")"}], "4"]}]]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qq", "[", 
    RowBox[{"k_", ",", "h_", ",", "\[Omega]mo_", ",", "\[Omega]bo_"}], "]"}], 
   ":=", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["Tcmb", "2.7"], ")"}], "2"], 
    FractionBox["k", 
     RowBox[{"gamma", "[", 
      RowBox[{"k", ",", "h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], 
      "]"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L0", "[", 
    RowBox[{"k_", ",", "h_", ",", "\[Omega]mo_", ",", "\[Omega]bo_"}], "]"}], 
   ":=", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"2", " ", "\[ExponentialE]"}], "+", 
     RowBox[{"1.8", " ", 
      RowBox[{"qq", "[", 
       RowBox[{"k", ",", "h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C0", "[", 
    RowBox[{"k_", ",", "h_", ",", "\[Omega]mo_", ",", "\[Omega]bo_"}], "]"}], 
   ":=", 
   RowBox[{"14.2", "+", 
    FractionBox["731", 
     RowBox[{"1", "+", 
      RowBox[{"62.5", " ", 
       RowBox[{"qq", "[", 
        RowBox[{"k", ",", "h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], 
        "]"}]}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tnw", "[", 
   RowBox[{"k_", ",", "h_", ",", "\[Omega]mo_", ",", "\[Omega]bo_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"L0", "[", 
    RowBox[{"k", ",", "h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"L0", "[", 
      RowBox[{"k", ",", "h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], "]"}], 
     "+", 
     RowBox[{
      RowBox[{"C0", "[", 
       RowBox[{"k", ",", "h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], "]"}], 
      SuperscriptBox[
       RowBox[{"qq", "[", 
        RowBox[{"k", ",", "h", ",", "\[Omega]mo", ",", "\[Omega]bo"}], "]"}], 
       "2"]}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.824228427822036*^9, 3.82422849458391*^9}, {
  3.826020853865164*^9, 3.8260208541236863`*^9}, {3.8260209846227884`*^9, 
  3.8260210007222605`*^9}, {3.826021046842255*^9, 3.826021196939199*^9}, {
  3.8269915797653008`*^9, 3.8269916725725927`*^9}, {3.826992612139552*^9, 
  3.826992690815546*^9}, {3.8269927263338757`*^9, 3.82699274366078*^9}, {
  3.8510891384207106`*^9, 3.8510891467992973`*^9}, {3.8595483863746567`*^9, 
  3.8595483864452972`*^9}, {3.859548427299262*^9, 3.8595484369361672`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"40ec03f4-4193-47d4-8ae3-436df527e70b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dlin", "[", 
    RowBox[{"a_", ",", "h_", ",", "\[Omega]mo_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["a", 
      RowBox[{"3", " ", 
       SqrtBox[
        RowBox[{
         FractionBox["\[Omega]mo", 
          SuperscriptBox["h", "2"]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["a", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox["\[Omega]mo", 
               SuperscriptBox["h", "2"]]}], ")"}]}], "+", 
           FractionBox["\[Omega]mo", 
            SuperscriptBox["h", "2"]]}], ")"}]}]]}]]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", 
       FractionBox["\[Omega]mo", 
        SuperscriptBox["h", "2"]], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], ",", 
         FractionBox["5", "6"], ",", 
         FractionBox["11", "6"], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["a", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox["\[Omega]mo", 
               SuperscriptBox["h", "2"]]}], ")"}]}], 
           FractionBox["\[Omega]mo", 
            SuperscriptBox["h", "2"]]]}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["a", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["\[Omega]mo", 
             SuperscriptBox["h", "2"]]}], ")"}]}], "+", 
         RowBox[{"5", " ", 
          FractionBox["\[Omega]mo", 
           SuperscriptBox["h", "2"]]}]}], ")"}], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         FractionBox["1", "2"], ",", 
         FractionBox["5", "6"], ",", 
         FractionBox["11", "6"], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["a", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox["\[Omega]mo", 
               SuperscriptBox["h", "2"]]}], ")"}]}], 
           FractionBox["\[Omega]mo", 
            SuperscriptBox["h", "2"]]]}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dlinz", "[", 
    RowBox[{"z_", ",", "h_", ",", "\[Omega]mo_"}], "]"}], ":=", 
   RowBox[{"Dlin", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "+", "z"}]], ",", "h", ",", "\[Omega]mo"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8242333973354053`*^9, 3.824233422492607*^9}, {
  3.824233516292571*^9, 3.8242335405404663`*^9}, {3.824233595530195*^9, 
  3.8242336184180937`*^9}, {3.826021246910445*^9, 3.826021304544264*^9}, {
  3.826992760368518*^9, 3.8269927822060175`*^9}, {3.826992971004707*^9, 
  3.8269930082796803`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"4c01172d-5400-4a12-be24-cb5ced6f6d81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kP", "[", "h_", "]"}], ":=", 
   RowBox[{"0.05", " ", 
    SuperscriptBox["h", 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PLnw", "[", 
    RowBox[{
    "k_", ",", "z_", ",", "h_", ",", "\[CapitalOmega]mo_", ",", "\[Omega]bo_",
      ",", "lnAs_", ",", "ns_"}], "]"}], ":=", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Pi]", "2"], 
    FractionBox["4", "25"], " ", 
    FractionBox[
     RowBox[{
      RowBox[{"Exp", "[", "lnAs", "]"}], "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "10"}]], " ", "k", " "}], 
     RowBox[{
      SuperscriptBox["Ho", "4"], 
      SuperscriptBox["\[CapitalOmega]mo", "2"]}]], 
    SuperscriptBox[
     RowBox[{"Dlinz", "[", 
      RowBox[{"z", ",", "h", ",", 
       RowBox[{"\[CapitalOmega]mo", " ", 
        SuperscriptBox["h", "2"]}]}], "]"}], "2"], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"k", " "}], 
       RowBox[{"kP", "[", "h", "]"}]], ")"}], 
     RowBox[{"ns", "-", "1"}]], 
    SuperscriptBox[
     RowBox[{"Tnw", "[", 
      RowBox[{"k", ",", "h", ",", 
       RowBox[{"\[CapitalOmega]mo", " ", 
        SuperscriptBox["h", "2"]}], ",", "\[Omega]bo"}], "]"}], "2"]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8242290274326687`*^9, 3.824229029451044*^9}, {
   3.8242294655406313`*^9, 3.824229469778174*^9}, {3.824229612806644*^9, 
   3.824229619826413*^9}, {3.824229993439479*^9, 3.824230014091902*^9}, {
   3.8242316517317963`*^9, 3.824231658105014*^9}, 3.824233652262869*^9, {
   3.824233898154591*^9, 3.824233922171389*^9}, {3.826021311732221*^9, 
   3.8260213793818507`*^9}, {3.826021590374197*^9, 3.8260215906413193`*^9}, {
   3.82699319753203*^9, 3.826993257958674*^9}, {3.826995210999189*^9, 
   3.826995213912695*^9}, {3.82699526785888*^9, 3.8269952685570307`*^9}, {
   3.859202996424014*^9, 3.8592030389839115`*^9}, 3.859203136247549*^9, {
   3.8595483864518523`*^9, 3.8595483864553766`*^9}, {3.859548436941716*^9, 
   3.859548436944809*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"9e9c9915-7089-46b9-96f3-b8bebf75ac25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", "=", "0.25"}], ";"}]], "Input",
 CellChangeTimes->{{3.8242458331526847`*^9, 3.8242458370170975`*^9}, {
  3.824245874429221*^9, 3.8242458746685934`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"8c706810-1ced-4b31-b3e6-8efba3b2c1be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pwnwdat", "[", 
   RowBox[{
   "dat_", ",", "z_", ",", "h_", ",", "\[CapitalOmega]mo_", ",", 
    "\[Omega]bo_", ",", "lnAs_", ",", "ns_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "plindat", ",", "iplin", ",", "klin", ",", "plinEHtab", ",", "iR", ",", 
      "fk", ",", "pnw", ",", "pw", ",", "ipnw", ",", "ipw", ",", 
      "\[CapitalSigma]2", ",", "\[Delta]\[CapitalSigma]2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plindat", "=", "dat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"klin", "=", 
      RowBox[{"plindat", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plinEHtab", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"klin", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"PLnw", "[", 
           RowBox[{
            RowBox[{"klin", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "z", ",", "h", ",", 
            "\[CapitalOmega]mo", ",", "\[Omega]bo", ",", "lnAs", ",", "ns"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "klin", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"iR", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"klin", ",", 
          FractionBox[
           RowBox[{"plindat", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
           RowBox[{"plinEHtab", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fk", "[", "k_", "]"}], ":=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"iR", "[", 
          SuperscriptBox["10", "x"], "]"}], " ", 
         RowBox[{
          RowBox[{"PDF", "[", 
           RowBox[{"NormalDistribution", "[", 
            RowBox[{
             RowBox[{"Log10", "[", "k", "]"}], ",", "\[Lambda]"}], "]"}], 
           "]"}], "[", "x", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"Log10", "[", "k", "]"}], "-", 
           RowBox[{"4", " ", "\[Lambda]"}]}], ",", 
          RowBox[{
           RowBox[{"Log10", "[", "k", "]"}], "+", 
           RowBox[{"4", " ", "\[Lambda]"}]}]}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<LocalAdaptive\>\"", ",", 
           RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pnw", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "klin", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"plinEHtab", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"fk", "[", 
            RowBox[{
            "klin", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "klin", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pw", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "klin", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"plindat", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
           RowBox[{"pnw", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "klin", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ipnw", "=", 
      RowBox[{"Interpolation", "[", "pnw", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ipw", "=", 
      RowBox[{"Interpolation", "[", "pw", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]2", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", 
         SuperscriptBox["\[Pi]", "2"]}]], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"SphericalBesselJ", "[", 
              RowBox[{"0", ",", 
               RowBox[{"q", " ", "losc"}]}], "]"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"SphericalBesselJ", "[", 
               RowBox[{"2", ",", 
                RowBox[{"q", " ", "losc"}]}], "]"}]}]}], ")"}], 
           RowBox[{"ipnw", "[", "q", "]"}]}], "/.", 
          RowBox[{"losc", "\[Rule]", "110"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", 
           RowBox[{
           "klin", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "0.2"}], "}"}]}], "]"}]}]}], ";", "\n", 
     RowBox[{"\[Delta]\[CapitalSigma]2", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Pi]", "2"]}]], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SphericalBesselJ", "[", 
            RowBox[{"2", ",", 
             RowBox[{"q", " ", "losc"}]}], "]"}], 
           RowBox[{"ipnw", "[", "q", "]"}]}], "/.", 
          RowBox[{"losc", "\[Rule]", "110"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", 
           RowBox[{
           "klin", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "0.2"}], "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "pnw", ",", "pw", ",", "\[CapitalSigma]2", ",", 
       "\[Delta]\[CapitalSigma]2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.824245473684967*^9, 3.824245569018676*^9}, {
   3.824245644353461*^9, 3.824245657658865*^9}, {3.824245700385511*^9, 
   3.8242457823041925`*^9}, {3.8242458599567327`*^9, 
   3.8242458652271385`*^9}, {3.824245899889493*^9, 3.824246003982457*^9}, {
   3.824246075246049*^9, 3.824246184607853*^9}, 3.824246311092114*^9, {
   3.8242464436724825`*^9, 3.824246454017674*^9}, {3.8242468079578967`*^9, 
   3.8242468124373407`*^9}, {3.824287758502564*^9, 3.8242877871995025`*^9}, {
   3.8242878419395447`*^9, 3.824287872092209*^9}, {3.8242881112391863`*^9, 
   3.8242881937221055`*^9}, {3.8242883218979535`*^9, 3.824288323488044*^9}, {
   3.8243697087715464`*^9, 3.8243697117899675`*^9}, {3.8260258473760047`*^9, 
   3.8260258598596745`*^9}, {3.8260259115474596`*^9, 3.826025915844813*^9}, 
   3.8260259962302575`*^9, {3.8269955332832174`*^9, 3.82699553538373*^9}, {
   3.8269964531091805`*^9, 3.826996454219929*^9}, {3.826998718054936*^9, 
   3.826998826706139*^9}, {3.827000467234462*^9, 3.82700046927886*^9}, 
   3.8270009905691376`*^9, {3.8553093635368752`*^9, 3.855309368015204*^9}, {
   3.859203171801525*^9, 3.8592031724962435`*^9}, {3.8595483864654655`*^9, 
   3.8595483864700007`*^9}, {3.8595484369522557`*^9, 3.8595484369564095`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"025e2b7c-0e12-411d-b136-57cbfc91bda0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pwnwavg", "[", 
   RowBox[{
   "dat_", ",", "f_", ",", "z_", ",", "h_", ",", "\[CapitalOmega]mo_", ",", 
    "\[Omega]bo_", ",", "lnAs_", ",", "ns_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "full", ",", "klin", ",", "plindat", ",", "pnw", ",", "pw", ",", "ipnw", 
      ",", "ipw", ",", "\[CapitalSigma]2", ",", "\[Delta]\[CapitalSigma]2", 
      ",", "\[CapitalSigma]tot2avg"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"full", "  ", "=", " ", 
      RowBox[{"pwnwdat", "[", 
       RowBox[{
       "dat", ",", "z", ",", "h", ",", "\[CapitalOmega]mo", ",", "\[Omega]bo",
         ",", "lnAs", ",", "ns"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plindat", "=", "dat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"klin", "=", 
      RowBox[{"plindat", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pnw", " ", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pw", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]2", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]\[CapitalSigma]2", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]tot2avg", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "15"]}], " ", 
        SuperscriptBox["f", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[Delta]\[CapitalSigma]2"}], "-", 
          RowBox[{"5", " ", "\[CapitalSigma]2"}]}], ")"}]}], "+", 
       "\[CapitalSigma]2", "+", 
       FractionBox[
        RowBox[{"2", " ", "f", " ", "\[CapitalSigma]2"}], "3"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"klin", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"pnw", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", " ", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"klin", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "2"]}], 
             "\[CapitalSigma]tot2avg"}], "]"}], 
           RowBox[{"pw", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "klin", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pwnwavgTree", "[", 
   RowBox[{
   "dat_", ",", "f_", ",", "z_", ",", "h_", ",", "\[CapitalOmega]mo_", ",", 
    "\[Omega]bo_", ",", "lnAs_", ",", "ns_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "full", ",", "klin", ",", "plindat", ",", "pnw", ",", "pw", ",", "ipnw", 
      ",", "ipw", ",", "\[CapitalSigma]2", ",", "\[Delta]\[CapitalSigma]2", 
      ",", "\[CapitalSigma]tot2avg"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"full", "  ", "=", " ", 
      RowBox[{"pwnwdat", "[", 
       RowBox[{
       "dat", ",", "z", ",", "h", ",", "\[CapitalOmega]mo", ",", "\[Omega]bo",
         ",", "lnAs", ",", "ns"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plindat", "=", "dat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"klin", "=", 
      RowBox[{"plindat", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pnw", " ", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pw", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]2", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]\[CapitalSigma]2", "=", " ", 
      RowBox[{"full", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]tot2avg", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "15"]}], " ", 
        SuperscriptBox["f", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[Delta]\[CapitalSigma]2"}], "-", 
          RowBox[{"5", " ", "\[CapitalSigma]2"}]}], ")"}]}], "+", 
       "\[CapitalSigma]2", "+", 
       FractionBox[
        RowBox[{"2", " ", "f", " ", "\[CapitalSigma]2"}], "3"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"klin", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"pnw", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"klin", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "2"], 
              "\[CapitalSigma]tot2avg"}]}], ")"}], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"klin", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "2"]}], 
             "\[CapitalSigma]tot2avg"}], "]"}], 
           RowBox[{"pw", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "klin", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8242886281735363`*^9, 3.824288842054801*^9}, {
   3.824288926891656*^9, 3.824288930412013*^9}, {3.82429530151223*^9, 
   3.8242953061580825`*^9}, {3.8242971496587677`*^9, 
   3.8242971580348983`*^9}, {3.824297188141562*^9, 3.824297243362626*^9}, {
   3.8242972917621384`*^9, 3.824297294703221*^9}, {3.8242978044214954`*^9, 
   3.824297813167178*^9}, {3.824297909845583*^9, 3.8242979477009554`*^9}, {
   3.8242981448072743`*^9, 3.8242981917040663`*^9}, {3.8243697551845765`*^9, 
   3.8243697570713124`*^9}, {3.826025946209279*^9, 3.8260259548899107`*^9}, {
   3.826995537511572*^9, 3.826995539450594*^9}, {3.8269964566024923`*^9, 
   3.8269964575078278`*^9}, 3.827000941553684*^9, 3.827322657794044*^9, 
   3.827323122227503*^9, {3.859203173913754*^9, 3.8592031744744253`*^9}, {
   3.85954838647705*^9, 3.859548386482606*^9}, {3.859548436963488*^9, 
   3.859548436966381*^9}, {3.8704948900450897`*^9, 3.870494907234829*^9}, 
   3.870495064270155*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"087b3902-363d-46ba-bdd6-11d0b22c97a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IRrep", "[", "res_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Pnw", "\[Rule]", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"res", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "//", "Interpolation"}], ")"}]}], ",", 
    RowBox[{"Pw", "\[Rule]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"res", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", "Interpolation"}], ")"}]}], ",", 
    RowBox[{"\[CapitalSigma]2", "\[Rule]", " ", 
     RowBox[{"res", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{"\[Delta]\[CapitalSigma]2", "\[Rule]", " ", 
     RowBox[{"res", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"832a8e5c-9dd4-463f-ae95-3bde02f1e5ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalSigma]tot2", "[", 
   RowBox[{"\[Mu]_", ",", "f_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"f", " ", 
       SuperscriptBox["\[Mu]", "2"], 
       RowBox[{"(", 
        RowBox[{"2", "+", "f"}], ")"}]}]}], ")"}], "\[CapitalSigma]2"}], "+", 
   RowBox[{
    SuperscriptBox["f", "2"], 
    SuperscriptBox["\[Mu]", "2"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Mu]", "2"], "-", "1"}], ")"}], 
    "\[Delta]\[CapitalSigma]2"}]}]}]], "Input",
 CellChangeTimes->{
  3.824298399205532*^9, {3.8243706681275816`*^9, 3.8243706756105294`*^9}, {
   3.824473937166915*^9, 3.824473937743157*^9}, {3.824473990419207*^9, 
   3.8244739940594025`*^9}, {3.8273203935473533`*^9, 3.827320417192904*^9}, {
   3.8273231590553217`*^9, 3.8273231622289333`*^9}, {3.827323197389564*^9, 
   3.827323212176195*^9}, {3.827323298529451*^9, 3.8273232998227215`*^9}, {
   3.827592806023881*^9, 3.827592806168067*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"a6c67862-6e88-4288-8d15-c527c81faf38"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plin decomposition", "Subsubsection",
 CellChangeTimes->{{3.8722984803126707`*^9, 3.872298483554838*^9}, {
  3.872298520768156*^9, 
  3.872298537815727*^9}},ExpressionUUID->"3039824a-f227-4973-80ef-\
d4712df34e8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kmax", "=", "1000"}], ";"}]], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"022de9d9-d67e-45fd-9f6d-d39caffb7427"],

Cell[BoxData[
 RowBox[{
  RowBox[{"highval", "[", "plindat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nshigh", ",", "Ashigh", ",", "pextrahigh"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nshigh", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"plindat", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "-", 
          RowBox[{"Log", "[", 
           RowBox[{"plindat", "[", 
            RowBox[{"[", 
             RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"plindat", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "-", 
          RowBox[{"Log", "[", 
           RowBox[{"plindat", "[", 
            RowBox[{"[", 
             RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ashigh", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"plindat", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"plindat", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "nshigh"]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pextrahigh", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"plindat", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "0.01"], "+", "0.01", 
           "+", 
           SuperscriptBox["10", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], " ", "0.01"}]]}], ",", " ", 
          RowBox[{"Ashigh", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               FractionBox[
                RowBox[{"Log10", "[", 
                 RowBox[{
                  RowBox[{"plindat", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "0.01"], "+", "0.01",
                "+", 
               SuperscriptBox["10", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], " ", "0.01"}]]}], 
              RowBox[{
               RowBox[{"plindat", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]], ")"}], "nshigh"]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            FractionBox[
             RowBox[{"Log10", "[", "kmax", "]"}], "0.01"], "]"}], "+", 
           "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{"plindat", ",", "pextrahigh"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.826356609877014*^9, 3.826356656314909*^9}, 
   3.8263568106076045`*^9, 3.826358579654022*^9, 3.826359388368717*^9, 
   3.8274853671274652`*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"a718dae9-6737-4e1d-9aa2-4879431916b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Nmax", " ", "log", " ", "k", " ", "bins"}], ",", " ", 
    RowBox[{"form", " ", "kmin", " ", "to", " ", "kmax"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kBins", "[", 
     RowBox[{"Nmax_", ",", "kmin_", ",", "kmax_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalDelta]", ",", "result"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", "=", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"Nmax", "-", "1"}]], 
          RowBox[{"Log", "[", 
           FractionBox["kmax", "kmin"], "]"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"kmin", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], " ", "\[CapitalDelta]"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Nmax"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.819039356791849*^9, 3.819039357095039*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"846845d4-6b35-4ec3-aa42-14dedbba4aaf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kmaxFit", " ", "=", " ", "0.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kminFit", " ", "=", " ", "0.001"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8420316063936357`*^9, 3.8420316288401003`*^9}, 
   3.8510204813769836`*^9, {3.851020522780489*^9, 3.8510205229074793`*^9}, 
   3.851020714117572*^9, {3.851790273887822*^9, 3.851790274075263*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"5efc2e92-0dc2-430b-bd71-a655509da29b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genPlinCoef", "[", 
   RowBox[{"imax_", ",", "dat_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "knFit", ",", "k", ",", "MyPsmoothtab", ",", "errors", ",", "Parameters",
       ",", "MyFitFunctions", ",", "nlm", ",", "Plin", ",", "Pinteger", ",", 
      "coefnowig"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plin", "=", 
      RowBox[{"Interpolation", "[", "dat", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"knFit", "=", 
      RowBox[{"kBins", "[", 
       RowBox[{"100", ",", "kminFit", ",", "kmaxFit"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MyPsmoothtab", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "knFit", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"Plin", "[", 
           RowBox[{
           "knFit", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "knFit", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"errors", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MyPsmoothtab", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "knFit", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"kuv1", "=", "0.069"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kuv2", "=", "0.0082"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kuv3", "=", "0.0013"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kuv4", "=", "0.0000135"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kuv5", " ", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kpeak1", "=", 
      RowBox[{"-", "0.034"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kpeak2", "=", 
      RowBox[{"-", "0.001"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kpeak3", "=", 
      RowBox[{"-", "0.000076"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kpeak4", "=", 
      RowBox[{"-", "0.0000156"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Parameters", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a1", "[", "i", "]"}], ",", 
           RowBox[{"a2", "[", "i", "]"}], ",", 
           RowBox[{"a3", "[", "i", "]"}], ",", 
           RowBox[{"a4", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MyFitFunctions", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            FractionBox["1", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox["k", "2"], 
                SuperscriptBox["kuv5", "2"]]}], ")"}]], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak1"}], ")"}], "2"], 
                    SuperscriptBox["kuv1", "2"]]}], ")"}], 
                 RowBox[{"(", "i", ")"}]]], ",", " ", 
               FractionBox[
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["k", 
                   RowBox[{"1", "/", "20"}]], ")"}], "2"], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak2"}], ")"}], "2"], 
                    SuperscriptBox["kuv2", "2"]]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}]]], ",", 
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak3"}], ")"}], "2"], 
                    SuperscriptBox["kuv3", "2"]]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"i", "+", "2"}], ")"}]]], ",", 
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak4"}], ")"}], "2"], 
                    SuperscriptBox["kuv4", "2"]]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}]]]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}]}], "]"}], 
         "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nlm", "=", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{"MyPsmoothtab", ",", "MyFitFunctions", ",", "k", ",", 
        RowBox[{"Weights", "\[Rule]", 
         FractionBox["1", 
          SuperscriptBox["errors", "2"]]}], ",", 
        RowBox[{"IncludeConstantBasis", "\[Rule]", "False"}]}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pinteger", "[", "k_", "]"}], "=", 
      RowBox[{"nlm", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coefnowig", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], ",", "50"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Pinteger", "[", "q", "]"}], ",", "coefnowig"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.841503515215816*^9, 3.841503567828342*^9}, {
   3.841503622098826*^9, 3.8415037409337797`*^9}, {3.841503791120183*^9, 
   3.841503824743412*^9}, {3.841503924281901*^9, 3.8415039244116573`*^9}, {
   3.841504036767881*^9, 3.841504051592267*^9}, {3.841504083539542*^9, 
   3.841504103530798*^9}, {3.8419351070814734`*^9, 3.8419351118592443`*^9}, {
   3.842031614031726*^9, 3.842031638165668*^9}, 3.8420316758993998`*^9, {
   3.842032168330083*^9, 3.84203217979782*^9}, {3.8420474252344637`*^9, 
   3.842047430122857*^9}, {3.851523595302593*^9, 3.851523595745265*^9}, 
   3.851523631906959*^9, {3.853853076379998*^9, 3.8538530960429077`*^9}, {
   3.853944143963623*^9, 3.853944156678894*^9}, {3.853948877631281*^9, 
   3.8539488781254797`*^9}, {3.854213631405365*^9, 3.854213631449149*^9}, {
   3.856806805386994*^9, 3.856806805885378*^9}, 3.8938281199233637`*^9, 
   3.893828179433674*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"37bda897-8074-4e62-b0d0-0d1462883c15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyFitFunctions", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         FractionBox["1", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox["k", "2"], 
             SuperscriptBox["kuv5", "2"]]}], ")"}]], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak1"}], ")"}], "2"], 
                 SuperscriptBox["kuv1", "2"]]}], ")"}], 
              RowBox[{"(", "i", ")"}]]], ",", " ", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox["k", 
                RowBox[{"1", "/", "20"}]], ")"}], "2"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak2"}], ")"}], "2"], 
                 SuperscriptBox["kuv2", "2"]]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}]]], ",", 
            FractionBox["1", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak3"}], ")"}], "2"], 
                 SuperscriptBox["kuv3", "2"]]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"i", "+", "2"}], ")"}]]], ",", 
            FractionBox["1", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["k", "2"], "-", "kpeak4"}], ")"}], "2"], 
                 SuperscriptBox["kuv4", "2"]]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}]]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}], "]"}], 
     ",", "2"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872842089393485*^9, 3.872842089846793*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"108a6c3b-4f5c-48d0-abe0-1fe4939b49c1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Final needed functions", "Subsubsection",
 CellChangeTimes->{{3.872298497937295*^9, 
  3.872298503427107*^9}},ExpressionUUID->"d6e8842f-9194-4129-8ebb-\
9251138433ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IRls", "[", 
   RowBox[{
   "dat_", ",", "hfactor_", ",", "\[CapitalOmega]mfacor_", ",", 
    "\[Omega]bfacor_", ",", "Asfactor_", ",", "nsfactor_", ",", "zpk_", ",", 
    "f1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iplin", ",", "splitwnw", ",", "ls", ",", "lsnw", ",", "iplinnw", ",", 
      "iplinw", ",", "sig", ",", "iplinresum", ",", "iplinresumTree"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iplin", " ", "=", 
      RowBox[{
       RowBox[{"highval", "[", "dat", "]"}], "//", "Interpolation"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"splitwnw", "=", 
      RowBox[{"pwnwdat", "[", 
       RowBox[{"dat", ",", "zpk", ",", 
        RowBox[{"hback", "*", "hfactor"}], ",", 
        RowBox[{"\[CapitalOmega]mback", "*", "\[CapitalOmega]mfacor"}], ",", 
        RowBox[{"\[Omega]bback", "*", "\[Omega]bfacor"}], ",", 
        RowBox[{"lnAsback", "+", "Asfactor"}], ",", 
        RowBox[{"nsback", "*", "nsfactor"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ls", "=", 
      RowBox[{
       RowBox[{"genPlinCoef", "[", 
        RowBox[{"3", ",", "dat"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lsnw", "=", 
      RowBox[{
       RowBox[{"genPlinCoef", "[", 
        RowBox[{"3", ",", 
         RowBox[{"splitwnw", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iplinnw", " ", "=", " ", 
      RowBox[{
       RowBox[{"highval", "[", 
        RowBox[{"splitwnw", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "Interpolation"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"iplinw", " ", "=", " ", 
      RowBox[{
       RowBox[{"highval", "[", 
        RowBox[{"splitwnw", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", "Interpolation"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sig", "=", 
      RowBox[{
       RowBox[{"\[CapitalSigma]tot2", "[", 
        RowBox[{"\[Mu]", ",", "f1"}], "]"}], "/.", 
       RowBox[{"IRrep", "[", "splitwnw", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"iplinresum", " ", "=", " ", 
      RowBox[{
       RowBox[{"pwnwavg", "[", 
        RowBox[{"dat", ",", "f1", ",", "zpk", ",", 
         RowBox[{"hback", "*", "hfactor"}], ",", 
         RowBox[{"\[CapitalOmega]mback", "*", "\[CapitalOmega]mfacor"}], ",", 
         RowBox[{"\[Omega]bback", "*", "\[Omega]bfacor"}], ",", 
         RowBox[{"lnAsback", "+", "Asfactor"}], ",", 
         RowBox[{"nsback", "*", "nsfactor"}]}], "]"}], "//", 
       "Interpolation"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"iplinresumTree", " ", "=", " ", 
      RowBox[{
       RowBox[{"pwnwavgTree", "[", 
        RowBox[{"dat", ",", "f1", ",", "zpk", ",", 
         RowBox[{"hback", "*", "hfactor"}], ",", 
         RowBox[{"\[CapitalOmega]mback", "*", "\[CapitalOmega]mfacor"}], ",", 
         RowBox[{"\[Omega]bback", "*", "\[Omega]bfacor"}], ",", 
         RowBox[{"lnAsback", "+", "Asfactor"}], ",", 
         RowBox[{"nsback", "*", "nsfactor"}]}], "]"}], "//", 
       "Interpolation"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "ls", ",", "lsnw", ",", "iplin", ",", "iplinnw", ",", "iplinw", ",", 
       "sig", ",", "iplinresum", ",", "iplinresumTree", ",", "f1"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.87229864317938*^9, 3.872298670601705*^9}, {
   3.872301598693972*^9, 3.872301610839383*^9}, 3.872305320414753*^9, 
   3.87335852974572*^9, 3.873359253094769*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"978fd682-eb7b-4061-96b9-9bde6a1cd8a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plinsubs", "[", 
   RowBox[{"survey_", ",", "zpk_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fback", ",", "f\[CapitalOmega]mhigh", ",", "f\[CapitalOmega]mlow", ",", 
      "f\[Omega]bhigh", ",", "f\[Omega]blow", ",", "fhhigh", ",", "fhlow", 
      ",", "fm\[Nu]high", ",", "fm\[Nu]low", ",", "f\[CapitalOmega]khigh", 
      ",", "f\[CapitalOmega]klow", ",", "path"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"path", " ", "=", " ", 
      RowBox[{"ToString", "[", "survey", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fback", ",", "f\[CapitalOmega]mhigh", ",", "f\[CapitalOmega]mlow", 
        ",", "f\[Omega]bhigh", ",", "f\[Omega]blow", ",", "fhhigh", ",", 
        "fhlow", ",", "fm\[Nu]high", ",", "fm\[Nu]low", ",", 
        "f\[CapitalOmega]khigh", ",", "f\[CapitalOmega]klow"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</allfs.dat\>\""}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "8", ",", "9", ",", "10", ",", "11", ",", "6", ",", "7", 
           ",", "12", ",", "13", ",", "14", ",", "15"}], "}"}], "]"}], "]"}], 
       "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_fid.dat\>\""}], "]"}],
          ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "zpk", ",", 
         "fback"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_lnAs_pl.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", "\[CapitalDelta]lnAs", 
         " ", ",", "1", ",", "zpk", ",", "fback"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_lnAs_min.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", 
         RowBox[{"-", "\[CapitalDelta]lnAs"}], " ", ",", "1", ",", "zpk", ",",
          "fback"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_ns_pl.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", "0", ",", 
         RowBox[{"1", "+", "\[CapitalDelta]ns"}], ",", "zpk", ",", "fback"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_ns_min.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", "0", ",", 
         RowBox[{"1", "-", "\[CapitalDelta]ns"}], ",", "zpk", ",", "fback"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_h_pl.dat\>\""}], 
          "]"}], ",", 
         RowBox[{"1", "+", "\[CapitalDelta]h"}], ",", "1", ",", "1", ",", "0",
          ",", "1", ",", "zpk", ",", "fhhigh"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_h_min.dat\>\""}], 
          "]"}], ",", 
         RowBox[{"1", "-", "\[CapitalDelta]h"}], ",", "1", ",", "1", ",", "0",
          ",", "1", ",", "zpk", ",", "fhlow"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_Om_pl.dat\>\""}], 
          "]"}], ",", "1", ",", 
         RowBox[{"1", "+", "\[CapitalDelta]\[CapitalOmega]m"}], ",", "1", ",",
          "0", ",", "1", ",", "zpk", ",", "f\[CapitalOmega]mhigh"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_Om_min.dat\>\""}], 
          "]"}], ",", "1", ",", 
         RowBox[{"1", "-", "\[CapitalDelta]\[CapitalOmega]m"}], ",", "1", ",",
          "0", ",", "1", ",", "zpk", ",", "f\[CapitalOmega]mlow"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_ob_pl.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", 
         RowBox[{"1", "+", "\[CapitalDelta]\[Omega]b"}], ",", "0", ",", "1", 
         ",", "zpk", ",", "f\[Omega]bhigh"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_ob_min.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", 
         RowBox[{"1", "-", "\[CapitalDelta]\[Omega]b"}], ",", "0", ",", "1", 
         ",", "zpk", ",", "f\[Omega]blow"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_nu_pl.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "zpk",
          ",", "fm\[Nu]high"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_nu_min.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "zpk",
          ",", "fm\[Nu]low"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_Ok_pl.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "zpk",
          ",", "f\[CapitalOmega]khigh"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"IRls", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</pk_Ok_min.dat\>\""}], 
          "]"}], ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "zpk",
          ",", "f\[CapitalOmega]klow"}], "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.860592153656376*^9, 3.8605922769401207`*^9}, {
   3.860592784042924*^9, 3.8605928116836967`*^9}, {3.860592862227766*^9, 
   3.860593003826927*^9}, {3.862333350169976*^9, 3.862333359303771*^9}, {
   3.86233339479215*^9, 3.8623334506526327`*^9}, {3.8646785674727793`*^9, 
   3.864678587100781*^9}, {3.870333698986932*^9, 3.870333714214059*^9}, {
   3.870333773386005*^9, 3.870333776185665*^9}, {3.870333806359174*^9, 
   3.870333809826613*^9}, {3.870333904297577*^9, 3.8703339234815283`*^9}, {
   3.870334186567668*^9, 3.8703343625316753`*^9}, 3.870334419313024*^9, {
   3.8703353148839827`*^9, 3.870335317703458*^9}, {3.870335705191218*^9, 
   3.870335712438648*^9}, {3.872299217985195*^9, 3.872299252052537*^9}, 
   3.8723015786441803`*^9, {3.872301629503119*^9, 3.872301671884811*^9}, {
   3.872303230926468*^9, 3.87230323637397*^9}, {3.872305310347661*^9, 
   3.872305326422699*^9}, {3.874329322979403*^9, 3.874329356536625*^9}, {
   3.874329421307653*^9, 3.874329424897448*^9}, {3.885482038550435*^9, 
   3.885482039182116*^9}, {3.885482172885857*^9, 3.885482199685717*^9}, {
   3.8854837279109087`*^9, 3.885483731933114*^9}, {3.893771904684319*^9, 
   3.8937719324686832`*^9}, 3.893772939044509*^9, {3.893828119927696*^9, 
   3.89382811995042*^9}, {3.893828179435911*^9, 3.893828179461527*^9}, 
   3.893830759069194*^9, {3.894995047044746*^9, 3.894995047071953*^9}, {
   3.896278404405775*^9, 3.896278404427391*^9}, {3.896294132545601*^9, 
   3.896294132568062*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"3ec26ec5-6300-4218-9b6e-0cf284f7ffe9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetT", "[", "path_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_fid.dat\>\""}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_lnAs_pl.dat\>\""}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_lnAs_min.dat\>\""}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_ns_pl.dat\>\""}],
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_ns_min.dat\>\""}], "]"}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_h_pl.dat\>\""}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_h_min.dat\>\""}],
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_Om_pl.dat\>\""}],
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_Om_min.dat\>\""}], "]"}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_ob_pl.dat\>\""}],
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_ob_min.dat\>\""}], "]"}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_nu_pl.dat\>\""}],
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_nu_min.dat\>\""}], "]"}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_Ok_pl.dat\>\""}],
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<Plin/\>\"", "<>", "path", "<>", "\"\</Tk_Ok_min.dat\>\""}], "]"}],
       "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873358582747734*^9, 3.873358677002121*^9}, {
   3.873358792013736*^9, 3.8733587971766644`*^9}, {3.873358830133018*^9, 
   3.8733588330093517`*^9}, {3.874329358584203*^9, 3.8743294269295673`*^9}, 
   3.874329595782731*^9, 3.8743299053304167`*^9, {3.88548220866844*^9, 
   3.8854822170496187`*^9}, {3.88548364768221*^9, 3.885483647854467*^9}, {
   3.893771904707581*^9, 3.893771904720544*^9}, {3.893828119952063*^9, 
   3.893828119965536*^9}, {3.893828189774289*^9, 3.893828189789455*^9}, {
   3.894995047073347*^9, 3.894995047087792*^9}, {3.89627840442848*^9, 
   3.8962784044413223`*^9}, {3.896294132569413*^9, 3.896294132583213*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"3082cd77-ee39-49f1-a19f-ed7442109d3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlinsubsT", "[", 
   RowBox[{"survey_", ",", "zpk_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ts", ",", "Pks"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Pks", " ", "=", " ", 
      RowBox[{"Plinsubs", "[", 
       RowBox[{"survey", ",", "zpk"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ts", " ", "=", " ", 
      RowBox[{"GetT", "[", 
       RowBox[{"ToString", "[", "survey", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Pks", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Ts", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "Ts", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.873359348099731*^9, 3.873359401235229*^9}, {
  3.873359469014976*^9, 3.873359532630211*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"2ec6ae8b-766d-478d-9451-9abe21d4fcdc"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Useful functions", "Subsection",
 CellChangeTimes->{{3.8585202011227694`*^9, 3.858520204287999*^9}, 
   3.8585239027917986`*^9, 3.8599777456120453`*^9, 3.8605268064818*^9, 
   3.8733594042152987`*^9, {3.878320347555318*^9, 3.878320363009737*^9}, 
   3.893772131775839*^9},ExpressionUUID->"f5ef098b-14ed-49ea-b5bb-\
36d9a9e38e5b"],

Cell["Number format for jmat imports", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.878321798758705*^9, 
  3.8783218041243973`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"6d425349-4653-488a-8975-4d3dedc11822"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fi", "[", "a_", "]"}], ":=", 
  RowBox[{"NumberForm", "[", 
   RowBox[{"a", ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tfi", "[", "a_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{"fi", "[", "a", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.863632187212137*^9, 3.86363219769361*^9}, 
   3.872396470590571*^9, {3.8723965074111443`*^9, 3.872396525018661*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"971acab8-3339-4403-9a92-6b6224297a3e"],

Cell["Quick evalutations", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.878321798758705*^9, 
  3.878321813011868*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"778730d1-7ef0-4a06-a5cb-5e932df12504"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EV", "[", 
    RowBox[{"f_", ",", "tab_"}], "]"}], ":=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"tab", "[", 
         RowBox[{"[", "s", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", 
         RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", "s"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EV2", "[", 
    RowBox[{"f_", ",", "tab_"}], "]"}], ":=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"tab", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"tab", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"tab", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", 
         RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", "s"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8517742899507437`*^9, 3.8517743315475063`*^9}, {
  3.8518671421118674`*^9, 3.851867153318045*^9}, {3.8534074580475655`*^9, 
  3.8534074628341823`*^9}, {3.8636242232482977`*^9, 3.863624223362212*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"6e8705e9-d0b9-4db9-94df-db9dd3c646a3"],

Cell["Some Matrix Manipulation", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"85b386b8-c8b0-440f-8d3d-edf72889261b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelfKronecker", "[", "a_", "]"}], ":=", 
  RowBox[{"KroneckerProduct", "[", 
   RowBox[{"a", ",", "a"}], "]"}]}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"bb411e9d-1ed1-47be-b99f-49f5a7b8f470"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Upperrightpre", "[", "mat_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"mat", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "j"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8383642440175285`*^9, 3.838364284685878*^9}, {
  3.8383643703114357`*^9, 3.8383643975490737`*^9}, {3.8383644957964196`*^9, 
  3.8383645282926235`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"1c5bccdb-f8fc-49f3-85d0-cfbbde85c284"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Upperright", "[", "mat_", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Upperrightpre", "[", "mat", "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "mat", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.838364529627927*^9, 3.838364555701111*^9}, {
  3.8383646475563154`*^9, 3.8383646482975035`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"58e3843d-655b-4d60-826c-c880a23fd6d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mirror", "[", "mat_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"mat", "-", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Diagonal", "[", "mat", "]"}], "]"}]}], "]"}], "+", "mat"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8383646493803234`*^9, 3.838364687550815*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"b1052b42-2912-4ca8-9b7a-57230b4e7eb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveRowCol", "[", 
   RowBox[{"A_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Delete", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "A", "]"}], ",", " ", "n"}], "]"}], "]"}], 
    ",", "n"}], "]"}]}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"d6023fac-4807-4957-9d82-68c450c2ecc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveRowCol2", "[", 
   RowBox[{"A_", ",", "list_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"listor", ",", "A2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listor", " ", "=", " ", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "list", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A2", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"A2", "=", 
        RowBox[{"RemoveRowCol", "[", 
         RowBox[{"A2", ",", 
          RowBox[{"listor", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "A2"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.858517130670414*^9, 3.8585171672483006`*^9}, {
  3.858517206770048*^9, 3.858517214322392*^9}, {3.858517275492928*^9, 
  3.8585173255918727`*^9}, {3.858519483067375*^9, 3.8585194911798663`*^9}, {
  3.8585195851952467`*^9, 3.8585195853319263`*^9}, {3.8585197134033613`*^9, 
  3.858519730003107*^9}, {3.8585197768266954`*^9, 3.8585197770601287`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"85e2a7ba-b144-4623-9e70-7bdcaae4dd80"],

Cell["Get triangles and keff", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
  3.872297247278839*^9}, {3.8738708899346247`*^9, 3.8738708927083797`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"74e5c31e-109c-451d-8381-75c901ee6b94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeTri", "[", 
    RowBox[{"kmin_", ",", "kmax_", ",", "dk_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kpairs", ",", "kpairstriangle", ",", "Alltriangs", ",", "ktab"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ktab", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"kmin", "+", 
          RowBox[{"i", "*", "dk"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            FractionBox[
             RowBox[{"kmax", "-", "kmin"}], "dk"], "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"kpairs", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ktab", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"ktab", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"ktab", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "j"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "ktab", "]"}]}], "}"}]}], "]"}], ",", 
         "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kpairstriangle", " ", "=", 
       RowBox[{
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"kpairs", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{"kpairs", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{"kpairs", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
              "0", ",", 
              RowBox[{"kpairs", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "kpairs", "]"}]}], "}"}]}], "]"}], ",", 
          "i"}], "]"}], "//", "DeleteDuplicates"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Alltriangs", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"kpairstriangle", ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Alltriangs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "Alltriangs", "]"}]}], "}"}]}], "]"}], "//",
        "N"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Alltriangs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "Alltriangs", "]"}]}], "}"}]}], "]"}], "//",
        "Sort"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"6b4b0f06-913c-4d0f-8c18-0d3eccf81b59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getkeff", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], ",", 
    "\[CapitalDelta]k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1eff", ",", "k2eff", ",", "k3eff", ",", "VT"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VT", " ", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"q1", " ", "q2", " ", "q3", " ", 
         RowBox[{"Boole", "[", 
          RowBox[{"q1", "<=", 
           RowBox[{"q2", "+", "q3"}]}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"q2", "<=", 
           RowBox[{"q1", "+", "q3"}]}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"q3", "<=", 
           RowBox[{"q1", "+", "q2"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", 
          RowBox[{"k1", "-", 
           FractionBox["\[CapitalDelta]k", "2"]}], ",", 
          RowBox[{"k1", "+", 
           FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q2", ",", 
          RowBox[{"k2", "-", 
           FractionBox["\[CapitalDelta]k", "2"]}], ",", 
          RowBox[{"k2", "+", 
           FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q3", ",", 
          RowBox[{"k3", "-", 
           FractionBox["\[CapitalDelta]k", "2"]}], ",", 
          RowBox[{"k3", "+", 
           FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k1eff", " ", "=", " ", 
      RowBox[{
       FractionBox["1", "VT"], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"q1", " ", "q2", " ", "q3", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}], "]"}], " ", 
          RowBox[{"Boole", "[", 
           RowBox[{"q1", "<=", 
            RowBox[{"q2", "+", "q3"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{"q2", "<=", 
            RowBox[{"q1", "+", "q3"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{"q3", "<=", 
            RowBox[{"q1", "+", "q2"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", 
           RowBox[{"k1", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k1", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q2", ",", 
           RowBox[{"k2", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k2", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q3", ",", 
           RowBox[{"k3", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k3", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"k2eff", " ", "=", 
      RowBox[{
       FractionBox["1", "VT"], " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"q1", " ", "q2", " ", "q3", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"q1", " ", "q2", " ", "q3"}], ")"}], 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}], "]"}], 
            RowBox[{"Max", "[", 
             RowBox[{"{", 
              RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}], "]"}]}]], " ", 
          RowBox[{"Boole", "[", 
           RowBox[{"q1", "<=", 
            RowBox[{"q2", "+", "q3"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{"q2", "<=", 
            RowBox[{"q1", "+", "q3"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{"q3", "<=", 
            RowBox[{"q1", "+", "q2"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", 
           RowBox[{"k1", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k1", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q2", ",", 
           RowBox[{"k2", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k2", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q3", ",", 
           RowBox[{"k3", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k3", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"k3eff", " ", "=", " ", 
      RowBox[{
       FractionBox["1", "VT"], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"q1", " ", "q2", " ", "q3", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}], "]"}], " ", 
          RowBox[{"Boole", "[", 
           RowBox[{"q1", "<=", 
            RowBox[{"q2", "+", "q3"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{"q2", "<=", 
            RowBox[{"q1", "+", "q3"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{"q3", "<=", 
            RowBox[{"q1", "+", "q2"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", 
           RowBox[{"k1", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k1", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q2", ",", 
           RowBox[{"k2", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k2", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q3", ",", 
           RowBox[{"k3", "-", 
            FractionBox["\[CapitalDelta]k", "2"]}], ",", 
           RowBox[{"k3", "+", 
            FractionBox["\[CapitalDelta]k", "2"]}]}], "}"}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k1eff", ",", "k2eff", ",", "k3eff"}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"06d3e33c-7879-49d7-8184-4c3c07d5e128"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeTrikeff", "[", 
   RowBox[{"kmin_", ",", "kmax_", ",", "dk_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tris", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tris", "=", 
      RowBox[{"makeTri", "[", 
       RowBox[{"kmin", ",", "kmax", ",", "dk"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Getkeff", "[", 
          RowBox[{
           RowBox[{"tris", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "dk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "tris", "]"}]}], "}"}]}], "]"}], ",", 
       FractionBox[
        RowBox[{"i", "*", "100.0"}], 
        RowBox[{"Length", "[", "tris", "]"}]]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.873870945146803*^9, 3.873871064298078*^9}, {
  3.878988593603874*^9, 3.87898862172132*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"79c162f1-920e-4f1f-9a56-289e0fa881d8"],

Cell["Get Powerspectrum multipoles", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
  3.872297247278839*^9}, {3.878320522794362*^9, 3.8783205260150023`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d20b1ac4-cb64-4f44-8a0b-bd393efdb593"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mono", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"f", "//", "Expand"}], ")"}], "/.", 
   RowBox[{
    SuperscriptBox["\[Mu]", "n_."], "\[Rule]", " ", 
    FractionBox[
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "n"]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n"}], ")"}]}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quad", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "-", 
      RowBox[{"(", 
       RowBox[{"f", "/.", 
        RowBox[{"\[Mu]", "\[Rule]", " ", "0"}]}], ")"}]}], "//", "Expand"}], 
    ")"}], "/.", 
   RowBox[{
    SuperscriptBox["\[Mu]", "n_."], "\[Rule]", " ", 
    FractionBox[
     RowBox[{"5", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "n"]}], ")"}], " ", "n"}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "n"}], ")"}]}]]}]}]}]}], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"ff7c2431-fbfe-4c01-ad27-2d9197d1a0d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"removelg2", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "//", "mono"}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "//", "quad"}], ")"}], 
    RowBox[{"LegendreP", "[", 
     RowBox[{"2", ",", "\[Mu]"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"af17259b-5cfa-49cc-91de-6d9292a79614"],

Cell["\<\
Make list of derivatives, the order is  lnAs, ns h, \[CapitalOmega]m, \
\[Omega]b, log(\[Nu]m), log(b1), BAllcoefs[[2;]]}\
\>", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
   3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
   3.872297247278839*^9}, {3.872326067866156*^9, 3.8723260757524347`*^9}, {
   3.872328959855983*^9, 3.872328964934123*^9}, {3.878321838840213*^9, 
   3.87832185526639*^9}, 3.893829905443501*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"60dffee5-611f-402a-8813-1c82412b2275"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Makederiv", "[", "prederiv_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"EFTderiv", ",", "cosmoderiv", ",", "derivs", ",", "fnlderiv"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EFTderiv", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"prederiv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"BAllcoefs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "BAllcoefs", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EFTderiv", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"EFTderiv", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "b1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cosmoderiv", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"prederiv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", " ", ";;", "2"}], "]"}], "]"}], "-", 
        RowBox[{"prederiv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", " ", ";;", "2"}], "]"}], "]"}]}], 
       RowBox[{"2", " ", "shifts"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cosmoderiv", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "=", 
      RowBox[{"m\[Nu]back", " ", 
       RowBox[{"cosmoderiv", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"fnlderiv", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"prederiv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"fnlcoefs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "fnlcoefs", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"derivs", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"cosmoderiv", ",", "fnlderiv", ",", "EFTderiv"}], "]"}]}], ";",
      "\[IndentingNewLine]", "derivs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8938299054494267`*^9, 3.8938299054519167`*^9}, {
  3.893830191990416*^9, 3.893830228283998*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"81e1afc6-e286-4f5c-89cb-2aba061bee3c"],

Cell["Combine matrices for 4 sky correlations", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
  3.872297247278839*^9}, {3.872326067866156*^9, 3.8723260757524347`*^9}, {
  3.872328959855983*^9, 3.872328964934123*^9}, {3.878321919124189*^9, 
  3.878321928566327*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a8cc46e0-b9b4-493d-841a-8030145167b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cosmopars", " ", "=", 
   RowBox[{"{", 
    RowBox[{
    "lnAs", ",", "ns", ",", "h", ",", "\[CapitalOmega]m", ",", "\[Omega]b", 
     ",", "m\[Nu]", ",", "\[CapitalOmega]k"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885480142896834*^9, 3.88548014322303*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"4af7fa3a-bad6-494f-9bfd-ebce401c425b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cosmopar", "=", " ", 
   RowBox[{
    RowBox[{"Length", "[", "cosmopars", "]"}], "+", 
    RowBox[{"Length", "[", "fnlcoefs", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8785609174385853`*^9, 3.878560918736175*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"eee4da9b-1ecc-439f-b792-17eb08006ea0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CombineMs", "[", "Ms_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MAu", ",", "MBu", ",", "double", ",", "l", ",", "Msu"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"Length", "[", "Ms", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Msu", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Upperright", "[", 
         RowBox[{"Ms", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "Ms", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"double", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"cosmopar", "+", 
             RowBox[{"l", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Msu", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "cosmopar"}], 
               ")"}]}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"cosmopar", "+", 
           RowBox[{"l", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Msu", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "cosmopar"}], 
             ")"}]}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"cosmopar", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"cosmopar", "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"double", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"Msu", "[", 
              RowBox[{"[", 
               RowBox[{"s", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";"}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"cosmopar", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"cosmopar", "+", "1"}]}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"Length", "[", "double", "]"}]}], ",", 
         RowBox[{"j", "+=", "l"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"s", "=", "0"}], ",", 
           RowBox[{"s", "<", "l"}], ",", 
           RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"double", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "s"}]}], "]"}], "]"}], "=", 
             RowBox[{"Msu", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"s", "+", "1"}], ",", "i", ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"j", "-", 
                   RowBox[{"(", 
                    RowBox[{"cosmopar", "+", "1"}], ")"}]}], "l"], "+", 
                 RowBox[{"(", 
                  RowBox[{"cosmopar", "+", "1"}], ")"}]}]}], "]"}], "]"}]}], 
            ";"}]}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"cosmopar", "+", "1"}]}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"Length", "[", "double", "]"}]}], ",", 
       RowBox[{"i", "+=", "l"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"cosmopar", "+", "1"}]}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"Length", "[", "double", "]"}]}], ",", 
         RowBox[{"j", "+=", "l"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"s", "=", "0"}], ",", 
           RowBox[{"s", "<", "l"}], ",", 
           RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"double", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "s"}], ",", 
                RowBox[{"j", "+", "s"}]}], "]"}], "]"}], "=", 
             RowBox[{"Msu", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"s", "+", "1"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"i", "-", 
                   RowBox[{"(", 
                    RowBox[{"cosmopar", "+", "1"}], ")"}]}], "l"], "+", 
                 "cosmopar", "+", "1"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"j", "-", 
                   RowBox[{"(", 
                    RowBox[{"cosmopar", "+", "1"}], ")"}]}], "l"], "+", 
                 "cosmopar", "+", "1"}]}], "]"}], "]"}]}], ";"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Mirror", "[", "double", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.87232815707622*^9, 3.872328168902966*^9}, {
   3.872328333561966*^9, 3.87232835415739*^9}, {3.872329880805771*^9, 
   3.87232988549597*^9}, {3.872329931479525*^9, 3.872329932729744*^9}, {
   3.872336238551152*^9, 3.8723362681831837`*^9}, {3.873385173927168*^9, 
   3.873385173960567*^9}, {3.8733852098877497`*^9, 3.8733852322089577`*^9}, {
   3.873385500731867*^9, 3.873385517145925*^9}, {3.878321915620845*^9, 
   3.87832193164816*^9}, 3.878560855438764*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"8435758a-33a9-4500-8ee7-eb8cf94c8f50"],

Cell[TextData[{
 "AP-effect (DA an Hu are sometimes stripped off constants that would drop \
out anyways),",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{
    RowBox[{"knew", "=", 
     RowBox[{
      FractionBox["k", "qo"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["\[Mu]", "2"], 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox["F", "2"]], "-", "1"}], ")"}]}]}], ")"}], 
       RowBox[{"1", "/", "2"}]]}]}], "\[IndentingNewLine]", 
    RowBox[{"\[Mu]new", "=", 
     RowBox[{
      FractionBox["\[Mu]", "F"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["\[Mu]", "2"], 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox["F", "2"]], "-", "1"}], ")"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]]}]}]}]}]],
  CellChangeTimes->{{3.892630417042344*^9, 3.8926304739546556`*^9}, {
   3.892630537048826*^9, 3.892630547093381*^9}},ExpressionUUID->
  "79d2728c-b109-4d2b-a028-636bf3782596"]
}], "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.89263003862247*^9, 
  3.892630040834231*^9}, {3.8926649041836348`*^9, 3.89266492083191*^9}, {
  3.892664968304894*^9, 3.89266496859444*^9}, {3.8954740440290833`*^9, 
  3.895474044029352*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"619b7472-2da0-4ae2-b05c-ba44563bc9cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hu", "[", 
   RowBox[{"z_", ",", "\[CapitalOmega]m_", ",", "\[CapitalOmega]k_"}], "]"}], 
  ":=", 
  SqrtBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z"}], ")"}], "3"], "\[CapitalOmega]m"}], "+", 
    RowBox[{"(", 
     RowBox[{"1", "-", "\[CapitalOmega]m", "-", "\[CapitalOmega]k"}], ")"}], 
    "+", 
    RowBox[{"\[CapitalOmega]k", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z"}], ")"}], "2"]}]}]]}]], "Input",
 CellChangeTimes->{{3.892630193227709*^9, 3.89263025471706*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"a2c753d7-1155-4e7a-9acd-aa1a5e097904"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DA", "[", 
   RowBox[{"z_", ",", "\[CapitalOmega]m_", ",", "\[CapitalOmega]k_"}], "]"}], 
  ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Hu", "[", 
      RowBox[{"zp", ",", "\[CapitalOmega]m", ",", "\[CapitalOmega]k"}], 
      "]"}]], ",", 
    RowBox[{"{", 
     RowBox[{"zp", ",", "0", ",", "z"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.892630084946836*^9, 3.8926300975065393`*^9}, {
  3.8926301474029093`*^9, 3.892630170408195*^9}, {3.8926302604327497`*^9, 
  3.892630275115467*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"716c90bd-d319-423e-b094-8421cb83fd06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"qor", "[", 
    RowBox[{"z_", ",", "\[CapitalOmega]m_", ",", "\[CapitalOmega]k_"}], "]"}],
    ":=", 
   FractionBox[
    RowBox[{"DA", "[", 
     RowBox[{"z", ",", "\[CapitalOmega]m", ",", "\[CapitalOmega]k"}], "]"}], 
    RowBox[{"DA", "[", 
     RowBox[{"z", ",", "\[CapitalOmega]mback", ",", "\[CapitalOmega]kback"}], 
     "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qp", "[", 
    RowBox[{"z_", ",", "\[CapitalOmega]m_", ",", "\[CapitalOmega]k_"}], "]"}],
    ":=", 
   FractionBox[
    RowBox[{"Hu", "[", 
     RowBox[{"z", ",", "\[CapitalOmega]mback", ",", "\[CapitalOmega]kback"}], 
     "]"}], 
    RowBox[{"Hu", "[", 
     RowBox[{"z", ",", "\[CapitalOmega]m", ",", "\[CapitalOmega]k"}], 
     "]"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.892630277106694*^9, 3.8926302819032784`*^9}, {
   3.8926303138860893`*^9, 3.8926303596022873`*^9}, 3.892630431668055*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"7b7febd2-eea0-41ef-bfc2-a9bbc3f56a52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fe", "[", 
   RowBox[{"z_", ",", "\[CapitalOmega]m_", ",", "\[CapitalOmega]k_"}], "]"}], 
  ":=", 
  FractionBox[
   RowBox[{"qp", "[", 
    RowBox[{"z", ",", "\[CapitalOmega]m", ",", "\[CapitalOmega]k"}], "]"}], 
   RowBox[{"qor", "[", 
    RowBox[{"z", ",", "\[CapitalOmega]m", ",", "\[CapitalOmega]k"}], 
    "]"}]]}]], "Input",
 CellChangeTimes->{{3.8926303650325747`*^9, 3.892630398111232*^9}, {
  3.8926304342139997`*^9, 3.8926304350969257`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"999fa4ac-711b-4561-ae19-a61f9562706a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kAP", "=", 
   RowBox[{
    FractionBox["k", "qo"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       FractionBox["1", "6"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["F", "2"]], "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892631236203793*^9, 3.8926312405333357`*^9}, 
   3.893827728041671*^9, {3.894253286860677*^9, 3.894253290710037*^9}, {
   3.894253423169271*^9, 3.894253426823379*^9}, 3.8949984885301123`*^9, 
   3.894998551312728*^9, {3.894998910276911*^9, 3.894998911085718*^9}, 
   3.8950583047846737`*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"79cf17b6-7609-49cd-81e8-ba259ef6f352"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kavg", "[", "k_", "]"}], "=", "kAP"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kavg2", "[", 
    RowBox[{"k_", ",", "F_", ",", "qo_"}], "]"}], "=", "kAP"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.894998916317954*^9, 3.894998933622841*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"bcb67c7c-09a6-43ff-a8f4-948a4e7e6258"],

Cell[BoxData[
 RowBox[{
  RowBox[{"APrep1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"plin", "[", "k", "]"}], "->", 
      RowBox[{"plin", "[", "kAP", "]"}]}], ",", 
     RowBox[{
      SuperscriptBox["k", "n_."], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["k", "qo"], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox["1", 
             SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Mu]", "n_."], "->", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Mu]", "F"], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox["1", 
             SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892630730646235*^9, 3.892630744229497*^9}, {
   3.8926308288899727`*^9, 3.892630854902816*^9}, 3.892631247936131*^9, {
   3.892631367192667*^9, 3.8926313953943863`*^9}, 3.892631618331481*^9, {
   3.8926317435220327`*^9, 3.892631745973827*^9}, 3.8926319617576733`*^9, {
   3.8926320162376966`*^9, 3.89263202577686*^9}, {3.89425344737547*^9, 
   3.894253450214622*^9}, {3.8949985613048763`*^9, 3.894998563566165*^9}, 
   3.894998913475903*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"d1af40fc-a3aa-42d1-9d29-289cc38a77f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"APrepb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"plin", "[", "k1", "]"}], "\[Rule]", 
      RowBox[{"plin", "[", 
       RowBox[{
        FractionBox["k1", "qo"], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "6"], 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["F", "2"]], "-", "1"}], ")"}]}]}], ")"}]}], 
       "]"}]}], ",", 
     RowBox[{
      SuperscriptBox["k1", "n_."], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["k1", "qo"], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox["1", 
             SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
          SuperscriptBox["\[Mu]1", "2"]}]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Mu]1", "n_."], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Mu]1", "F"], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox["1", 
             SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
          SuperscriptBox["\[Mu]1", "2"]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"plin", "[", "k2", "]"}], "\[Rule]", 
      RowBox[{"plin", "[", 
       RowBox[{
        FractionBox["k2", "qo"], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "6"], 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["F", "2"]], "-", "1"}], ")"}]}]}], ")"}]}], 
       "]"}]}], ",", 
     RowBox[{
      SuperscriptBox["k2", "n_."], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["k2", "qo"], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox["1", 
             SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
          SuperscriptBox["\[Mu]2", "2"]}]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Mu]2", "n_."], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Mu]2", "F"], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox["1", 
             SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
          SuperscriptBox["\[Mu]2", "2"]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"plin", "[", "k3", "]"}], "\[Rule]", 
      RowBox[{"plin", "[", 
       RowBox[{
        FractionBox["k3", "qo"], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "6"], 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["F", "2"]], "-", "1"}], ")"}]}]}], ")"}]}], 
       "]"}]}], ",", 
     RowBox[{
      SuperscriptBox["k3", "n_."], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["k3", "qo"], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             FractionBox["1", 
              SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "k1"}], " ", "\[Mu]1"}], "-", 
              RowBox[{"k2", " ", "\[Mu]2"}]}], ")"}], "2"]}], 
          SuperscriptBox["k3", "2"]]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "k1"}], " ", "\[Mu]1"}], "-", 
          RowBox[{"k2", " ", "\[Mu]2"}]}], "k3"], ")"}], "n_."], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "k1"}], " ", "\[Mu]1"}], "-", 
           RowBox[{"k2", " ", "\[Mu]2"}]}], 
          RowBox[{"F", " ", "k3"}]], ")"}], "n"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             FractionBox["1", 
              SuperscriptBox["F", "2"]]}], ")"}], " ", "n", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "k1"}], " ", "\[Mu]1"}], "-", 
              RowBox[{"k2", " ", "\[Mu]2"}]}], ")"}], "2"]}], 
          SuperscriptBox["k3", "2"]]}], ")"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894253218321538*^9, 3.894253249571867*^9}, {
  3.894253300278058*^9, 3.89425331251047*^9}, {3.89499851471415*^9, 
  3.894998539324586*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"d2c79a09-6a0a-4339-974d-778ea2fd1869"],

Cell[BoxData[
 RowBox[{
  RowBox[{"APfix2", "[", "z_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"qor", "[", 
       RowBox[{"z", ",", 
        RowBox[{"\[CapitalOmega]mback", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[CapitalDelta]\[CapitalOmega]m"}], ")"}]}], ",",
         "\[CapitalOmega]kback"}], "]"}], ",", 
      RowBox[{"Fe", "[", 
       RowBox[{"z", ",", 
        RowBox[{"\[CapitalOmega]mback", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[CapitalDelta]\[CapitalOmega]m"}], ")"}]}], ",",
         "\[CapitalOmega]kback"}], "]"}], ",", 
      RowBox[{"qp", "[", 
       RowBox[{"z", ",", 
        RowBox[{"\[CapitalOmega]mback", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[CapitalDelta]\[CapitalOmega]m"}], ")"}]}], ",",
         "\[CapitalOmega]kback"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"qor", "[", 
       RowBox[{"z", ",", 
        RowBox[{"\[CapitalOmega]mback", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[CapitalDelta]\[CapitalOmega]m"}], ")"}]}], ",",
         "\[CapitalOmega]kback"}], "]"}], ",", 
      RowBox[{"Fe", "[", 
       RowBox[{"z", ",", 
        RowBox[{"\[CapitalOmega]mback", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[CapitalDelta]\[CapitalOmega]m"}], ")"}]}], ",",
         "\[CapitalOmega]kback"}], "]"}], ",", 
      RowBox[{"qp", "[", 
       RowBox[{"z", ",", 
        RowBox[{"\[CapitalOmega]mback", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[CapitalDelta]\[CapitalOmega]m"}], ")"}]}], ",",
         "\[CapitalOmega]kback"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"qor", "[", 
       RowBox[{
       "z", ",", "\[CapitalOmega]mback", ",", 
        "\[CapitalDelta]\[CapitalOmega]k"}], "]"}], ",", 
      RowBox[{"Fe", "[", 
       RowBox[{
       "z", ",", "\[CapitalOmega]mback", ",", 
        "\[CapitalDelta]\[CapitalOmega]k"}], "]"}], ",", 
      RowBox[{"qp", "[", 
       RowBox[{
       "z", ",", "\[CapitalOmega]mback", ",", 
        "\[CapitalDelta]\[CapitalOmega]k"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"qor", "[", 
       RowBox[{"z", ",", "\[CapitalOmega]mback", ",", 
        RowBox[{"-", "\[CapitalDelta]\[CapitalOmega]k"}]}], "]"}], ",", 
      RowBox[{"Fe", "[", 
       RowBox[{"z", ",", "\[CapitalOmega]mback", ",", 
        RowBox[{"-", "\[CapitalDelta]\[CapitalOmega]k"}]}], "]"}], ",", 
      RowBox[{"qp", "[", 
       RowBox[{"z", ",", "\[CapitalOmega]mback", ",", 
        RowBox[{"-", "\[CapitalDelta]\[CapitalOmega]k"}]}], "]"}]}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.892631825546258*^9, 3.892631932360712*^9}, {
  3.892633234730579*^9, 3.8926332523124437`*^9}, {3.894254254274817*^9, 
  3.894254304991571*^9}, {3.894254457069377*^9, 3.894254457257106*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"0ca32de3-28db-466c-9136-d672ca48fb55"],

Cell["Some Fisher matrix  manipulations (comeback)", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
  3.872297247278839*^9}, {3.872326067866156*^9, 3.8723260757524347`*^9}, {
  3.872328959855983*^9, 3.872328964934123*^9}, {3.87832308968871*^9, 
  3.8783230947537403`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e916508c-dd8a-476e-80f9-a8e69bd2768a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllParams", " ", "=", 
   RowBox[{"Join", "[", " ", 
    RowBox[{"cosmopars", ",", "fnlcoefs", ",", "BAllcoefs"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878322559215056*^9, 3.8783225597559347`*^9}, {
  3.878322607818639*^9, 3.8783226182669573`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"c49c3e5a-8382-48ad-b12e-b325105ad884"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Getpos", "[", "arr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"AllParams", ",", 
        RowBox[{"arr", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "arr", "]"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"1ec008f5-718c-4fb5-8f9a-69081c56f0e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubFisher", "[", 
    RowBox[{"Fisher_", ",", "params_"}], "]"}], ":=", 
   RowBox[{"Fisher", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Getpos", "[", "params", "]"}], ",", 
      RowBox[{"Getpos", "[", "params", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"97e8837d-dcac-4282-8afa-06c0234e727e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BAllcoefs4sky", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "BAllcoefs", "}"}], ",", 
       RowBox[{"{", "BAllcoefs", "}"}], ",", 
       RowBox[{"{", "BAllcoefs", "}"}], ",", 
       RowBox[{"{", "BAllcoefs", "}"}]}], "]"}], "//", "Transpose"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllParams4sky", " ", "=", 
   RowBox[{"Join", "[", " ", 
    RowBox[{"cosmopars", ",", "fnlcoefs", ",", "BAllcoefs4sky"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878322575804591*^9, 3.8783225761695766`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"a30843de-1e4e-4461-bd26-646868ee535b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Getpos4sky", "[", "arr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"AllParams4sky", ",", 
        RowBox[{"arr", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "arr", "]"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"338c8c5b-0578-4fc9-b3db-c38444b671d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubFisher4sky", "[", 
    RowBox[{"Fisher_", ",", "params_"}], "]"}], ":=", 
   RowBox[{"Fisher", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Getpos4sky", "[", "params", "]"}], ",", 
      RowBox[{"Getpos4sky", "[", "params", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872325813376278*^9, 3.872325896649271*^9}, {
  3.872325968671319*^9, 3.87232596973584*^9}, {3.872329906830872*^9, 
  3.872329918967013*^9}, {3.873385114527492*^9, 3.8733851194562263`*^9}, {
  3.873385159257605*^9, 3.87338516400776*^9}, {3.873385527341937*^9, 
  3.8733855342231703`*^9}, {3.8783225576504593`*^9, 3.8783225993168716`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"8e68517c-5fca-47b6-89de-67398ddbf20a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetError", "[", "F_", "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"Diagonal", "[", 
      RowBox[{"Inverse", "[", "F", "]"}], "]"}], ")"}], 
    RowBox[{"1", "/", "2"}]], "]"}]}]], "Input",
 CellLabel->"In[98]:=",ExpressionUUID->"cf22dfb5-1624-47eb-871b-1fc2f093ac7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getzeffs", "[", 
   RowBox[{"spec_", ",", "cut_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{";;", "cut"}]}], "]"}], "]"}], 
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", 
          RowBox[{";;", "cut"}]}], "]"}], "]"}]}], "]"}], 
     RowBox[{"Total", "[", 
      RowBox[{"spec", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", 
         RowBox[{";;", "cut"}]}], "]"}], "]"}], "]"}]], ",", 
    FractionBox[
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"cut", "+", "1"}], ";;"}]}], "]"}], "]"}], 
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", 
          RowBox[{
           RowBox[{"cut", "+", "1"}], ";;"}]}], "]"}], "]"}]}], "]"}], 
     RowBox[{"Total", "[", 
      RowBox[{"spec", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", 
         RowBox[{
          RowBox[{"cut", "+", "1"}], ";;"}]}], "]"}], "]"}], "]"}]]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.893829905453225*^9, 3.893829905456718*^9}, {
   3.893830147020961*^9, 3.8938301493670073`*^9}, {3.89383887924126*^9, 
   3.893838880555666*^9}, 3.89383894114287*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"c1569188-8903-4b57-9af0-1da2378502a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fixsurv", "[", 
    RowBox[{"spec_", ",", "dkk_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dk", "\[Rule]", 
        RowBox[{"dkk", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"nb", "\[Rule]", 
        RowBox[{"spec", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"Vs", "\[Rule]", 
        RowBox[{"spec", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "i"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"spec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878384302157143*^9, 3.878384303174946*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"6d8f9654-fc31-4693-8f4a-54482e0251f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getnbeff", "[", 
   RowBox[{"spec_", ",", "cut_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{";;", "cut"}]}], "]"}], "]"}], 
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", 
          RowBox[{";;", "cut"}]}], "]"}], "]"}]}], "]"}], 
     RowBox[{"Total", "[", 
      RowBox[{"spec", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", 
         RowBox[{";;", "cut"}]}], "]"}], "]"}], "]"}]], ",", 
    FractionBox[
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"cut", "+", "1"}], ";;"}]}], "]"}], "]"}], 
       RowBox[{"spec", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", 
          RowBox[{
           RowBox[{"cut", "+", "1"}], ";;"}]}], "]"}], "]"}]}], "]"}], 
     RowBox[{"Total", "[", 
      RowBox[{"spec", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", 
         RowBox[{
          RowBox[{"cut", "+", "1"}], ";;"}]}], "]"}], "]"}], "]"}]]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.878474412068879*^9, 3.87847442319575*^9}, {
  3.893829905457551*^9, 3.893829905460903*^9}, {3.89383015317072*^9, 
  3.8938301554944468`*^9}, {3.893838881440906*^9, 3.893838906550894*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"6d400552-7ff6-451c-9af6-4acc0c6a9c1f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Priors including 1sky and 4sky", "Subsection",
 CellChangeTimes->{{3.872329124574959*^9, 3.8723291254125223`*^9}, {
  3.872337486184376*^9, 3.8723374882990713`*^9}, {3.8783204973786783`*^9, 
  3.8783205008500547`*^9}, {3.885625671666057*^9, 
  3.885625673870825*^9}},ExpressionUUID->"7e9fea05-58dd-498a-91e5-\
90a2af6bc953"],

Cell["\<\
We put a BBN prior on \[Omega]b, Gaussian priors of width 2 or 4 on all \
biases except b1, where we put a log prior. \
\>", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
   3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
   3.872297247278839*^9}, {3.878320552155201*^9, 3.878320679949615*^9}, {
   3.878320787697627*^9, 3.878320788155834*^9}, {3.878321275410214*^9, 
   3.878321286731275*^9}, 3.894995113074264*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"8e7ee30e-3f09-44a0-9aab-b7e392f62c61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Sigma]\[Omega]b", "=", "0.00036"}], ";"}]], "Input",
 CellChangeTimes->{{3.866565435205287*^9, 3.8665654382133493`*^9}, 
   3.885847632885219*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"e589d87f-4d2b-4ced-bb56-368bb2316e35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"priorspre", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", "\[Sigma]\[Omega]b", ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     SqrtBox["0.8"], ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
     "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "4", ",", "4", ",", 
     "4", ",", "2", ",", "2", ",", "4", ",", "2", ",", "2", ",", "2", ",", 
     "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
     "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
     "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Priors", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["priorspre", "2"]], "/.", " ", 
     RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.872329132359683*^9, 3.8723291340022173`*^9}, {
   3.872336867808779*^9, 3.872336869092799*^9}, {3.8728387733927402`*^9, 
   3.8728387819406424`*^9}, {3.872839125093223*^9, 3.87283912549442*^9}, {
   3.87286006800522*^9, 3.87286006811301*^9}, {3.873385245795267*^9, 
   3.8733852529803257`*^9}, {3.874324078232458*^9, 3.874324078315707*^9}, 
   3.874747764714916*^9, {3.885485356385191*^9, 3.885485361231114*^9}, {
   3.8937928672693043`*^9, 3.893792867369749*^9}, {3.895059123093513*^9, 
   3.895059127179062*^9}, {3.89547405765928*^9, 3.895474071928041*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"6e6ad3fd-3027-4efe-aad9-489166cdb6dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"priorspreamb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", "\[Sigma]\[Omega]b", ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", 
     RowBox[{"1", "/", "\[Epsilon]"}], ",", "0.3", ",", "0.3", ",", "0.3", 
     ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", 
     ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", 
     ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", 
     ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", 
     ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", 
     ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", 
     ",", "0.3", ",", "0.3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Priorsamb", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["priorspreamb", "2"]], "/.", " ", 
      RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], "-", "Priors"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.872329132359683*^9, 3.8723291340022173`*^9}, {
   3.872336867808779*^9, 3.872336869092799*^9}, {3.8728387733927402`*^9, 
   3.8728387819406424`*^9}, {3.872839125093223*^9, 3.87283912549442*^9}, {
   3.87286006800522*^9, 3.87286006811301*^9}, {3.873385245795267*^9, 
   3.8733852529803257`*^9}, {3.874324078232458*^9, 3.874324078315707*^9}, 
   3.874747764714916*^9, {3.885485356385191*^9, 3.885485361231114*^9}, {
   3.8937928672693043`*^9, 3.893792867369749*^9}, {3.89505864720956*^9, 
   3.895058687732237*^9}, {3.895058803893285*^9, 3.895058816534121*^9}, 
   3.895058965258094*^9, 3.8950589978045797`*^9, {3.895059092837834*^9, 
   3.8950591358410873`*^9}, {3.895474089070715*^9, 3.895474091705502*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"d8e728df-dcbe-4674-9faa-681d79bac729"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<Fishers/Prioramb.mtx\>\"", ",", "Priorsamb"}], "]"}]], "Input",
 CellChangeTimes->{{3.895059147392695*^9, 3.8950591793851624`*^9}, {
   3.895474151855131*^9, 3.895474156489561*^9}, {3.8962784260315857`*^9, 
   3.896278438740885*^9}, 3.896294228088151*^9},
 CellLabel->
  "In[107]:=",ExpressionUUID->"85cbd5c8-367d-4703-9998-a27437e25120"],

Cell[BoxData["\<\"Fishers/Prioramb.mtx\"\>"], "Output",
 CellChangeTimes->{3.896298038091411*^9, 3.896326907508271*^9, 
  3.89641282834804*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"dfb8cfad-730d-4822-a05c-2837520c270a"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData["\"\<Fishersn2/Prioramb.mtx\>\""], "Input",
 CellChangeTimes->{3.8962942280888023`*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"062d1f52-579b-4d34-a0c2-89d3f1dc7427"],

Cell[BoxData["\<\"Fishersn2/Prioramb.mtx\"\>"], "Output",
 CellChangeTimes->{3.8963269075110292`*^9, 3.896412828351*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"5417008b-dccd-4c83-9f35-40ea7c04f5b2"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData["\"\<Fishers/Prioramb.mtx\>\""], "Input",
 CellChangeTimes->{3.896278426032947*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"98c5eee4-2fc1-4ad8-a3a9-b01c4ac1dbed"],

Cell[BoxData["\<\"Fishers/Prioramb.mtx\"\>"], "Output",
 CellChangeTimes->{3.896294172544759*^9, 3.8962980380943727`*^9, 
  3.896326907517982*^9, 3.896412828357409*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"3e30b754-02d2-4c05-9556-4e7cac908c74"]
}, Closed]],

Cell["Create a correlated 4 sky prior", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
   3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
   3.872297247278839*^9}, {3.878320552155201*^9, 3.878320679949615*^9}, {
   3.878320787697627*^9, 3.878320788155834*^9}, {3.878321275410214*^9, 
   3.878321286731275*^9}, {3.878321478897922*^9, 3.8783214905268908`*^9}, 
   3.89505868790907*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"026e7d0f-0a78-4f78-a015-84a7542894b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blockArray", "[", "mat_", "]"}], ":=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"Range", "@", "#"}], "-", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rest", "@", "#"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "&"}], "@", 
     RowBox[{"Dimensions", "@", "mat"}]}], "->", 
    RowBox[{"Flatten", "@", "mat"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864484725309821*^9, 3.8644847253151712`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"1e4f7bea-c99e-4d0d-9f4a-954b4f4d13a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]12", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox["0.1", "2"], "/", "2"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]13", " ", "=", 
   RowBox[{"(", " ", 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox["0.2", "2"], "/", "2"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8646958257310257`*^9, 3.864695840006352*^9}, {
  3.8647486273267736`*^9, 3.8647486726130123`*^9}, {3.8648287470757027`*^9, 
  3.8648287507786293`*^9}, {3.864828794635573*^9, 3.864828798436116*^9}, {
  3.864829077947125*^9, 3.8648291102367077`*^9}, {3.864829358354806*^9, 
  3.864829362558661*^9}, {3.864829397211746*^9, 3.86482939825951*^9}, {
  3.864829439873828*^9, 3.864829446107923*^9}, {3.865427714837467*^9, 
  3.865427721572164*^9}, {3.865427804274852*^9, 3.865427805168721*^9}, {
  3.865459432294635*^9, 3.8654594636489983`*^9}, {3.865459513360614*^9, 
  3.865459520893382*^9}, {3.867335025693591*^9, 3.867335036866583*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"83029c53-5fba-487a-bc3c-ba1b1732111e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"corrmat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "\[Rho]12", ",", " ", "\[Rho]13", ",", 
       RowBox[{"\[Rho]12", " ", "\[Rho]13"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"{", 
      RowBox[{"\[Rho]12", ",", "1", ",", " ", 
       RowBox[{"\[Rho]12", " ", "\[Rho]13"}], ",", " ", "\[Rho]13"}], "}"}], 
     ",", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"{", 
      RowBox[{"\[Rho]13", ",", " ", 
       RowBox[{"\[Rho]12", " ", "\[Rho]13"}], ",", " ", "1", ",", " ", 
       "\[Rho]12"}], "}"}], ",", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Rho]12", " ", "\[Rho]13"}], ",", " ", "\[Rho]13", ",", " ", 
       "\[Rho]12", ",", " ", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8646957259143553`*^9, 3.864695756475009*^9}, {
  3.864695799617426*^9, 3.8646958969195213`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"6e5789f9-6c64-4e40-9f81-de27a1da9b73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"buildCorrPrior", "[", 
   RowBox[{"priorlist_", ",", " ", "cosmolen_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fullPriorpre", ",", "fullPrior"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullPriorpre", "=", 
      RowBox[{"blockArray", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"priorlist", "//", "Diagonal"}], ")"}], "[", 
           RowBox[{"[", " ", "i", "]"}], "]"}], 
          RowBox[{"Inverse", "[", "corrmat", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"cosmolen", "+", "1"}], ",", " ", 
           RowBox[{"Length", "[", "priorlist", "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fullPrior", "=", 
      RowBox[{
       RowBox[{"ArrayPad", "[", 
        RowBox[{"fullPriorpre", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cosmolen", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"cosmolen", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullPrior", "[", 
       RowBox[{"[", 
        RowBox[{"5", ",", "5"}], "]"}], "]"}], "=", 
      FractionBox["1", 
       SuperscriptBox["\[Sigma]\[Omega]b", "2"]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullPrior", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "6"}], "]"}], "]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", "fullPrior"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.865914261961269*^9, 3.8659143521078367`*^9}, {
  3.865914385461402*^9, 3.865914401169504*^9}, {3.86591467282381*^9, 
  3.865914683522748*^9}, {3.865914813582415*^9, 3.865914814480459*^9}, {
  3.86591624517268*^9, 3.8659162492092457`*^9}, {3.8733853978464527`*^9, 
  3.873385399048849*^9}, {3.874395461439167*^9, 3.874395509925618*^9}, {
  3.874396058563992*^9, 3.8743960590693913`*^9}, {3.8749240770885983`*^9, 
  3.874924087602857*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"852a7693-b4af-46a5-bca8-68776dcf7ba5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Prior4sky", " ", "=", " ", 
   RowBox[{"buildCorrPrior", "[", 
    RowBox[{"Priors", ",", "cosmopar"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872330449260469*^9, 3.872330475793741*^9}, {
  3.873385266096732*^9, 3.873385266612385*^9}, {3.88548539587892*^9, 
  3.8854853974787693`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"65ed3252-ec1b-4459-93b4-80750f6214b3"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Powespectrum Fisher", "Section",
 CellChangeTimes->{{3.872299864650228*^9, 
  3.872299868103323*^9}},ExpressionUUID->"00b26582-c588-4834-9a8c-\
1703cc1bec56"],

Cell[CellGroupData[{

Cell["Perliminary functions and definitions", "Subsection",
 CellChangeTimes->{{3.872304473324328*^9, 3.872304477223215*^9}, {
  3.872305074049398*^9, 
  3.872305076043375*^9}},ExpressionUUID->"b779b216-13ad-447b-b266-\
ba4041cc7c94"],

Cell["Counter term definition", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"143e2293-4a92-4f40-bae2-3b43d1cfc047"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CounterP13", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b1", "+", 
      RowBox[{"f1", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}], 
    RowBox[{"plin", "[", "k", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Bc1", " ", 
         SuperscriptBox["k", "2"]}], 
        SuperscriptBox["km", "2"]]}], "+", 
      FractionBox[
       RowBox[{"f1", " ", 
        RowBox[{"(", 
         RowBox[{"Bc2", "-", 
          FractionBox[
           RowBox[{"Bc4", " ", "f1"}], "2"]}], ")"}], " ", 
        SuperscriptBox["k", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"]}], 
       SuperscriptBox["kr", "2"]], "-", 
      FractionBox[
       RowBox[{"Bc3", " ", 
        SuperscriptBox["f1", "2"], " ", 
        SuperscriptBox["k", "2"], " ", 
        SuperscriptBox["\[Mu]", "4"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["kr", "2"]}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StochasticP22", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"nb", "  "}]], 
    RowBox[{"(", 
     RowBox[{"Be1", "+", 
      FractionBox[
       RowBox[{"Be2", " ", 
        SuperscriptBox["k", "2"]}], 
       SuperscriptBox["km", "2"]], "+", 
      FractionBox[
       RowBox[{"3", " ", "ce2", " ", 
        SuperscriptBox["k", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["km", "2"]}]]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.837760515645254*^9, 3.837760516821219*^9}, {
   3.8377699986204977`*^9, 3.83776999995352*^9}, {3.83777028131917*^9, 
   3.8377702815340877`*^9}, 3.8379453013160787`*^9, {3.8379454005957255`*^9, 
   3.837945401384302*^9}, {3.837946153154419*^9, 3.8379461555371532`*^9}, {
   3.8478009750891914`*^9, 3.8478009805159836`*^9}, 3.847802668274679*^9, {
   3.8478042187247653`*^9, 3.8478042427104425`*^9}, {3.858430224510688*^9, 
   3.8584302246646852`*^9}, {3.85852377417082*^9, 3.858523774261567*^9}, {
   3.860321580481114*^9, 3.860321590607567*^9}, {3.860322073955772*^9, 
   3.8603220774870834`*^9}, {3.8603271430373683`*^9, 
   3.8603271442509565`*^9}, {3.860327255902384*^9, 3.8603272584951286`*^9}, 
   3.86039300642037*^9, 3.860393495384943*^9, 3.86039514995938*^9, 
   3.8603953921173754`*^9, {3.8605255233647394`*^9, 3.8605255259231615`*^9}, {
   3.860574121574869*^9, 3.860574139815667*^9}, {3.860574181446759*^9, 
   3.860574187606518*^9}, {3.8605745429997435`*^9, 3.8605745453666887`*^9}, 
   3.860652130039155*^9, {3.8606953996495695`*^9, 3.860695426008072*^9}, {
   3.8607509277769012`*^9, 3.8607509568799963`*^9}, {3.8607512870418587`*^9, 
   3.8607512963848715`*^9}, {3.860751436900077*^9, 3.8607514476317234`*^9}, {
   3.8607591405075645`*^9, 3.860759142811185*^9}, {3.8703359247780724`*^9, 
   3.8703359279016237`*^9}, 3.870862783401044*^9, {3.871017080290926*^9, 
   3.8710170886019*^9}, {3.871017206946537*^9, 3.871017207870308*^9}, {
   3.872301024167328*^9, 3.872301048107801*^9}, {3.8728070433803673`*^9, 
   3.8728070471685266`*^9}, {3.8728095583556643`*^9, 
   3.8728095632764273`*^9}, {3.872829938985023*^9, 3.872829940493107*^9}, {
   3.872838317705502*^9, 3.872838339139844*^9}, 3.872838519754595*^9, {
   3.892543039399047*^9, 3.8925430443390007`*^9}, {3.892550148379386*^9, 
   3.892550150449306*^9}, {3.892631979971115*^9, 3.892631981661837*^9}, {
   3.892632629105638*^9, 3.8926326659016113`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"9796360f-e760-486e-9003-cb4d3a77e2cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PCounterAP", "[", 
    RowBox[{"k_", ",", "plin_", ",", "f1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "CounterP13"}], "+", "StochasticP22"}], "/.", "APrep1"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.837759699236809*^9, 3.8377597187572346`*^9}, {
   3.837770004461619*^9, 3.8377700127543354`*^9}, {3.8377702838780727`*^9, 
   3.837770285776758*^9}, {3.847804230955636*^9, 3.8478042773452263`*^9}, 
   3.8584270006783657`*^9, {3.860393505815215*^9, 3.8603935069048557`*^9}, {
   3.872301059612591*^9, 3.872301064883523*^9}, {3.8723011915647*^9, 
   3.872301196062764*^9}, 3.8723375249823933`*^9, {3.87882263041964*^9, 
   3.878822631920085*^9}, {3.878822758888946*^9, 3.878822760639144*^9}, {
   3.878822837239666*^9, 3.878822837610668*^9}, {3.892631971398119*^9, 
   3.892632030330904*^9}, {3.892632625388315*^9, 3.892632640455715*^9}, 
   3.892632846740556*^9, 3.892632969950016*^9, {3.8926650061764812`*^9, 
   3.892665006779626*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"f26bed4d-91fa-45c2-8ac6-545f1575cb3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PCounter", "[", 
    RowBox[{"k_", ",", "plin_", ",", "f1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"2", "CounterP13"}], "+", "StochasticP22"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8926329725887613`*^9, 3.892632973298896*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"b41c5220-a2cd-4b4a-9650-48fe001b51ef"],

Cell["Loop definitions and imports", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.872305117692829*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"33bf4e33-8438-4ec7-8e1d-50873ed97486"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DumpGet", "[", "\"\<Createjmats/jmats/P13interp.mx\>\"", "]"}], 
  ";", 
  RowBox[{"DumpGet", "[", "\"\<Createjmats/jmats/P22interp1pre.mx\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DumpGet", "[", "\"\<Createjmats/jmats/P22interp2pre.mx\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DumpGet", "[", "\"\<Createjmats/jmats/P22interp3pre.mx\>\"", "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.8723046151313543`*^9, 3.872304617782464*^9}, {
   3.8739710493414783`*^9, 3.873971053695849*^9}, {3.8750896490947313`*^9, 
   3.875089651582652*^9}, {3.87508970023035*^9, 3.875089703428845*^9}, {
   3.875093858767973*^9, 3.875093861274969*^9}, {3.878840509147448*^9, 
   3.878840510750029*^9}, {3.878840693917115*^9, 3.8788406955208483`*^9}, {
   3.893828119969705*^9, 3.893828119970447*^9}, {3.893829905461629*^9, 
   3.893829905462022*^9}, {3.895058124936957*^9, 3.895058124937902*^9}, {
   3.895579714750165*^9, 3.8955797207647247`*^9}, 3.89558883846933*^9, {
   3.895588904068572*^9, 3.895588904500462*^9}, {3.897808028372506*^9, 
   3.897808030949973*^9}, 3.897998357135385*^9, {3.89799848730904*^9, 
   3.897998489837473*^9}, {3.897998550097063*^9, 3.8979985733643627`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"0ae28508-d84d-44f5-bede-7fbecd4eef9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P22interp", "[", "k_", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"P22interp1pre", "[", "k", "]"}], ",", 
     RowBox[{"P22interp2pre", "[", "k", "]"}], ",", 
     RowBox[{"P22interp3pre", "[", "k", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.897998352152884*^9, 3.897998484576033*^9, {3.897998557264727*^9, 
   3.897998563244091*^9}, 
   3.897998605653615*^9},ExpressionUUID->"9ef83cde-5298-4633-8cfa-\
89006bd2a275"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"P13interp2", "[", 
    RowBox[{"k_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"P13interp", "[", "k", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P22interp2", "[", 
    RowBox[{"k_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"P22interp", "[", "k", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.892633983299066*^9, 3.892634037966607*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"e58ac727-bcc3-48c8-9a7d-c86b0ba519b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P13coefs", "[", "f1_", "]"}], " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/P13simpcoefs.m\>\"", "]"}]}], 
  ";", " ", 
  RowBox[{
   RowBox[{"P13kers", "[", "k_", "]"}], " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/P13simppermks.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8606521710429764`*^9, 3.8606521836503716`*^9}, {
   3.8606522143380394`*^9, 3.8606522201279025`*^9}, 3.8606554301776404`*^9, {
   3.872304606383265*^9, 3.872304606854814*^9}, {3.87283889441852*^9, 
   3.8728389098249407`*^9}, {3.8938281199712057`*^9, 3.893828119971694*^9}, {
   3.8938299054625063`*^9, 3.893829905462928*^9}, {3.895058124939036*^9, 
   3.8950581249396467`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"67632711-2db4-4629-9025-64d7909ad89f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P22coefs", "[", "f1_", "]"}], " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/P22simpcoefs.m\>\"", "]"}]}], 
  ";", " ", 
  RowBox[{
   RowBox[{"P22kers", "[", "k_", "]"}], " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/P22simppermks.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.860652226577163*^9, 3.860655432897608*^9, {3.872304609169154*^9, 
   3.872304609487385*^9}, 3.872838911608514*^9, {3.893828119972577*^9, 
   3.893828119973061*^9}, {3.8938299054633923`*^9, 3.893829930219767*^9}, 
   3.893844822056328*^9, {3.895058124941023*^9, 3.895058124941637*^9}, 
   3.895473833281911*^9},
 CellLabel->
  "In[124]:=",ExpressionUUID->"e825a6da-26b5-4668-8402-2486341b330b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"P22sub", "=", 
   RowBox[{
    RowBox[{"P22kers", "[", "0.001", "]"}], ".", 
    RowBox[{"P22interp", "[", "0.001", "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"d95c04f1-6976-4fe1-97a8-5aea802e451b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"P13n", "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"P13kers", "[", "k", "]"}], ")"}], ".", 
    RowBox[{"P13interp", "[", "k", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P22n", "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"P22kers", "[", "k", "]"}], ")"}], ".", 
     RowBox[{"P22interp", "[", "k", "]"}]}], "-", "P22sub"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8512603699616375`*^9, 3.8512603704015617`*^9}, 
   3.8512604092681885`*^9, 3.8513397013218327`*^9, {3.8518666695133715`*^9, 
   3.8518666721857643`*^9}, {3.8584212455227513`*^9, 
   3.8584213246101365`*^9}, {3.8584223955408344`*^9, 3.858422414703537*^9}, {
   3.8584234508395033`*^9, 3.8584234875024023`*^9}, {3.8584243694425297`*^9, 
   3.85842437170817*^9}, {3.859446100651111*^9, 3.8594461174039307`*^9}, {
   3.859646195632016*^9, 3.859646199583989*^9}, {3.875088834544386*^9, 
   3.875088836306697*^9}, {3.875253861271221*^9, 3.8752538621758823`*^9}, 
   3.8880463960713*^9, {3.892543368039345*^9, 3.892543378793634*^9}, {
   3.892551365432158*^9, 3.8925513681899652`*^9}, {3.892632114109826*^9, 
   3.892632151823818*^9}, {3.892633501308531*^9, 3.8926335066253*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"c2de7523-6917-4ae2-b362-d37626324ba9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"P13ev", "[", 
    RowBox[{"P13_", ",", "ls_", ",", "f_", ",", "Plink_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"P13", ".", "ls", ".", 
     RowBox[{"(", 
      RowBox[{"P13coefs", "[", "f", "]"}], ")"}]}], " ", "Plink"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P22ev", "[", 
    RowBox[{"P22_", ",", "ls_", ",", "f_"}], "]"}], " ", ":=", " ", 
   RowBox[{"P22", ".", "ls", ".", "ls", ".", 
    RowBox[{"(", 
     RowBox[{"P22coefs", "[", "f", "]"}], ")"}]}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.8584243362865796`*^9, 3.8584243925123625`*^9}, {
  3.858424432750366*^9, 3.8584244501508474`*^9}, {3.8584245036291757`*^9, 
  3.858424545467021*^9}, {3.892543390461046*^9, 3.8925434033658953`*^9}, {
  3.892543434368658*^9, 3.89254344470252*^9}, {3.892550161090857*^9, 
  3.892550163044613*^9}, {3.8926321622065763`*^9, 3.892632169278471*^9}, {
  3.892633613931238*^9, 3.892633618517857*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"1f0ac6e4-4b71-4ae6-b07a-88e9f74b0cae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"P13kersAP", "[", 
    RowBox[{"k_", ",", "F_", ",", "qo_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"P13kers", "[", "k", "]"}], "/.", "APrep1"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P22kersAP", "[", 
    RowBox[{"k_", ",", "F_", ",", "qo_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"P22kers", "[", "k", "]"}], "/.", "APrep1"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P13coefsAP", "[", 
    RowBox[{"f_", ",", "F_", ",", "qo_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"P13coefs", "[", "f", "]"}], "/.", "APrep1"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P22coefsAP", "[", 
    RowBox[{"f_", ",", "F_", ",", "qo_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"P22coefs", "[", "f", "]"}], "/.", "APrep1"}], ")"}]}], 
  ";"}]}], "Input",
 CellLabel->
  "In[130]:=",ExpressionUUID->"8a9500e4-5e27-454b-9230-f56e73a2083f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8512603699616375`*^9, 3.8512603704015617`*^9}, 
   3.8512604092681885`*^9, 3.8513397013218327`*^9, {3.8518666695133715`*^9, 
   3.8518666721857643`*^9}, {3.8584212455227513`*^9, 
   3.8584213246101365`*^9}, {3.8584223955408344`*^9, 3.858422414703537*^9}, {
   3.8584234508395033`*^9, 3.8584234875024023`*^9}, {3.8584243694425297`*^9, 
   3.85842437170817*^9}, {3.859446100651111*^9, 3.8594461174039307`*^9}, {
   3.859646195632016*^9, 3.859646199583989*^9}, {3.875088834544386*^9, 
   3.875088836306697*^9}, {3.875253861271221*^9, 3.8752538621758823`*^9}, 
   3.8880463960713*^9, {3.892543368039345*^9, 3.892543378793634*^9}, {
   3.892551365432158*^9, 3.8925513681899652`*^9}, {3.892632114109826*^9, 
   3.892632151823818*^9}, {3.892633501308531*^9, 3.8926335066253*^9}, {
   3.8926406920991173`*^9, 3.892640695991418*^9}, {3.892665147196203*^9, 
   3.892665160988846*^9}, 3.894996816612197*^9, {3.894998698194357*^9, 
   3.8949986990118847`*^9}, 3.894998926884902*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"d7e98747-9c33-4193-af1f-6b3ff72c6810"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"P13evAP", "[", 
    RowBox[{
    "k_", ",", "F_", ",", "qo_", ",", "ls_", ",", "f_", ",", "Plin_"}], "]"}],
    " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"P13kersAP", "[", 
      RowBox[{"k", ",", "F", ",", "qo"}], "]"}], ".", 
     RowBox[{"P13interp", "[", 
      RowBox[{"kavg2", "[", 
       RowBox[{"k", ",", "F", ",", "qo"}], "]"}], "]"}], ".", "ls", ".", 
     RowBox[{"(", 
      RowBox[{"P13coefsAP", "[", 
       RowBox[{"f", ",", "F", ",", "qo"}], "]"}], ")"}]}], " ", 
    RowBox[{"Plin", "[", 
     RowBox[{"kavg2", "[", 
      RowBox[{"k", ",", "F", ",", "qo"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P22evAP", "[", 
    RowBox[{"k_", ",", "F_", ",", "qo_", ",", "ls_", ",", "f_"}], "]"}], " ", 
   ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P22kersAP", "[", 
        RowBox[{"k", ",", "F", ",", "qo"}], "]"}], ".", 
       RowBox[{"P22interp", "[", 
        RowBox[{"kavg2", "[", 
         RowBox[{"k", ",", "F", ",", "qo"}], "]"}], "]"}]}], "-", "P22sub"}], 
     ")"}], ".", "ls", ".", "ls", ".", 
    RowBox[{"(", 
     RowBox[{"P22coefsAP", "[", 
      RowBox[{"f", ",", "F", ",", "qo"}], "]"}], ")"}]}]}], " ", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8584243362865796`*^9, 3.8584243925123625`*^9}, {
  3.858424432750366*^9, 3.8584244501508474`*^9}, {3.8584245036291757`*^9, 
  3.858424545467021*^9}, {3.892543390461046*^9, 3.8925434033658953`*^9}, {
  3.892543434368658*^9, 3.89254344470252*^9}, {3.892550161090857*^9, 
  3.892550163044613*^9}, {3.8926321622065763`*^9, 3.892632169278471*^9}, {
  3.892633613931238*^9, 3.892633618517857*^9}, {3.892640702893218*^9, 
  3.89264071522095*^9}, {3.892640813468066*^9, 3.892640930513975*^9}, {
  3.892640970651876*^9, 3.8926409927460117`*^9}, {3.892641094607562*^9, 
  3.892641101819558*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"60a1d0cf-8815-4025-88ec-62df55e2f189"],

Cell[BoxData[
 RowBox[{
  RowBox[{"P1loopAP", "[", 
   RowBox[{"k_", ",", "F_", ",", "qo_", ",", "ls_", ",", "f_", ",", "Plin_"}],
    "]"}], ":=", 
  RowBox[{
   RowBox[{"P13evAP", "[", 
    RowBox[{"k", ",", "F", ",", "qo", ",", "ls", ",", "f", ",", "Plin"}], 
    "]"}], "+", 
   RowBox[{"P22evAP", "[", 
    RowBox[{"k", ",", "F", ",", "qo", ",", "ls", ",", "f"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8926411405426207`*^9, 3.8926411698926477`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"238f672d-5a20-466b-afab-0b64f2c6530a"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "NL"], TraditionalForm]],ExpressionUUID->
  "465ed0a4-e97c-4639-be7d-29f7d354fd2f"],
 " definitions "
}], "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.872305117692829*^9}, {
  3.873385732769526*^9, 3.873385734495266*^9}, {3.878323776231235*^9, 
  3.8783237769852*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"fd17723e-204a-4f59-9fe0-a015aa1acae8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PNG", "[", 
   RowBox[{"k_", ",", 
    RowBox[{"{", 
     RowBox[{"fnl_", ",", "\[Beta]s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"plin_", ",", "f1_", ",", "T\[Alpha]_"}], "}"}]}], "]"}], ":=", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "b1"}], ")"}], " ", "fnl", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["k", "knl"], ")"}], "\[Beta]s"], " ", "\[Delta]c", " ", 
    RowBox[{"(", 
     RowBox[{"b1", "+", 
      RowBox[{"f1", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}], " ", 
    RowBox[{"plin", "[", "k", "]"}]}], 
   RowBox[{"T\[Alpha]", "[", "k", "]"}]]}]], "Input",
 CellChangeTimes->{{3.873385745428348*^9, 3.873385805791253*^9}, {
  3.873385876939601*^9, 3.873385883476165*^9}, {3.873386039528496*^9, 
  3.873386046335174*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"f002eac3-2d1e-4eb4-95e2-5dd8e21d8108"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PNGfull", "[", 
   RowBox[{"k_", ",", 
    RowBox[{"{", 
     RowBox[{"plin_", ",", "f1_", ",", "T\[Alpha]_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PNG", "[", 
    RowBox[{"k", ",", " ", 
     RowBox[{"{", 
      RowBox[{"fNLloc", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"plin", ",", "f1", ",", "T\[Alpha]"}], "}"}]}], "]"}], "+", 
   RowBox[{"PNG", "[", 
    RowBox[{"k", ",", 
     RowBox[{"{", 
      RowBox[{"fNLeq", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"plin", ",", "f1", ",", "T\[Alpha]"}], "}"}]}], "]"}], "+", 
   RowBox[{"PNG", "[", 
    RowBox[{"k", ",", 
     RowBox[{"{", 
      RowBox[{"fNLorth", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"plin", ",", "f1", ",", "T\[Alpha]"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.87338616674959*^9, 3.873386222596446*^9}, {
  3.87338665109072*^9, 3.873386656549919*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"a07da269-ee19-40a0-ae72-f80b7eecece2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivatives Resummed", "Subsection",
 CellChangeTimes->{{3.858430192687768*^9, 3.858430198239727*^9}, 
   3.8723050472079287`*^9, {3.87265520040689*^9, 
   3.872655201962266*^9}},ExpressionUUID->"816000c8-012c-4b8e-9dbe-\
a4508edc0e25"],

Cell["Tree derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.8723051697520514`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"66d50b1c-2f4e-4e2f-ab0a-85522688b257"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PTreeDerivs", "[", 
   RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "PTreeresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv", ",", 
      "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PTreeresum", "[", "arr_", "]"}], ":=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"b1", "+", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", "4", "]"}], "]"}], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "k", "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["k", "2"], 
             RowBox[{"arr", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], 
            RowBox[{"arr", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "k", "]"}]}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PTreeresum", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"4", ",", "5", ",", "6", ",", "9"}], "}"}], "]"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8585077292340565`*^9, 3.8585077305031223`*^9}, {
   3.859204856667835*^9, 3.8592050386818385`*^9}, {3.859205082609642*^9, 
   3.8592051738040447`*^9}, 3.859205336286848*^9, 3.8592060435140676`*^9, {
   3.859270824435414*^9, 3.8592708280355687`*^9}, {3.8595483866231203`*^9, 
   3.859548386713423*^9}, {3.859647898003146*^9, 3.859647921616929*^9}, 
   3.8603266457002697`*^9, {3.86042419836705*^9, 3.860424200491829*^9}, {
   3.860424906918251*^9, 3.8604249179063807`*^9}, 3.8604356901509686`*^9, {
   3.8605079396856136`*^9, 3.8605079401018467`*^9}, 3.8605081470038366`*^9, {
   3.8703362242951612`*^9, 3.870336235661982*^9}, {3.8703362716024218`*^9, 
   3.870336281675535*^9}, {3.8704910051904716`*^9, 3.870491007432871*^9}, 
   3.872300459566333*^9, {3.87230099660244*^9, 3.8723010000801973`*^9}, {
   3.87230354744785*^9, 3.8723035508091927`*^9}, {3.872303582620851*^9, 
   3.8723036182272043`*^9}, {3.8723036850178633`*^9, 3.872303773137793*^9}, {
   3.872304531464572*^9, 3.87230453478293*^9}, 3.87230459825539*^9, {
   3.87335973190872*^9, 3.873359732164007*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"98e39fdc-89c9-46a8-b61a-501cf97f19ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PTreeDerivsAP", "[", 
   RowBox[{"k_", ",", "pks_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "PTreeresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv", ",", 
      "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PTreeresum", "[", "arr_", "]"}], ":=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"b1", "+", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", "4", "]"}], "]"}], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"kavg", "[", "k", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["k", "2"], 
             RowBox[{"arr", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], 
            RowBox[{"arr", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"kavg", "[", "k", "]"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"qpa", " ", 
            SuperscriptBox["qo", "2"]}]], 
          RowBox[{"PTreeresum", "[", 
           RowBox[{
            RowBox[{"pks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5", ",", "6", ",", "9"}], "}"}], "]"}], 
            "]"}], "]"}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"qo", ",", "F", ",", "qpa"}], "}"}], "->", 
           RowBox[{
            RowBox[{"APfix2", "[", "z", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.892632250204133*^9, 3.8926322964466333`*^9}, {
   3.8926324301829042`*^9, 3.892632433293075*^9}, {3.892632463914555*^9, 
   3.892632509074834*^9}, {3.892638156066525*^9, 3.8926381563946877`*^9}, {
   3.892665035837552*^9, 3.892665036594243*^9}, 3.8926651882459517`*^9, {
   3.89425432316593*^9, 3.894254332080351*^9}, {3.894254497533185*^9, 
   3.8942545054218893`*^9}, 3.894254804367415*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"5304d4fb-e9d1-4796-b574-6d78340a2622"],

Cell["Counter derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305175380875*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0e63b1cf-3b95-4502-8484-3ac421fcf19f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PCounterDerivs", "[", 
   RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Pcounteresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv", ",",
       "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Pcounteresum", "[", "arr_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"PCounter", "[", 
         RowBox[{"k", ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], 
            RowBox[{"arr", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["k", "2"]}], 
          RowBox[{"arr", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], 
        RowBox[{"PCounter", "[", 
         RowBox[{"k", ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Pcounteresum", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "6", ",", "9"}], "}"}], "]"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8585077292340565`*^9, 3.8585077305031223`*^9}, {
   3.859204856667835*^9, 3.8592050386818385`*^9}, {3.859205082609642*^9, 
   3.8592051738040447`*^9}, 3.859205336286848*^9, {3.8592057271524687`*^9, 
   3.8592057649514475`*^9}, {3.8592058030996037`*^9, 3.8592058082698317`*^9}, 
   3.8592060480106535`*^9, 3.859206079803241*^9, {3.859270817539712*^9, 
   3.859270821251371*^9}, {3.859548382888116*^9, 3.8595483866064787`*^9}, 
   3.8596478764988956`*^9, {3.859647931041823*^9, 3.8596479361773014`*^9}, 
   3.8603266346548815`*^9, {3.860392926426573*^9, 3.860392978325523*^9}, 
   3.8603951053326235`*^9, {3.860424183173935*^9, 3.86042418605873*^9}, {
   3.8604248258482523`*^9, 3.8604248386823792`*^9}, 3.860435700967555*^9, {
   3.860507944800791*^9, 3.860507946121937*^9}, 3.860508151292697*^9, {
   3.8703355099728394`*^9, 3.87033552074256*^9}, {3.8703356425378036`*^9, 
   3.870335644720654*^9}, {3.8703358702780857`*^9, 3.8703358993774443`*^9}, 
   3.8703362132800207`*^9, {3.870486390995903*^9, 3.8704863978244543`*^9}, {
   3.870491010844184*^9, 3.8704910122366343`*^9}, {3.8723001177355223`*^9, 
   3.8723001183877707`*^9}, {3.872300475403232*^9, 3.872300496437989*^9}, {
   3.872300533617116*^9, 3.872300572494783*^9}, {3.872300640404958*^9, 
   3.872300661231141*^9}, {3.8723009113131237`*^9, 3.8723009209721746`*^9}, 
   3.87230117805485*^9, {3.872301236572525*^9, 3.872301240902731*^9}, {
   3.872301487653479*^9, 3.8723015344112453`*^9}, {3.872301786365005*^9, 
   3.872301794564292*^9}, {3.872301874173452*^9, 3.872301896395938*^9}, {
   3.872301968797126*^9, 3.872302014398234*^9}, {3.8723021645136013`*^9, 
   3.8723024275451097`*^9}, {3.872302461383832*^9, 3.8723025184086227`*^9}, {
   3.872302594143104*^9, 3.872302594459876*^9}, {3.87230298149977*^9, 
   3.872302996036478*^9}, {3.87230311742161*^9, 3.872303125557418*^9}, {
   3.872303253434042*^9, 3.872303256272379*^9}, {3.872303350371029*^9, 
   3.8723033533701563`*^9}, 3.872304543260758*^9, {3.873359737358776*^9, 
   3.8733597375970907`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"06f25064-487f-4eba-ae11-79c3a764cd16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PCounterDerivsAP", "[", 
   RowBox[{"k_", ",", "pks_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Pcounteresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv", ",",
       "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Pcounteresum", "[", "arr_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"PCounterAP", "[", 
         RowBox[{"k", ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["k", "2"]}], 
             RowBox[{"arr", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["k", "2"]}], 
           RowBox[{"arr", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ")"}], 
        RowBox[{"PCounterAP", "[", 
         RowBox[{"k", ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"arr", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"qpa", " ", 
            SuperscriptBox["qo", "2"]}]], 
          RowBox[{"Pcounteresum", "[", 
           RowBox[{
            RowBox[{"pks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "6", ",", "9"}], "}"}], "]"}], 
            "]"}], "]"}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"qo", ",", "F", ",", "qpa"}], "}"}], "->", 
           RowBox[{
            RowBox[{"APfix2", "[", "z", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8926326069244003`*^9, 3.892632609274371*^9}, {
   3.8926327202802887`*^9, 3.892632755546384*^9}, {3.892632811938738*^9, 
   3.8926328157272043`*^9}, 3.892632918723558*^9, {3.892632977696114*^9, 
   3.892632979792639*^9}, {3.8926380490682373`*^9, 3.892638050766448*^9}, {
   3.89266501877569*^9, 3.892665022565641*^9}, 3.893775759274991*^9, {
   3.894254340875252*^9, 3.894254341612747*^9}, 3.894254514552924*^9, 
   3.8942547773887653`*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"b8cd1ea9-14a4-4cf6-81c9-eafb8684975a"],

Cell["Loop derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305179544417*^9}, {3.878324003553637*^9, 
  3.878324003914877*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"187c7b9c-5917-4d8c-8eb4-e891156897d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PLoopDerivs", "[", 
    RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P13", ",", "P22", ",", "Plint", ",", "Ploopeval", ",", "Ploopresum", 
       ",", "PTreeresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv",
        ",", "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P13", "=", 
       RowBox[{"P13n", "[", "k", "]"}]}], ";", " ", 
      RowBox[{"P22", "=", 
       RowBox[{"P22n", "[", "k", "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"Plint", "[", "Plin_", "]"}], "=", 
       RowBox[{"Plin", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ploopeval", "[", 
        RowBox[{"ls_", ",", "plin_", ",", "f_"}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"P13ev", "[", 
         RowBox[{"P13", ",", "ls", ",", "f", ",", 
          RowBox[{"Plint", "[", "plin", "]"}]}], "]"}], "+", " ", 
        RowBox[{"P22ev", "[", 
         RowBox[{"P22", ",", "ls", ",", "f"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ploopresum", "[", "arr_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Ploopeval", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"arr", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"arr", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", "  ", 
          RowBox[{"1", "-", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["k", "2"]}], 
             RowBox[{"arr", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["k", "2"]}], 
           RowBox[{"arr", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "]"}], 
         RowBox[{"Ploopeval", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"arr", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"arr", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prederiv", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Ploopresum", "[", 
          RowBox[{
           RowBox[{"pks", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"3", ",", "4", ",", "1", ",", "2", ",", "6", ",", "9"}], 
             "}"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8552132605934753`*^9, 3.8552132798433037`*^9}, {
   3.8552133168235965`*^9, 3.8552134519073095`*^9}, {3.855214310132822*^9, 
   3.855214329507357*^9}, {3.8552145356976748`*^9, 3.8552145359857054`*^9}, {
   3.8552174770254335`*^9, 3.8552174900170984`*^9}, {3.8552179845936913`*^9, 
   3.8552179927568665`*^9}, {3.855218049880351*^9, 3.8552180584186835`*^9}, {
   3.855218374242013*^9, 3.8552183863836155`*^9}, {3.855218581225415*^9, 
   3.8552186436184196`*^9}, {3.855218860733153*^9, 3.855218907905439*^9}, {
   3.8552190114921703`*^9, 3.855219025025141*^9}, {3.8552191026630116`*^9, 
   3.8552191044038963`*^9}, {3.855220038959756*^9, 3.8552201831079626`*^9}, {
   3.855220268445395*^9, 3.855220276197358*^9}, {3.855220353364435*^9, 
   3.8552203564952407`*^9}, 3.8552213394337807`*^9, {3.855222020830437*^9, 
   3.855222077639424*^9}, {3.8552221267733335`*^9, 3.855222186950463*^9}, 
   3.8552222300647345`*^9, {3.8552222791890097`*^9, 3.855222343814923*^9}, {
   3.855222861723735*^9, 3.855222888194085*^9}, {3.8552229430859127`*^9, 
   3.855222950341934*^9}, {3.8552229967658815`*^9, 3.8552230061592307`*^9}, {
   3.855223077125824*^9, 3.8552230927018023`*^9}, 3.8552232304530745`*^9, {
   3.8552233644007025`*^9, 3.8552233701414604`*^9}, {3.8552234328456154`*^9, 
   3.8552234593622584`*^9}, {3.8552239024595747`*^9, 3.855224276446269*^9}, {
   3.8552243329876633`*^9, 3.855224362717295*^9}, {3.8552244508150525`*^9, 
   3.8552244512937717`*^9}, {3.8552255851006145`*^9, 3.855225672529089*^9}, {
   3.8552258523822546`*^9, 3.8552259693744965`*^9}, {3.8552272270698085`*^9, 
   3.8552272861744967`*^9}, {3.8552317621657467`*^9, 3.855231790813834*^9}, 
   3.8552319007882366`*^9, {3.85523233787451*^9, 3.8552323657626767`*^9}, {
   3.855232879120243*^9, 3.855232885665193*^9}, {3.8552416671146774`*^9, 
   3.855241683416233*^9}, {3.856001481815685*^9, 3.8560015587790375`*^9}, {
   3.8560018092919507`*^9, 3.856001810122726*^9}, {3.8560911858586807`*^9, 
   3.856091190386009*^9}, {3.8560925640493307`*^9, 3.856092580798242*^9}, {
   3.8560926150596046`*^9, 3.856092617493783*^9}, 3.856092682422635*^9, {
   3.8560928393152943`*^9, 3.856092907440245*^9}, {3.8560949884782977`*^9, 
   3.856095026452264*^9}, {3.856095116595584*^9, 3.856095129745544*^9}, {
   3.8560953050759416`*^9, 3.8560953054493847`*^9}, {3.8560954039018345`*^9, 
   3.856095426939816*^9}, 3.8560954718436995`*^9, {3.856095573603755*^9, 
   3.856095683173815*^9}, {3.8560957337354827`*^9, 3.8560957618144503`*^9}, {
   3.8560958116120224`*^9, 3.8560958291066275`*^9}, {3.8560961396470156`*^9, 
   3.8560961402033467`*^9}, {3.856096279425429*^9, 3.8560962817975345`*^9}, {
   3.856096411908641*^9, 3.8560964120929337`*^9}, {3.8560970153045826`*^9, 
   3.8560970571397276`*^9}, {3.856097178060191*^9, 3.8560971844527464`*^9}, {
   3.856097629425712*^9, 3.8560976555142183`*^9}, {3.856097699862956*^9, 
   3.8560977006561527`*^9}, 3.8560979420462165`*^9, 3.8583221399702253`*^9, {
   3.85832231106285*^9, 3.8583223355084534`*^9}, {3.858339887622612*^9, 
   3.8583400512865343`*^9}, {3.8583402445748534`*^9, 3.858340299843937*^9}, 
   3.858340375526843*^9, {3.858340515952941*^9, 3.8583406097988853`*^9}, 
   3.8583406812917166`*^9, {3.8583412433621283`*^9, 3.8583412451320343`*^9}, {
   3.858341688263835*^9, 3.858341695556431*^9}, {3.858341770190067*^9, 
   3.8583417913265553`*^9}, {3.8583421907559304`*^9, 3.858342199772802*^9}, {
   3.858342361505916*^9, 3.8583424091742673`*^9}, {3.8583426247693005`*^9, 
   3.858342681095413*^9}, {3.85834282806733*^9, 3.858342890692011*^9}, {
   3.8583992112529054`*^9, 3.858399237254298*^9}, {3.8584057453200507`*^9, 
   3.8584057671362743`*^9}, {3.8584058468948145`*^9, 3.8584058530822535`*^9}, 
   3.8584064026274195`*^9, {3.858406654015836*^9, 3.858406665692851*^9}, 
   3.8584068489049354`*^9, {3.858408761162578*^9, 3.858408794828392*^9}, {
   3.858408902186231*^9, 3.8584089049223137`*^9}, {3.8584242139138193`*^9, 
   3.858424298965557*^9}, {3.858424627391868*^9, 3.8584247725645237`*^9}, {
   3.8584248590641956`*^9, 3.8584252146986575`*^9}, {3.8584256527141633`*^9, 
   3.8584259578060045`*^9}, {3.858425998441145*^9, 3.858426099539225*^9}, {
   3.8584269321518774`*^9, 3.8584269402318735`*^9}, 3.8584455085278015`*^9, 
   3.858445589158205*^9, {3.858445802783335*^9, 3.858445849361331*^9}, 
   3.8584459633161063`*^9, {3.8584460486711073`*^9, 3.858446069653865*^9}, {
   3.858446402312545*^9, 3.858446441105647*^9}, {3.858446580048362*^9, 
   3.8584465851577168`*^9}, {3.8584467720028315`*^9, 3.858446787591322*^9}, {
   3.858446870613494*^9, 3.8584468768529644`*^9}, {3.858446996717199*^9, 
   3.858447013758864*^9}, {3.858447048677722*^9, 3.8584471352705812`*^9}, {
   3.8584476181927495`*^9, 3.858447630245302*^9}, {3.858447777037052*^9, 
   3.8584478114909887`*^9}, {3.8584479411165047`*^9, 
   3.8584479490172105`*^9}, {3.858483134493806*^9, 3.8584831748348255`*^9}, {
   3.858483633560991*^9, 3.8584836351396513`*^9}, {3.8584842649220924`*^9, 
   3.858484276014456*^9}, 3.8584844375679836`*^9, {3.8584844892469788`*^9, 
   3.8584844959819717`*^9}, {3.858484756194998*^9, 3.8584847642393064`*^9}, 
   3.8584849427247853`*^9, {3.858484992461914*^9, 3.8584849929043646`*^9}, {
   3.858501063185598*^9, 3.858501074923715*^9}, {3.8592052257720623`*^9, 
   3.8592052769407997`*^9}, {3.8592053122498283`*^9, 3.859205398924036*^9}, {
   3.8592054352404785`*^9, 3.8592054516585026`*^9}, {3.8592055433234053`*^9, 
   3.859205571006667*^9}, {3.8592060355958834`*^9, 3.859206036314386*^9}, {
   3.859208145100141*^9, 3.8592081571798496`*^9}, {3.859208210316988*^9, 
   3.859208229388755*^9}, {3.8592086004611273`*^9, 3.8592086071019583`*^9}, {
   3.8592089569899015`*^9, 3.8592089591711783`*^9}, {3.8592708316085024`*^9, 
   3.8592708349157925`*^9}, {3.859548386742169*^9, 3.859548386867742*^9}, {
   3.8596479687586308`*^9, 3.8596479825458117`*^9}, {3.860317925991248*^9, 
   3.8603179298929825`*^9}, {3.860322104107588*^9, 3.860322106489632*^9}, 
   3.8603266291535344`*^9, {3.8604242232890215`*^9, 3.8604242261819906`*^9}, {
   3.860424924597393*^9, 3.860424933636318*^9}, {3.86043567499611*^9, 
   3.8604356780799265`*^9}, {3.860507933320891*^9, 3.8605079337470794`*^9}, 
   3.8605081415294876`*^9, {3.870336295586814*^9, 3.870336357792151*^9}, {
   3.8703364166511917`*^9, 3.870336435571916*^9}, {3.8703364784729*^9, 
   3.870336489402371*^9}, {3.870485718016523*^9, 3.8704857222961807`*^9}, {
   3.870488118532496*^9, 3.870488121860173*^9}, {3.870490964624899*^9, 
   3.870490974992442*^9}, {3.87230410210859*^9, 3.872304151789733*^9}, {
   3.872304207715746*^9, 3.872304257400985*^9}, {3.87230431052207*^9, 
   3.87230436821388*^9}, {3.872304410476109*^9, 3.872304417444831*^9}, {
   3.872304449936763*^9, 3.87230445035609*^9}, {3.872304555628427*^9, 
   3.8723045883021097`*^9}, {3.8723047258757553`*^9, 3.872304726040217*^9}, {
   3.872305149362557*^9, 3.872305152967976*^9}, {3.873359741656402*^9, 
   3.873359741894813*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"ff622c39-80c5-4dfd-ba35-82583834364b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PLoopDerivsAP", "[", 
    RowBox[{"k_", ",", "pks_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P13", ",", "P22", ",", "Plint", ",", "Flist", ",", "qplist", ",", 
       "qolist", ",", "PTreeresum", ",", "prederiv", ",", "EFTderiv", ",", 
       "cosmoderiv", ",", "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Flist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"APfix2", "[", "z", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qolist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"APfix2", "[", "z", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qplist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"APfix2", "[", "z", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prederiv", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"qplist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            SuperscriptBox[
             RowBox[{"qolist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "2"]}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"P1loopAP", "[", 
              RowBox[{"k", ",", 
               RowBox[{"Flist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"qolist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"pks", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"pks", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "9"}], "]"}], "]"}], ",", 
               RowBox[{"pks", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "]"}], 
             RowBox[{"(", "  ", 
              RowBox[{"1", "-", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox["k", "2"]}], 
                 RowBox[{"pks", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "6"}], "]"}], "]"}]}], "]"}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["k", "2"]}], 
               RowBox[{"pks", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "6"}], "]"}], "]"}]}], "]"}], 
             RowBox[{"P1loopAP", "[", 
              RowBox[{"k", ",", 
               RowBox[{"Flist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"qolist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"pks", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"pks", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "9"}], "]"}], "]"}], ",", 
               RowBox[{"pks", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}]}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892665171297105*^9, 3.8926651717293043`*^9}, {
   3.8942545297541323`*^9, 3.894254570059222*^9}, 3.8942548364374523`*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"d651b22c-4fb0-4eb3-800a-3df0eaeddc0d"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "NL"], TraditionalForm]],ExpressionUUID->
  "d159037d-52f9-4c59-b5d7-ed417bc74787"],
 " derivatives"
}], "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.8723051697520514`*^9}, {3.873385012560247*^9, 
  3.873385014247384*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"f51974f7-dd55-4110-90e0-833a9dfb0ede"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PNGDerivs", "[", 
   RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "PTreeresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv", ",", 
      "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PNGfull", "[", 
         RowBox[{"k", ",", 
          RowBox[{
           RowBox[{"pks", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"3", ",", "9", ",", "10"}], "}"}], "]"}], "]"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8585077292340565`*^9, 3.8585077305031223`*^9}, {
   3.859204856667835*^9, 3.8592050386818385`*^9}, {3.859205082609642*^9, 
   3.8592051738040447`*^9}, 3.859205336286848*^9, 3.8592060435140676`*^9, {
   3.859270824435414*^9, 3.8592708280355687`*^9}, {3.8595483866231203`*^9, 
   3.859548386713423*^9}, {3.859647898003146*^9, 3.859647921616929*^9}, 
   3.8603266457002697`*^9, {3.86042419836705*^9, 3.860424200491829*^9}, {
   3.860424906918251*^9, 3.8604249179063807`*^9}, 3.8604356901509686`*^9, {
   3.8605079396856136`*^9, 3.8605079401018467`*^9}, 3.8605081470038366`*^9, {
   3.8703362242951612`*^9, 3.870336235661982*^9}, {3.8703362716024218`*^9, 
   3.870336281675535*^9}, {3.8704910051904716`*^9, 3.870491007432871*^9}, 
   3.872300459566333*^9, {3.87230099660244*^9, 3.8723010000801973`*^9}, {
   3.87230354744785*^9, 3.8723035508091927`*^9}, {3.872303582620851*^9, 
   3.8723036182272043`*^9}, {3.8723036850178633`*^9, 3.872303773137793*^9}, {
   3.872304531464572*^9, 3.87230453478293*^9}, 3.87230459825539*^9, {
   3.87335973190872*^9, 3.873359732164007*^9}, {3.873385016085627*^9, 
   3.873385018127852*^9}, {3.873386300483424*^9, 3.873386354374435*^9}, {
   3.873386393914277*^9, 3.8733863964613867`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"5e0d1e2b-1af2-4617-8399-7e016095483e"],

Cell["Full P1loop derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d9be7222-a543-4ffd-8fa2-70d89d83e68c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P1Loopderivs", "[", 
    RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PLoopDerivs", "[", 
        RowBox[{"k", ",", "pks"}], "]"}], "+", 
       RowBox[{"PTreeDerivs", "[", 
        RowBox[{"k", ",", "pks"}], "]"}], "+", 
       RowBox[{"PCounterDerivs", "[", 
        RowBox[{"k", ",", "pks"}], "]"}], "+", 
       RowBox[{"PNGDerivs", "[", 
        RowBox[{"k", ",", "pks"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "10"}], "}"}]}], "]"}], "//", 
    "Normal"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872304779495996*^9, 3.8723048146033173`*^9}, 
   3.87230485825953*^9, {3.8728388385182037`*^9, 3.8728388855263157`*^9}, {
   3.873386406735013*^9, 3.873386411957713*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"4a13301e-c83c-4bed-a0c3-0b17b4bffc28"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P1LoopderivsAP", "[", 
    RowBox[{"k_", ",", "pks_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PLoopDerivsAP", "[", 
        RowBox[{"k", ",", "pks", ",", "z"}], "]"}], "+", 
       RowBox[{"PTreeDerivsAP", "[", 
        RowBox[{"k", ",", "pks", ",", "z"}], "]"}], "+", 
       RowBox[{"PCounterDerivsAP", "[", 
        RowBox[{"k", ",", "pks", ",", "z"}], "]"}], "+", 
       RowBox[{"PNGDerivs", "[", 
        RowBox[{"k", ",", "pks"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "10"}], "}"}]}], "]"}], "//", 
    "Normal"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892638804298242*^9, 3.8926388101064663`*^9}, {
  3.892641772379071*^9, 3.892641779090354*^9}, {3.89266520376755*^9, 
  3.892665214945086*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"cf6ae302-e02b-404b-934f-d50924d9ae0a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Covariance", "Subsection",
 CellChangeTimes->{{3.872305455191352*^9, 
  3.872305460498106*^9}},ExpressionUUID->"a5429fc0-2b11-4863-aff0-\
30133bfe0b63"],

Cell["Fisher with Analytical covariance", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337573185067*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"15e6540c-63a2-41ba-afe2-743869dd62bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PTree", "[", 
    RowBox[{"k_", ",", "plin_", ",", "f1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"b1", "+", 
        RowBox[{"f1", " ", 
         SuperscriptBox["\[Mu]", "2"]}]}], ")"}], "2"], 
     RowBox[{"plin", "[", "k", "]"}]}], "+", 
    FractionBox["Be1", "nb"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.861260930372882*^9, 3.86126095836022*^9}, {
   3.8612609892238593`*^9, 3.8612610205806756`*^9}, 3.861261256596815*^9, {
   3.861264053876422*^9, 3.8612640593303595`*^9}, 3.8612646876977043`*^9, {
   3.870332673572981*^9, 3.870332675378186*^9}, 3.8703366586208982`*^9, 
   3.8703367049405603`*^9, {3.870336851192854*^9, 3.870336868722395*^9}, {
   3.870336904186833*^9, 3.8703369106794653`*^9}, {3.871096566844083*^9, 
   3.871096578809074*^9}, {3.871107621664961*^9, 3.8711076258392897`*^9}, {
   3.8711078407474413`*^9, 3.871107842308467*^9}, {3.872305791631235*^9, 
   3.872305805920432*^9}, 3.8723058946814947`*^9, 3.873166770262146*^9, {
   3.87413547694027*^9, 3.874135477046113*^9}, {3.874138237257159*^9, 
   3.8741382373980227`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"0f0e5298-5fe4-4737-83c1-3511a8bbb389"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CovPInv", "[", 
    RowBox[{"k_", ",", "pks_", ",", "bias_", ",", "Survey_", ",", "f1_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", " ", 
       FractionBox[
        RowBox[{"4", 
         SuperscriptBox["\[Pi]", "2"]}], 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "dk", " ", "Vs"}]], ")"}], 
      RowBox[{"-", "1"}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"PTree", "[", 
             RowBox[{"k", ",", 
              RowBox[{"pks", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "f1"}], "]"}], "/.",
             "bias"}]], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", "30"}], "}"}]}], "]"}], "//", 
        "Normal"}], ")"}], "2"]}], "/.", "Survey"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877297279315164*^9, 3.877297287135517*^9}, {
   3.877298141428604*^9, 3.877298144408141*^9}, 3.885479339486116*^9, {
   3.885479768861726*^9, 3.885479769515623*^9}, 3.885479801644491*^9, 
   3.895474294871976*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"72dc809b-3549-4efc-8a81-4aa70e486c80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CovPInvmulti", "[", 
   RowBox[{"k_", ",", "pks_", ",", "bias_", ",", "Survey_", ",", "fs_"}], 
   "]"}], ":=", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"CovPInv", "[", 
       RowBox[{"k", ",", "pks", ",", 
        RowBox[{"bias", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Survey", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"fs", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "bias", "]"}]}], "}"}]}], "]"}], ",", "i"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.877298148313857*^9, 3.877298154118338*^9}, {
   3.877298463861012*^9, 3.877298467421825*^9}, 3.885479804090824*^9, {
   3.8954742948731823`*^9, 3.895474294873828*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"4d7fa0d1-a71b-4a5f-a509-a52357064b28"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{"ks_", ",", "pks_", ",", "spec_", ",", "stoch_", ",", "dkk_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"CovPInvmulti", "[", 
     RowBox[{"ks", ",", "pks", ",", 
      RowBox[{"shiftedbfix", "[", 
       RowBox[{"spec", ",", "stoch"}], "]"}], ",", 
      RowBox[{"fixsurv", "[", 
       RowBox[{"spec", ",", "dkk"}], "]"}], ",", 
      RowBox[{"spec", "[", 
       RowBox[{"[", "6", "]"}], "]"}]}], "]"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8783270984955053`*^9, 3.878327105078795*^9}, {
   3.878389189785825*^9, 3.878389194523428*^9}, 3.880014797394404*^9, {
   3.8852352224941387`*^9, 3.885235222711915*^9}, {3.8854794075377693`*^9, 
   3.8854794269523973`*^9}, {3.895474294874688*^9, 3.895474294875358*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"2902ebc7-e022-48d5-a57a-c5b44250bb8a"]
}, Closed]],

Cell[CellGroupData[{

Cell["FisherMatrix", "Subsection",
 CellChangeTimes->{{3.872306023975786*^9, 3.8723060279098387`*^9}, {
  3.872326036363183*^9, 
  3.872326041129922*^9}},ExpressionUUID->"d4596cea-1bc3-4949-b44f-\
1392b33a9c8d"],

Cell["Get Fishers ", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337573185067*^9}, {3.8783251770837717`*^9, 3.878325179329892*^9}, {
  3.885479625767445*^9, 3.88547962674446*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9c2498f0-5d67-49d9-832a-1378f3fca788"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetFisherP", "[", 
    RowBox[{"derivs_", ",", "covsinv_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Mirror", "[", 
    RowBox[{"mono", "[", 
     RowBox[{"Upperright", "[", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{
              RowBox[{"derivs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"derivs", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ")"}], 
           RowBox[{"covsinv", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "derivs", "]"}]}], "}"}]}], "]"}], ",", 
        "i"}], "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8772958355492363`*^9, 3.877295896988563*^9}, 
   3.885479599365719*^9, {3.8954743148150663`*^9, 3.89547431558132*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"af6562c7-0617-41c9-96dd-b40c10aba6d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetFisherPNum", "[", 
   RowBox[{"derivs_", ",", "covsinv_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"2048", " ", "-", " ", 
     RowBox[{"Length", "[", "covsinv", "]"}], " ", "-", " ", "2"}], 
    RowBox[{"2048", " ", "-", " ", "1"}]], "*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"derivs", "//", "Transpose"}], ")"}], ".", 
    RowBox[{"Inverse", "[", "covsinv", "]"}], ".", "derivs"}]}]}]], "Input",
 CellChangeTimes->{{3.878380186546871*^9, 3.8783802126960573`*^9}, 
   3.885479599366469*^9, {3.895474316528904*^9, 3.8954743187612267`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"b128058f-57af-470d-b495-38ea9f842386"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Bispectrum Fisher", "Section",
 CellChangeTimes->{{3.872338317139975*^9, 
  3.87233831992837*^9}},ExpressionUUID->"bbbfab1c-ea48-4e9f-80f8-\
8aaf0e7b2a7a"],

Cell[CellGroupData[{

Cell["Imports and potential exports", "Subsection",
 CellChangeTimes->{{3.872415456723543*^9, 
  3.872415462186433*^9}},ExpressionUUID->"164fe5e2-168a-449d-8d47-\
0e988c75358f"],

Cell["Some path functions", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872394578890099*^9, 3.872394580546254*^9}, {3.872396904889988*^9, 
  3.872396907416482*^9}, {3.872408408570532*^9, 3.8724084113068333`*^9}, {
  3.8783260282493153`*^9, 3.8783260308541594`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e38a07d3-7c17-4b2d-b673-73812cdbc2de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExportKer", "[", 
    RowBox[{"file_", ",", "func_", ",", "triang_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "file", "]"}], ",", 
     RowBox[{"x", "=", "x"}], ",", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", 
       RowBox[{"func", "[", "triang", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"savelpath", "[", 
    RowBox[{"triang_", ",", "diag_"}], "]"}], ":=", 
   RowBox[{"\"\<LoopKerInt/saveloops/\>\"", "<>", 
    RowBox[{"ToString", "[", "diag", "]"}], "<>", "\"\</\>\"", "<>", 
    RowBox[{"Tfi", "[", 
     RowBox[{"triang", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"Tfi", "[", 
     RowBox[{"triang", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"Tfi", "[", 
     RowBox[{"triang", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<_.m\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jmatimp", "[", 
    RowBox[{"triang_", ",", "diag_"}], "]"}], ":=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"\"\<Createjmats/jmats/\>\"", "<>", 
      RowBox[{"ToString", "[", "diag", "]"}], "<>", "\"\</\>\"", "<>", 
      RowBox[{"Tfi", "[", 
       RowBox[{"triang", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"Tfi", "[", 
       RowBox[{"triang", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"Tfi", "[", 
       RowBox[{"triang", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<_.h5\>\""}], ",", 
     "\"\<jmat\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.872408406618546*^9, {3.8724096786459293`*^9, 3.8724096971587553`*^9}, {
   3.8724101569649973`*^9, 3.872410173396256*^9}, 3.893828119976203*^9, 
   3.893829905464821*^9, {3.8950580210204887`*^9, 3.895058046379239*^9}, 
   3.897807983119214*^9},ExpressionUUID->"69066abc-71f9-4402-9ad7-\
75eeffc1e262"],

Cell["Import kernels", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872394578890099*^9, 3.872394580546254*^9}, {3.872396904889988*^9, 
   3.872396907416482*^9}, {3.872408408570532*^9, 3.8724084113068333`*^9}, 
   3.885626709493884*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e15b6dbc-89cd-4528-9b7a-d9e079999e69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"B222kers", "[", 
    RowBox[{"{", 
     RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], "]"}], " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/B222simppermks.m\>\"", "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B3211kers", "[", 
    RowBox[{"{", 
     RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], "]"}], " ", "=", " ", 
   RowBox[{"TensorTranspose", "[", 
    RowBox[{
     RowBox[{
     "Import", "[", "\"\<LoopKerInt/tabs/B3211simppermks.m\>\"", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B3212kers", "[", 
    RowBox[{"{", 
     RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], "]"}], " ", "=", " ", 
   RowBox[{"TensorTranspose", "[", 
    RowBox[{
     RowBox[{
     "Import", "[", "\"\<LoopKerInt/tabs/B3212simppermks.m\>\"", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B411kers", "[", 
    RowBox[{"{", 
     RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], "]"}], " ", "=", " ", 
   RowBox[{"TensorTranspose", "[", 
    RowBox[{
     RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/B411simppermks.m\>\"", "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8724077445799837`*^9, 3.872407849901642*^9}, 
   3.872407891839993*^9, {3.872407935812456*^9, 3.872408064792536*^9}, {
   3.87240833714543*^9, 3.872408395179*^9}, {3.872413536000762*^9, 
   3.872413538089375*^9}, 3.878925524191661*^9, {3.8938281199775677`*^9, 
   3.893828119979335*^9}, {3.893828179463216*^9, 3.8938281897908773`*^9}, {
   3.89505811171529*^9, 3.895058128188067*^9}, {3.895058337333393*^9, 
   3.895058337450541*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"fd13622b-e967-4988-a646-881a81b42b72"],

Cell["Export evaluated things", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872394578890099*^9, 3.872394580546254*^9}, {3.872396904889988*^9, 
  3.872396907416482*^9}, {3.872408408570532*^9, 3.8724084113068333`*^9}, {
  3.872408553610174*^9, 3.8724085597607813`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"17a5fae5-1824-428d-a942-ebb272e75fa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tabexport", "[", "triangs_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "B222precomp", ",", "file1", ",", "file2", ",", "file3", ",", "file4"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "triangs", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ExportKer", "[", 
           RowBox[{
            RowBox[{"savelpath", "[", 
             RowBox[{
              RowBox[{"triangs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "B222"}], "]"}], ",", 
            "B222kers", ",", 
            RowBox[{"triangs", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ExportKer", "[", 
           RowBox[{
            RowBox[{"savelpath", "[", 
             RowBox[{
              RowBox[{"triangs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "B3211"}], "]"}], ",", 
            "B3211kers", ",", 
            RowBox[{"triangs", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ExportKer", "[", 
           RowBox[{
            RowBox[{"savelpath", "[", 
             RowBox[{
              RowBox[{"triangs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "B3212"}], "]"}], ",", 
            "B3212kers", ",", 
            RowBox[{"triangs", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ExportKer", "[", 
           RowBox[{
            RowBox[{"savelpath", "[", 
             RowBox[{
              RowBox[{"triangs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "B411"}], "]"}], ",", 
            "B411kers", ",", 
            RowBox[{"triangs", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", "i"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8724081159994993`*^9, 3.8724081519950953`*^9}, {
  3.872408424962451*^9, 3.872408473360855*^9}, {3.872408520463311*^9, 
  3.8724085275254498`*^9}, {3.872409704365231*^9, 3.872409710473877*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"d163c88a-dc2d-4481-9b8c-818911358d3a"],

Cell["This only needs to be run the first time evaluating the code", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872394578890099*^9, 3.872394580546254*^9}, {3.872396904889988*^9, 
  3.872396907416482*^9}, {3.872408408570532*^9, 3.8724084113068333`*^9}, {
  3.872408553610174*^9, 3.8724085597607813`*^9}, {3.895599885569757*^9, 
  3.895599894240768*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"61e57361-55b3-4f1e-8024-c881e518ddcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"smallk", "=", "0.001`"}], ";"}]], "Input",
 CellLabel->
  "In[168]:=",ExpressionUUID->"e8eef5c0-a360-4100-ba04-ec5019197d15"],

Cell[BoxData[
 RowBox[{"Tabexport", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"smallk", ",", "smallk", ",", "smallk"}], "}"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.89560379854662*^9, 3.895603809256261*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"0743e738-58fd-4eed-868f-7532d33ab8a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tabexport", "[", 
   RowBox[{"Import", "[", "\"\<covsks/TriCMASSkeff.mtx\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tabexport", "[", 
   RowBox[{"Import", "[", "\"\<covsks/TriLOWZkeff.mtx\>\"", "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895603780161934*^9, 3.8956037806702757`*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"5eae9468-0dd3-40c7-b05a-72355c9142bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tabexport", "[", 
   RowBox[{"Import", "[", "\"\<covsks/baseTrikeff.mtx\>\"", "]"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.895599857725109*^9, 3.895599908346323*^9}, 
   3.895599987215561*^9, {3.8956003213934317`*^9, 3.895600342563881*^9}, {
   3.895603749260618*^9, 3.895603781648286*^9}, 3.8956038184256697`*^9, {
   3.89780869551989*^9, 
   3.897808696917787*^9}},ExpressionUUID->"2f494f15-2a14-417f-92b7-\
55b664fa7f0c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary functions and definitions", "Subsection",
 CellChangeTimes->{{3.8723384241350517`*^9, 
  3.872338434753911*^9}},ExpressionUUID->"d9b52e95-387f-41ac-b95e-\
66a9adc55bc6"],

Cell["Angle definitions", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872394578890099*^9, 3.872394580546254*^9}, {3.878326050684908*^9, 
  3.878326053312443*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"96ad5bac-91d9-4013-8a37-af1b80f601b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ys", "[", 
    RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["k1", "2"]}], "-", 
     SuperscriptBox["k2", "2"], "+", 
     SuperscriptBox["k3", "2"]}], 
    RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
  RowBox[{
   RowBox[{"y13s", "[", 
    RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["k1", "2"]}], "+", 
     SuperscriptBox["k2", "2"], "-", 
     SuperscriptBox["k3", "2"]}], 
    RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.872427238217733*^9, 3.872427239591991*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"2b7d5043-6406-4148-81a8-7c3dbaf9c171"],

Cell["Tree term definition", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872394578890099*^9, 3.872394580546254*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5342e184-95a8-4080-bd7a-51595e2f006c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BTree", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "k3_", ",", "Plin_", ",", "f1_", ",", "y_", ",", 
     "y13_"}], "]"}], "=", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/Treelist.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.8628351998598957`*^9, {3.8635722562718887`*^9, 3.863572259543641*^9}, 
   3.863643579395754*^9, {3.870783837385638*^9, 3.8707838378610487`*^9}, {
   3.87078412562113*^9, 3.870784126336732*^9}, {3.871016982427359*^9, 
   3.871016982989205*^9}, {3.872394584255641*^9, 3.872394584940051*^9}, 
   3.8723947182126093`*^9, 3.872559131034532*^9, {3.872858523354272*^9, 
   3.872858528339521*^9}, 3.872858869410548*^9, {3.8733598059869547`*^9, 
   3.873359806680983*^9}, {3.873970792762492*^9, 3.873970796120399*^9}, 
   3.8938281199804697`*^9, 3.89382993022085*^9, 3.893844804951975*^9, 
   3.8950581249473753`*^9, {3.895473700420559*^9, 3.8954737044229107`*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"4117c101-afbb-4352-9eb8-62cb0b48f801"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BTreeAP", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "k3_", ",", "Plin_", ",", "f1_", ",", "y_", ",", 
     "y13_", ",", "F_", ",", "qo_"}], "]"}], "=", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/TreelistAP.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892644158745969*^9, 3.892644180678657*^9}, {
   3.892646470186221*^9, 3.892646472369155*^9}, {3.89264678067588*^9, 
   3.892646784322185*^9}, 3.893828119981441*^9, 3.8938299302215242`*^9, 
   3.8938448037449827`*^9, 3.895058124948822*^9, {3.895473696110573*^9, 
   3.895473697962101*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"ac2b902c-cb2a-41ea-80f6-63319157bad7"],

Cell["Counter term definition", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"95d78b4e-0149-4845-bf37-cdf1f7fd22ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"counterlist2", "=", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/counterlistG.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8728580361403933`*^9, 3.872858041153919*^9}, {
   3.872858127902025*^9, 3.8728581314563704`*^9}, {3.872858541112605*^9, 
   3.8728585485086517`*^9}, {3.872858799347577*^9, 3.8728588028221207`*^9}, {
   3.873119048151767*^9, 3.873119057669409*^9}, {3.873119511407545*^9, 
   3.873119516597375*^9}, {3.873120561460999*^9, 3.873120577950083*^9}, 
   3.873970863970661*^9, 3.8743986745375233`*^9, 3.8938281199823513`*^9, 
   3.893829930222069*^9, 3.8938448020923443`*^9, 3.89505812494995*^9, 
   3.895473767092305*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"e784f08d-1a72-4046-8b27-5dd17bdd4dc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"counterlist2Tree", "=", 
   RowBox[{"counterlist2", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Bd2", ",", "Bd3", ",", "Be2", ",", "ce2", ",", "Be3", ",", "Be4", ",",
         "Be6", ",", "Be7", ",", "Be8", ",", "Be9", ",", "Be10", ",", "Be11", 
        ",", "Be12", ",", "Bc1", ",", "Bc10", ",", "Bc11", ",", "Bc12", ",", 
        "Bc13", ",", "Bc14", ",", "Bc2", ",", "Bc3", ",", "Bc4", ",", "Bc5", 
        ",", "Bc6", ",", "Bc7", ",", "Bc8", ",", "Bc9"}], "}"}], "->", "0"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8854812963150177`*^9, 3.88548131162022*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"4fb5ab4e-5e46-4a3d-8783-3967e4e96aab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BCounter", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "k3_", ",", "Plin_", ",", "f1_", ",", "y_", ",", 
     "y13_"}], "]"}], "=", "counterlist2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCounterTree", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "k3_", ",", "Plin_", ",", "f1_", ",", "y_", ",", 
     "y13_"}], "]"}], "=", "counterlist2Tree"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCounterTreeAP", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "k3_", ",", "Plin_", ",", "f_", ",", "y_", ",", 
     "y13_", ",", "F_", ",", "qo_"}], "]"}], "=", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/counterlistGAP.m\>\"", "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{
  3.8628351998598957`*^9, {3.8635722562718887`*^9, 3.863572259543641*^9}, 
   3.863643579395754*^9, {3.870783837385638*^9, 3.8707838378610487`*^9}, {
   3.87078412562113*^9, 3.870784126336732*^9}, {3.871016982427359*^9, 
   3.871016982989205*^9}, 3.872394714311256*^9, 3.872559179082725*^9, {
   3.872858029737763*^9, 3.872858045974394*^9}, {3.885481336832296*^9, 
   3.88548134172828*^9}, {3.892648485591674*^9, 3.892648501713377*^9}, 
   3.892649431717898*^9, 3.893828119983268*^9, 3.893829905465528*^9, 
   3.895058124951173*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"c7e3e15a-5572-44f9-bcf9-b75a9fd08619"],

Cell["Loop definitions and imports", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872394578890099*^9, 3.872394580546254*^9}, {3.872396904889988*^9, 
   3.872396907416482*^9}, {3.872408408570532*^9, 3.8724084113068333`*^9}, {
   3.872408553610174*^9, 3.8724085597607813`*^9}, {3.8724086058319683`*^9, 
   3.872408608430937*^9}, {3.8724135499164762`*^9, 3.8724135535367527`*^9}, {
   3.872415519245735*^9, 3.872415519696249*^9}, 3.8724156337708597`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c584b5f8-2bbf-4f80-8491-909de779c10e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"B222coefs", "[", 
    RowBox[{"f_", ",", "y_", ",", "y13_"}], "]"}], "=", 
   RowBox[{
   "Import", "[", "\"\<LoopKerInt/tabs/B222simpcoefslist.m\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B3211coefs", "[", 
    RowBox[{"f_", ",", "y_", ",", "y13_"}], "]"}], "=", 
   RowBox[{
   "Import", "[", "\"\<LoopKerInt/tabs/B3211simpcoefslist.m\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B3212coefs", "[", 
    RowBox[{"f_", ",", "y_", ",", "y13_"}], "]"}], "=", 
   RowBox[{
   "Import", "[", "\"\<LoopKerInt/tabs/B3212simpcoefslist.m\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B411coefs", "[", 
    RowBox[{"f_", ",", "y_", ",", "y13_"}], "]"}], "=", 
   RowBox[{
   "Import", "[", "\"\<LoopKerInt/tabs/B411simpcoefslist.m\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87240861726896*^9, 3.872408652727193*^9}, {
   3.872413605954921*^9, 3.872413616558351*^9}, {3.8725593309286337`*^9, 
   3.872559333450384*^9}, {3.872858606174039*^9, 3.872858635654916*^9}, {
   3.873359815063816*^9, 3.8733598233828087`*^9}, 3.8733617617813683`*^9, {
   3.8938281199849052`*^9, 3.893828119987069*^9}, {3.893829930223063*^9, 
   3.893829930225561*^9}, {3.893844788015052*^9, 3.893844790792343*^9}, {
   3.895058124953897*^9, 3.8950581249567337`*^9}, 3.895473246236298*^9, {
   3.895473599283228*^9, 3.895473607637389*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"bf74b555-004b-4aa5-bc24-52b3b5f5c04d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B222n", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"savelpath", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B222"}], "]"}], 
    "]"}], ".", 
   RowBox[{"jmatimp", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B222"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B3211n", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"saveker", ",", "jm"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"saveker", " ", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"savelpath", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B3211"}], "]"}], 
       "]"}]}], ";", " ", 
     RowBox[{"jm", "=", 
      RowBox[{"TensorTranspose", "[", 
       RowBox[{
        RowBox[{"jmatimp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B3211"}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"saveker", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "All"}], "]"}], "]"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"jm", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B3212n", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"saveker", ",", "jm"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"saveker", " ", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"savelpath", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B3212"}], "]"}], 
       "]"}]}], ";", " ", 
     RowBox[{"jm", "=", 
      RowBox[{"TensorTranspose", "[", 
       RowBox[{
        RowBox[{"jmatimp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B3212"}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"saveker", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "All"}], "]"}], "]"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"jm", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B411n", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"saveker", ",", "jm"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"saveker", " ", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"savelpath", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B411"}], "]"}], 
       "]"}]}], ";", " ", 
     RowBox[{"jm", "=", 
      RowBox[{"TensorTranspose", "[", 
       RowBox[{
        RowBox[{"jmatimp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "B411"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"saveker", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "All"}], "]"}], "]"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"jm", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.855209197141024*^9, {3.855209340220626*^9, 3.855209377734875*^9}, {
   3.85520960347972*^9, 3.855209619700591*^9}, 3.8552177101168666`*^9, {
   3.855225760082529*^9, 3.855225766294866*^9}, 3.856091554701582*^9, {
   3.8582195234284773`*^9, 3.8582195352381306`*^9}, {3.858219595875521*^9, 
   3.8582196435071*^9}, {3.8582205868899717`*^9, 3.8582206043891897`*^9}, 
   3.858220693949464*^9, {3.858220735638833*^9, 3.858220752339714*^9}, {
   3.858220867337052*^9, 3.8582208688240952`*^9}, {3.8582209320621862`*^9, 
   3.8582209350347877`*^9}, 3.8583352567069736`*^9, 3.858337932625865*^9, 
   3.858339222403682*^9, {3.858339809845899*^9, 3.858339821441238*^9}, {
   3.8607818530961623`*^9, 3.860781860117911*^9}, {3.860783155892627*^9, 
   3.8607831581809626`*^9}, {3.8608247044978256`*^9, 3.860824713858588*^9}, 
   3.860824769042124*^9, {3.863631684258131*^9, 3.8636317076557703`*^9}, {
   3.872409746549622*^9, 3.872409775301813*^9}, {3.87240981980103*^9, 
   3.872409857268229*^9}, {3.872410192168541*^9, 3.872410200578541*^9}, {
   3.872413503000296*^9, 3.872413507484847*^9}, {3.8724149973650217`*^9, 
   3.8724151014768553`*^9}, {3.872415134153453*^9, 3.872415142793543*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"7a7bfb55-37f4-482d-a5a0-864c9846aa6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"B222ev", "[", 
    RowBox[{"B222_", ",", "ls_", ",", "coefs_"}], "]"}], " ", ":=", " ", 
   RowBox[{"B222", ".", "ls", ".", "ls", ".", "ls", ".", "coefs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B3211ev", "[", 
    RowBox[{"B3211_", ",", "ls_", ",", "coefs_", ",", "PTab_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"B3211", ",", "1"}], "]"}], ".", "ls", ".", "ls", ".", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"coefs", " ", "PTab"}], ",", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B3212ev", "[", 
    RowBox[{"B3212_", ",", "ls_", ",", "coefs_", ",", "PTab_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"B3212", ",", "1"}], "]"}], ".", "ls", ".", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"coefs", " ", "PTab"}], ",", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B411ev", "[", 
    RowBox[{"B411_", ",", "ls_", ",", "coefs_", ",", "PTab_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"B411", ",", "1"}], "]"}], ".", "ls", ".", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"coefs", " ", "PTab"}], ",", "1"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.872409202063308*^9, 3.872409212338937*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"9a4370b9-0c4f-47a1-81fb-6a9e361bcd5b"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "NL"], TraditionalForm]],ExpressionUUID->
  "c6d11b77-17bb-476a-9ef8-e200f47c510a"],
 " definitions and imports"
}], "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872394578890099*^9, 3.872394580546254*^9}, {3.872396904889988*^9, 
   3.872396907416482*^9}, {3.872408408570532*^9, 3.8724084113068333`*^9}, {
   3.872408553610174*^9, 3.8724085597607813`*^9}, {3.8724086058319683`*^9, 
   3.872408608430937*^9}, {3.8724135499164762`*^9, 3.8724135535367527`*^9}, {
   3.872415519245735*^9, 3.872415519696249*^9}, 3.8724156337708597`*^9, {
   3.873387008536064*^9, 3.8733870101782913`*^9}, {3.873387154353695*^9, 
   3.8733871544372377`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"db8717c5-3043-4e73-bc81-78ec74cd8b02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Bloc", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["k1", "3"], 
       SuperscriptBox["k2", "3"]}]], "+", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["k2", "3"], 
       SuperscriptBox["k3", "3"]}]], "+", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["k3", "3"], 
       SuperscriptBox["k1", "3"]}]]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bequil", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", " ", 
  RowBox[{"6", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      RowBox[{
       SuperscriptBox["k1", "3"], 
       SuperscriptBox["k2", "3"]}]], "-", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["k1", "3"], 
       SuperscriptBox["k3", "3"]}]], "-", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["k2", "3"], 
       SuperscriptBox["k3", "3"]}]], "-", 
     FractionBox["2", 
      RowBox[{
       SuperscriptBox["k1", "2"], 
       SuperscriptBox["k2", "2"], 
       SuperscriptBox["k3", "2"]}]], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"k1", " ", 
         SuperscriptBox["k2", "2"], 
         SuperscriptBox["k3", "3"]}]], "+", 
       FractionBox["1", 
        RowBox[{"k1", " ", 
         SuperscriptBox["k3", "2"], 
         SuperscriptBox["k2", "3"]}]], "+", 
       FractionBox["1", 
        RowBox[{"k2", " ", 
         SuperscriptBox["k1", "2"], 
         SuperscriptBox["k3", "3"]}]], "+", 
       FractionBox["1", 
        RowBox[{"k2", " ", 
         SuperscriptBox["k3", "2"], 
         SuperscriptBox["k1", "3"]}]], "+", 
       FractionBox["1", 
        RowBox[{"k3", " ", 
         SuperscriptBox["k1", "2"], 
         SuperscriptBox["k2", "3"]}]], "+", 
       FractionBox["1", 
        RowBox[{"k3", " ", 
         SuperscriptBox["k2", "2"], 
         SuperscriptBox["k1", "3"]}]]}], ")"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Borth", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
  RowBox[{"6", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "k1"}], "+", "k2", "+", "k3"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"k1", "-", "k2", "+", "k3"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"k1", "+", "k2", "-", "k3"}], ")"}]}], 
       RowBox[{
        SuperscriptBox["k1", "3"], 
        SuperscriptBox["k2", "3"], 
        SuperscriptBox["k3", "3"]}]], 
      RowBox[{"(", 
       RowBox[{"1", "+", "p"}], ")"}]}], "-", 
     RowBox[{"p", " ", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["k1", "4"], 
        SuperscriptBox["k2", "4"], 
        SuperscriptBox["k3", "4"]}]], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["2", "3"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", " ", "k2"}], "+", 
            RowBox[{"k2", " ", "k3"}], "+", 
            RowBox[{"k3", " ", "k1"}]}], ")"}]}], "-", 
         RowBox[{
          FractionBox["1", "3"], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["k1", "2"], "+", 
            SuperscriptBox["k2", "2"], "+", 
            SuperscriptBox["k3", "2"]}], ")"}]}]}], ")"}], "3"]}]}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.861287036001605*^9, 3.8612871188246613`*^9}, {
   3.8665515825534678`*^9, 3.86655162572399*^9}, {3.866568096372713*^9, 
   3.866568097964345*^9}, {3.8711611930289097`*^9, 3.871161222880465*^9}, 
   3.873360647412846*^9, {3.87338724174275*^9, 3.873387244646748*^9}, {
   3.878985319705517*^9, 3.878985322066525*^9}, {3.8789865041191187`*^9, 
   3.878986504228997*^9}, {3.878987388700656*^9, 3.8789873887703543`*^9}, {
   3.878987730312654*^9, 3.87898773646756*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"8ecdd776-4a04-48fd-b1fc-f2155b66b033"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BNG", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"fnl_", ",", "\[Beta]s_", ",", "FNG_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"plin_", ",", "f1_", ",", "T\[Alpha]_"}], "}"}]}], "]"}], "=", 
   RowBox[{"fnl", " ", 
    RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/BNGlist.m\>\"", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.873387099987398*^9, 3.87338714268987*^9}, {
   3.873387301950275*^9, 3.873387331582018*^9}, 3.873387393063075*^9, {
   3.8733875203025103`*^9, 3.873387523101103*^9}, {3.873970909850997*^9, 
   3.873970913159163*^9}, {3.8789853243063*^9, 3.8789853265149813`*^9}, {
   3.8789865057031116`*^9, 3.8789865521128397`*^9}, {3.878987369893444*^9, 
   3.878987386794932*^9}, {3.87898773346451*^9, 3.878987735227292*^9}, {
   3.8789877961082487`*^9, 3.8789878042433167`*^9}, {3.878988071802286*^9, 
   3.8789880769356527`*^9}, 3.893828119988653*^9, 3.89382990546628*^9, {
   3.894995285460451*^9, 3.894995286044746*^9}, 3.8950581249577827`*^9},
 CellLabel->
  "In[186]:=",ExpressionUUID->"36578b07-a9e6-4d62-8435-8e80751596a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BNGFull", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"plin_", ",", "f1_", ",", "T\[Alpha]_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/BNGsimp.m\>\"", "]"}], "/.", 
      RowBox[{"y13", "->", 
       FractionBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["k1", "2"]}], "+", 
         SuperscriptBox["k2", "2"], "-", 
         SuperscriptBox["k3", "2"]}], 
        RowBox[{"2", " ", "k1", " ", "k3"}]]}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}]}], "/.", "paramfix"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878985348637389*^9, 3.878985367609379*^9}, {
   3.8789873561317453`*^9, 3.8789873651711597`*^9}, {3.878987400840809*^9, 
   3.878987426971079*^9}, {3.8789875264755993`*^9, 3.8789875265062313`*^9}, 
   3.8789876387160263`*^9, 3.878987739581718*^9, 3.878988066002037*^9, 
   3.893828119989744*^9, 3.8938299302265472`*^9, 3.893844822058476*^9, 
   3.895058124959374*^9},
 CellLabel->
  "In[187]:=",ExpressionUUID->"70633310-4b28-4269-bcd8-ae88194c95b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivatives Resummed", "Subsection",
 CellChangeTimes->{{3.8552301395006886`*^9, 3.8552301435947404`*^9}, {
   3.8552322560725813`*^9, 3.855232257286789*^9}, {3.856090019871007*^9, 
   3.8560900200669928`*^9}, 3.8583396248449163`*^9, 3.872415672771947*^9, {
   3.872860297782524*^9, 
   3.872860300673518*^9}},ExpressionUUID->"be273922-cf85-48f2-b567-\
ce8e49ed9c91"],

Cell["Tree derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.8723051697520514`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"3984dd4c-7f2f-40b8-ae20-e359e0eb5d8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BTreeDerivs", "[", 
   RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "k3", ",", "y", ",", "y13", ",", "Btreeevpre", ",",
       "Btreeev", ",", "prederiv"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"k2", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"k3", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
     RowBox[{"y", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
     RowBox[{"y13", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "+", 
        SuperscriptBox["k2", "2"], "-", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Btreeevpre", " ", "[", 
       RowBox[{"Plin_", ",", "f_"}], "]"}], " ", "=", " ", 
      RowBox[{"BTree", "[", 
       RowBox[{
       "k1", ",", "k2", ",", "k3", ",", "Plin", ",", "f", ",", "y", ",", 
        "y13"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Btreeev", " ", "[", "ar_", "]"}], " ", ":=", 
      RowBox[{"Btreeevpre", " ", "[", 
       RowBox[{
        RowBox[{"ar", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ar", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Btreeev", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"8", ",", "9"}], "}"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872338475377421*^9, 3.8723384758697653`*^9}, 
   3.872338799473525*^9, {3.8723389521980247`*^9, 3.872339002808071*^9}, 
   3.872339040939315*^9, 3.872339136225584*^9, 3.872339171573242*^9, {
   3.872339342603086*^9, 3.872339380567452*^9}, 3.872394530607967*^9, {
   3.872394723337199*^9, 3.8723947562622643`*^9}, 3.872394840565118*^9, {
   3.873359907596909*^9, 3.873359907776107*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"b622d883-6d9b-45d0-9810-47745c169763"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BTreeDerivsAP", "[", 
   RowBox[{"arr_", ",", "pks_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "k3", ",", "y", ",", "y13", ",", "Btreeevpre", ",",
       "Btreeev", ",", "prederiv", ",", "Fqotab"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"k2", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"k3", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
     RowBox[{"y", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
     RowBox[{"y13", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "+", 
        SuperscriptBox["k2", "2"], "-", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Btreeevpre", " ", "[", 
       RowBox[{"Plin_", ",", "f_", ",", "F_", ",", "qo_"}], "]"}], " ", "=", 
      " ", 
      RowBox[{"BTreeAP", "[", 
       RowBox[{
       "k1", ",", "k2", ",", "k3", ",", "Plin", ",", "f", ",", "y", ",", 
        "y13", ",", "F", ",", "qo"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Btreeev", " ", "[", 
       RowBox[{"ar_", ",", 
        RowBox[{"{", 
         RowBox[{"F_", ",", "qo_", ",", "qpa_"}], "}"}]}], "]"}], " ", ":=", 
      RowBox[{"Btreeevpre", " ", "[", 
       RowBox[{
        RowBox[{"ar", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ar", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "F", ",", "qo"}], "]"}]}], " ", 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Fqotab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"APfix2", "[", "z", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Fqotab", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], "2"], 
           SuperscriptBox[
            RowBox[{"Fqotab", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "4"]}]], 
         RowBox[{"Btreeev", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"8", ",", "9"}], "}"}], "]"}], "]"}], ",", 
           RowBox[{"Fqotab", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.892644209879548*^9, 3.8926442526034403`*^9}, {
  3.892646672133534*^9, 3.8926467542245817`*^9}, {3.892646804361524*^9, 
  3.8926468075860443`*^9}, {3.892665387348158*^9, 3.892665387902267*^9}, {
  3.8942543692031527`*^9, 3.8942543752215567`*^9}, {3.894271990294688*^9, 
  3.8942720403789997`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"e6a243a5-8a37-46f8-be32-6bf25f8d1464"],

Cell["Counter derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.8723051697520514`*^9}, {3.872415684519256*^9, 
  3.8724156852458143`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e6c09c1f-29e5-4d4f-9ed9-1aead7ed35cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BCounterTreeDerivs", "[", 
   RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "k3", ",", "y", ",", "y13", ",", "Bcounterevpre", 
      ",", "Bcounterev", ",", "prederiv"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"k2", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"k3", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
     RowBox[{"y", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
     RowBox[{"y13", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "+", 
        SuperscriptBox["k2", "2"], "-", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bcounterevpre", " ", "[", 
       RowBox[{"Plin_", ",", "f_"}], "]"}], " ", "=", " ", 
      RowBox[{"BCounterTree", "[", 
       RowBox[{
       "k1", ",", "k2", ",", "k3", ",", "Plin", ",", "f", ",", "y", ",", 
        "y13"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bcounterev", " ", "[", "ar_", "]"}], " ", ":=", 
      RowBox[{"Bcounterevpre", " ", "[", 
       RowBox[{
        RowBox[{"ar", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ar", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Bcounterev", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"8", ",", "9"}], "}"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872338475377421*^9, 3.8723384758697653`*^9}, 
   3.872338799473525*^9, {3.8723389521980247`*^9, 3.872339002808071*^9}, 
   3.872339040939315*^9, 3.872339136225584*^9, 3.872339171573242*^9, {
   3.872339342603086*^9, 3.872339380567452*^9}, 3.872394530607967*^9, {
   3.8733599102434607`*^9, 3.8733599104161987`*^9}, {3.885481429636243*^9, 
   3.8854814365066423`*^9}, {3.885481534653637*^9, 3.885481535926865*^9}, {
   3.8854815914944153`*^9, 3.88548159156168*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"8b2a2d83-7ec1-4a1f-9bfd-aee6ac296186"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BCounterTreeDerivsAP", "[", 
   RowBox[{"arr_", ",", "pks_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "k3", ",", "y", ",", "y13", ",", "Fqotab", ",", 
      "Bcounterevpre", ",", "Bcounterev", ",", "prederiv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"k2", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"k3", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
     RowBox[{"y", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
     RowBox[{"y13", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "+", 
        SuperscriptBox["k2", "2"], "-", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fqotab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"APfix2", "[", "z", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bcounterevpre", " ", "[", 
       RowBox[{"Plin_", ",", "f1_", ",", "F_", ",", "qo_", ",", "qpa_"}], 
       "]"}], " ", "=", " ", 
      RowBox[{"BCounterTreeAP", "[", 
       RowBox[{
       "k1", ",", "k2", ",", "k3", ",", "Plin", ",", "f1", ",", "y", ",", 
        "y13", ",", "F", ",", "qo"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Fqotab", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], "2"], 
           SuperscriptBox[
            RowBox[{"Fqotab", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "4"]}]], 
         RowBox[{"Bcounterevpre", "[", 
          RowBox[{
           RowBox[{"pks", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "8"}], "]"}], "]"}], ",", 
           RowBox[{"pks", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "9"}], "]"}], "]"}], ",", 
           RowBox[{"Fqotab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Fqotab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"Fqotab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.892648550160631*^9, 3.8926486142887793`*^9}, {
   3.8926487019501543`*^9, 3.892648718069265*^9}, 3.892649035000478*^9, {
   3.892649110851892*^9, 3.892649112781891*^9}, {3.892649221296999*^9, 
   3.89264926177497*^9}, {3.892649319411474*^9, 3.8926493197099857`*^9}, {
   3.8926654019780283`*^9, 3.892665402524899*^9}, {3.894254401214539*^9, 
   3.8942544088645973`*^9}, 3.8942720920321283`*^9},
 CellLabel->
  "In[191]:=",ExpressionUUID->"fcf42c47-435b-44fb-8da2-fcaf6ea79522"],

Cell["Counter derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.8723051697520514`*^9}, {3.872415684519256*^9, 
  3.8724156852458143`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"49713e2d-5320-4ff4-a829-e95b2c940041"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BCounterDerivs", "[", 
   RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "k3", ",", "y", ",", "y13", ",", "Bcounterevpre", 
      ",", "Bcounterev", ",", "prederiv"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"k2", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"k3", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
     RowBox[{"y", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
     RowBox[{"y13", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "+", 
        SuperscriptBox["k2", "2"], "-", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bcounterevpre", " ", "[", 
       RowBox[{"Plin_", ",", "f_"}], "]"}], " ", "=", " ", 
      RowBox[{"BCounter", "[", 
       RowBox[{
       "k1", ",", "k2", ",", "k3", ",", "Plin", ",", "f", ",", "y", ",", 
        "y13"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bcounterev", " ", "[", "ar_", "]"}], " ", ":=", 
      RowBox[{"Bcounterevpre", " ", "[", 
       RowBox[{
        RowBox[{"ar", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ar", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Bcounterev", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"7", ",", "9"}], "}"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872338475377421*^9, 3.8723384758697653`*^9}, 
   3.872338799473525*^9, {3.8723389521980247`*^9, 3.872339002808071*^9}, 
   3.872339040939315*^9, 3.872339136225584*^9, 3.872339171573242*^9, {
   3.872339342603086*^9, 3.872339380567452*^9}, 3.872394530607967*^9, {
   3.8733599102434607`*^9, 3.8733599104161987`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"9d2f7f1b-158d-4188-b2d1-682e240262c1"],

Cell["Loop derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.87241569018826*^9, 3.872415691905408*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"abb50693-07d9-4fac-9bc0-b1a210de49e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BLoopDerivs", "[", 
   RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "k3", ",", "B222", ",", "B3211", ",", "B3212", ",",
       "B411", ",", "B222co", ",", "B3211co", ",", "B3212co", ",", "B411co", 
      ",", "Bloopeval", ",", "y", ",", "y13", ",", "PTab3211", ",", 
      "PTab3212", ",", "PTab411", ",", "prederiv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"k2", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"k3", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
     RowBox[{"y", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
     RowBox[{"y13", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "+", 
        SuperscriptBox["k2", "2"], "-", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B222", "=", 
      RowBox[{"B222n", "[", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}], ";", 
     RowBox[{"B3211", "=", 
      RowBox[{"B3211n", "[", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B3212", "=", 
      RowBox[{"B3212n", "[", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}], ";", 
     RowBox[{"B411", "=", 
      RowBox[{"B411n", "[", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"B222co", "[", "f_", "]"}], "=", 
      RowBox[{"B222coefs", "[", 
       RowBox[{"f", ",", "y", ",", "y13"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"B3211co", "[", "f_", "]"}], "=", 
      RowBox[{"B3211coefs", "[", 
       RowBox[{"f", ",", "y", ",", "y13"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"B3212co", "[", "f_", "]"}], "=", 
      RowBox[{"B3212coefs", "[", 
       RowBox[{"f", ",", "y", ",", "y13"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"B411co", "[", "f_", "]"}], "=", 
      RowBox[{"B411coefs", "[", 
       RowBox[{"f", ",", "y", ",", "y13"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PTab3211", "[", "P11_", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P11", "[", "k1", "]"}], ",", 
        RowBox[{"P11", "[", "k1", "]"}], ",", 
        RowBox[{"P11", "[", "k2", "]"}], ",", 
        RowBox[{"P11", "[", "k2", "]"}], ",", 
        RowBox[{"P11", "[", "k3", "]"}], ",", 
        RowBox[{"P11", "[", "k3", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PTab3212", "[", "P11_", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"P11", "[", "k1", "]"}], " ", 
         RowBox[{"P11", "[", "k2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"P11", "[", "k1", "]"}], " ", 
         RowBox[{"P11", "[", "k3", "]"}]}], ",", 
        RowBox[{
         RowBox[{"P11", "[", "k1", "]"}], " ", 
         RowBox[{"P11", "[", "k2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"P11", "[", "k2", "]"}], " ", 
         RowBox[{"P11", "[", "k3", "]"}]}], ",", 
        RowBox[{
         RowBox[{"P11", "[", "k1", "]"}], " ", 
         RowBox[{"P11", "[", "k3", "]"}]}], ",", 
        RowBox[{
         RowBox[{"P11", "[", "k2", "]"}], " ", 
         RowBox[{"P11", "[", "k3", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PTab411", "[", "P11_", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"P11", "[", "k1", "]"}], " ", 
         RowBox[{"P11", "[", "k2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"P11", "[", "k2", "]"}], " ", 
         RowBox[{"P11", "[", "k3", "]"}]}], ",", 
        RowBox[{
         RowBox[{"P11", "[", "k1", "]"}], " ", 
         RowBox[{"P11", "[", "k3", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bloopeval", "[", "ar_", "]"}], ":=", "  ", 
      RowBox[{
       RowBox[{"B222ev", "[", 
        RowBox[{"B222", ",", 
         RowBox[{"ar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"B222co", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], "+", "     ", 
       RowBox[{"B3211ev", "[", 
        RowBox[{"B3211", ",", 
         RowBox[{"ar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"B3211co", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
         RowBox[{"PTab3211", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "+", "    ", 
       RowBox[{"B3212ev", "[", 
        RowBox[{"B3212", ",", 
         RowBox[{"ar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"B3212co", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
         RowBox[{"PTab3212", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "+", "   ", 
       RowBox[{"B411ev", "[", 
        RowBox[{"B411", ",", 
         RowBox[{"ar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"B411co", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
         RowBox[{"PTab411", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Bloopeval", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "7", ",", "9"}], "}"}], "]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8552132605934753`*^9, 3.8552132798433037`*^9}, {
   3.8552133168235965`*^9, 3.8552134519073095`*^9}, {3.855214310132822*^9, 
   3.855214329507357*^9}, {3.8552145356976748`*^9, 3.8552145359857054`*^9}, {
   3.8552174770254335`*^9, 3.8552174900170984`*^9}, {3.8552179845936913`*^9, 
   3.8552179927568665`*^9}, {3.855218049880351*^9, 3.8552180584186835`*^9}, {
   3.855218374242013*^9, 3.8552183863836155`*^9}, {3.855218581225415*^9, 
   3.8552186436184196`*^9}, {3.855218860733153*^9, 3.855218907905439*^9}, {
   3.8552190114921703`*^9, 3.855219025025141*^9}, {3.8552191026630116`*^9, 
   3.8552191044038963`*^9}, {3.855220038959756*^9, 3.8552201831079626`*^9}, {
   3.855220268445395*^9, 3.855220276197358*^9}, {3.855220353364435*^9, 
   3.8552203564952407`*^9}, 3.8552213394337807`*^9, {3.855222020830437*^9, 
   3.855222077639424*^9}, {3.8552221267733335`*^9, 3.855222186950463*^9}, 
   3.8552222300647345`*^9, {3.8552222791890097`*^9, 3.855222343814923*^9}, {
   3.855222861723735*^9, 3.855222888194085*^9}, {3.8552229430859127`*^9, 
   3.855222950341934*^9}, {3.8552229967658815`*^9, 3.8552230061592307`*^9}, {
   3.855223077125824*^9, 3.8552230927018023`*^9}, 3.8552232304530745`*^9, {
   3.8552233644007025`*^9, 3.8552233701414604`*^9}, {3.8552234328456154`*^9, 
   3.8552234593622584`*^9}, {3.8552239024595747`*^9, 3.855224276446269*^9}, {
   3.8552243329876633`*^9, 3.855224362717295*^9}, {3.8552244508150525`*^9, 
   3.8552244512937717`*^9}, {3.8552255851006145`*^9, 3.855225672529089*^9}, {
   3.8552258523822546`*^9, 3.8552259693744965`*^9}, {3.8552272270698085`*^9, 
   3.8552272861744967`*^9}, {3.8552317621657467`*^9, 3.855231790813834*^9}, 
   3.8552319007882366`*^9, {3.85523233787451*^9, 3.8552323657626767`*^9}, {
   3.855232879120243*^9, 3.855232885665193*^9}, {3.8552416671146774`*^9, 
   3.855241683416233*^9}, {3.856001481815685*^9, 3.8560015587790375`*^9}, {
   3.8560018092919507`*^9, 3.856001810122726*^9}, {3.8560911858586807`*^9, 
   3.856091190386009*^9}, {3.8560925640493307`*^9, 3.856092580798242*^9}, {
   3.8560926150596046`*^9, 3.856092617493783*^9}, 3.856092682422635*^9, {
   3.8560928393152943`*^9, 3.856092907440245*^9}, {3.8560949884782977`*^9, 
   3.856095026452264*^9}, {3.856095116595584*^9, 3.856095129745544*^9}, {
   3.8560953050759416`*^9, 3.8560953054493847`*^9}, {3.8560954039018345`*^9, 
   3.856095426939816*^9}, 3.8560954718436995`*^9, {3.856095573603755*^9, 
   3.856095683173815*^9}, {3.8560957337354827`*^9, 3.8560957618144503`*^9}, {
   3.8560958116120224`*^9, 3.8560958291066275`*^9}, {3.8560961396470156`*^9, 
   3.8560961402033467`*^9}, {3.856096279425429*^9, 3.8560962817975345`*^9}, {
   3.856096411908641*^9, 3.8560964120929337`*^9}, {3.8560970153045826`*^9, 
   3.8560970571397276`*^9}, {3.856097178060191*^9, 3.8560971844527464`*^9}, {
   3.856097629425712*^9, 3.8560976555142183`*^9}, {3.856097699862956*^9, 
   3.8560977006561527`*^9}, 3.8560979420462165`*^9, 3.8583221399702253`*^9, {
   3.85832231106285*^9, 3.8583223355084534`*^9}, {3.858339887622612*^9, 
   3.8583400512865343`*^9}, {3.8583402445748534`*^9, 3.858340299843937*^9}, 
   3.858340375526843*^9, {3.858340515952941*^9, 3.8583406097988853`*^9}, 
   3.8583406812917166`*^9, {3.8583412433621283`*^9, 3.8583412451320343`*^9}, {
   3.858341688263835*^9, 3.858341695556431*^9}, {3.858341770190067*^9, 
   3.8583417913265553`*^9}, {3.8583421907559304`*^9, 3.858342199772802*^9}, {
   3.858342361505916*^9, 3.8583424091742673`*^9}, {3.8583426247693005`*^9, 
   3.858342681095413*^9}, {3.85834282806733*^9, 3.858342890692011*^9}, {
   3.8583992112529054`*^9, 3.858399237254298*^9}, {3.8584057453200507`*^9, 
   3.8584057671362743`*^9}, {3.8584058468948145`*^9, 3.8584058530822535`*^9}, 
   3.8584064026274195`*^9, {3.858406654015836*^9, 3.858406665692851*^9}, 
   3.8584068489049354`*^9, {3.858408761162578*^9, 3.858408794828392*^9}, {
   3.858408902186231*^9, 3.8584089049223137`*^9}, {3.860784658171872*^9, 
   3.860784663941991*^9}, {3.8607850453044653`*^9, 3.860785080798154*^9}, {
   3.8607851189728756`*^9, 3.8607851840239534`*^9}, {3.8607852203366337`*^9, 
   3.86078526244135*^9}, {3.8608215493972163`*^9, 3.8608215609302273`*^9}, {
   3.8608216464675245`*^9, 3.860821650213027*^9}, {3.8608217710389547`*^9, 
   3.8608218092207756`*^9}, {3.8608222329617195`*^9, 3.860822264920909*^9}, {
   3.8608223083230686`*^9, 3.860822368454985*^9}, {3.860822428133074*^9, 
   3.860822440421172*^9}, {3.860822518392109*^9, 3.8608225625189123`*^9}, {
   3.8608229871902933`*^9, 3.860822990948965*^9}, {3.8608233494950047`*^9, 
   3.860823358323019*^9}, {3.860823498773631*^9, 3.860823499555645*^9}, {
   3.8608236488522186`*^9, 3.8608236851730595`*^9}, {3.860823719607087*^9, 
   3.8608237216242085`*^9}, {3.860823801206216*^9, 3.8608238308077765`*^9}, {
   3.860823926372691*^9, 3.860823982262246*^9}, {3.8608244933518314`*^9, 
   3.860824494133003*^9}, {3.8608248193357706`*^9, 3.8608248226778393`*^9}, {
   3.860825339019058*^9, 3.8608253438313875`*^9}, {3.860834291188476*^9, 
   3.8608342977718296`*^9}, {3.860834901853506*^9, 3.860834907614649*^9}, {
   3.861450174864681*^9, 3.8614502409150095`*^9}, {3.8616071385840025`*^9, 
   3.861607143760998*^9}, {3.861607205551732*^9, 3.8616072138455653`*^9}, {
   3.8616072995191374`*^9, 3.8616073065125356`*^9}, {3.8616084786973567`*^9, 
   3.8616084851065035`*^9}, {3.8628254919214582`*^9, 3.862825513405034*^9}, {
   3.862825798821686*^9, 3.862825803860089*^9}, {3.8635453199604397`*^9, 
   3.8635453369186974`*^9}, {3.863545495931238*^9, 3.8635455226637774`*^9}, {
   3.863545562156636*^9, 3.863545604028966*^9}, 3.863548426228208*^9, {
   3.863548604598041*^9, 3.863548658432684*^9}, {3.863554137377467*^9, 
   3.8635541413689337`*^9}, {3.87077881314783*^9, 3.8707788667963743`*^9}, {
   3.870779022094248*^9, 3.870779068084824*^9}, {3.870785108970849*^9, 
   3.870785115605482*^9}, {3.8708450231222153`*^9, 3.8708450286867113`*^9}, {
   3.870845431968979*^9, 3.8708454368596087`*^9}, {3.870847580310461*^9, 
   3.870847583030004*^9}, {3.8708508849063396`*^9, 3.870850891501783*^9}, {
   3.872413663667158*^9, 3.872413664283457*^9}, {3.87241376147017*^9, 
   3.8724138172706957`*^9}, {3.872413861104085*^9, 3.872413967995356*^9}, 
   3.872414732328302*^9, {3.872414776452856*^9, 3.872414778030229*^9}, {
   3.872414823261956*^9, 3.872414835488287*^9}, {3.872415162487221*^9, 
   3.8724151678505917`*^9}, {3.872415302405335*^9, 3.8724153092422047`*^9}, {
   3.8724153544733257`*^9, 3.8724153796010027`*^9}, 3.872415771671792*^9, {
   3.873359914440587*^9, 3.873359914611096*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"2a9c5658-5b6c-4d01-a8bf-614b7f748fc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"smallk", "=", "0.001`"}], ";"}]], "Input",
 CellChangeTimes->{{3.886508421399274*^9, 3.886508422742795*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"991bf284-d7a3-43c6-8e1e-1da67e8b0835"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B222sub", "=", 
   RowBox[{"B222n", "@@", 
    RowBox[{"{", 
     RowBox[{"smallk", ",", "smallk", ",", "smallk"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B3211sub", "=", 
   RowBox[{"B3211n", "@@", 
    RowBox[{"{", 
     RowBox[{"smallk", ",", "smallk", ",", "smallk"}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.886507841838695*^9, 3.886507859054473*^9}, {
  3.8865083841955423`*^9, 3.886508406526011*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"79821132-7a28-46d9-a39e-3f09563aa485"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BLoopsub", "[", "pks_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "B222", ",", "B3211", ",", "B3212", ",", "B411", ",", "B222co", ",", 
      "B3211co", ",", "B3212co", ",", "B411co", ",", "Bloopeval", ",", "y", 
      ",", "y13", ",", "PTab3211", ",", "PTab3212", ",", "PTab411", ",", 
      "prederiv", ",", "PTab3211low"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"B222co", "[", "f_", "]"}], "=", 
      RowBox[{"B222coefs", "[", 
       RowBox[{"f", ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}], ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"B3211co", "[", "f_", "]"}], "=", 
      RowBox[{"B3211coefs", "[", 
       RowBox[{"f", ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}], ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PTab3211", "[", "P11_", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P11", "[", "0.001`", "]"}], ",", 
        RowBox[{"P11", "[", "0.001`", "]"}], ",", 
        RowBox[{"P11", "[", "0.001`", "]"}], ",", 
        RowBox[{"P11", "[", "0.001`", "]"}], ",", 
        RowBox[{"P11", "[", "0.001`", "]"}], ",", 
        RowBox[{"P11", "[", "0.001`", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bloopeval", "[", "ar_", "]"}], ":=", "  ", 
      RowBox[{
       RowBox[{"B222ev", "[", 
        RowBox[{"B222sub", ",", 
         RowBox[{"ar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"B222co", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], "+", "     ", 
       RowBox[{"B3211ev", "[", 
        RowBox[{"B3211sub", ",", 
         RowBox[{"ar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"B3211co", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
         RowBox[{"PTab3211", "[", 
          RowBox[{"ar", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Bloopeval", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "7", ",", "9"}], "}"}], "]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.886507804090168*^9, 3.886507818564855*^9}, {
  3.886507861779291*^9, 3.886507923177348*^9}, {3.886507965273603*^9, 
  3.8865079685232267`*^9}, {3.886508266592676*^9, 3.886508272889988*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"590e8144-7138-4a04-8a27-2e5b6a368784"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "NL"], TraditionalForm]],ExpressionUUID->
  "61abe6f8-2f03-4848-9531-4e3d529c733e"],
 " derivatives"
}], "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.87241569018826*^9, 3.872415691905408*^9}, {3.8733876451953363`*^9, 
  3.873387646412273*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"dac10884-28f4-4fb2-8d09-c5a57c55c012"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BNGDerivs", "[", 
   RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"prederiv", ",", "BNGev"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BNGev", "[", 
       RowBox[{"{", 
        RowBox[{"plin_", ",", "f1_", ",", "T\[Alpha]_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"BNGFull", "[", 
        RowBox[{"arr", ",", 
         RowBox[{"{", 
          RowBox[{"plin", ",", "f1", ",", "T\[Alpha]"}], "}"}]}], "]"}], "/.",
        "paramfix"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BNGev", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"3", ",", "9", ",", "10"}], "}"}], "]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8733875607673473`*^9, 3.873387608282858*^9}, {
  3.873387651883567*^9, 3.873387654250682*^9}, {3.873387979461308*^9, 
  3.8733880039972153`*^9}, {3.873388034153985*^9, 3.873388060987617*^9}, {
  3.873388223386528*^9, 3.87338822680098*^9}, {3.873389985993225*^9, 
  3.873389986076885*^9}, {3.8733901670594397`*^9, 3.873390167403314*^9}, {
  3.878984840341959*^9, 3.878984857163517*^9}, {3.878985292845261*^9, 
  3.878985293198135*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"94a05fc9-0e94-49db-8e61-5afa6f698758"],

Cell["Full B1loop derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872415758517033*^9, 
  3.872415758834323*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"810f947c-f552-45ea-a938-88f91048db49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"B1Loopderivs", "[", 
    RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BLoopDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}], "+", 
    RowBox[{"BTreeDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}], "+", 
    RowBox[{"BCounterDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}], "+", 
    RowBox[{"BNGDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872304779495996*^9, 3.8723048146033173`*^9}, 
   3.87230485825953*^9, {3.872415760270871*^9, 3.872415801543703*^9}, {
   3.87338768380227*^9, 3.873387687774431*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"165fa182-9d60-4e48-8a36-f7f5fb3a8f6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"B1LoopderivsAPcorr", "[", 
    RowBox[{"arr_", ",", "pks_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BTreeDerivsAP", "[", 
     RowBox[{"arr", ",", "pks", ",", "z"}], "]"}], "-", 
    RowBox[{"BTreeDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}], "+", 
    RowBox[{"BCounterTreeDerivsAP", "[", 
     RowBox[{"arr", ",", "pks", ",", "z"}], "]"}], "-", 
    RowBox[{"BCounterTreeDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8926468615643997`*^9, 3.8926468790573187`*^9}, {
  3.8926494707637672`*^9, 3.892649484850348*^9}, {3.892665779630628*^9, 
  3.8926657917886257`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"39077c17-6683-4dd6-a52d-30a7c4559f31"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BTreederivs", "[", 
    RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BTreeDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}], "+", 
    RowBox[{"BCounterTreeDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}], "+", 
    RowBox[{"BNGDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878892003800787*^9, 3.8788920381662188`*^9}, {
  3.88547972818819*^9, 3.885479729114563*^9}, {3.88548161074087*^9, 
  3.885481618989666*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"86537da6-3e93-459d-9520-d1a506950393"]
}, Closed]],

Cell[CellGroupData[{

Cell["Covariance", "Subsection",
 CellChangeTimes->{{3.872305455191352*^9, 
  3.872305460498106*^9}},ExpressionUUID->"99f28e4a-e57c-4773-bbca-\
cebf32e88197"],

Cell["Analytical covariance", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.872337573185067*^9}, 3.872427297107655*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c3bb5283-1117-490b-ae74-8d70551b250e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bcovinvlist", " ", "=", 
   RowBox[{"Import", "[", "\"\<LoopKerInt/tabs/Covlist.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8724195521302547`*^9, 3.872419569437367*^9}, {
   3.8724217278729057`*^9, 3.872421737022946*^9}, {3.872426044082386*^9, 
   3.872426061229525*^9}, {3.8724268264189053`*^9, 3.872426826666499*^9}, 
   3.8725591582165947`*^9, {3.873167537993041*^9, 3.873167538293222*^9}, {
   3.873970927002221*^9, 3.873970927576181*^9}, {3.874137080571991*^9, 
   3.874137080680643*^9}, {3.874138231991062*^9, 3.8741382321193542`*^9}, 
   3.8938281199924507`*^9, 3.893829930227306*^9, 3.893844822060278*^9, 
   3.895058124960384*^9, 3.895474350299486*^9, 3.895474851062052*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"7412adde-b56f-43e7-a583-32bc21223add"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sb", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sym", "}"}], ",", 
    RowBox[{
     RowBox[{"sym", "=", "0"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k1", "===", "k2"}], "||", 
        RowBox[{"k2", "===", "k3"}]}], ",", 
       RowBox[{"sym", "=", "1"}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k1", "===", "k2"}], "&&", 
        RowBox[{"k2", "===", "k3"}]}], ",", 
       RowBox[{"sym", "=", "5"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"1", "+", "sym"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pisym", "[", 
    RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], " ", ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k1", "+", "k2", "-", "k3"}], "<", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", 
     FractionBox["1", "2"], ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.863624170552115*^9, 3.8636241722504387`*^9}, {
  3.8738722124778633`*^9, 3.873872223556343*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"f26fc93a-5cf3-4fbc-959d-8888d2e26f7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getcovsinv", "[", 
   RowBox[{
   "Triangs_", ",", "pks_", ",", "biasfix_", ",", "Survey_", ",", "fs_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "covinvfast", ",", "covinv", ",", "sub", ",", "pos", ",", "covinvfast2", 
      ",", "trisub"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"covinvlist2", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Bcovinvlist", "/.", "Survey"}], "/.", 
        RowBox[{"f1", "->", "fs"}]}], "/.", "biasfix"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"covinvfast", "[", 
       RowBox[{"y_", ",", "y13_", ",", "pk1_", ",", "pk2_", ",", "pk3_"}], 
       "]"}], "=", "covinvlist2"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"covinvfast2", "[", 
       RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"8", " ", 
             SuperscriptBox["\[Pi]", "4"]}], 
            RowBox[{
             SuperscriptBox["dk", "3"], " ", "Vs"}]], " ", 
           FractionBox[
            RowBox[{" ", 
             RowBox[{"sb", "[", 
              RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}], 
            RowBox[{" ", 
             RowBox[{"k1", " ", "k2", " ", "k3", " ", 
              RowBox[{"pisym", "[", 
               RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}]}]]}], "/.", 
          "Survey"}], ")"}], 
        RowBox[{"-", "1"}]], 
       RowBox[{"covinvfast", "[", 
        RowBox[{
         RowBox[{"ys", "[", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}], ",", 
         RowBox[{"y13s", "[", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}], ",", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], "[", "k1", "]"}], ",", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], "[", "k2", "]"}], ",", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], "[", "k3", "]"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"covinv", " ", "=", " ", 
      RowBox[{"EV2", "[", 
       RowBox[{"covinvfast2", ",", "Triangs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "covinvlist2", "]"}], ";", "\[IndentingNewLine]", 
     "covinv"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.877298964956806*^9, 3.8772989724419727`*^9}, {
   3.8783271186017857`*^9, 3.878327119912724*^9}, {3.8785016779445047`*^9, 
   3.878501699845622*^9}, 3.885479837994272*^9, 3.8952963716822577`*^9, 
   3.895474322354005*^9, {3.8954743562053347`*^9, 3.895474369163373*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"5a5831d3-b960-4146-9dba-1181de52411a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CovinvBmulti", "[", 
   RowBox[{
   "Triangs_", ",", "pks_", ",", "biasfix_", ",", "Survey_", ",", "fs_"}], 
   "]"}], ":=", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Getcovsinv", "[", 
       RowBox[{"Triangs", ",", "pks", ",", 
        RowBox[{"biasfix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Survey", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"fs", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "biasfix", "]"}]}], "}"}]}], "]"}], ",", "i"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.877294290654689*^9, 3.877294373062851*^9}, {
   3.877298977370551*^9, 3.877298984712845*^9}, 3.8783270392453957`*^9, {
   3.878327072368312*^9, 3.878327076308161*^9}, {3.878327111880847*^9, 
   3.878327131705558*^9}, {3.878390235402116*^9, 3.878390237084667*^9}, 
   3.8854798397844*^9, 3.8954743299295607`*^9, {3.89547437081889*^9, 
   3.895474376922826*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"8fc212e2-7337-453f-9aee-744cb115b18d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "Triangs_", ",", "pks_", ",", "spec_", ",", "stoch_", ",", "dkk_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CovinvBmulti", "[", 
     RowBox[{"Triangs", ",", "pks", ",", 
      RowBox[{"shiftedbfix", "[", 
       RowBox[{"spec", ",", "stoch"}], "]"}], ",", 
      RowBox[{"fixsurv", "[", 
       RowBox[{"spec", ",", "dkk"}], "]"}], ",", 
      RowBox[{"spec", "[", 
       RowBox[{"[", "6", "]"}], "]"}]}], "]"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878389559217341*^9, 3.878389566937626*^9}, {
  3.87838959711281*^9, 3.878389608310685*^9}, {3.885235206125115*^9, 
  3.885235206565065*^9}, {3.885479877113717*^9, 3.885479894467989*^9}, {
  3.895474391762781*^9, 3.895474407692423*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"a61dffc7-bf11-4d0d-b140-23e175a0e46f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminaries for redshift integrations", "Subsection",
 CellChangeTimes->{{3.8724273329039*^9, 
  3.872427340746114*^9}},ExpressionUUID->"4fe3de66-21b3-4c5a-be9f-\
707276117855"],

Cell[TextData[{
 "List definitions for loop, tree and covariance ",
 Cell[BoxData[
  RowBox[{"(*", 
   RowBox[{"u", " ", "=", " ", 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["\[Mu]1", "2"]}]], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "*)"}]],ExpressionUUID->
  "f584722b-533c-4abd-863d-3bb84c46b015"]
}], "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337565248485*^9}, {3.872427543176365*^9, 3.872427561428813*^9}, {
  3.873331358937352*^9, 3.873331358937428*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2babe7ef-2dd0-47f4-995f-410a2875583c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Blooplist", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SuperscriptBox["u", "2"], ",", 
     SuperscriptBox["u", "4"], ",", 
     SuperscriptBox["u", "6"], ",", 
     SuperscriptBox["u", "8"], ",", 
     SuperscriptBox["u", "10"], ",", 
     SuperscriptBox["u", "12"], ",", 
     RowBox[{"u", " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", "\[Mu]1"}], ",", 
     SuperscriptBox["\[Mu]1", "2"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     SuperscriptBox["\[Mu]1", "4"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     SuperscriptBox["\[Mu]1", "6"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     SuperscriptBox["\[Mu]1", "8"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     SuperscriptBox["\[Mu]1", "10"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     SuperscriptBox["\[Mu]1", "12"]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[208]:=",ExpressionUUID->"4df8506e-58f6-4746-bc48-1f271c86a2ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bcoefstree", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SuperscriptBox["u", "2"], ",", 
     SuperscriptBox["u", "4"], ",", 
     RowBox[{"u", " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", "\[Mu]1"}], ",", 
     SuperscriptBox["\[Mu]1", "2"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     SuperscriptBox["\[Mu]1", "4"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     SuperscriptBox["\[Mu]1", "6"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     SuperscriptBox["\[Mu]1", "8"]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[209]:=",ExpressionUUID->"fbc44887-2a75-4662-af80-df82392ccb8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"covcoefs", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SuperscriptBox["u", "2"], ",", 
     SuperscriptBox["u", "4"], ",", 
     SuperscriptBox["u", "6"], ",", 
     SuperscriptBox["u", "8"], ",", 
     SuperscriptBox["u", "10"], ",", 
     SuperscriptBox["u", "12"], ",", 
     SuperscriptBox["u", "14"], ",", 
     SuperscriptBox["u", "16"], ",", 
     SuperscriptBox["u", "18"], ",", 
     SuperscriptBox["u", "20"], ",", 
     SuperscriptBox["u", "22"], ",", 
     SuperscriptBox["u", "24"], ",", 
     RowBox[{"u", " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", "\[Mu]1"}], ",", 
     RowBox[{
      SuperscriptBox["u", "23"], " ", "\[Mu]1"}], ",", 
     SuperscriptBox["\[Mu]1", "2"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "22"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "24"], " ", 
      SuperscriptBox["\[Mu]1", "2"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "23"], " ", 
      SuperscriptBox["\[Mu]1", "3"]}], ",", 
     SuperscriptBox["\[Mu]1", "4"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "22"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "24"], " ", 
      SuperscriptBox["\[Mu]1", "4"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "23"], " ", 
      SuperscriptBox["\[Mu]1", "5"]}], ",", 
     SuperscriptBox["\[Mu]1", "6"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "22"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "24"], " ", 
      SuperscriptBox["\[Mu]1", "6"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "23"], " ", 
      SuperscriptBox["\[Mu]1", "7"]}], ",", 
     SuperscriptBox["\[Mu]1", "8"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "22"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "24"], " ", 
      SuperscriptBox["\[Mu]1", "8"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "23"], " ", 
      SuperscriptBox["\[Mu]1", "9"]}], ",", 
     SuperscriptBox["\[Mu]1", "10"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "22"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "24"], " ", 
      SuperscriptBox["\[Mu]1", "10"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "23"], " ", 
      SuperscriptBox["\[Mu]1", "11"]}], ",", 
     SuperscriptBox["\[Mu]1", "12"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "22"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "24"], " ", 
      SuperscriptBox["\[Mu]1", "12"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "23"], " ", 
      SuperscriptBox["\[Mu]1", "13"]}], ",", 
     SuperscriptBox["\[Mu]1", "14"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "22"], " ", 
      SuperscriptBox["\[Mu]1", "14"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "21"], " ", 
      SuperscriptBox["\[Mu]1", "15"]}], ",", 
     SuperscriptBox["\[Mu]1", "16"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "20"], " ", 
      SuperscriptBox["\[Mu]1", "16"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "19"], " ", 
      SuperscriptBox["\[Mu]1", "17"]}], ",", 
     SuperscriptBox["\[Mu]1", "18"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "18"], " ", 
      SuperscriptBox["\[Mu]1", "18"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "17"], " ", 
      SuperscriptBox["\[Mu]1", "19"]}], ",", 
     SuperscriptBox["\[Mu]1", "20"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "16"], " ", 
      SuperscriptBox["\[Mu]1", "20"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "15"], " ", 
      SuperscriptBox["\[Mu]1", "21"]}], ",", 
     SuperscriptBox["\[Mu]1", "22"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "22"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "22"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "22"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "22"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "22"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "22"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "14"], " ", 
      SuperscriptBox["\[Mu]1", "22"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "23"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "23"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "23"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "23"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "23"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "23"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "13"], " ", 
      SuperscriptBox["\[Mu]1", "23"]}], ",", 
     SuperscriptBox["\[Mu]1", "24"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "24"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "24"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "24"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "24"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "24"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "12"], " ", 
      SuperscriptBox["\[Mu]1", "24"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "25"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "25"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "25"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "25"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "25"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "11"], " ", 
      SuperscriptBox["\[Mu]1", "25"]}], ",", 
     SuperscriptBox["\[Mu]1", "26"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "26"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "26"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "26"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "26"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "10"], " ", 
      SuperscriptBox["\[Mu]1", "26"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "27"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "27"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "27"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "27"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "9"], " ", 
      SuperscriptBox["\[Mu]1", "27"]}], ",", 
     SuperscriptBox["\[Mu]1", "28"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "28"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "28"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "28"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "8"], " ", 
      SuperscriptBox["\[Mu]1", "28"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "29"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "29"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "29"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "7"], " ", 
      SuperscriptBox["\[Mu]1", "29"]}], ",", 
     SuperscriptBox["\[Mu]1", "30"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "30"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "30"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "6"], " ", 
      SuperscriptBox["\[Mu]1", "30"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "31"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "31"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "5"], " ", 
      SuperscriptBox["\[Mu]1", "31"]}], ",", 
     SuperscriptBox["\[Mu]1", "32"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "32"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "4"], " ", 
      SuperscriptBox["\[Mu]1", "32"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "33"]}], ",", 
     RowBox[{
      SuperscriptBox["u", "3"], " ", 
      SuperscriptBox["\[Mu]1", "33"]}], ",", 
     SuperscriptBox["\[Mu]1", "34"], ",", 
     RowBox[{
      SuperscriptBox["u", "2"], " ", 
      SuperscriptBox["\[Mu]1", "34"]}], ",", 
     RowBox[{"u", " ", 
      SuperscriptBox["\[Mu]1", "35"]}], ",", 
     SuperscriptBox["\[Mu]1", "36"]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.862039955956108*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"55a41371-4021-46f1-9644-af34136f58d0"],

Cell["Angular integrations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337565248485*^9}, {3.872427506829399*^9, 3.8724275098265467`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ec6cb975-2ed7-4bae-9021-eb27018da57d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"full\[Mu]urep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["u", "m_."], 
      SuperscriptBox["\[Mu]1", "n_."]}], "->", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "m"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "n"]}], ")"}], " ", 
       RowBox[{"Gamma", "[", 
        FractionBox[
         RowBox[{"1", "+", "m"}], "2"], "]"}], " ", 
       RowBox[{"Gamma", "[", 
        FractionBox[
         RowBox[{"1", "+", "n"}], "2"], "]"}]}], 
      RowBox[{"8", " ", 
       SqrtBox["\[Pi]"], " ", 
       RowBox[{"Gamma", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "m", "+", "n"}], ")"}]}], "]"}]}]]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"single\[Mu]urep", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["u", "m_."], "->", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "m"]}], ")"}], " ", 
        RowBox[{"Gamma", "[", 
         FractionBox[
          RowBox[{"1", "+", "m"}], "2"], "]"}]}], 
       RowBox[{"4", " ", 
        RowBox[{"Gamma", "[", 
         FractionBox[
          RowBox[{"3", "+", "m"}], "2"], "]"}]}]]}], ",", 
     RowBox[{
      SuperscriptBox["\[Mu]1", "n_."], "->", 
      FractionBox[
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "n"]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "n"}], ")"}]}]]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.863532471933217*^9, 3.863532514690872*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"d6479bbd-7f25-420c-91ee-0c832c2489ca"],

Cell["Integration tensors for full \[Mu] dependence", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337565248485*^9}, {3.872427515372335*^9, 3.872427524556435*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"74d801be-62c0-4b83-b796-d338240e759b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mastercreator", "[", 
   RowBox[{"Bcoefs_", ",", "Covacoefs_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorProduct", "[", 
     RowBox[{"Bcoefs", ",", "Bcoefs", ",", "Covacoefs"}], "]"}], "/.", 
    "full\[Mu]urep"}], "/.", "single\[Mu]urep"}]}]], "Input",
 CellChangeTimes->{{3.863532531099457*^9, 3.863532598436219*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"323dc9b6-dd27-488d-ab9c-98c3cd4c92f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Treemaster", " ", "=", " ", 
   RowBox[{"Mastercreator", "[", 
    RowBox[{"Bcoefstree", ",", "covcoefs"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Loopmaster", " ", "=", " ", 
   RowBox[{"Mastercreator", "[", 
    RowBox[{"Blooplist", ",", "covcoefs"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8635326224963408`*^9, 3.8635326448226223`*^9}, {
  3.863532951954756*^9, 3.863532952971735*^9}, {3.86353299693114*^9, 
  3.863533000837612*^9}, {3.863533052740484*^9, 3.8635330545078297`*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"10674e12-38db-46ed-afa5-9c3b3c3f7f8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Looppriormaster", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"Blooplist", ",", "Blooplist"}], "]"}], "/.", "full\[Mu]urep"}],
     "/.", "single\[Mu]urep"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895136977857938*^9, 3.895136985101025*^9}, 
   3.8951370223157053`*^9},
 CellLabel->
  "In[216]:=",ExpressionUUID->"71b280ad-a3a5-42aa-93a0-a3d7df1bca81"],

Cell["Integration for monopole only", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337565248485*^9}, {3.8724275300679617`*^9, 3.8724275357682858`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9736a62d-ed9f-4a14-8e61-b896d6cfd8bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Blooplistmono", " ", "=", " ", 
   RowBox[{
    RowBox[{"Blooplist", "/.", "full\[Mu]urep"}], "/.", "single\[Mu]urep"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covcoefsmono", "=", 
   RowBox[{
    RowBox[{"covcoefs", "/.", "full\[Mu]urep"}], "/.", "single\[Mu]urep"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Loopmastermono", " ", "=", 
   RowBox[{"Mastercreator", "[", 
    RowBox[{"Blooplistmono", ",", "covcoefs"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.861686889881752*^9, 3.8616868988739643`*^9}, {
   3.8724274830273323`*^9, 3.872427486610854*^9}, {3.873632716701725*^9, 
   3.873632731132085*^9}, 3.873796694174612*^9, 3.873872332812913*^9, {
   3.873872841348094*^9, 3.873872843843258*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"f8f2b696-f4d4-4f82-9d83-41f2bedee38f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fisher matrix", "Subsection",
 CellChangeTimes->{{3.872427345825388*^9, 
  3.8724273482981977`*^9}},ExpressionUUID->"33d2b6cf-e331-4a8a-b16b-\
04f358671ac8"],

Cell["Fisher with Numerical covariance", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337573185067*^9}, {3.8728598386009903`*^9, 3.872859840837*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"28d15ee9-25f6-4b9d-85d0-a0c5212dc392"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetFisherBNum", "[", 
   RowBox[{"derivs_", ",", "covsinv_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"2048", " ", "-", " ", 
     RowBox[{"Length", "[", "covsinv", "]"}], " ", "-", " ", "2"}], 
    RowBox[{"2048", " ", "-", " ", "1"}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"derivs", ".", "Blooplistmono"}], "//", "Transpose"}], ")"}], 
    ".", 
    RowBox[{"Inverse", "[", "covsinv", "]"}], ".", "derivs", ".", 
    "Blooplistmono"}]}]}]], "Input",
 CellChangeTimes->{{3.861266360064621*^9, 3.86126662921376*^9}, {
   3.870337098605201*^9, 3.8703371850501204`*^9}, 3.87033722944936*^9, {
   3.870337279347876*^9, 3.870337367307479*^9}, {3.87049012245586*^9, 
   3.870490138863616*^9}, {3.872306135645194*^9, 3.872306158362726*^9}, {
   3.872427590973464*^9, 3.872427616916098*^9}, {3.8728599661360188`*^9, 
   3.872859990563045*^9}, {3.873519262603414*^9, 3.873519274708584*^9}, 
   3.8784108925394993`*^9, 3.885479959472972*^9, {3.8954744636108637`*^9, 
   3.895474464637601*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"e3aab1b7-e4bd-4849-928e-50d6fac3553d"],

Cell["Fisher with Analytical covariance", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.872337573185067*^9}, {3.878330452727605*^9, 3.8783304541162*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"887afaf2-2039-4194-9e4d-70e46346e643"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetFisherB", "[", 
   RowBox[{"derivs_", ",", "covsinv_", ",", "inter_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "Fpre", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Fpre", " ", "=", 
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "inter", ".", 
          RowBox[{"covsinv", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"derivs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "//", "Transpose"}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "covsinv", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.861266360064621*^9, 3.86126662921376*^9}, {
   3.870337098605201*^9, 3.8703371850501204`*^9}, 3.87033722944936*^9, {
   3.870337279347876*^9, 3.870337367307479*^9}, {3.87049012245586*^9, 
   3.870490138863616*^9}, {3.872306135645194*^9, 3.872306158362726*^9}, {
   3.872427590973464*^9, 3.872427616916098*^9}, {3.874575713480174*^9, 
   3.874575782963448*^9}, {3.874575874766016*^9, 3.874575874811535*^9}, {
   3.878330460173724*^9, 3.878330468015154*^9}, 3.878330544219475*^9, {
   3.895474465686912*^9, 3.895474467420185*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"5ecb1ffc-348c-400d-84bc-423bc8ac67d6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Perturbative Prior", "Section",
 CellChangeTimes->{{3.8950534784813423`*^9, 
  3.895053482223502*^9}},ExpressionUUID->"37e06d60-ed39-4764-9d3f-\
af8b6361fdfd"],

Cell["\<\
Everything we do for the prior is with a smooth powerspectrum. This will \
destroy BAO information. However, we here are really interested in the size \
of objects, so it is benefitial to not have things oscilate and in many cases \
is monotonous instead. \
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.8723051697520514`*^9}, {3.886676560347579*^9, 
  3.886676560778887*^9}, {3.886766938195977*^9, 3.886767014181056*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"30609e82-d5bc-4d38-b8db-b160b29e1767"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Makeprior", "[", 
    RowBox[{"Loopd_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SelfKronecker", "[", "Loopd", " ", "]"}], 
    SuperscriptBox["\[Sigma]", 
     RowBox[{"-", "2"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{3.895001580044561*^9},
 CellLabel->
  "In[222]:=",ExpressionUUID->"7febd96f-2bb1-41c2-90a6-a8a66aa1f01c"],

Cell[CellGroupData[{

Cell["Powerspectrum", "Subsection",
 CellChangeTimes->{{3.886518946754225*^9, 3.88651895981149*^9}, {
   3.886844006220415*^9, 3.8868440113406487`*^9}, 
   3.886933115069581*^9},ExpressionUUID->"4d9b7026-2b06-49ab-84b2-\
b79eeb996566"],

Cell["Counter derivatives only", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305175380875*^9}, {3.886676563330258*^9, 
  3.88667656391881*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"8d50c7c3-4c27-482c-a02f-5839f4cba3b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PCounterLoopDerivs", "[", 
   RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Pcounteresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv", ",",
       "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Pcounteresum", "[", "arr_", "]"}], ":=", 
      RowBox[{
       RowBox[{"PCounter", "[", 
        RowBox[{"k", ",", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "/.", 
       RowBox[{"Be1", "->", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Pcounteresum", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"4", ",", "9"}], "}"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "prederiv"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8585077292340565`*^9, 3.8585077305031223`*^9}, {
   3.859204856667835*^9, 3.8592050386818385`*^9}, {3.859205082609642*^9, 
   3.8592051738040447`*^9}, 3.859205336286848*^9, {3.8592057271524687`*^9, 
   3.8592057649514475`*^9}, {3.8592058030996037`*^9, 3.8592058082698317`*^9}, 
   3.8592060480106535`*^9, 3.859206079803241*^9, {3.859270817539712*^9, 
   3.859270821251371*^9}, {3.859548382888116*^9, 3.8595483866064787`*^9}, 
   3.8596478764988956`*^9, {3.859647931041823*^9, 3.8596479361773014`*^9}, 
   3.8603266346548815`*^9, {3.860392926426573*^9, 3.860392978325523*^9}, 
   3.8603951053326235`*^9, {3.860424183173935*^9, 3.86042418605873*^9}, {
   3.8604248258482523`*^9, 3.8604248386823792`*^9}, 3.860435700967555*^9, {
   3.860507944800791*^9, 3.860507946121937*^9}, 3.860508151292697*^9, {
   3.8703355099728394`*^9, 3.87033552074256*^9}, {3.8703356425378036`*^9, 
   3.870335644720654*^9}, {3.8703358702780857`*^9, 3.8703358993774443`*^9}, 
   3.8703362132800207`*^9, {3.870486390995903*^9, 3.8704863978244543`*^9}, {
   3.870491010844184*^9, 3.8704910122366343`*^9}, {3.8723001177355223`*^9, 
   3.8723001183877707`*^9}, {3.872300475403232*^9, 3.872300496437989*^9}, {
   3.872300533617116*^9, 3.872300572494783*^9}, {3.872300640404958*^9, 
   3.872300661231141*^9}, {3.8723009113131237`*^9, 3.8723009209721746`*^9}, 
   3.87230117805485*^9, {3.872301236572525*^9, 3.872301240902731*^9}, {
   3.872301487653479*^9, 3.8723015344112453`*^9}, {3.872301786365005*^9, 
   3.872301794564292*^9}, {3.872301874173452*^9, 3.872301896395938*^9}, {
   3.872301968797126*^9, 3.872302014398234*^9}, {3.8723021645136013`*^9, 
   3.8723024275451097`*^9}, {3.872302461383832*^9, 3.8723025184086227`*^9}, {
   3.872302594143104*^9, 3.872302594459876*^9}, {3.87230298149977*^9, 
   3.872302996036478*^9}, {3.87230311742161*^9, 3.872303125557418*^9}, {
   3.872303253434042*^9, 3.872303256272379*^9}, {3.872303350371029*^9, 
   3.8723033533701563`*^9}, 3.872304543260758*^9, {3.873359737358776*^9, 
   3.8733597375970907`*^9}, {3.886671854360067*^9, 3.886671854773823*^9}, {
   3.886671905596189*^9, 3.886671908624387*^9}, {3.886672088108148*^9, 
   3.886672116050559*^9}, {3.886672146463876*^9, 3.8866721471486998`*^9}, {
   3.8867671532824287`*^9, 3.886767153329517*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"1ff3e4cf-d700-40c6-a76a-49a95d67beee"],

Cell["Loop derivatives only", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305179544417*^9}, {3.878324003553637*^9, 
  3.878324003914877*^9}, {3.886676566404244*^9, 3.8866765672496653`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0b8e8337-7119-45c5-a554-e602644305d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PLoopDerivspre", "[", 
    RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P13", ",", "P22", ",", "Plint", ",", "Ploopeval", ",", "Ploopresum", 
       ",", "PTreeresum", ",", "prederiv", ",", "EFTderiv", ",", "cosmoderiv",
        ",", "derivs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P13", "=", 
       RowBox[{"P13n", "[", "k", "]"}]}], ";", " ", 
      RowBox[{"P22", "=", 
       RowBox[{"P22n", "[", "k", "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"Plint", "[", "Plin_", "]"}], "=", 
       RowBox[{"Plin", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ploopeval", "[", 
        RowBox[{"ls_", ",", "plin_", ",", "f_"}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"P13ev", "[", 
         RowBox[{"P13", ",", "ls", ",", "f", ",", 
          RowBox[{"Plint", "[", "plin", "]"}]}], "]"}], "+", " ", 
        RowBox[{"P22ev", "[", 
         RowBox[{"P22", ",", "ls", ",", "f"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ploopresum", "[", "arr_", "]"}], ":=", 
       RowBox[{"Ploopeval", "[", 
        RowBox[{
         RowBox[{"arr", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prederiv", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Ploopresum", "[", 
          RowBox[{
           RowBox[{"pks", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "4", ",", "9"}], "}"}], "]"}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "prederiv"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8552132605934753`*^9, 3.8552132798433037`*^9}, {
   3.8552133168235965`*^9, 3.8552134519073095`*^9}, {3.855214310132822*^9, 
   3.855214329507357*^9}, {3.8552145356976748`*^9, 3.8552145359857054`*^9}, {
   3.8552174770254335`*^9, 3.8552174900170984`*^9}, {3.8552179845936913`*^9, 
   3.8552179927568665`*^9}, {3.855218049880351*^9, 3.8552180584186835`*^9}, {
   3.855218374242013*^9, 3.8552183863836155`*^9}, {3.855218581225415*^9, 
   3.8552186436184196`*^9}, {3.855218860733153*^9, 3.855218907905439*^9}, {
   3.8552190114921703`*^9, 3.855219025025141*^9}, {3.8552191026630116`*^9, 
   3.8552191044038963`*^9}, {3.855220038959756*^9, 3.8552201831079626`*^9}, {
   3.855220268445395*^9, 3.855220276197358*^9}, {3.855220353364435*^9, 
   3.8552203564952407`*^9}, 3.8552213394337807`*^9, {3.855222020830437*^9, 
   3.855222077639424*^9}, {3.8552221267733335`*^9, 3.855222186950463*^9}, 
   3.8552222300647345`*^9, {3.8552222791890097`*^9, 3.855222343814923*^9}, {
   3.855222861723735*^9, 3.855222888194085*^9}, {3.8552229430859127`*^9, 
   3.855222950341934*^9}, {3.8552229967658815`*^9, 3.8552230061592307`*^9}, {
   3.855223077125824*^9, 3.8552230927018023`*^9}, 3.8552232304530745`*^9, {
   3.8552233644007025`*^9, 3.8552233701414604`*^9}, {3.8552234328456154`*^9, 
   3.8552234593622584`*^9}, {3.8552239024595747`*^9, 3.855224276446269*^9}, {
   3.8552243329876633`*^9, 3.855224362717295*^9}, {3.8552244508150525`*^9, 
   3.8552244512937717`*^9}, {3.8552255851006145`*^9, 3.855225672529089*^9}, {
   3.8552258523822546`*^9, 3.8552259693744965`*^9}, {3.8552272270698085`*^9, 
   3.8552272861744967`*^9}, {3.8552317621657467`*^9, 3.855231790813834*^9}, 
   3.8552319007882366`*^9, {3.85523233787451*^9, 3.8552323657626767`*^9}, {
   3.855232879120243*^9, 3.855232885665193*^9}, {3.8552416671146774`*^9, 
   3.855241683416233*^9}, {3.856001481815685*^9, 3.8560015587790375`*^9}, {
   3.8560018092919507`*^9, 3.856001810122726*^9}, {3.8560911858586807`*^9, 
   3.856091190386009*^9}, {3.8560925640493307`*^9, 3.856092580798242*^9}, {
   3.8560926150596046`*^9, 3.856092617493783*^9}, 3.856092682422635*^9, {
   3.8560928393152943`*^9, 3.856092907440245*^9}, {3.8560949884782977`*^9, 
   3.856095026452264*^9}, {3.856095116595584*^9, 3.856095129745544*^9}, {
   3.8560953050759416`*^9, 3.8560953054493847`*^9}, {3.8560954039018345`*^9, 
   3.856095426939816*^9}, 3.8560954718436995`*^9, {3.856095573603755*^9, 
   3.856095683173815*^9}, {3.8560957337354827`*^9, 3.8560957618144503`*^9}, {
   3.8560958116120224`*^9, 3.8560958291066275`*^9}, {3.8560961396470156`*^9, 
   3.8560961402033467`*^9}, {3.856096279425429*^9, 3.8560962817975345`*^9}, {
   3.856096411908641*^9, 3.8560964120929337`*^9}, {3.8560970153045826`*^9, 
   3.8560970571397276`*^9}, {3.856097178060191*^9, 3.8560971844527464`*^9}, {
   3.856097629425712*^9, 3.8560976555142183`*^9}, {3.856097699862956*^9, 
   3.8560977006561527`*^9}, 3.8560979420462165`*^9, 3.8583221399702253`*^9, {
   3.85832231106285*^9, 3.8583223355084534`*^9}, {3.858339887622612*^9, 
   3.8583400512865343`*^9}, {3.8583402445748534`*^9, 3.858340299843937*^9}, 
   3.858340375526843*^9, {3.858340515952941*^9, 3.8583406097988853`*^9}, 
   3.8583406812917166`*^9, {3.8583412433621283`*^9, 3.8583412451320343`*^9}, {
   3.858341688263835*^9, 3.858341695556431*^9}, {3.858341770190067*^9, 
   3.8583417913265553`*^9}, {3.8583421907559304`*^9, 3.858342199772802*^9}, {
   3.858342361505916*^9, 3.8583424091742673`*^9}, {3.8583426247693005`*^9, 
   3.858342681095413*^9}, {3.85834282806733*^9, 3.858342890692011*^9}, {
   3.8583992112529054`*^9, 3.858399237254298*^9}, {3.8584057453200507`*^9, 
   3.8584057671362743`*^9}, {3.8584058468948145`*^9, 3.8584058530822535`*^9}, 
   3.8584064026274195`*^9, {3.858406654015836*^9, 3.858406665692851*^9}, 
   3.8584068489049354`*^9, {3.858408761162578*^9, 3.858408794828392*^9}, {
   3.858408902186231*^9, 3.8584089049223137`*^9}, {3.8584242139138193`*^9, 
   3.858424298965557*^9}, {3.858424627391868*^9, 3.8584247725645237`*^9}, {
   3.8584248590641956`*^9, 3.8584252146986575`*^9}, {3.8584256527141633`*^9, 
   3.8584259578060045`*^9}, {3.858425998441145*^9, 3.858426099539225*^9}, {
   3.8584269321518774`*^9, 3.8584269402318735`*^9}, 3.8584455085278015`*^9, 
   3.858445589158205*^9, {3.858445802783335*^9, 3.858445849361331*^9}, 
   3.8584459633161063`*^9, {3.8584460486711073`*^9, 3.858446069653865*^9}, {
   3.858446402312545*^9, 3.858446441105647*^9}, {3.858446580048362*^9, 
   3.8584465851577168`*^9}, {3.8584467720028315`*^9, 3.858446787591322*^9}, {
   3.858446870613494*^9, 3.8584468768529644`*^9}, {3.858446996717199*^9, 
   3.858447013758864*^9}, {3.858447048677722*^9, 3.8584471352705812`*^9}, {
   3.8584476181927495`*^9, 3.858447630245302*^9}, {3.858447777037052*^9, 
   3.8584478114909887`*^9}, {3.8584479411165047`*^9, 
   3.8584479490172105`*^9}, {3.858483134493806*^9, 3.8584831748348255`*^9}, {
   3.858483633560991*^9, 3.8584836351396513`*^9}, {3.8584842649220924`*^9, 
   3.858484276014456*^9}, 3.8584844375679836`*^9, {3.8584844892469788`*^9, 
   3.8584844959819717`*^9}, {3.858484756194998*^9, 3.8584847642393064`*^9}, 
   3.8584849427247853`*^9, {3.858484992461914*^9, 3.8584849929043646`*^9}, {
   3.858501063185598*^9, 3.858501074923715*^9}, {3.8592052257720623`*^9, 
   3.8592052769407997`*^9}, {3.8592053122498283`*^9, 3.859205398924036*^9}, {
   3.8592054352404785`*^9, 3.8592054516585026`*^9}, {3.8592055433234053`*^9, 
   3.859205571006667*^9}, {3.8592060355958834`*^9, 3.859206036314386*^9}, {
   3.859208145100141*^9, 3.8592081571798496`*^9}, {3.859208210316988*^9, 
   3.859208229388755*^9}, {3.8592086004611273`*^9, 3.8592086071019583`*^9}, {
   3.8592089569899015`*^9, 3.8592089591711783`*^9}, {3.8592708316085024`*^9, 
   3.8592708349157925`*^9}, {3.859548386742169*^9, 3.859548386867742*^9}, {
   3.8596479687586308`*^9, 3.8596479825458117`*^9}, {3.860317925991248*^9, 
   3.8603179298929825`*^9}, {3.860322104107588*^9, 3.860322106489632*^9}, 
   3.8603266291535344`*^9, {3.8604242232890215`*^9, 3.8604242261819906`*^9}, {
   3.860424924597393*^9, 3.860424933636318*^9}, {3.86043567499611*^9, 
   3.8604356780799265`*^9}, {3.860507933320891*^9, 3.8605079337470794`*^9}, 
   3.8605081415294876`*^9, {3.870336295586814*^9, 3.870336357792151*^9}, {
   3.8703364166511917`*^9, 3.870336435571916*^9}, {3.8703364784729*^9, 
   3.870336489402371*^9}, {3.870485718016523*^9, 3.8704857222961807`*^9}, {
   3.870488118532496*^9, 3.870488121860173*^9}, {3.870490964624899*^9, 
   3.870490974992442*^9}, {3.87230410210859*^9, 3.872304151789733*^9}, {
   3.872304207715746*^9, 3.872304257400985*^9}, {3.87230431052207*^9, 
   3.87230436821388*^9}, {3.872304410476109*^9, 3.872304417444831*^9}, {
   3.872304449936763*^9, 3.87230445035609*^9}, {3.872304555628427*^9, 
   3.8723045883021097`*^9}, {3.8723047258757553`*^9, 3.872304726040217*^9}, {
   3.872305149362557*^9, 3.872305152967976*^9}, {3.873359741656402*^9, 
   3.873359741894813*^9}, {3.8866721906584473`*^9, 3.8866722292520437`*^9}, {
   3.886672399925645*^9, 3.88667240005842*^9}, {3.886767157036992*^9, 
   3.886767157222451*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"cf6d3a69-b5dd-420c-96f8-2a1e465cdedd"],

Cell["Full P1loop derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"71e5f4f0-1091-4d45-90f5-c80700feb71b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P1looprederivpre", "[", 
    RowBox[{"k_", ",", "pks_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PCounterLoopDerivs", "[", 
        RowBox[{"k", ",", "pks"}], "]"}], "+", 
       RowBox[{"PLoopDerivspre", "[", 
        RowBox[{"k", ",", "pks"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "10"}], "}"}]}], "]"}], "//", 
    "Normal"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.886837721407029*^9, 3.886837721667657*^9}, {
   3.8868404958490877`*^9, 3.886840497016727*^9}, 3.887736392518159*^9, {
   3.887736425214087*^9, 3.887736425763061*^9}, 3.887963604022727*^9},
 CellLabel->
  "In[225]:=",ExpressionUUID->"517d0b99-8a7d-4884-921f-7e1cecd67caf"],

Cell["Make Prior for Powerspectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5a469737-41b2-4ae9-a36d-cdaccd6561ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakePriorP", "[", 
   RowBox[{"k_", ",", "pks_", ",", "\[Sigma]_"}], "]"}], ":=", 
  RowBox[{"Makeprior", "[", 
   RowBox[{
    RowBox[{"Makederiv", "[", 
     RowBox[{"P1looprederivpre", "[", 
      RowBox[{"k", ",", "pks"}], "]"}], "]"}], ",", "\[Sigma]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.886672554275097*^9, 3.8866726434181967`*^9}, 
   3.886672717738697*^9, {3.886836791646081*^9, 3.886836797708456*^9}, {
   3.886837485889091*^9, 3.8868374872880383`*^9}, {3.88683752972075*^9, 
   3.886837534102*^9}, {3.886840833846266*^9, 3.886840839974907*^9}, {
   3.886840883269945*^9, 3.886840904750098*^9}, {3.886842278438393*^9, 
   3.886842280607627*^9}, {3.886935707535892*^9, 3.886935721330452*^9}, {
   3.886935985748843*^9, 3.8869359888637447`*^9}, {3.887737705905127*^9, 
   3.887737741847879*^9}, {3.887861446880579*^9, 3.887861448975101*^9}, {
   3.8878617119018784`*^9, 3.887861721846341*^9}, {3.887963690991391*^9, 
   3.887963699930525*^9}, 3.8879638288428392`*^9, 3.888414907721697*^9, {
   3.8884916313626003`*^9, 3.88849168954904*^9}, {3.88866702217388*^9, 
   3.888667023135585*^9}, {3.888739060285619*^9, 3.8887390650388937`*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"c0c07320-c04c-4774-b27a-d7028156be50"],

Cell["Ploop/Ptree scaling", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
   3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
   3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
   3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
   3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
   3.888047434202862*^9}, {3.888394026420682*^9, 3.88839403184702*^9}, 
   3.888394371748201*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"80bbe19c-ff6c-471d-8f0a-d53ecfcf9f32"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PTNS", "[", 
    RowBox[{"k_", ",", "pk_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox["b1", "2"], 
    RowBox[{
     RowBox[{"pk", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8884922582815723`*^9, 3.888492277891873*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"c079a9c3-8794-4a15-ac91-d754d7cb0df5"],

Cell["getting \[Sigma] for the powerspectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047434202862*^9}, {3.888394026420682*^9, 3.88839403184702*^9}, {
  3.888394366937797*^9, 3.8883943704951878`*^9}, {3.888394425318575*^9, 
  3.888394426943108*^9}, {3.88873961450459*^9, 3.888739621521304*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e4547cb3-2bba-4016-bb65-6fede9eeb8c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"P1LC", "[", 
   RowBox[{"Stab_", ",", "\[Sigma]tab_", ",", "PTtab_"}], "]"}], ":=", 
  RowBox[{"Stab", " ", 
   SuperscriptBox[
    RowBox[{"Total", "[", 
     RowBox[{"9", 
      FractionBox[
       SuperscriptBox["Stab", "4"], 
       RowBox[{
        SuperscriptBox["\[Sigma]tab", "2"], 
        SuperscriptBox["PTtab", "2"]}]]}], "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "/", "4"}]]}]}]], "Input",
 CellChangeTimes->{{3.8887387203275843`*^9, 3.888738795341176*^9}, {
   3.8887388301011133`*^9, 3.8887388302082443`*^9}, 3.895051530557374*^9, {
   3.8950515772827587`*^9, 3.895051605530759*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"caa0405e-10ae-4f4c-8dc4-e63e7d2a4ab3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bispectrum", "Subsection",
 CellChangeTimes->{{3.895053435370804*^9, 
  3.895053439838395*^9}},ExpressionUUID->"e68f8153-e855-44de-baa3-\
cb042808f833"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Blooplistreal", "=", 
   RowBox[{
    RowBox[{"Blooplist", "/.", 
     RowBox[{"u", "->", "0"}]}], "/.", 
    RowBox[{"\[Mu]1", "->", "0"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[229]:=",ExpressionUUID->"ebd61ba3-34d7-463f-8cfc-931fe63e7166"],

Cell["\<\
Convert full derivatives to loop derivatives only (counter tree removes the \
tree level counter terms)\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.8723051697520514`*^9}, {3.886676560347579*^9, 
   3.886676560778887*^9}, {3.8878663658670464`*^9, 3.887866374349979*^9}, {
   3.895050593682282*^9, 3.895050609985876*^9}, 3.896390267370103*^9, {
   3.896390380796479*^9, 3.896390381708975*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"edf20ab2-8bfc-48a5-91c7-473977fcf81a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BCounterTreeDerivspre2", "[", 
   RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "k3", ",", "y", ",", "y13", ",", "Bcounterevpre", 
      ",", "Bcounterev", ",", "prederiv"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"k2", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"k3", " ", "=", " ", 
      RowBox[{"arr", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
     RowBox[{"y", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "-", 
        SuperscriptBox["k2", "2"], "+", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k2"}]]}], ";", " ", 
     RowBox[{"y13", " ", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k1", "2"]}], "+", 
        SuperscriptBox["k2", "2"], "-", 
        SuperscriptBox["k3", "2"]}], 
       RowBox[{"2", " ", "k1", " ", "k3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bcounterevpre", " ", "[", 
       RowBox[{"Plin_", ",", "f_"}], "]"}], " ", "=", " ", 
      RowBox[{"BCounterTree", "[", 
       RowBox[{
       "k1", ",", "k2", ",", "k3", ",", "Plin", ",", "f", ",", "y", ",", 
        "y13"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bcounterev", " ", "[", "ar_", "]"}], " ", ":=", 
      RowBox[{"Bcounterevpre", " ", "[", 
       RowBox[{
        RowBox[{"ar", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ar", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prederiv", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Bcounterev", "[", 
         RowBox[{
          RowBox[{"pks", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"7", ",", "9"}], "}"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pks", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Makederiv", "[", "prederiv", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.887866842369525*^9, 3.887866844907611*^9}, {
  3.895000892148178*^9, 3.8950009189215193`*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"c959aa41-70a8-4f3c-8042-86b6dff61097"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BCorrection", "[", 
   RowBox[{"arr_", ",", "pks_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"BTreeDerivs", "[", 
      RowBox[{"arr", ",", "pks"}], "]"}]}], "-", 
    RowBox[{"BNGDerivs", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}], "-", 
    RowBox[{"BCounterTreeDerivspre2", "[", 
     RowBox[{"arr", ",", "pks"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.887866670677659*^9, 3.887866675966839*^9}, 
   3.887866847260849*^9, {3.887869013761104*^9, 3.887869019130166*^9}, {
   3.895000894297085*^9, 3.895000920647831*^9}, {3.895136817657552*^9, 
   3.895136818844384*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"4710148e-890f-4dbf-b487-8da361e88b86"],

Cell["Symmetric powerspectrum scaling", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047434202862*^9}, {3.888394026420682*^9, 3.88839403184702*^9}, {
  3.888394366937797*^9, 3.8883943704951878`*^9}, {3.888739955095392*^9, 
  3.888739963845561*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7efb0c1e-264f-49e0-b42d-5e8258b69cfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SPsymT", "[", 
   RowBox[{"tri_", ",", "pk_", ",", "SPtab_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "3"], 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"SPtab", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"PTNS", "[", 
       RowBox[{
        RowBox[{"tri", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "pk"}], "]"}]], "+", 
     FractionBox[
      RowBox[{"SPtab", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"PTNS", "[", 
       RowBox[{
        RowBox[{"tri", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "pk"}], "]"}]], "+", 
     FractionBox[
      RowBox[{"SPtab", "[", 
       RowBox[{"[", "3", "]"}], "]"}], 
      RowBox[{"PTNS", "[", 
       RowBox[{
        RowBox[{"tri", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "pk"}], "]"}]]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.88839532125797*^9, 3.888395328351391*^9}, {
   3.888493785917426*^9, 3.888493822067892*^9}, {3.888493898909082*^9, 
   3.888493910666441*^9}, {3.8884939409421253`*^9, 3.888493947791501*^9}, 
   3.888494324660109*^9, 3.888699452222156*^9, {3.8886994962011766`*^9, 
   3.8886995177852716`*^9}, {3.8886995826961184`*^9, 3.8886995834128447`*^9}, 
   3.888700271206015*^9},
 CellLabel->
  "In[232]:=",ExpressionUUID->"96bcac3e-a9f2-499d-9273-aaa54eb40e4c"],

Cell["Make Prior for Bispectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"3507cf5b-4222-4cc0-90ee-f79eebe67fbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B1LC", "[", 
   RowBox[{
   "BStab_", ",", "B\[Sigma]tab_", ",", "Psymtab_", ",", "Stab_", ",", 
    "\[Sigma]tab_", ",", "PTtab_"}], "]"}], ":=", 
  RowBox[{"BStab", 
   FractionBox[
    RowBox[{" ", 
     SuperscriptBox[
      RowBox[{"Total", "[", 
       RowBox[{"9", 
        FractionBox[
         SuperscriptBox["Stab", "4"], 
         RowBox[{
          SuperscriptBox["\[Sigma]tab", "2"], 
          SuperscriptBox["PTtab", "2"]}]]}], "]"}], 
      RowBox[{"1", "/", "4"}]]}], 
    SuperscriptBox[
     RowBox[{"Total", "[", 
      RowBox[{"9", 
       FractionBox[
        RowBox[{
         SuperscriptBox["BStab", "2"], 
         SuperscriptBox["Psymtab", "2"]}], 
        SuperscriptBox["B\[Sigma]tab", "2"]]}], "]"}], 
     RowBox[{"1", "/", "2"}]]]}]}]], "Input",
 CellChangeTimes->{
  3.888739920309684*^9, {3.8887400091535892`*^9, 3.888740136872439*^9}, {
   3.895051063051816*^9, 3.89505106476256*^9}, {3.8950528753228407`*^9, 
   3.8950529050257683`*^9}, {3.8950530216792383`*^9, 3.895053024641534*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"e83a5ef4-bafe-45f6-8842-c489975aaf5f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scaling estimates", "Subsection",
 CellChangeTimes->{{3.896342751981344*^9, 
  3.896342757433579*^9}},ExpressionUUID->"f332b2c4-be8f-43ac-85b3-\
fa1d991f17d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BTreebias", "[", 
    RowBox[{"k1_", ",", "k2_", ",", "k3_", ",", "Plin_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BTree", "[", 
      RowBox[{
      "k1", ",", "k2", ",", "k3", ",", "Plin", ",", "f", ",", "y", ",", 
       "y13"}], "]"}], ".", "Blooplistreal"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.89634767633249*^9, 3.8963476843522253`*^9}, 
   3.8963477840468903`*^9, {3.896350520969185*^9, 3.896350522383052*^9}, {
   3.896381244910489*^9, 3.896381246684606*^9}},
 CellLabel->
  "In[1952]:=",ExpressionUUID->"c4eea684-4e5f-4fd2-a5b3-0f00da893254"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plooponlyscale", "[", 
   RowBox[{"k_", ",", "Plin_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["b1", "2"], 
   RowBox[{
    RowBox[{"Plin", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k", "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["k", "knl"], ")"}], 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"GetSlope", "[", 
       RowBox[{
        RowBox[{"0.8", "k"}], ",", 
        RowBox[{"1.2", "k"}], ",", 
        RowBox[{"Plin", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}]}], 
     ")"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcounteronlyscale", "[", 
   RowBox[{"k_", ",", "Plin_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "2"}], " ", "b1", " ", 
   FractionBox["b1", 
    RowBox[{"(", 
     RowBox[{"b1", "/.", "coeffixBOSS"}], ")"}]], " ", 
   RowBox[{
    RowBox[{"Plin", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k", "]"}], 
   FractionBox[
    RowBox[{" ", 
     SuperscriptBox["k", "2"]}], 
    SuperscriptBox["knl", "2"]]}]}]}], "Input",
 CellChangeTimes->{{3.896419892993627*^9, 3.8964199421061783`*^9}, 
   3.896440499450083*^9, {3.896440591382709*^9, 3.896440592191985*^9}, {
   3.8964406862275333`*^9, 3.89644069628734*^9}, {3.896441017134859*^9, 
   3.89644102861117*^9}, {3.8964414737167683`*^9, 3.89644147604804*^9}, {
   3.8964422134370527`*^9, 3.896442214184713*^9}, {3.896461821505965*^9, 
   3.896461827589046*^9}},
 CellLabel->
  "In[1953]:=",ExpressionUUID->"41d9f9ff-74f2-4397-9c29-c6473a928169"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BLooponlyscale", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_", ",", "Plin_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"BTreebias", "[", 
    RowBox[{"k1", ",", "k2", ",", "k3", ",", 
     RowBox[{"Plin", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["k1", "knl"], ")"}], 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"GetSlope", "[", 
         RowBox[{
          RowBox[{"0.8", "k1"}], ",", 
          RowBox[{"1.2", "k1"}], ",", 
          RowBox[{"Plin", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}]}], ")"}]], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["k2", "knl"], ")"}], 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"GetSlope", "[", 
         RowBox[{
          RowBox[{"0.8", "k2"}], ",", 
          RowBox[{"1.2", "k2"}], ",", 
          RowBox[{"Plin", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}]}], ")"}]], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["k3", "knl"], ")"}], 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"GetSlope", "[", 
         RowBox[{
          RowBox[{"0.8", "k3"}], ",", 
          RowBox[{"1.2", "k3"}], ",", 
          RowBox[{"Plin", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}]}], ")"}]]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bcounteronlyscale", "[", 
    RowBox[{"k1_", ",", "k2_", ",", "k3_", ",", "Plin_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    SuperscriptBox["b1", "2"], 
    FractionBox["b1", 
     RowBox[{"(", 
      RowBox[{"b1", "/.", "coeffixBOSS"}], ")"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        SuperscriptBox["k1", "2"], 
        SuperscriptBox["knl", "2"]], " ", 
       RowBox[{
        RowBox[{"Plin", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k2", "]"}], " ", 
       RowBox[{
        RowBox[{"Plin", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k3", "]"}]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["k2", "2"], 
        SuperscriptBox["knl", "2"]], " ", 
       RowBox[{
        RowBox[{"Plin", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k1", "]"}], " ", 
       RowBox[{
        RowBox[{"Plin", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k3", "]"}]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["k3", "2"], 
        SuperscriptBox["knl", "2"]], " ", 
       RowBox[{
        RowBox[{"Plin", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k1", "]"}], " ", 
       RowBox[{
        RowBox[{"Plin", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k2", "]"}]}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.896419934834959*^9, 3.8964199926154623`*^9}, {
  3.896440780219923*^9, 3.896440792065074*^9}, {3.89644148577629*^9, 
  3.896441509795435*^9}, {3.896461817807852*^9, 3.8964618320407133`*^9}},
 CellLabel->
  "In[1955]:=",ExpressionUUID->"b782efce-9198-4d77-9940-8e44a0f22a91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PLoopscale", "[", 
   RowBox[{"k_", ",", "Plin_"}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"Plooponlyscale", "[", 
       RowBox[{"k", ",", "Plin"}], "]"}], "]"}], ",", 
     RowBox[{"Abs", "[", 
      RowBox[{"Pcounteronlyscale", "[", 
       RowBox[{"k", ",", "Plin"}], "]"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8963427599089203`*^9, 3.896342765749498*^9}, {
   3.896342825176072*^9, 3.896342898607263*^9}, {3.896344989009129*^9, 
   3.896344998245131*^9}, {3.896345094177574*^9, 3.896345110061418*^9}, {
   3.896346131598627*^9, 3.896346133846595*^9}, {3.8963476893364973`*^9, 
   3.896347690436042*^9}, 3.896413669825197*^9, {3.896419889991703*^9, 
   3.896419923831792*^9}, {3.8964199599723387`*^9, 3.8964199780461283`*^9}, 
   3.89642048733212*^9, {3.896439030553672*^9, 3.896439045843988*^9}, {
   3.896440508693965*^9, 3.896440511893057*^9}, {3.8964406123997507`*^9, 
   3.896440612627281*^9}, 3.896442226969638*^9, {3.896442351949605*^9, 
   3.8964423530317783`*^9}, {3.8964618629037867`*^9, 3.8964618631608667`*^9}},
 CellLabel->
  "In[1957]:=",ExpressionUUID->"9dd45791-9dcc-4c58-98cb-be888977b03e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bloopscale", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "}"}], ",", "Plin_"}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"BLooponlyscale", "[", 
       RowBox[{"k1", ",", "k2", ",", "k3", ",", "Plin"}], "]"}], "]"}], ",", 
     RowBox[{"Abs", "[", 
      RowBox[{"Bcounteronlyscale", "[", 
       RowBox[{"k1", ",", "k2", ",", "k3", ",", "Plin"}], "]"}], "]"}]}], 
    "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.896342836996173*^9, 3.896342838740056*^9}, {
   3.896342907773451*^9, 3.896342958930072*^9}, {3.896343062460044*^9, 
   3.896343062526353*^9}, 3.896344978371057*^9, {3.896345139032946*^9, 
   3.896345187912456*^9}, {3.8963461120413637`*^9, 3.8963461276322412`*^9}, 
   3.896350676893244*^9, {3.8964200039417887`*^9, 3.896420014976789*^9}, {
   3.896439050090333*^9, 3.896439067683433*^9}, {3.896440221088789*^9, 
   3.89644023091297*^9}, 3.896442228909617*^9, {3.896442349400587*^9, 
   3.8964423495730343`*^9}, {3.896461864906765*^9, 3.8964618651688423`*^9}},
 CellLabel->
  "In[1958]:=",ExpressionUUID->"37b38672-fb30-472b-998e-8f637283a8cf"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminaries for All survey evaluations ", "Section",
 CellChangeTimes->{{3.887890897917221*^9, 3.8878909041488867`*^9}, {
  3.895054317805303*^9, 
  3.89505432440456*^9}},ExpressionUUID->"43470e4e-35d6-4714-829a-\
9b87beef6ae7"],

Cell["BOSS numbers fully binned", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.8783836881286488`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"cd2b709a-fe4f-4880-99f6-39b0cb34d662"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "z", ",", "nb", ",", "V", ",", "N", ",", "Dg", ",", "fs", ",", "b1"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8854753539720993`*^9, 3.8854753543794107`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"e38dd6f6-4eff-4bbe-8fc7-d32717e12738"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BOSSspec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.05`", ",", "0.15`", ",", "0.25`", ",", "0.35`", ",", "0.45`", ",", 
       "0.55`", ",", "0.65`", ",", "0.75`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.000289`", ",", "0.00029`", ",", "0.0003`", ",", "0.000304`", ",", 
       "0.00027600000000000004`", ",", "0.000323`", ",", "0.00012`", ",", 
       "0.00001`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2.55`*^7", ",", "1.64`*^8", ",", "4.02`*^8", ",", "7.04`*^8", ",", 
       "1.04`*^9", ",", "1.38`*^9", ",", "1.72`*^9", ",", "2.04`*^9"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
      "7369.499999999999`", ",", "47560.`", ",", "120599.99999999999`", ",", 
       "214016.`", ",", "287040.00000000006`", ",", "445740.`", ",", 
       "206400.`", ",", "20400.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.973938713655033", ",", "0.9235978369817912", ",", 
       "0.8759572952224975", ",", "0.8312353500171761", ",", 
       "0.789497353926307", ",", "0.7506997404081879", ",", 
       "0.7147268398976079", ",", "0.6814195172840236"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.5559799005938011", ",", "0.6106395138125067", ",", 
       "0.6593260133608193", ",", "0.7021004757219186", ",", 
       "0.7392994196584667", ",", "0.7714187036372595", ",", 
       "0.799023714461632", ",", "0.8226875527129273"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.4798689114411347`", ",", "1.560529449372745`", ",", 
       "1.6454017014847226`", ",", "1.7339272493130506`", ",", 
       "1.8255939894151774`", ",", "1.9199442152509005`", ",", 
       "2.0165768843849974`", ",", "2.115145791144549`"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.877265916864263*^9, 3.877265918514963*^9}, {
   3.878382336152431*^9, 3.878382338551983*^9}, {3.878382424749436*^9, 
   3.878382427765259*^9}, 3.87838246170047*^9, {3.878383826491439*^9, 
   3.8783838277095737`*^9}, {3.883946711856142*^9, 3.883946720383527*^9}, {
   3.885475347228559*^9, 3.885475351885529*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"dc492109-3ff0-4e4a-9a9c-5d399f71ffc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BOSScut", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.878383193930118*^9, 3.878383199484385*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"706fb54c-f943-40ad-b804-5f8f16dec01c"],

Cell["Get zeffs and define cental values", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
   3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
   3.87387541354895*^9}, {3.878382212762868*^9, 3.878382216951807*^9}, 
   3.878382259950922*^9, 3.8783829477289057`*^9, {3.878383185752803*^9, 
   3.878383210959243*^9}, {3.878383719533955*^9, 3.878383723260166*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"b5977868-6052-4f67-a1d7-d0d798f3adc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LOWZspec", " ", "=", " ", 
   RowBox[{"BOSSspec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{";;", "BOSScut"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CMASSspec", " ", "=", " ", 
   RowBox[{"BOSSspec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"BOSScut", "+", "1"}], ";;"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87729569843889*^9, 3.8772957323200274`*^9}, {
   3.878382358668338*^9, 3.87838237967688*^9}, 3.878382526664139*^9, {
   3.878383218340361*^9, 3.878383219242804*^9}, {3.893829905469788*^9, 
   3.893829905470271*^9}, {3.893830268903974*^9, 3.893830295687128*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"5134f262-8a10-4a7b-9005-8568dd65c9e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dg57", "=", "0.7432838038198406"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dg32", " ", "=", "0.8443391196514677"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8839467624189987`*^9, 3.8839467633827333`*^9}, 
   3.883946794966707*^9},
 CellLabel->
  "In[242]:=",ExpressionUUID->"816c5707-7b97-4d97-9edf-6af61edc98a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CMASSpk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"CMASSpks", ",", "0.57"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZpk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"LOWZpks", ",", "0.32"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8727413630602694`*^9, 3.8727413655934258`*^9}, {
   3.8727546915351477`*^9, 3.872754694985199*^9}, {3.872766326967618*^9, 
   3.8727663281148233`*^9}, 3.872770560272434*^9, {3.873359960402536*^9, 
   3.8733599619315567`*^9}, {3.87346870319875*^9, 3.873468706946323*^9}, {
   3.8739667794686813`*^9, 3.8739667861596413`*^9}, {3.874402252136847*^9, 
   3.874402253720666*^9}, {3.8840011405392637`*^9, 3.8840011423693647`*^9}, {
   3.88400133931207*^9, 3.884001340221551*^9}, {3.8854835741974783`*^9, 
   3.885483575327087*^9}, {3.887879184470942*^9, 3.887879187488707*^9}, {
   3.887879471714119*^9, 3.887879474026322*^9}, {3.8949953994591093`*^9, 
   3.8949954005044193`*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"8f93862b-2aec-4857-b458-d01860a449ff"],

Cell["BOSS numbers fully binned into 2", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"51a92a31-c177-4949-93f7-bddb56287a71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbfixCMASSngc", " ", "=", 
   RowBox[{"nb", "->", 
    FractionBox[
     RowBox[{"435741", "+", "500872"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"5.3", "+", "9.0"}], ")"}], 
      SuperscriptBox["hback", "3"], 
      SuperscriptBox["10", "9"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbfixCMASSsgc", " ", "=", 
   RowBox[{"nb", "->", 
    FractionBox[
     RowBox[{"185498", "+", "158262"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.0", "+", "3.3"}], ")"}], 
      SuperscriptBox["hback", "3"], 
      SuperscriptBox["10", "9"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbfixLOWZngc", " ", "=", 
   RowBox[{"nb", "->", 
    FractionBox["429182", 
     RowBox[{"4.7", " ", 
      SuperscriptBox["hback", "3"], 
      SuperscriptBox["10", "9"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbfixLOWZsgc", " ", "=", 
   RowBox[{"nb", "->", 
    FractionBox["174819", 
     RowBox[{"1.7", 
      SuperscriptBox["hback", "3"], 
      SuperscriptBox["10", "9"]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"VSCMASSngc", " ", "=", 
   RowBox[{"Vs", "->", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5.3", "+", "9.0"}], ")"}], 
     SuperscriptBox["hback", "3"], 
     SuperscriptBox["10", "9"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VSCMASSsgc", "=", 
   RowBox[{"Vs", "->", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2.0", "+", "3.3"}], ")"}], 
     SuperscriptBox["hback", "3"], 
     SuperscriptBox["10", "9"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VLOWZngc", " ", "=", 
   RowBox[{"Vs", "->", " ", 
    RowBox[{"4.7", " ", 
     SuperscriptBox["hback", "3"], 
     SuperscriptBox["10", "9"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VLOWZsgc", " ", "=", 
   RowBox[{"Vs", "->", 
    RowBox[{"1.7", 
     SuperscriptBox["hback", "3"], 
     SuperscriptBox["10", "9"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873875438860836*^9, 3.873875447797975*^9}, 
   3.873964417558131*^9, {3.874994697144123*^9, 3.8749947131881104`*^9}, {
   3.877976102770084*^9, 3.8779761140267982`*^9}, {3.878157695711175*^9, 
   3.8781577092274923`*^9}, 3.8783854049941874`*^9},
 CellLabel->
  "In[246]:=",ExpressionUUID->"590edee1-8e89-41d4-b02a-d71f2e484c06"],

Cell["Parameters bestfit from BOSS", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
  3.878318564396934*^9, 3.8783185665840807`*^9}, {3.8783189236834927`*^9, 
  3.8783189249818363`*^9}, {3.8783193275467777`*^9, 3.878319330519642*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"3013b7ce-c56d-428e-9816-ac0b3569435a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"knlfixBOSS", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"knl", "->", "0.7"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878823169021199*^9, 3.87882317566413*^9}, {
  3.878826333566222*^9, 3.878826335195261*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"dd3749b2-efb7-4aef-b1ed-de66d51987b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfixBOSSNS", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Be1", "->", "0"}], "}"}], ",", "bfixBOSS"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8784930964624567`*^9, 3.8784930986580276`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"07807f35-1bb4-47e3-bca4-c1303bc156be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffixBOSS", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
    "bfixBOSS", ",", "bfixstochBOSS", ",", "fnlfix", ",", "paramfix", ",", 
     "knlfixBOSS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffixstfixBOSS", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
    "bfixBOSS", ",", "bfixstoch", ",", "fnlfix", ",", "paramfix", ",", 
     "knlfixBOSS"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878823165855525*^9, 3.8788231813925943`*^9}, {
  3.8788263372729073`*^9, 3.8788263379221287`*^9}, {3.8854842981276073`*^9, 
  3.885484306783326*^9}, {3.8925340389384537`*^9, 3.892534039184407*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"6f4588a5-c34b-417b-b7bc-edbaaf4d306b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffixBOSSNS", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Be1", "->", "0"}], "}"}], ",", "coeffixBOSS"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffixBOSSNSstfix", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Be1", "->", "0"}], "}"}], ",", "coeffixstfixBOSS"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87838627110912*^9, 3.878386275887601*^9}, {
  3.892534021106481*^9, 3.8925340326663733`*^9}, {3.8925341582040167`*^9, 
  3.892534158408633*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"0808e19e-fd16-4db4-874f-cd44889c9f28"],

Cell["Functions to get knl", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
  3.878318564396934*^9, 3.8783185665840807`*^9}, {3.8783189236834927`*^9, 
  3.8783189249818363`*^9}, {3.8783193275467777`*^9, 3.878319330519642*^9}, {
  3.887891021467949*^9, 3.8878910250785923`*^9}, {3.8878911056257257`*^9, 
  3.887891105987898*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5dc46418-18b4-45bf-8dd6-bfb41d5094fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CC", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", 
      SuperscriptBox["\[Pi]", "2"]}]], 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["k", "2"], 
       RowBox[{
        RowBox[{"CMASSpk", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], "[", "k", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]], ",", "0.7"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[260]:=",ExpressionUUID->"4d3579a2-0ef6-4a3a-ad61-96c042ca8a29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getknl", "[", "pk_", "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         SuperscriptBox["\[Pi]", "2"]}]], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["k", "2"], 
          RowBox[{"pk", "[", "k", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], ",", "kn"}], "}"}]}], "]"}]}], "-", "CC"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"kn", ",", "0.5"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.878827973880945*^9, {3.878828011684456*^9, 3.8788280182252407`*^9}, {
   3.887891273037027*^9, 3.887891275735816*^9}, 3.887891338378776*^9},
 CellLabel->
  "In[261]:=",ExpressionUUID->"d312235d-68f3-4da5-99e8-440cdad4b03c"],

Cell["Base tab and setting kmax ", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
  3.872297247278839*^9}, {3.8738708899346247`*^9, 3.8738708927083797`*^9}, {
  3.87841313542971*^9, 3.8784131420677233`*^9}, {3.878413179679388*^9, 
  3.878413201424553*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"113ec7de-ab24-4c3d-abd6-ae8843c05550"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ktabraw", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"0.001`", "+", 
      RowBox[{"i", " ", "0.005"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "300"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878895579618306*^9, 3.8788955804938707`*^9}, {
  3.8788956284897118`*^9, 3.878895630748551*^9}, {3.8788956611838913`*^9, 
  3.878895661414843*^9}, {3.8791635414504547`*^9, 3.879163541669219*^9}, {
  3.8791635894533253`*^9, 3.879163589924549*^9}, {3.885550126399822*^9, 
  3.8855501264071293`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"f1336859-d967-42bd-b74b-53b0e41e8b63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Basetri", "  ", "=", 
   RowBox[{"makeTri", "[", 
    RowBox[{"0.02", ",", "0.91", ",", "0.02"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffbase", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<covsks/baseTrikeff.mtx\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87916348683456*^9, 3.8791634885132113`*^9}, {
   3.8792456482218533`*^9, 3.879245661477367*^9}, {3.879444136918521*^9, 
   3.8794441395896482`*^9}, {3.8794442276939983`*^9, 3.879444232498129*^9}, {
   3.879447658779847*^9, 3.879447661731332*^9}, 3.8794632161185513`*^9, {
   3.8853778990445137`*^9, 3.885377911699746*^9}, 3.8854946549036627`*^9, 
   3.8938281199947987`*^9, 3.893829905470847*^9, {3.895058174017045*^9, 
   3.8950582029107933`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"8b91c026-fd5c-47f1-80de-d52f62f925ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bins", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Basetri", "//", "Flatten"}], "//", "DeleteDuplicates"}], "//", 
    "Sort"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.879245764667458*^9, 3.8792457698637447`*^9}, {
  3.8794441464211082`*^9, 3.879444146689913*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"2ef8e66b-bc1a-49a7-b486-e62b2c2e89bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Setkmax", "[", "kmax_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"Bins", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmax"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"goodTri", "[", "kmax_", "]"}], " ", ":=", " ", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "Basetri", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"Basetri", ",", 
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{"Bins", ",", 
                RowBox[{"Setkmax", "[", "kmax", "]"}]}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Complement", "[", 
              RowBox[{"Bins", ",", 
               RowBox[{"Setkmax", "[", "kmax", "]"}]}], "]"}], "]"}]}], 
           "}"}]}], "]"}], "//", "Flatten"}], "//", "DeleteDuplicates"}], "//",
       "Sort"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[266]:=",ExpressionUUID->"ac169eaf-46b9-49a6-8dc2-05e54af4af3c"],

Cell["Functions to get kmax", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
  3.878318564396934*^9, 3.8783185665840807`*^9}, {3.8783189236834927`*^9, 
  3.8783189249818363`*^9}, {3.8783193275467777`*^9, 3.878319330519642*^9}, {
  3.887891021467949*^9, 3.8878910250785923`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e1934989-8077-4581-8950-6ef7acb03b7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetSlope", "[", 
    RowBox[{"ku_", ",", "kd_", ",", "pk_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{"ku", "+", "kd"}], ")"}], "2"], 
    FractionBox[
     RowBox[{" ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"pk", "[", "ku", "]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"pk", "[", "kd", "]"}], "]"}]}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{"ku", "-", "kd"}], ")"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8878908470568857`*^9, 3.887890847261978*^9}, 
   3.8878911599409313`*^9, 3.888324731051979*^9},
 CellLabel->
  "In[268]:=",ExpressionUUID->"43e7ebe2-ca3a-4fcd-91c4-38bdb082ef08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get\[Sigma]", "[", 
   RowBox[{"ktab_", ",", " ", "Covinv_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"ktab", ",", 
      FractionBox["1", 
       RowBox[{"Covinv", "//", "mono"}]]}], "}"}]}], "//", 
   "Interpolation"}]}]], "Input",
 CellChangeTimes->{{3.8878895894245663`*^9, 3.887889593822278*^9}, 
   3.887891031010639*^9, 3.887891398560581*^9, {3.895474499402014*^9, 
   3.8954745020893583`*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"6b73722a-25af-4247-a37b-65f1520ece16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]TheoryTree", "[", 
   RowBox[{"k_", ",", "pk_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["k", 
       RowBox[{
        RowBox[{"Getknl", "[", 
         RowBox[{"pk", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]], ")"}], 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"GetSlope", "[", 
        RowBox[{
         RowBox[{"0.8", "k"}], ",", 
         RowBox[{"1.2", "k"}], ",", 
         RowBox[{"pk", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}]}], ")"}]], 
    RowBox[{
     RowBox[{"pk", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], "[", "k", "]"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]Theory", "[", 
   RowBox[{"k_", ",", "pk_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"pk", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], "[", "k", "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["k", 
      RowBox[{
       RowBox[{"Getknl", "[", 
        RowBox[{"pk", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"GetSlope", "[", 
        RowBox[{
         RowBox[{"0.8", "k"}], ",", 
         RowBox[{"1.2", "k"}], ",", 
         RowBox[{"pk", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "]"}]}], ")"}], 
     "2"}]]}]}]}], "Input",
 CellChangeTimes->{{3.887876024641273*^9, 3.887876032657041*^9}, {
   3.887876118946822*^9, 3.8878761632266493`*^9}, {3.887876485906324*^9, 
   3.887876486954945*^9}, {3.887876606156247*^9, 3.887876689052903*^9}, {
   3.887876739023777*^9, 3.887876763618137*^9}, 3.887876803165265*^9, {
   3.8878837925590267`*^9, 3.887883794189258*^9}, {3.8878850502047253`*^9, 
   3.8878850540498943`*^9}, {3.88788833426222*^9, 3.887888334678334*^9}, {
   3.888324747590362*^9, 3.8883247481394577`*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"c2f37409-7ff9-4556-a900-92417adf5ded"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Sigma]Theory2L", "[", 
   RowBox[{"k_", ",", "pk_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"pk", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], "[", "k", "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["k", 
      RowBox[{
       RowBox[{"Getknl", "[", 
        RowBox[{"pk", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"GetSlope", "[", 
        RowBox[{
         RowBox[{"0.8", "k"}], ",", 
         RowBox[{"1.2", "k"}], ",", 
         RowBox[{"pk", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "]"}]}], ")"}], 
     "3"}]]}]}]], "Input",
 CellChangeTimes->{{3.8878858350379047`*^9, 3.887885857278756*^9}, 
   3.887888461114882*^9, 3.887888589270639*^9, {3.887890838780575*^9, 
   3.887890840988697*^9}, {3.887891032090788*^9, 3.887891032447386*^9}, {
   3.888322329412285*^9, 3.888322391006239*^9}, {3.8883231414490643`*^9, 
   3.888323143575495*^9}, 3.888323216434404*^9, 3.888323327410389*^9, {
   3.888324739839572*^9, 3.8883247546766357`*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"7d39743f-e385-45cc-b88e-923ae2acfffc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcCMASSNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "CMASSpk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "CMASSpk", ",", "CMASSspec", ",", 
            "bfixstochBOSSNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.887876844210058*^9, 3.887876858086894*^9}, {
   3.8878770679681587`*^9, 3.8878770729183083`*^9}, {3.887883989862365*^9, 
   3.887884003932568*^9}, {3.887884425042014*^9, 3.8878844334117107`*^9}, {
   3.8878845634770737`*^9, 3.887884564639076*^9}, {3.8878845971212797`*^9, 
   3.8878846010720367`*^9}, {3.887884777334887*^9, 3.887884778697404*^9}, {
   3.887886091746608*^9, 3.887886094095797*^9}, {3.887886167889772*^9, 
   3.8878861693270683`*^9}, {3.887886977448468*^9, 3.887886978930045*^9}, {
   3.887887540243675*^9, 3.887887542468958*^9}, {3.887888340537932*^9, 
   3.887888342360015*^9}, {3.887889235514371*^9, 3.887889277112615*^9}, 
   3.88788935875453*^9, 3.887889503484562*^9, {3.8883863775592823`*^9, 
   3.888386381775695*^9}, {3.894995604371518*^9, 3.8949956052870293`*^9}, {
   3.894995731445126*^9, 3.894995731979794*^9}, 3.8954742948771553`*^9},
 CellLabel->
  "In[273]:=",ExpressionUUID->"dc62c375-d232-4cb7-8008-4a23e13f68c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcCMASSNS2L", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory2L", "[", 
     RowBox[{"k", ",", "CMASSpk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "CMASSpk", ",", "CMASSspec", ",", 
            "bfixstochBOSSNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.888324966236002*^9, 3.888324974370799*^9}, 
   3.895474294878253*^9},
 CellLabel->
  "In[274]:=",ExpressionUUID->"ca5cd71a-99ac-47d9-adc4-d5603ae31de5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcCMASSTNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "CMASSpk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "CMASSpk", ",", "CMASSspec", ",", 
            "bfixstochBOSSNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88832218693019*^9, 3.8883221930685673`*^9}, 
   3.895474294879216*^9},
 CellLabel->
  "In[275]:=",ExpressionUUID->"99b729fc-fd2b-4818-8058-330be67ebe62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getkmax", "[", "func_", "]"}], ":=", 
  RowBox[{
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"func", "[", "k", "]"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "kmx"}], "}"}]}], "]"}], "-", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"funcCMASSNS", "[", "k", "]"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "0.22"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kmx", ",", "0.2"}], "}"}]}], "]"}], "//", "Quiet"}]}]], "Input",
 CellLabel->
  "In[276]:=",ExpressionUUID->"57dac530-c9c2-4b18-ba4f-f3632521a6fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetkmaxT", "[", "func_", "]"}], ":=", 
  RowBox[{
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"func", "[", "k", "]"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "kmx"}], "}"}]}], "]"}], "-", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"funcCMASSTNS", "[", "k", "]"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "0.1"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kmx", ",", "0.1"}], "}"}]}], "]"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.8883222083386602`*^9, 3.888322220781336*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"fd23a89b-b267-4e10-a38d-917255c8e2e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"funcCMASSNS2L", "[", "k", "]"}], "2"], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "kmx"}], "}"}]}], "]"}], "-", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"funcCMASSNS", "[", "k", "]"}], "2"], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0.22"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"kmx", ",", "0.2"}], "}"}]}], "]"}], "//", "Quiet"}]], "Input",
 CellChangeTimes->{3.888324985336132*^9},
 CellLabel->
  "In[278]:=",ExpressionUUID->"5523fdd4-c344-4516-83be-86d1c6f64fab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"kmx", "\[Rule]", "0.26673136988479457`"}], "}"}]], "Output",
 CellChangeTimes->{3.888324998621714*^9, 3.888350794192152*^9, 
  3.8886598567695913`*^9, 3.888922061768496*^9, 3.8890926229411173`*^9, 
  3.890668145529158*^9, 3.892534195375375*^9, 3.892550340726308*^9, 
  3.893773157941637*^9, 3.893793041023842*^9, 3.893797866354969*^9, 
  3.893825353581522*^9, 3.893828011151626*^9, 3.8938309158367*^9, 
  3.893843340563466*^9, 3.893867379402491*^9, 3.8938742254476357`*^9, 
  3.8941948452606916`*^9, 3.894995755891238*^9, 3.895058488079303*^9, 
  3.895475441926998*^9, 3.895998371176324*^9, 3.896278553836274*^9, 
  3.896294305802547*^9, 3.8962981705195827`*^9, 3.896327041042459*^9, 
  3.896412956858602*^9},
 CellLabel->
  "Out[278]=",ExpressionUUID->"5ae786c5-748b-45f3-99fa-14d102a12b63"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getkmax2L", "[", "func_", "]"}], ":=", 
  RowBox[{
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"func", "[", "k", "]"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "kmx"}], "}"}]}], "]"}], "-", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"funcCMASSNS2L", "[", "k", "]"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "0.26673136988479457`"}], "}"}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kmx", ",", "0.25"}], "}"}]}], "]"}], "//", 
   "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.888325015784679*^9, 3.888325019426775*^9}, {
   3.888325154386198*^9, 3.888325159679957*^9}, 3.895058496713338*^9},
 CellLabel->
  "In[279]:=",ExpressionUUID->"94e9a900-9941-4d1f-bb21-33c864a0d6bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pipeline Validation+BOSS results", "Section",
 CellChangeTimes->{{3.873874436782016*^9, 3.873874440817452*^9}, {
  3.8739643915210037`*^9, 3.8739643916267567`*^9}, {3.8739713597098627`*^9, 
  3.873971360089781*^9}, {3.874335391625215*^9, 3.874335393416067*^9}, {
  3.8743951131865683`*^9, 3.874395114134469*^9}, {3.8783307046760273`*^9, 
  3.878330709107346*^9}, {3.895002162765571*^9, 3.895002163896922*^9}, {
  3.8950543274138403`*^9, 
  3.895054332086412*^9}},ExpressionUUID->"3225b65f-519d-4c0c-b83b-\
5075d593e841"],

Cell[CellGroupData[{

Cell["BOSS specifications and derivative computations", "Subsection",
 CellChangeTimes->{{3.878331664336233*^9, 3.878331667108832*^9}, {
  3.878331979807946*^9, 3.878331981863579*^9}, {3.8783783257461557`*^9, 
  3.8783783354989758`*^9}},ExpressionUUID->"071c2664-f748-4df6-ad2a-\
d35e37b2c6ff"],

Cell["\<\
Get kmax for LOWZ (this is just for validation of the formulas. We use the \
same kmax as in the BOSS analyses)\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878396838288425*^9, 3.878396840811236*^9}, {
  3.887891050815291*^9, 3.887891055236865*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"669f2252-f240-427b-a1b1-1d9ceff761cd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcLOWZNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "LOWZpk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSSNS", 
            ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Getkmax", "[", "funcLOWZNS", "]"}]}], "Input",
 CellChangeTimes->{{3.887884222120967*^9, 3.8878842382057533`*^9}, {
   3.887884275152647*^9, 3.8878842790031424`*^9}, {3.8878843212796164`*^9, 
   3.887884361770008*^9}, 3.887889295141453*^9, {3.887889338481331*^9, 
   3.887889361958377*^9}, {3.887889508870927*^9, 3.8878895169366713`*^9}, {
   3.8878908874952593`*^9, 3.887890887715082*^9}, 3.88789107565238*^9, 
   3.888058228220274*^9, {3.892533719347641*^9, 3.892533720052292*^9}, 
   3.8954742948817797`*^9},
 CellLabel->
  "In[537]:=",ExpressionUUID->"fd328fbc-9a30-4cbe-84ec-63e949efd9e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"kmx", "\[Rule]", "0.19219448943811587`"}], "}"}]], "Output",
 CellChangeTimes->{3.887891356562778*^9, 3.887891410387886*^9, 
  3.887892101308775*^9, 3.888388373581171*^9, 3.888659863654825*^9, 
  3.8891492240734987`*^9, 3.890668153155209*^9, 3.8925450395162277`*^9, 
  3.892554734091947*^9, 3.8937731662168207`*^9, 3.893793223584795*^9, 
  3.8937978740648413`*^9, 3.893827788488162*^9, 3.893828018686574*^9, 
  3.894194852645002*^9, 3.894995804076494*^9, 3.895058527414756*^9, 
  3.895476407322094*^9, 3.8962785609543257`*^9, 3.896327047961294*^9, 
  3.8964146853289003`*^9},
 CellLabel->
  "Out[538]=",ExpressionUUID->"9d70af71-e4ee-43c0-aa37-d3d95362feac"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcLOWZNSTree", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "LOWZpk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSSNS", 
            ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetkmaxT", "[", "funcLOWZNSTree", "]"}]}], "Input",
 CellChangeTimes->{{3.889149224022972*^9, 3.88914926010793*^9}, {
   3.89253375355863*^9, 3.8925337542396917`*^9}, 3.892533789498287*^9, 
   3.895474294883216*^9},
 CellLabel->
  "In[539]:=",ExpressionUUID->"29f6852d-47ae-4d70-8130-f70b4dbc7adc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"kmx", "\[Rule]", "0.09393543290031504`"}], "}"}]], "Output",
 CellChangeTimes->{3.889149267412547*^9, 3.8906681601738787`*^9, 
  3.8925450465907393`*^9, 3.89255474119403*^9, 3.89377317300836*^9, 
  3.893793230720098*^9, 3.893797881247884*^9, 3.893827795851713*^9, 
  3.8938280257132473`*^9, 3.894194859484064*^9, 3.8949958109024677`*^9, 
  3.895058534217008*^9, 3.89547641420899*^9, 3.896278568194291*^9, 
  3.896327054768593*^9, 3.89641469244346*^9},
 CellLabel->
  "Out[540]=",ExpressionUUID->"20a30d95-8d5a-433b-8abd-3d27bb724a9a"]
}, Closed]],

Cell["Tab imports", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d728f643-7bde-4f05-b1aa-9d7b5aaf1d43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabCMASS", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<covsks/ktabCMASS.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ktabLOWZ", " ", "=", " ", 
    RowBox[{"Import", "[", "\"\<covsks/ktabLOWZ.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TriCMASSkeff", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<covsks/TriCMASSkeff.mtx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TriLOWZkeff", " ", "=", " ", 
    RowBox[{"Import", "[", "\"\<covsks/TriLOWZkeff.mtx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CMASStriangs", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CMASStriangs.mtx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZtriangs", "=", 
   RowBox[{"Import", "[", "\"\<covsks/LOWZtriangs.mtx\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873468583303989*^9, 3.873468660291182*^9}, {
   3.87387514677607*^9, 3.873875146950919*^9}, {3.873964428032702*^9, 
   3.873964462207315*^9}, 3.8739665707698593`*^9, {3.87396675335675*^9, 
   3.8739667596310387`*^9}, {3.873971006821004*^9, 3.873971008067816*^9}, {
   3.8783319345931463`*^9, 3.878331935928195*^9}, {3.893828119995943*^9, 
   3.893828119999086*^9}, {3.893829905471705*^9, 3.893829905474204*^9}},
 CellLabel->
  "In[541]:=",ExpressionUUID->"7c4ba6ac-c497-4bd6-b4b5-88514e4596e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CMASStriangsbins", "=", 
   RowBox[{
    RowBox[{"CMASStriangs", "//", "Flatten"}], "//", "DeleteDuplicates"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZtriangsbins", "=", 
   RowBox[{
    RowBox[{"LOWZtriangs", "//", "Flatten"}], "//", "DeleteDuplicates"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8891501052581*^9, 3.889150113202238*^9}, {
  3.889150265577065*^9, 3.8891502746919003`*^9}, {3.892665929531816*^9, 
  3.8926659302025843`*^9}},
 CellLabel->
  "In[547]:=",ExpressionUUID->"4bd29d90-5c7f-4c92-9ef8-ed92c92f77e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CMASSTreepos", "=", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
     "20", ",", "21", ",", "22", ",", "23", ",", "24", ",", "26", ",", "44", 
     ",", "45", ",", "48", ",", "70"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZTreepos", "=", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "14", ",", "15", ",", 
     "17", ",", "29"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889150315806789*^9, 3.8891503320706663`*^9}},
 CellLabel->
  "In[549]:=",ExpressionUUID->"1c91f8ed-c2c0-4082-9497-da446e9a300b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CMASStriangsT", "=", 
   RowBox[{"CMASStriangs", "[", 
    RowBox[{"[", "CMASSTreepos", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZtriangsT", "=", 
   RowBox[{"LOWZtriangs", "[", 
    RowBox[{"[", "LOWZTreepos", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889150359207098*^9, 3.889150398765655*^9}},
 CellLabel->
  "In[551]:=",ExpressionUUID->"30571f7b-5a50-4544-acff-7b3bb86e9190"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TriCMASSkeffT", "=", 
   RowBox[{"TriCMASSkeff", "[", 
    RowBox[{"[", "CMASSTreepos", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TriLOWZkeffT", "=", 
   RowBox[{"TriLOWZkeff", "[", 
    RowBox[{"[", "LOWZTreepos", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889150388889104*^9, 3.8891504008924847`*^9}},
 CellLabel->
  "In[553]:=",ExpressionUUID->"8239a810-885a-45cd-9827-d183390d06b4"],

Cell["Binning sizes", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781577058616667`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2af02326-1674-41d7-85aa-e81dc4afd9c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dkP", " ", "=", " ", 
   RowBox[{"dk", "->", "0.01"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dkBCMASS", "=", 
   RowBox[{"dk", "->", "0.02154"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dkBLOWZ", "=", 
   RowBox[{"dk", "->", "0.02459"}]}], ";"}]}], "Input",
 CellLabel->
  "In[555]:=",ExpressionUUID->"ef045e86-fd40-48f6-8106-8d9c74d817d2"],

Cell["Analytical Covariance with Full redshift", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.878383948812495*^9, 3.878383950482119*^9}, {
  3.878386152574986*^9, 3.8783861554874563`*^9}, {3.8783863995820503`*^9, 
  3.8783864090286303`*^9}, {3.878389253828569*^9, 3.878389261403257*^9}, {
  3.878389696132431*^9, 3.878389697083682*^9}, {3.878391368215104*^9, 
  3.878391370393168*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9c81425c-01e7-46b9-85e4-12e2aaee0aee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVCMASSP", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabCMASS", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSS", ",", 
     "dkP"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVLOWZP", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabLOWZ", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSS", ",", 
     "dkP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.885484403806097*^9, 3.885484416717572*^9}, {
  3.886830491603899*^9, 3.886830492342593*^9}, {3.892533805835065*^9, 
  3.892533806275154*^9}, {3.8954742948847933`*^9, 3.8954742948851624`*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"fc4f5322-c130-4e0e-abf1-f834db71cc2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVCMASSB", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "CMASStriangs", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSS", 
     ",", "dkBCMASS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVLOWZB", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "LOWZtriangs", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSS", ",", 
     "dkBLOWZ"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8783896333113213`*^9, 3.87838968310667*^9}, {
   3.885484443395198*^9, 3.885484461759823*^9}, 3.885536940344656*^9, {
   3.892533806656765*^9, 3.892533807024271*^9}, {3.895474420600909*^9, 
   3.89547442060168*^9}},
 CellLabel->
  "In[580]:=",ExpressionUUID->"0bd2f8c1-abf9-4c6c-83a6-8fc25b049409"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVCMASSBT", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "CMASStriangsT", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSS", 
     ",", "dkBCMASS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVLOWZBT", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "LOWZtriangsT", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSS", ",",
      "dkBLOWZ"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895474420603303*^9, 3.895474420603753*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"9c6ec5de-1bbc-4dcd-9226-5bb1ecf6b13d"],

Cell["Analytical Covariance with Full redshift- No shot noise", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.878383948812495*^9, 3.878383950482119*^9}, {
  3.878386152574986*^9, 3.8783861554874563`*^9}, {3.8783863995820503`*^9, 
  3.8783864090286303`*^9}, {3.878389253828569*^9, 3.878389261403257*^9}, {
  3.878389696132431*^9, 3.878389697083682*^9}, {3.878391368215104*^9, 
  3.878391370393168*^9}, {3.8783917561480427`*^9, 3.878391759615937*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"75431f4d-d52f-411e-81f5-e7fbd0f31ac3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVCMASSPNS", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabCMASS", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSSNS", 
     ",", "dkP"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVLOWZPNS", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabLOWZ", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSSNS", ",", 
     "dkP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.885484403806097*^9, 3.885484416717572*^9}, {
  3.885484570829022*^9, 3.885484583031292*^9}, {3.8925338074743347`*^9, 
  3.8925338076971617`*^9}, {3.895474294886269*^9, 3.895474294886634*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"0a992fdc-9990-4023-b4ad-b15d69dc4a3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVCMASSBNS", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "CMASStriangs", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSSNS", 
     ",", "dkBCMASS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVLOWZBNS", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "LOWZtriangs", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSSNS", 
     ",", "dkBLOWZ"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8783896333113213`*^9, 3.87838968310667*^9}, {
   3.885484443395198*^9, 3.885484461759823*^9}, {3.885484575288108*^9, 
   3.885484586561069*^9}, 3.8855369425643587`*^9, {3.892533808018847*^9, 
   3.892533808301463*^9}, {3.8954744206048822`*^9, 3.8954744206052837`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"07c11a4d-0ada-4728-82c0-0779a5299284"],

Cell["Powerspectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332301420657*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5e7161e4-8219-46db-8980-5105f3d8a6d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSngcderivs", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabCMASS", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixCMASSngc"}], ",", "si"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PCMASSsgcderivs", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabCMASS", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixCMASSsgc"}], ",", "si"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZngcderivs", " ", "=", 
   RowBox[{"Monitor", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabLOWZ", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixLOWZngc"}], ",", "si"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZsgcderivs", " ", "=", 
   RowBox[{"Monitor", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabLOWZ", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixLOWZsgc"}], ",", "si"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873518998897326*^9, 3.873519007688743*^9}, {
   3.873519068623493*^9, 3.873519077607183*^9}, {3.873519615193363*^9, 
   3.873519620203136*^9}, {3.8735196572278223`*^9, 3.8735196641762877`*^9}, {
   3.873875798249857*^9, 3.873875813066736*^9}, {3.873966975417568*^9, 
   3.87396704163301*^9}, 3.873967115591464*^9, 3.878332335499425*^9, {
   3.878385477696348*^9, 3.878385485946587*^9}, {3.878840787515625*^9, 
   3.878840798469812*^9}, {3.890889878569715*^9, 3.8908898873868313`*^9}, {
   3.890894978744554*^9, 3.890894983779361*^9}, {3.892545078718499*^9, 
   3.892545101123992*^9}, {3.892545175198453*^9, 3.892545190889317*^9}, {
   3.8925456387861013`*^9, 3.8925456461750402`*^9}, {3.892555973043233*^9, 
   3.8925559773311577`*^9}, {3.892649727458186*^9, 3.8926497428721848`*^9}, {
   3.8926659545742483`*^9, 3.8926659696624937`*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"1861a821-987b-4a16-9ac0-1e30eb191c2b"],

Cell["Powerspectrum Derivatives with AP", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332301420657*^9}, {3.892665943590253*^9, 3.892665944620442*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c6ee5498-36e9-43d1-989d-56977445ce0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSngcderivsAP", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1LoopderivsAP", "[", 
          RowBox[{
           RowBox[{"ktabCMASS", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk", ",", "0.57"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixCMASSngc"}], ",", "si"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PCMASSsgcderivsAP", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1LoopderivsAP", "[", 
          RowBox[{
           RowBox[{"ktabCMASS", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk", ",", "0.57"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixCMASSsgc"}], ",", "si"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZngcderivsAP", " ", "=", 
   RowBox[{"Monitor", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1LoopderivsAP", "[", 
          RowBox[{
           RowBox[{"ktabLOWZ", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk", ",", "0.32"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixLOWZngc"}], ",", "si"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZsgcderivsAP", " ", "=", 
   RowBox[{"Monitor", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1LoopderivsAP", "[", 
          RowBox[{
           RowBox[{"ktabLOWZ", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk", ",", "0.32"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixLOWZsgc"}], ",", "si"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873518998897326*^9, 3.873519007688743*^9}, {
   3.873519068623493*^9, 3.873519077607183*^9}, {3.873519615193363*^9, 
   3.873519620203136*^9}, {3.8735196572278223`*^9, 3.8735196641762877`*^9}, {
   3.873875798249857*^9, 3.873875813066736*^9}, {3.873966975417568*^9, 
   3.87396704163301*^9}, 3.873967115591464*^9, 3.878332335499425*^9, {
   3.878385477696348*^9, 3.878385485946587*^9}, {3.878840787515625*^9, 
   3.878840798469812*^9}, {3.890889878569715*^9, 3.8908898873868313`*^9}, {
   3.890894978744554*^9, 3.890894983779361*^9}, {3.892545078718499*^9, 
   3.892545101123992*^9}, {3.892545175198453*^9, 3.892545190889317*^9}, {
   3.8925456387861013`*^9, 3.8925456461750402`*^9}, {3.892555973043233*^9, 
   3.8925559773311577`*^9}, {3.892649727458186*^9, 3.8926497428721848`*^9}, {
   3.892665946199472*^9, 3.892665979898628*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"20c3bd50-87ac-453b-81b0-fb850c4426cc"],

Cell["Powerspectrum Derivatives 2 loop", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332301420657*^9}, {3.8798091939415627`*^9, 3.879809195001499*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"68f4c5ac-7289-4b31-918a-9c52845206ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabraw2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"0.001`", "+", 
      RowBox[{"i", " ", "0.01"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "300"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktab2CMASS", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw2", ",", 
     RowBox[{
      RowBox[{"#", "<", "0.28082275802205403`"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktab2LOWZ", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw2", ",", 
     RowBox[{
      RowBox[{"#", "<", "0.2411136157029445`"}], "&"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879809244602491*^9, 3.879809257529707*^9}, {
  3.879809568578637*^9, 3.879809579414398*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"0bb4794a-7f51-4490-9612-c6626f6ebfa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSngcderivs2L", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktab2CMASS", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "CMASSpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktab2CMASS", "]"}]}], "}"}]}], "]"}], "/.",
        "coeffixBOSS"}], "/.", "nbfixCMASSngc"}], ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PCMASSsgcderivs2L", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktab2CMASS", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "CMASSpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktab2CMASS", "]"}]}], "}"}]}], "]"}], "/.",
        "coeffixBOSS"}], "/.", "nbfixCMASSsgc"}], ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZngcderivs2L", " ", "=", 
   RowBox[{"Monitor", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktab2LOWZ", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "LOWZpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktab2LOWZ", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixLOWZngc"}], ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZsgcderivs2L", " ", "=", 
   RowBox[{"Monitor", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktab2LOWZ", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "LOWZpk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktab2LOWZ", "]"}]}], "}"}]}], "]"}], "/.", 
       "coeffixBOSS"}], "/.", "nbfixLOWZsgc"}], ",", "i"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8798095863040237`*^9, 3.8798096053586597`*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"8912f5ab-f424-4ad3-bb1d-401c6fbc684b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVCMASSP2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktab2CMASS", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSS", ",",
      "dkP"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVLOWZP2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktab2LOWZ", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSS", ",", 
     "dkP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.885484798087385*^9, 3.8854848022550697`*^9}, {
  3.892533809793829*^9, 3.892533809941695*^9}, {3.895474294887807*^9, 
  3.895474294888178*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"53042cb9-557a-420c-b959-65a143c41fad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVCMASSPNS2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktab2CMASS", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSSNS", 
     ",", "dkP"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVLOWZPNS2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktab2LOWZ", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSSNS", ",", 
     "dkP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879809620153837*^9, 3.8798096484025927`*^9}, {
  3.8854847609641237`*^9, 3.885484791415701*^9}, {3.892533810928488*^9, 
  3.8925338110912046`*^9}, {3.895474294889295*^9, 3.8954742948896627`*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"c570841a-ae08-4945-a3c2-ed30c7bb3811"],

Cell["Bispectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e982ec4d-75ee-474e-a58e-e66af0548039"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BderivsCMASSAPcorr", " ", "=", " ", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"B1LoopderivsAPcorr", "[", 
          RowBox[{
           RowBox[{"TriCMASSkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk", ",", "0.57"}], 
          "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}], ",",
       "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8926469052499228`*^9, 3.892646918573751*^9}, {
  3.892666105679304*^9, 3.892666113086622*^9}},
 CellLabel->
  "In[562]:=",ExpressionUUID->"53c4ef06-8460-48ac-b9f9-12d0f564e7b7"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.895477594154352*^9, 3.8962795593609324`*^9, 
  3.896327996658389*^9, 3.896414726394114*^9},
 CellLabel->
  "Out[562]=",ExpressionUUID->"e2a8cf18-ecb4-4efb-8c15-36f3c47753eb"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BderivsLOWZAPcorr", " ", "=", " ", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"B1LoopderivsAPcorr", "[", 
          RowBox[{
           RowBox[{"TriLOWZkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk", ",", "0.32"}], 
          "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.892646937088172*^9, 3.892646937512527*^9}, {
  3.892666107793832*^9, 3.89266610808959*^9}, {3.892666204244939*^9, 
  3.892666209436143*^9}, {3.893775049995058*^9, 3.893775055608242*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"aacf9bd8-9533-4ae1-a61d-b9c17d82421b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"39.449473`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.892646990875054*^9, 3.8926496377200003`*^9, 
  3.892666490502081*^9, 3.893774066278496*^9, 3.8937750965557737`*^9, 
  3.8937950958296623`*^9, 3.8937988109425707`*^9, 3.8938291694701233`*^9, 
  3.894195791474825*^9, 3.8942724352982597`*^9, 3.894997486120721*^9, 
  3.894999658977683*^9, 3.8954776343823347`*^9, 3.8962796017736073`*^9, 
  3.896328036133657*^9},
 CellLabel->
  "Out[340]=",ExpressionUUID->"ac8709e2-7604-4cdf-a496-6fbfc8a70106"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BderivsCMASSkeffpre", " ", "=", " ", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"B1Loopderivs", "[", 
          RowBox[{
           RowBox[{"TriCMASSkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}], ",",
       "si"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BderivsLOWZkeffpre", " ", "=", " ", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"B1Loopderivs", "[", 
          RowBox[{
           RowBox[{"TriLOWZkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{
  3.878378343840803*^9, 3.878385486956921*^9, 3.87850040613809*^9, {
   3.8785004390153847`*^9, 3.878500439469307*^9}, {3.880015499669732*^9, 
   3.880015500346471*^9}, {3.890889976213097*^9, 3.8908899817256613`*^9}, {
   3.890894988517914*^9, 3.890894990278867*^9}},
 CellLabel->
  "In[563]:=",ExpressionUUID->"526b1490-b2ad-4f2a-b86a-a3a22175621f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"447.514629`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.878379206922092*^9, 3.8784931575250463`*^9, 
  3.878493842949676*^9, 3.8785008677313004`*^9, 3.878562553163477*^9, 
  3.8788240334401283`*^9, 3.878826806699842*^9, 3.8794642899527617`*^9, 
  3.8800154616411743`*^9, 3.880015916301833*^9, 3.880055048388447*^9, 
  3.883948940846966*^9, 3.884002663756353*^9, 3.885486080021986*^9, 
  3.8855389996586246`*^9, 3.885555283531497*^9, 3.886831748802897*^9, 
  3.886933874742138*^9, 3.887737165063889*^9, 3.887892901510947*^9, 
  3.888389221348207*^9, 3.888660651719941*^9, 3.890890472484522*^9, 
  3.892555532179576*^9, 3.893774510322587*^9, 3.893795557252096*^9, 
  3.8937992653526382`*^9, 3.893829611674385*^9, 3.89419624021625*^9, 
  3.8949979238030767`*^9, 3.895478240979466*^9, 3.896280068833173*^9, 
  3.8963284709179373`*^9, 3.8964151763991756`*^9},
 CellLabel->
  "Out[563]=",ExpressionUUID->"368a7946-9a75-47d5-a12b-b27068feea97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"190.943797`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.878379206922092*^9, 3.8784931575250463`*^9, 
  3.878493842949676*^9, 3.8785008677313004`*^9, 3.878562553163477*^9, 
  3.8788240334401283`*^9, 3.878826806699842*^9, 3.8794642899527617`*^9, 
  3.8800154616411743`*^9, 3.880015916301833*^9, 3.880055048388447*^9, 
  3.883948940846966*^9, 3.884002663756353*^9, 3.885486080021986*^9, 
  3.8855389996586246`*^9, 3.885555283531497*^9, 3.886831748802897*^9, 
  3.886933874742138*^9, 3.887737165063889*^9, 3.887892901510947*^9, 
  3.888389221348207*^9, 3.888660651719941*^9, 3.890890472484522*^9, 
  3.892555532179576*^9, 3.893774510322587*^9, 3.893795557252096*^9, 
  3.8937992653526382`*^9, 3.893829611674385*^9, 3.89419624021625*^9, 
  3.8949979238030767`*^9, 3.895478240979466*^9, 3.896280068833173*^9, 
  3.8963284709179373`*^9, 3.896415367344308*^9},
 CellLabel->
  "Out[564]=",ExpressionUUID->"4d25b230-0503-49c0-a582-088b105c925b"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BderivsCMASSkeffpreAP", "=", 
   RowBox[{"BderivsCMASSkeffpre", "+", "BderivsCMASSAPcorr"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsLOWZkeffpreAP", "=", 
   RowBox[{"BderivsLOWZkeffpre", "+", "BderivsLOWZAPcorr"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8926469460253687`*^9, 3.892646964006476*^9}, {
  3.8926661341192217`*^9, 3.892666141590303*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"efa9e400-85ea-4f66-b927-ace5d1a73be8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoopsubCMASS", "=", 
   RowBox[{
    RowBox[{"BLoopsub", "[", "CMASSpk", "]"}], "/.", 
    RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoopsubLOWZ", "=", 
   RowBox[{
    RowBox[{"BLoopsub", "[", "LOWZpk", "]"}], "/.", 
    RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.88650853181662*^9, 3.8865085669867373`*^9}, 
   3.886509717798273*^9, {3.886509805455085*^9, 3.8865098063303537`*^9}, {
   3.890890112687315*^9, 3.890890113573494*^9}, {3.890894992403178*^9, 
   3.890894994261445*^9}},
 CellLabel->
  "In[565]:=",ExpressionUUID->"ee0b1541-9c8d-4dbd-af75-2d2296553ccc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BderivsCMASSkeffCMASSngc", "=", 
   RowBox[{
    RowBox[{"BderivsCMASSkeffpre", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubCMASS", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixCMASSngc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsCMASSkeffCMASSsgc", "=", 
   RowBox[{
    RowBox[{"BderivsCMASSkeffpre", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubCMASS", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixCMASSsgc"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878500473431449*^9, 3.878500474187036*^9}, {
   3.886508573341136*^9, 3.886508577455991*^9}, 3.886509556692789*^9, {
   3.886509653805912*^9, 3.886509680217519*^9}, {3.892646969421626*^9, 
   3.892646971417033*^9}, {3.8926661635150127`*^9, 3.892666164975254*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"627cea80-632b-4711-b4e4-380d3dc029ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BderivsLOWZkeffLOWZngc", "=", 
   RowBox[{
    RowBox[{"BderivsLOWZkeffpre", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubLOWZ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixLOWZngc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsLOWZkeffLOWZsgc", "=", 
   RowBox[{
    RowBox[{"BderivsLOWZkeffpre", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubLOWZ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixLOWZsgc"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87850047623808*^9, 3.878500477109908*^9}, {
  3.886509687991029*^9, 3.88650970624205*^9}, {3.892646972589821*^9, 
  3.8926469734399557`*^9}, {3.892666156435371*^9, 3.892666157281452*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"02a76096-dd69-4800-b2ee-9b0b7379301a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BderivsCMASSkeffCMASSngcAP", "=", 
   RowBox[{
    RowBox[{"BderivsCMASSkeffpreAP", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubCMASS", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixCMASSngc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsCMASSkeffCMASSsgcAP", "=", 
   RowBox[{
    RowBox[{"BderivsCMASSkeffpreAP", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubCMASS", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixCMASSsgc"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878500473431449*^9, 3.878500474187036*^9}, {
   3.886508573341136*^9, 3.886508577455991*^9}, 3.886509556692789*^9, {
   3.886509653805912*^9, 3.886509680217519*^9}, {3.892646969421626*^9, 
   3.892646971417033*^9}, {3.892666160000486*^9, 3.892666185836061*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"57588a01-cf26-441d-814c-3fb6682819de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BderivsLOWZkeffLOWZngcAP", "=", 
   RowBox[{
    RowBox[{"BderivsLOWZkeffpreAP", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubLOWZ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixLOWZngc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsLOWZkeffLOWZsgcAP", "=", 
   RowBox[{
    RowBox[{"BderivsLOWZkeffpreAP", "-", 
     RowBox[{"Table", "[", 
      RowBox[{"LoopsubLOWZ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}]}], "/.",
     "nbfixLOWZsgc"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87850047623808*^9, 3.878500477109908*^9}, {
  3.886509687991029*^9, 3.88650970624205*^9}, {3.892646972589821*^9, 
  3.8926469734399557`*^9}, {3.892666167053837*^9, 3.8926661825561333`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"81b1f74f-d090-4018-98b1-56eb58a4edc6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Validation of full P result", "Subsection",
 CellChangeTimes->{{3.872427699487052*^9, 3.872427700735634*^9}, {
   3.8724283585009527`*^9, 3.872428365057477*^9}, {3.873874477379335*^9, 
   3.8738744892592897`*^9}, {3.873876828278769*^9, 3.873876829135406*^9}, 
   3.878332540905488*^9, {3.87858694572862*^9, 3.878586950109029*^9}, {
   3.895054467632114*^9, 
   3.895054472298827*^9}},ExpressionUUID->"2a8d907d-906f-43e7-8436-\
1cbe1be557d8"],

Cell["\<\
reduce derivatives to monopole and quadrupole for the powerspectrum\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.8783324757624073`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"89c5f5da-2d88-404e-ad74-08779ead8d22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSngcderivsmonoquadAP", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PCMASSngcderivsAP", "]"}], ",", 
     RowBox[{"quad", "[", "PCMASSngcderivsAP", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PCMASSsgcderivsmonoquadAP", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PCMASSsgcderivsAP", "]"}], ",", 
     RowBox[{"quad", "[", "PCMASSsgcderivsAP", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZngcderivsmonoquadAP", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PLOWZngcderivsAP", "]"}], ",", 
     RowBox[{"quad", "[", "PLOWZngcderivsAP", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZsgcderivsmonoquadAP", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PLOWZsgcderivsAP", "]"}], ",", 
     RowBox[{"quad", "[", "PLOWZsgcderivsAP", "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87396712513303*^9, 3.873967176088191*^9}, {
  3.892666722626319*^9, 3.8926667336212378`*^9}, {3.8942742517780113`*^9, 
  3.894274256991194*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"513adf81-072c-4099-a59d-b09733335702"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSngcderivsmonoquad", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PCMASSngcderivs", "]"}], ",", 
     RowBox[{"quad", "[", "PCMASSngcderivs", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PCMASSsgcderivsmonoquad", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PCMASSsgcderivs", "]"}], ",", 
     RowBox[{"quad", "[", "PCMASSsgcderivs", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZngcderivsmonoquad", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PLOWZngcderivs", "]"}], ",", 
     RowBox[{"quad", "[", "PLOWZngcderivs", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZsgcderivsmonoquad", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"mono", "[", "PLOWZsgcderivs", "]"}], ",", 
     RowBox[{"quad", "[", "PLOWZsgcderivs", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894274261381205*^9, 3.894274275485664*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"b47e8bc4-7299-416c-bd2d-642e6ec56524"],

Cell["Covariances", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.873875578190517*^9, 
  3.8738755797976418`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"432e0d09-afd8-491f-af6f-ececd4cb2ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CovPInvCMASSngc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPCMASSngc.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CovPInvCMASSsgc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPCMASSsgc.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CovPInvLOWZngc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPLOWZngc.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CovPInvLOWZsgc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPLOWZsgc.mx\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873967274181652*^9, 3.873967299948895*^9}, {
  3.873967485195999*^9, 3.873967512054242*^9}, {3.87858698178209*^9, 
  3.878587031002468*^9}, {3.893828120000668*^9, 3.893828120002302*^9}, {
  3.893829905475419*^9, 3.8938299054769583`*^9}, {3.895474294893382*^9, 
  3.895474294896063*^9}, {3.895478540486498*^9, 3.895478544493918*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"071a26df-14d5-46b1-afb9-49c6163798c3"],

Cell["Fisher - numerical", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428266278404*^9}, {3.872428348503667*^9, 3.872428350697707*^9}, {
   3.873360207213697*^9, 3.87336020838678*^9}, 3.8738758174262657`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"6ba684cf-47eb-4a02-ac55-d9458e0fb255"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CMASSNGCFisherFullPAP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvCMASSngc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PCMASSngcderivsmonoquadAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvCMASSngc", "]"}], ".", 
      "PCMASSngcderivsmonoquadAP"}]}], "//", "Quiet"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CMASSSGCFisherFullPAP", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvCMASSsgc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PCMASSsgcderivsmonoquadAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvCMASSsgc", "]"}], ".", 
      "PCMASSsgcderivsmonoquadAP"}]}], "//", "Quiet"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZNGCFisherFullPAP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvLOWZngc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PLOWZngcderivsmonoquadAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvLOWZngc", "]"}], ".", 
      "PLOWZngcderivsmonoquadAP"}]}], "//", "Quiet"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZSGCFisherFullPAP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvLOWZsgc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PLOWZsgcderivsmonoquadAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvLOWZsgc", "]"}], ".", 
      "PLOWZsgcderivsmonoquadAP"}]}], "//", "Quiet"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873519794638896*^9, 3.873519800457526*^9}, {
  3.873519853144224*^9, 3.8735198641415367`*^9}, {3.87360681547532*^9, 
  3.8736068199775057`*^9}, {3.8738753726751137`*^9, 3.8738753729909763`*^9}, {
  3.873875936961404*^9, 3.8738759393605013`*^9}, {3.873967551111903*^9, 
  3.8739675591602573`*^9}, {3.878587039138103*^9, 3.878587104551463*^9}, {
  3.892666738875292*^9, 3.892666748943486*^9}, {3.894274309616478*^9, 
  3.894274326461238*^9}, {3.895474294897586*^9, 3.89547429490096*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"a779d2f1-05ca-4afe-a2ab-56ec7d4eba79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CMASSNGCFisherFullP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvCMASSngc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PCMASSngcderivsmonoquad", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvCMASSngc", "]"}], ".", 
      "PCMASSngcderivsmonoquad"}]}], "//", "Quiet"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CMASSSGCFisherFullP", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvCMASSsgc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PCMASSsgcderivsmonoquad", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvCMASSsgc", "]"}], ".", 
      "PCMASSsgcderivsmonoquad"}]}], "//", "Quiet"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZNGCFisherFullP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvLOWZngc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PLOWZngcderivsmonoquad", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvLOWZngc", "]"}], ".", 
      "PLOWZngcderivsmonoquad"}]}], "//", "Quiet"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LOWZSGCFisherFullP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvLOWZsgc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PLOWZsgcderivsmonoquad", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvLOWZsgc", "]"}], ".", 
      "PLOWZsgcderivsmonoquad"}]}], "//", "Quiet"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894274292157995*^9, 3.894274306453535*^9}, {
  3.895474294902388*^9, 3.895474294905382*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"68c44258-5c7a-4b39-a2b3-98155310d943"]
}, Closed]],

Cell[CellGroupData[{

Cell["Validation of  PB result", "Subsection",
 CellChangeTimes->{{3.872427699487052*^9, 3.872427700735634*^9}, {
   3.8724283585009527`*^9, 3.872428365057477*^9}, {3.873874477379335*^9, 
   3.8738744892592897`*^9}, {3.873876828278769*^9, 3.873876829135406*^9}, 
   3.878332540905488*^9, 3.87858694572862*^9, 
   3.895054476093079*^9},ExpressionUUID->"a4bb627d-24c7-4668-852c-\
e4379e093569"],

Cell["reduce derivatives to monopole  for the Bispectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"56ee3f27-bc02-4aa0-b820-acd1b3eff5b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BderivsCMASSngckeffmonoAP", "=", " ", 
   RowBox[{"BderivsCMASSkeffCMASSngcAP", ".", "Blooplistmono"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsCMASSsgckeffmonoAP", "=", " ", 
   RowBox[{"BderivsCMASSkeffCMASSsgcAP", ".", "Blooplistmono"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsLOWZngckeffmonoAP", "=", " ", 
   RowBox[{"BderivsLOWZkeffLOWZngcAP", ".", "Blooplistmono"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsLOWZsgckeffmonoAP", "=", " ", 
   RowBox[{"BderivsLOWZkeffLOWZsgcAP", ".", "Blooplistmono"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.873967122403302*^9, {3.873967179838984*^9, 3.873967223177074*^9}, {
   3.878332483500607*^9, 3.878332496881269*^9}, 3.8783783670548687`*^9, {
   3.8926667809238987`*^9, 3.892666787989131*^9}, {3.894274334632707*^9, 
   3.894274339639145*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"17e8dbe0-9e5a-4d3a-b6de-442977ed23a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BderivsCMASSngckeffmono", "=", " ", 
   RowBox[{"BderivsCMASSkeffCMASSngc", ".", "Blooplistmono"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsCMASSsgckeffmono", "=", " ", 
   RowBox[{"BderivsCMASSkeffCMASSsgc", ".", "Blooplistmono"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsLOWZngckeffmono", "=", " ", 
   RowBox[{"BderivsLOWZkeffLOWZngc", ".", "Blooplistmono"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BderivsLOWZsgckeffmono", "=", " ", 
   RowBox[{"BderivsLOWZkeffLOWZsgc", ".", "Blooplistmono"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.894274343758069*^9, 3.894274350732737*^9}},
 CellLabel->
  "In[383]:=",ExpressionUUID->"2534790b-eb69-4836-8b1b-b5c3069638a1"],

Cell["Combine powerspectrum and bispectrum data vectors", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332515815308*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2fcf3089-9b84-4afa-ad65-5d0e14941795"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CMASSngcPBderivsAP", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "PCMASSngcderivsmonoquadAP", " ", ",", "BderivsCMASSngckeffmonoAP"}], 
     " ", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CMASSsgcPBderivsAP", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "PCMASSsgcderivsmonoquadAP", " ", ",", "BderivsCMASSsgckeffmonoAP"}], 
     " ", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LOWZngcPBderivsAP", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "PLOWZngcderivsmonoquadAP", " ", ",", "BderivsLOWZngckeffmonoAP"}], " ", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LOWZsgcPBderivsAP", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "PLOWZsgcderivsmonoquadAP", " ", ",", "BderivsLOWZsgckeffmonoAP"}], " ", 
     "]"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.8739672272824383`*^9, 3.873967269257029*^9}, {
  3.894274363006177*^9, 3.894274385529409*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"72e1d168-d7cd-4a6c-b021-bdacf564575b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CMASSngcPBderivs", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"PCMASSngcderivsmonoquad", ",", "BderivsCMASSngckeffmono"}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CMASSsgcPBderivs", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"PCMASSsgcderivsmonoquad", ",", "BderivsCMASSsgckeffmono"}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LOWZngcPBderivs", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"PLOWZngcderivsmonoquad", ",", "BderivsLOWZngckeffmono"}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LOWZsgcPBderivs", " ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"PLOWZsgcderivsmonoquad", ",", "BderivsLOWZsgckeffmono"}], 
     "]"}]}], ";"}], " "}]}], "Input",
 CellLabel->
  "In[391]:=",ExpressionUUID->"a9bd2f3a-d868-46d3-bb27-32f1fae248ac"],

Cell["Covariances", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.873875578190517*^9, 
  3.8738755797976418`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"cea83e78-1547-45fc-bd2d-029c2eead01a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CovPInvBCMASSngc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPBCMASSngc.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CovPInvBCMASSsgc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPBCMASSsgc.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CovPInvBLOWZngc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPBLOWZngc.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CovPInvBLOWZsgc", "=", 
   RowBox[{"Import", "[", "\"\<covsks/CovPBLOWZsgc.mx\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873967274181652*^9, 3.873967299948895*^9}, {
  3.873967485195999*^9, 3.873967512054242*^9}, {3.893828120003055*^9, 
  3.893828120004636*^9}, {3.8938299054910707`*^9, 3.8938299054925137`*^9}, {
  3.895474294906543*^9, 3.895474294909115*^9}, {3.895478558752522*^9, 
  3.895478563312295*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"49d67d3e-fcc0-48ce-ae0d-1290c641f811"],

Cell["Fisher - numerical", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428266278404*^9}, {3.872428348503667*^9, 3.872428350697707*^9}, {
   3.873360207213697*^9, 3.87336020838678*^9}, 3.8738758174262657`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d9a350d3-4e95-45a6-972a-ef83bc61f04f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CMASSNGCFisherFullPBAP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvBCMASSngc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CMASSngcPBderivsAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvBCMASSngc", "]"}], ".", 
      "CMASSngcPBderivsAP"}]}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873519794638896*^9, 3.873519800457526*^9}, {
  3.873519853144224*^9, 3.8735198641415367`*^9}, {3.87360681547532*^9, 
  3.8736068199775057`*^9}, {3.8738753726751137`*^9, 3.8738753729909763`*^9}, {
  3.873875936961404*^9, 3.8738759393605013`*^9}, {3.873967551111903*^9, 
  3.8739675591602573`*^9}, {3.892666797611244*^9, 3.8926667976836643`*^9}, {
  3.89427440089855*^9, 3.894274405907609*^9}, {3.895474294910141*^9, 
  3.895474294910515*^9}},
 CellLabel->
  "In[399]:=",ExpressionUUID->"d28b32bd-0e5e-4e5a-a221-f7d7d7b08771"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CMASSSGCFisherFullPBAP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvBCMASSsgc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CMASSsgcPBderivsAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvBCMASSsgc", "]"}], ".", 
      "CMASSsgcPBderivsAP"}]}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873967538631435*^9, 3.873967538710552*^9}, {
  3.873967569391849*^9, 3.873967579781262*^9}, {3.8926667998085012`*^9, 
  3.89266679986099*^9}, {3.894274407035872*^9, 3.8942744083729973`*^9}, {
  3.8954742949115047`*^9, 3.895474294911875*^9}},
 CellLabel->
  "In[400]:=",ExpressionUUID->"236bac65-7bc2-4b1d-ba60-7d7e474dc354"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LOWZNGCFisherFullPBAP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvBLOWZngc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"LOWZngcPBderivsAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvBLOWZngc", "]"}], ".", 
      "LOWZngcPBderivsAP"}]}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873519794638896*^9, 3.873519800457526*^9}, {
  3.873519853144224*^9, 3.8735198641415367`*^9}, {3.87360681547532*^9, 
  3.8736068199775057`*^9}, {3.8738753726751137`*^9, 3.8738753729909763`*^9}, {
  3.873875936961404*^9, 3.8738759393605013`*^9}, {3.873967551111903*^9, 
  3.8739675591602573`*^9}, {3.873967600696082*^9, 3.873967601839353*^9}, {
  3.892666801185108*^9, 3.892666801283126*^9}, {3.894274409570363*^9, 
  3.894274412107895*^9}, {3.895474294912863*^9, 3.8954742949132338`*^9}},
 CellLabel->
  "In[401]:=",ExpressionUUID->"c5d24df6-202e-4f0c-8088-8941b30599e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LOWZSGCFisherFullPBAP", " ", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2048", " ", "-", " ", 
       RowBox[{"Length", "[", "CovPInvBLOWZsgc", "]"}], " ", "-", " ", "2"}], 
      RowBox[{"2048", " ", "-", " ", "1"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"LOWZsgcPBderivsAP", "//", "Transpose"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "CovPInvBLOWZsgc", "]"}], ".", 
      "LOWZsgcPBderivsAP"}]}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873967538631435*^9, 3.873967538710552*^9}, {
  3.873967569391849*^9, 3.87396760550515*^9}, {3.89266680284438*^9, 
  3.892666802868412*^9}, {3.894274410619211*^9, 3.8942744143653727`*^9}, {
  3.895474294914291*^9, 3.895474294914679*^9}},
 CellLabel->
  "In[402]:=",ExpressionUUID->"82b5fbcb-a55e-4781-bb63-9d8e218b896d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Comparisons part 1: Numerical Diagonal covariance results (w/o 4 sky \
correlation)\
\>", "Subsection",
 CellChangeTimes->{{3.8783307218610353`*^9, 3.8783307734591293`*^9}, {
  3.87833113443521*^9, 
  3.8783311908569613`*^9}},ExpressionUUID->"70066169-bea3-4ecb-bbbb-\
274a05cdeb10"],

Cell["Preliminary functions", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.87387541354895*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"558ce4f1-9a5a-4c8f-9627-0f087e763499"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DiagM", " ", "[", "A_", "]"}], ":=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Diagonal", "[", "A", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiagMP02corr", " ", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", "mono11", ",", "monoquad11", ",", "monoquad12", ",", 
      "quadquad11"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", " ", 
      FractionBox[
       RowBox[{"Length", "[", "A", "]"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mono11", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{";;", "l"}], ",", 
          RowBox[{";;", "l"}]}], "]"}], "]"}], "//", "DiagM"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"monoquad11", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{";;", "l"}], ",", 
          RowBox[{
           RowBox[{"l", "+", "1"}], ";;"}]}], "]"}], "]"}], "//", "DiagM"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"monoquad12", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"l", "+", "1"}], ";;"}], ",", 
          RowBox[{";;", "l"}]}], "]"}], "]"}], "//", "DiagM"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"quadquad11", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"l", "+", "1"}], ";;"}], ",", 
          RowBox[{
           RowBox[{"l", "+", "1"}], ";;"}]}], "]"}], "]"}], "//", "DiagM"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mono11", ",", "monoquad11"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"monoquad12", ",", "quadquad11"}], "}"}]}], "}"}], "//", 
       "ArrayFlatten"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.89382990560868*^9, 3.8938299056140413`*^9}, {
   3.893830046485157*^9, 3.893830049442358*^9}, 3.893830324490224*^9},
 CellLabel->
  "In[403]:=",ExpressionUUID->"e6e2729f-1078-40ee-9388-5fc724302390"],

Cell["\<\
Covariance import and reduction to diagonal only (we include monopole and \
quadrupole cross correlation)\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.87387541354895*^9}, {3.878332759742388*^9, 3.878332785023649*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"b5cd6402-6b66-4ce6-b904-f90e9e11ba8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CovPInvCMASSngcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/CovPCMASSngc.mx\>\"", "]"}], "//", 
    "DiagMP02corr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covB0CMASSngcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/covB0CMASSngc.mx\>\"", "]"}], "//", 
    "DiagM"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873967733638268*^9, 3.873967745594124*^9}, {
  3.8739679170332937`*^9, 3.8739679181701*^9}, {3.8739679571391487`*^9, 
  3.873967967386367*^9}, {3.893828120005362*^9, 3.893828120005845*^9}, {
  3.89382993022992*^9, 3.893829930230753*^9}, {3.893830056266943*^9, 
  3.8938300681352663`*^9}, {3.895474294915799*^9, 3.89547429491625*^9}, {
  3.89547858108887*^9, 3.895478581387724*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"84203322-ee57-4494-8b1b-1d2658d56da5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CovPInvCMASSsgcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/CovPCMASSsgc.mx\>\"", "]"}], "//", 
    "DiagMP02corr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covB0CMASSsgcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/covB0CMASSsgc.mx\>\"", "]"}], "//", 
    "DiagM"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873967747356475*^9, 3.873967751039342*^9}, {
  3.8739679192966137`*^9, 3.8739679202564793`*^9}, {3.8739679582960367`*^9, 
  3.8739679662655687`*^9}, {3.8938281200065536`*^9, 3.893828120007015*^9}, {
  3.8938299302328577`*^9, 3.893829930233677*^9}, {3.893830344995008*^9, 
  3.8938303462096233`*^9}, {3.8954742949173307`*^9, 3.895474294917742*^9}, {
  3.895478583436232*^9, 3.895478583755795*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"2adcde90-56bf-415c-a5de-264377fa388a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CovPInvLOWZngcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/CovPLOWZngc.mx\>\"", "]"}], "//", 
    "DiagMP02corr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covB0LOWZngcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/covB0LOWZngc.mx\>\"", "]"}], "//", 
    "DiagM"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873967761256659*^9, 3.873967762206176*^9}, {
  3.873967921418516*^9, 3.873967922445222*^9}, {3.873967960265861*^9, 
  3.873967964345461*^9}, {3.8938281200076857`*^9, 3.89382812000817*^9}, {
  3.893829930235577*^9, 3.893829930236141*^9}, {3.893830348086727*^9, 
  3.893830348934078*^9}, {3.89547429491883*^9, 3.895474294919245*^9}, {
  3.8954785854367657`*^9, 3.8954785857383757`*^9}},
 CellLabel->
  "In[409]:=",ExpressionUUID->"88787f6b-9029-4e84-b8ef-6159d188e69b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CovPInvLOWZsgcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/CovPLOWZsgc.mx\>\"", "]"}], "//", 
    "DiagMP02corr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covB0LOWZsgcD", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<covsks/covB0LOWZsgc.mx\>\"", "]"}], "//", 
    "DiagM"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873967757322185*^9, 3.873967764087468*^9}, {
  3.873967923491415*^9, 3.87396792470232*^9}, {3.8739679613686333`*^9, 
  3.873967965338262*^9}, {3.8938281200088663`*^9, 3.893828120009337*^9}, {
  3.893829930238109*^9, 3.893829930238706*^9}, {3.8938303504017057`*^9, 
  3.893830351338592*^9}, {3.895474294920286*^9, 3.8954742949206676`*^9}, {
  3.895478587691616*^9, 3.8954785879886217`*^9}},
 CellLabel->
  "In[411]:=",ExpressionUUID->"f05ba65a-842d-4ed0-9a8d-58f598d210a7"],

Cell["Powerspectrum Fisher", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1b53ee00-4332-4f3b-a0b5-62867d6794e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PFisherCMASSngcNumD", "=", 
   RowBox[{"GetFisherPNum", "[", 
    RowBox[{"PCMASSngcderivsmonoquadAP", ",", "CovPInvCMASSngcD"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PFisherCMASSsgcNumD", "=", 
   RowBox[{"GetFisherPNum", "[", 
    RowBox[{"PCMASSsgcderivsmonoquadAP", ",", "CovPInvCMASSsgcD"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PFisherLOWZngcNumD", "=", 
   RowBox[{"GetFisherPNum", "[", 
    RowBox[{"PLOWZngcderivsmonoquadAP", ",", "CovPInvLOWZngcD"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PFisherLOWZsgcNumD", "=", 
   RowBox[{"GetFisherPNum", "[", 
    RowBox[{"PLOWZsgcderivsmonoquadAP", ",", "CovPInvLOWZsgcD"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8783802254486*^9, 3.878380317928809*^9}, {
  3.88547959936789*^9, 3.885479599368973*^9}, {3.8942744287238894`*^9, 
  3.894274431635982*^9}, {3.895474294921728*^9, 3.895474294922789*^9}},
 CellLabel->
  "In[413]:=",ExpressionUUID->"cae05d46-8ba2-4a0e-9709-0eac7624773e"],

Cell["Bispectrum Fisher ", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
  3.872428266278404*^9}, {3.872428348503667*^9, 3.872428350697707*^9}, {
  3.873360207213697*^9, 3.87336020838678*^9}, {3.873876007272838*^9, 
  3.873876007967012*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e8235f35-5bed-4cc0-bbff-17de6fc9553d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BFisherCMASSngcNumD", " ", "=", " ", 
   RowBox[{"GetFisherBNum", "[", 
    RowBox[{"BderivsCMASSkeffCMASSngcAP", ",", "covB0CMASSngcD"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BFisherCMASSsgcNumD", " ", "=", " ", 
   RowBox[{"GetFisherBNum", "[", 
    RowBox[{"BderivsCMASSkeffCMASSsgcAP", ",", "covB0CMASSsgcD"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BFisherLOWZngcNumD", " ", "=", " ", 
   RowBox[{"GetFisherBNum", "[", 
    RowBox[{"BderivsLOWZkeffLOWZngcAP", ",", "covB0LOWZngcD"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BFisherLOWZsgcNumD", " ", "=", " ", 
   RowBox[{"GetFisherBNum", "[", 
    RowBox[{"BderivsLOWZkeffLOWZsgcAP", ",", "covB0LOWZsgcD"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.872860517163445*^9, 3.872860522939477*^9}, {
  3.873390291779215*^9, 3.873390294228992*^9}, {3.873422996812253*^9, 
  3.8734229979844112`*^9}, {3.873468895779221*^9, 3.873468941170693*^9}, {
  3.8736329708817*^9, 3.873632973466619*^9}, {3.8736330872145967`*^9, 
  3.873633095297299*^9}, {3.873876010076576*^9, 3.873876019134982*^9}, {
  3.873967810740756*^9, 3.8739678248787813`*^9}, {3.873967858826234*^9, 
  3.873967868739736*^9}, {3.873967934721209*^9, 3.873967944683631*^9}, {
  3.878380544029532*^9, 3.878380544246992*^9}, {3.89427443593583*^9, 
  3.894274438360635*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"ec1a228d-64c1-4e68-8adf-12f71be45dd3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Comparisons part 2: Full redshift dependence analytical covariance\
\>", "Subsection",
 CellChangeTimes->{{3.8783910593521233`*^9, 
  3.8783910828550453`*^9}},ExpressionUUID->"9bf5df29-0e24-4fb4-b06e-\
febf86b4e668"],

Cell["Reduce P-derivatives to monopole and quadrupole", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391400909933*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9a626645-8a2d-41d1-9863-3c031c4b7966"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSderivsmonoquadAP", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PCMASSngcderivsAP", "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZderivsmonoquadAP", " ", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PLOWZngcderivsAP", "]"}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8783854974202147`*^9, {3.878391156242745*^9, 3.878391178604154*^9}, {
   3.87839131726943*^9, 3.8783913246578836`*^9}, {3.892666867418969*^9, 
   3.8926668734405127`*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"16fdc1c1-e436-4092-8a9a-1055d076923d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSderivsmonoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PCMASSngcderivs", "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZderivsmonoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PLOWZngcderivs", "]"}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.894251660928046*^9, 3.894251664650529*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"6ed023a8-8347-429c-b585-420b7e0a7886"],

Cell["Powerspectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"626f2b3e-3609-4cde-90ff-daebbf83e359"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPCnew", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PCMASSderivsmonoquadAP", ",", "COVCMASSP"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPLnew", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PLOWZderivsmonoquadAP", ",", "COVLOWZP"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.877298767724556*^9, 3.8772987953889217`*^9}, {
  3.8783912080268583`*^9, 3.878391210249255*^9}, {3.885479599369503*^9, 
  3.885479599369829*^9}, {3.892666876237653*^9, 3.8926668781492767`*^9}},
 CellLabel->
  "In[425]:=",ExpressionUUID->"2f86e7e1-2227-4e7c-933f-f4549eb90a47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPCnewnoAP", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PCMASSderivsmonoquad", ",", "COVCMASSP"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPLnewnoAP", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PLOWZderivsmonoquad", ",", "COVLOWZP"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.894277490984377*^9, 3.894277499479642*^9}},
 CellLabel->
  "In[427]:=",ExpressionUUID->"459ff7dc-8e8a-4d70-a427-e17147392436"],

Cell["Bispectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391430313566*^9}, {
  3.878409282105134*^9, 3.878409283129027*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"61ef3067-f5a5-45e4-841b-52c077aacd7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBCnew", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{
    "BderivsCMASSkeffCMASSngcAP", ",", "COVCMASSB", ",", "Loopmastermono"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBLnew", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{
    "BderivsLOWZkeffLOWZngcAP", ",", "COVLOWZB", ",", "Loopmastermono"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877299183948834*^9, 3.877299194957054*^9}, 
   3.878411016536647*^9, {3.8926668876762323`*^9, 3.8926668899999933`*^9}},
 CellLabel->
  "In[429]:=",ExpressionUUID->"295a44f2-b7ca-4f95-8f5e-3488658e7fc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBCnewnoAP", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{
    "BderivsCMASSkeffCMASSngc", ",", "COVCMASSB", ",", "Loopmastermono"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBLnewnoAP", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{
    "BderivsLOWZkeffLOWZngc", ",", "COVLOWZB", ",", "Loopmastermono"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8942775043377647`*^9, 3.894277509662166*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"ff9280d6-0d7a-44cb-a5a0-8eba248fa11c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Independent studies: Full redshift dependence analytical covariance\
\>", "Subsection",
 CellChangeTimes->{{3.8783910593521233`*^9, 3.8783910828550453`*^9}, {
  3.8785620912760353`*^9, 3.8785620982568293`*^9}, {3.878562429537898*^9, 
  3.878562438525066*^9}, {3.878562887584858*^9, 
  3.878562900235496*^9}},ExpressionUUID->"bb81c3f2-cf1e-4a3b-8ad5-\
788bd4209c75"],

Cell[CellGroupData[{

Cell["Full angular dependence (all multipoles)", "Subsubsection",
 CellChangeTimes->{{3.878562914593812*^9, 
  3.878562916573283*^9}},ExpressionUUID->"8c411473-9b2c-4e9c-b777-\
8889ea5f5edf"],

Cell["Powerspectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e7f1689e-8f71-45fe-9c63-d489a26a5ef4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPCnewmu", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PCMASSngcderivs", ",", "COVCMASSP"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPLnewmu", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PLOWZsgcderivs", ",", "COVLOWZP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877298767724556*^9, 3.8772987953889217`*^9}, {
  3.8783912080268583`*^9, 3.878391210249255*^9}, {3.8785621051699963`*^9, 
  3.87856210716857*^9}, {3.878562229739369*^9, 3.878562261915365*^9}, {
  3.8854795993703337`*^9, 3.885479599370669*^9}, {3.894197753644115*^9, 
  3.894197756104598*^9}, {3.894273237803379*^9, 3.894273238836041*^9}},
 CellLabel->
  "In[433]:=",ExpressionUUID->"69ba23dc-ffda-49aa-8167-5cb34d8f9c95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPCnewmuAP", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PCMASSngcderivsAP", ",", "COVCMASSP"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPLnewmuAP", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PLOWZsgcderivsAP", ",", "COVLOWZP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.89427767266107*^9, 3.894277678206388*^9}},
 CellLabel->
  "In[435]:=",ExpressionUUID->"9bd54bd9-97ed-4113-b038-0e32d7ec86e9"],

Cell["Bispectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391430313566*^9}, {
  3.878409282105134*^9, 3.878409283129027*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"05c94940-067b-46fe-9a66-12ace8807ea5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBCnewmu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BderivsCMASSkeffCMASSngc", ",", "COVCMASSB", ",", "Loopmaster"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBLnewmu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BderivsLOWZkeffLOWZngc", ",", "COVLOWZB", ",", "Loopmaster"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877299183948834*^9, 3.877299194957054*^9}, 
   3.878411016536647*^9, {3.878562109409367*^9, 3.878562110516465*^9}, {
   3.87856222299389*^9, 3.8785622247210207`*^9}, {3.8941976899721127`*^9, 
   3.894197692495243*^9}, {3.894273243614958*^9, 3.894273244627787*^9}},
 CellLabel->
  "In[437]:=",ExpressionUUID->"c0373fa4-91e5-4193-bdc6-68640b165a42"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBCnewmuAP", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{
    "BderivsCMASSkeffCMASSngcAP", ",", "COVCMASSB", ",", "Loopmaster"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBLnewmuAP", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BderivsLOWZkeffLOWZngcAP", ",", "COVLOWZB", ",", "Loopmaster"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894277682520749*^9, 3.894277688240575*^9}},
 CellLabel->
  "In[439]:=",ExpressionUUID->"d27c1d8d-f4de-4eb3-9f2e-39bc01221369"]
}, Closed]],

Cell[CellGroupData[{

Cell["Full angular dependence BTree ", "Subsubsection",
 CellChangeTimes->{{3.878562914593812*^9, 3.878562916573283*^9}, {
  3.879809730183897*^9, 3.8798097408316193`*^9}, {3.889149055881192*^9, 
  3.889149074571279*^9}},ExpressionUUID->"1ccc7dff-e74e-4bf3-9573-\
2054b438bff7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BCMASSderivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"TriCMASSkeffT", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], "/.", 
         "nbfixCMASSngc"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "TriCMASSkeffT", "]"}]}], "}"}]}], "]"}], 
      ",", "si"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLOWZderivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"TriLOWZkeffT", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], "/.", 
         "nbfixLOWZngc"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "TriLOWZkeffT", "]"}]}], "}"}]}], "]"}], ",",
       "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8891504150052958`*^9, 3.8891504291960917`*^9}, {
  3.8891505066300697`*^9, 3.8891505372361517`*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"29925e31-e1b1-464e-8994-37eab8d33413"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.882958`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.889150470772286*^9, 3.889150541739913*^9, 
  3.8925558348076982`*^9, 3.892556083013145*^9, 3.892666926627944*^9, 
  3.892807681646942*^9, 3.8928078209665318`*^9, 3.8937751572736273`*^9, 
  3.8937994902009983`*^9, 3.893829834972377*^9, 3.893830379506756*^9, 
  3.8941964686400003`*^9, 3.8942724758818407`*^9, 3.89427583020217*^9, 
  3.8949982078623657`*^9, 3.894999698052297*^9, 3.895478634674234*^9, 
  3.895481422407453*^9, 3.896280318253642*^9, 3.8963287051340237`*^9},
 CellLabel->
  "Out[441]=",ExpressionUUID->"0a34115a-cb65-4bfc-a065-728b08f32f7c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.009124`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.889150470772286*^9, 3.889150541739913*^9, 
  3.8925558348076982`*^9, 3.892556083013145*^9, 3.892666926627944*^9, 
  3.892807681646942*^9, 3.8928078209665318`*^9, 3.8937751572736273`*^9, 
  3.8937994902009983`*^9, 3.893829834972377*^9, 3.893830379506756*^9, 
  3.8941964686400003`*^9, 3.8942724758818407`*^9, 3.89427583020217*^9, 
  3.8949982078623657`*^9, 3.894999698052297*^9, 3.895478634674234*^9, 
  3.895481422407453*^9, 3.896280318253642*^9, 3.896328706144289*^9},
 CellLabel->
  "Out[442]=",ExpressionUUID->"20719f4b-53d6-4d1c-9e34-d510ce9cc223"]
}, Closed]],

Cell["Powerspectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7486d97d-2b7e-40c9-a88e-ac358251b62d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBCT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BCMASSderivsT", ",", "COVCMASSBT", ",", "Loopmaster"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBLT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BLOWZderivsT", ",", "COVLOWZBT", ",", "Loopmaster"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.877298767724556*^9, 3.8772987953889217`*^9}, {
  3.8783912080268583`*^9, 3.878391210249255*^9}, {3.8785621051699963`*^9, 
  3.87856210716857*^9}, {3.878562229739369*^9, 3.878562261915365*^9}, {
  3.8798097544751883`*^9, 3.879809756596146*^9}, {3.885479599371167*^9, 
  3.885479599371523*^9}, {3.889149092072165*^9, 3.889149093844183*^9}, {
  3.889149166467523*^9, 3.8891491830232143`*^9}, {3.889150558943033*^9, 
  3.889150567329451*^9}},
 CellLabel->
  "In[443]:=",ExpressionUUID->"93783339-71cc-4b2c-8f51-405934bbdf5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Full angular dependence 2Loop w/o shot noise ", "Subsubsection",
 CellChangeTimes->{{3.878562914593812*^9, 3.878562916573283*^9}, {
  3.879809730183897*^9, 
  3.8798097408316193`*^9}},ExpressionUUID->"d6c1f0d0-9c70-4b4f-a393-\
e7917eea5358"],

Cell["Powerspectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"feb5cfb9-917c-4085-8200-da73ab765609"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPCnewmu2L", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PCMASSngcderivs2L", ",", "COVCMASSP2L"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPLnewmu2L", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PLOWZngcderivs2L", ",", "COVLOWZP2L"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879809770495747*^9, 3.879809801971344*^9}, {
  3.8798098371796217`*^9, 3.879809840524679*^9}, {3.885479599372905*^9, 
  3.885479599373296*^9}, {3.8942732600489492`*^9, 3.894273260530267*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"78a2b32a-9e2e-4a7b-b9ff-87ec8cba6b06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPCnewmu2LNS", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PCMASSngcderivs2L", ",", "COVCMASSPNS2L"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPLnewmu2LNS", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PLOWZngcderivs2L", ",", "COVLOWZPNS2L"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879809773417728*^9, 3.879809795015582*^9}, {
  3.879809843088575*^9, 3.879809845248377*^9}, {3.885479599373876*^9, 
  3.885479599374238*^9}},
 CellLabel->
  "In[447]:=",ExpressionUUID->"b739d108-9c1d-4ad0-98f2-87d6847b8fe0"]
}, Closed]],

Cell[CellGroupData[{

Cell["no shot noise full mu", "Subsubsection",
 CellChangeTimes->{{3.878562914593812*^9, 3.878562928491522*^9}, {
  3.8785633600215597`*^9, 
  3.878563361544279*^9}},ExpressionUUID->"4ecbf95c-6be9-4ca5-a781-\
d81103504f65"],

Cell["Powerspectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"95828652-0195-4a7b-aa4c-ebf2afeef242"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPCNS", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PCMASSngcderivs", ",", "COVCMASSPNS"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPLNS", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PLOWZsgcderivs", ",", "COVLOWZPNS"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877298767724556*^9, 3.8772987953889217`*^9}, {
   3.8783912080268583`*^9, 3.878391210249255*^9}, {3.8785621051699963`*^9, 
   3.87856210716857*^9}, {3.878562229739369*^9, 3.878562261915365*^9}, {
   3.8785629312631397`*^9, 3.8785629778887978`*^9}, {3.8854795993751583`*^9, 
   3.885479599375483*^9}, {3.885539470902315*^9, 3.885539475784678*^9}, 
   3.892555938911018*^9, {3.8941977236379766`*^9, 3.894197725696081*^9}, {
   3.894273231369858*^9, 3.894273232434696*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"f052b4b9-d4b8-4d92-83e0-6538456289af"],

Cell["Bispectrum Fishers", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391430313566*^9}, {
  3.878409282105134*^9, 3.878409283129027*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e3298f59-f7cb-4e27-94d2-686f9bc47807"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBCNS", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{
    "BderivsCMASSkeffCMASSngc", ",", "COVCMASSBNS", ",", "Loopmaster"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBLNS", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BderivsLOWZkeffLOWZngc", ",", "COVLOWZBNS", ",", "Loopmaster"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877299183948834*^9, 3.877299194957054*^9}, 
   3.878411016536647*^9, {3.878562109409367*^9, 3.878562110516465*^9}, {
   3.87856222299389*^9, 3.8785622247210207`*^9}, {3.8785629364563837`*^9, 
   3.87856295821504*^9}, {3.885539477281392*^9, 3.8855394793389874`*^9}, {
   3.8941977278795013`*^9, 3.894197730415131*^9}, {3.894273227700595*^9, 
   3.89427322892861*^9}},
 CellLabel->
  "In[451]:=",ExpressionUUID->"e697abc9-23b1-42f0-a3b7-bbd1f45c70d6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Perturbative Prior ", "Subsection",
 CellChangeTimes->{{3.895054428919343*^9, 3.895054448809629*^9}, {
   3.8963427347722893`*^9, 3.896342735484774*^9}, 
   3.896381283501287*^9},ExpressionUUID->"58df8d0c-c54a-4621-89d1-\
3e0dc8c0f4a0"],

Cell[CellGroupData[{

Cell["Powerspectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.88874151521391*^9}},ExpressionUUID->"b82a3c8f-99ac-41f1-95fa-\
39b153ccf0a1"],

Cell["scaling  bias  computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
   3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
   3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
   3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
   3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
   3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
   3.8887536509125*^9, 3.888753659481193*^9}, 3.894539283215518*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e6a81cfa-395e-4f3f-bea1-c16556f4d766"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSLoop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabCMASS", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixBOSS"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZLoop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabLOWZ", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixBOSS"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741261612136*^9, 3.88874127220191*^9}, 
   3.88875333043812*^9, {3.8887533861313133`*^9, 3.888753396861267*^9}, {
   3.888754416678398*^9, 3.888754434715231*^9}, {3.896345206309471*^9, 
   3.896345241875853*^9}, {3.896346149287546*^9, 3.896346151191637*^9}},
 CellLabel->
  "In[1221]:=",ExpressionUUID->"90b9df09-ca2d-479e-9894-540c50d2d71f"],

Cell["PTree computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
  3.888741162977934*^9, 3.888741164492325*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2a993a3e-e82d-4d03-861c-9be62880bf1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PCMASSTree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabCMASS", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], "/.", 
        "coeffixBOSS"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PLOWZTree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabLOWZ", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], "/.", 
        "coeffixBOSS"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741178216148*^9, 3.888741205021223*^9}, 
   3.888745462695631*^9},
 CellLabel->
  "In[1223]:=",ExpressionUUID->"14f1694f-8616-4c52-b934-205e786f2417"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcCMASS", "[", "k_", "]"}], "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GetFullzCovPInv", "[", 
          RowBox[{
          "ktabraw", ",", "CMASSpk", ",", "CMASSspec", ",", "bfixstochBOSS", 
           ",", "dkP"}], "]"}], "/.", 
         RowBox[{"\[Mu]", "->", "0"}]}], ")"}]}], "]"}], "[", "k", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcLOWZ", "[", "k_", "]"}], "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GetFullzCovPInv", "[", 
          RowBox[{
          "ktabraw", ",", "LOWZpk", ",", "LOWZspec", ",", "bfixstochBOSS", 
           ",", "dkP"}], "]"}], "/.", 
         RowBox[{"\[Mu]", "->", "0"}]}], ")"}]}], "]"}], "[", "k", "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740432992057*^9, 3.888740457002887*^9}, {
  3.8887405566797333`*^9, 3.8887405983128567`*^9}, {3.888740634886725*^9, 
  3.88874063767188*^9}, {3.888741118670182*^9, 3.888741121830488*^9}, {
  3.895296285845614*^9, 3.8952963088795757`*^9}, {3.8954742949241858`*^9, 
  3.895474294924636*^9}},
 CellLabel->
  "In[1225]:=",ExpressionUUID->"b7f9dd05-b9fc-426c-a9e1-7d659c3fc5fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]CMASStab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcCMASS", "[", 
      RowBox[{"ktabCMASS", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]LOWZtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcLOWZ", "[", 
      RowBox[{"ktabLOWZ", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740435898135*^9, 3.888740464811185*^9}},
 CellLabel->
  "In[1227]:=",ExpressionUUID->"d3e1976d-cade-44fa-92e1-47325ad7fe48"],

Cell["Get \[OpenCurlyDoubleQuote]correct\[CloseCurlyDoubleQuote] \
powerspectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.8950518293200827`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4079fe18-dfb1-4003-a9fc-4263f02c27cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1LCCMASS", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PCMASSLoop", ",", "\[Sigma]CMASStab", ",", "PCMASSTree"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1LCCLOWZ", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PLOWZLoop", ",", "\[Sigma]LOWZtab", ",", "PLOWZTree"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888753553372282*^9, 3.888753584704721*^9}, {
  3.895001710873721*^9, 3.895001711694565*^9}, {3.895051621578108*^9, 
  3.895051657499125*^9}},
 CellLabel->
  "In[1229]:=",ExpressionUUID->"56acd9c9-627c-4c20-856a-b640b3740351"],

Cell["Get powerspectrum priors", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.895051842826643*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d629c382-50d1-44dd-ac01-a529e5776e4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPriorCMASS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabCMASS", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabCMASS", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk", ",", " ", 
             RowBox[{"P1LCCMASS", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabCMASS", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", "coeffixBOSS"}], "/.", "nbfixCMASSngc"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPriorLOWZ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabLOWZ", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabLOWZ", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk", ",", " ", 
             RowBox[{"P1LCCLOWZ", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabLOWZ", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", "coeffixBOSS"}], "/.", "nbfixLOWZngc"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888236882503387*^9, 3.888236904238269*^9}, {
  3.8882369618172617`*^9, 3.888236967052273*^9}, {3.888312689163658*^9, 
  3.888312689822503*^9}, {3.888577750728319*^9, 3.888577768594573*^9}, {
  3.888578866567628*^9, 3.8885788721742907`*^9}, {3.888678324969201*^9, 
  3.888678327945434*^9}, {3.8886979404315042`*^9, 3.888697996479536*^9}, {
  3.8887414149150476`*^9, 3.888741420468852*^9}, {3.8887535561721287`*^9, 
  3.888753591906488*^9}, {3.8950017046228943`*^9, 3.895001715198107*^9}, {
  3.895051549124861*^9, 3.8950515526017523`*^9}, {3.895051638921514*^9, 
  3.895051642042029*^9}, {3.895051676363235*^9, 3.895051679348817*^9}, {
  3.895051789959259*^9, 3.8950517957990932`*^9}, {3.8950546749428873`*^9, 
  3.895054676353067*^9}, {3.895138595324391*^9, 3.895138605425686*^9}, {
  3.895296205900981*^9, 3.8952962080752*^9}},
 CellLabel->
  "In[1231]:=",ExpressionUUID->"b3467087-6e47-49f4-b6b6-e35cb8a046c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bispectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.888741528575953*^9}},ExpressionUUID->"5b318cdc-694a-46a8-a539-\
7e243052c9e9"],

Cell["Bispectrum - Background  Tree and Loop", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741616313279*^9, 3.8887416248599854`*^9}, {
  3.8887416567266483`*^9, 3.888741660704743*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4206dd99-3ee3-4971-8e0f-fca7fbcd19a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BCMASSLoopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Bloopscale", "[", 
          RowBox[{
           RowBox[{"TriCMASSkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], "/.", 
        "nbfixCMASSngc"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BLOWZLoopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Bloopscale", "[", 
          RowBox[{
           RowBox[{"TriLOWZkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], "/.", 
        "nbfixLOWZngc"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887870506613146*^9, 3.887870526214724*^9}, {
   3.888045960956028*^9, 3.888045982568386*^9}, 3.8886762373468113`*^9, 
   3.896345477621625*^9, {3.896346161430409*^9, 3.8963461637686653`*^9}},
 CellLabel->
  "In[1233]:=",ExpressionUUID->"0f9b33ab-99bb-4c33-993e-e714a8cfa5cb"],

Cell["Bispectrum - Derivatives of Loop only", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ae7a58d4-6847-45e8-9457-ec6843c75f9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CorrectionCMASS", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"TriCMASSkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "CMASSpk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], "/.", 
        "nbfixCMASSngc"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CorrectionLOWZ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"TriLOWZkeff", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "LOWZpk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixBOSS", "]"}]}], "/.", 
        "nbfixLOWZngc"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887869756685066*^9, 3.887869779195531*^9}, 
   3.8964158101339293`*^9, {3.896426219187924*^9, 
   3.8964262208160343`*^9}},ExpressionUUID->"28ea7775-aa9d-470f-975b-\
f1611291c114"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BCMASSngcLoopderivs", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BderivsCMASSkeffCMASSngc", "+", "CorrectionCMASS"}], ")"}], ".",
     "Blooplistreal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BLOWZngcLoopderivs", "  ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BderivsLOWZkeffLOWZngc", "+", "CorrectionLOWZ"}], ")"}], ".", 
    "Blooplistreal"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8868385093651257`*^9, 3.886838510201589*^9}, {
   3.886838918810886*^9, 3.886838923398671*^9}, 3.8868395694779863`*^9, 
   3.8868423371525383`*^9, {3.887869794724497*^9, 3.887869828310582*^9}, {
   3.887869867058724*^9, 3.8878698800661917`*^9}, {3.887961854062598*^9, 
   3.887961855134948*^9}, {3.895264105727298*^9, 3.8952641083380823`*^9}, {
   3.895296115936955*^9, 3.895296127470274*^9}},
 CellLabel->
  "In[1236]:=",ExpressionUUID->"f934b733-cce3-4ba5-a259-b0d2e4d96d60"],

Cell["Symmetric P1LC", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}, {
  3.8950532854616213`*^9, 3.895053290570174*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0c3b3c0c-c0a4-4afe-9fba-46fc510de72d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PTtritabCMASS", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"TriCMASSkeff", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "CMASSpk"}], "]"}],
           "/.", "coeffixBOSS"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PTtritabLOWZ", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"TriLOWZkeff", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "LOWZpk"}], "]"}], 
          "/.", "coeffixBOSS"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743170297797*^9, 3.888743178232419*^9}, {
  3.888743239420354*^9, 3.8887432774648733`*^9}, {3.888743593628655*^9, 
  3.888743613564752*^9}, {3.8887538943446207`*^9, 3.8887538992824593`*^9}, {
  3.8887539507915707`*^9, 3.8887540245086727`*^9}, {3.8963453537692623`*^9, 
  3.896345368101008*^9}, {3.896346168182728*^9, 3.8963461711208982`*^9}},
 CellLabel->
  "In[1238]:=",ExpressionUUID->"94abd2a1-df70-4c0f-9cf8-54276577b3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PsymtabCMASS", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"TriCMASSkeff", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "CMASSpk", ",", 
        RowBox[{"PTtritabCMASS", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixBOSS"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsymtabLOWZ", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"TriLOWZkeff", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "LOWZpk", ",", 
        RowBox[{"PTtritabLOWZ", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixBOSS"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743595979177*^9, 3.8887436284098597`*^9}, {
  3.888753901299285*^9, 3.888753903432684*^9}, {3.888753952413186*^9, 
  3.888753953499566*^9}, {3.888753996437364*^9, 3.888753999316115*^9}},
 CellLabel->
  "In[1240]:=",ExpressionUUID->"ee5e943a-01dd-47ec-bd5f-720becd84784"],

Cell["Bispectrum \[OpenCurlyQuote]correct\[CloseCurlyQuote]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.89505326165967*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"63bdd8ab-01f0-4af2-9f24-b9c79e505831"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B1LCCMASS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BCMASSLoopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVCMASSB", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabCMASS", ",", 
        "PCMASSLoop", ",", "\[Sigma]CMASStab", ",", "PCMASSTree"}], "]"}], "/.",
       "coeffixBOSS"}], "/.", "nbfixCMASSngc"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1LCLOWZ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BLOWZLoopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVLOWZB", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabLOWZ", ",", 
        "PLOWZLoop", ",", "\[Sigma]LOWZtab", ",", "PLOWZTree"}], "]"}], "/.", 
      "coeffixBOSS"}], "/.", "nbfixLOWZngc"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743598646628*^9, 3.888743598924089*^9}, {
  3.8887436318956842`*^9, 3.888743635015679*^9}, {3.888745932066663*^9, 
  3.888745933074651*^9}, {3.8887539075778713`*^9, 3.8887539557330914`*^9}, {
  3.888754032089074*^9, 3.888754068197426*^9}, {3.8887541078730497`*^9, 
  3.8887541151628428`*^9}, {3.888754160444756*^9, 3.8887541755244904`*^9}, {
  3.895053039641955*^9, 3.8950530471332006`*^9}},
 CellLabel->
  "In[1242]:=",ExpressionUUID->"0d1dfa8e-43b9-4a8d-93f3-4493aa3e27ab"],

Cell["Bispectrum prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.895053268869812*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c6323821-19bf-422a-9507-3bb40fbbab63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BPriorCMASS", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "TriCMASSkeff", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BCMASSngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCCMASS", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "TriCMASSkeff", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BPriorLOWZ", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "TriLOWZkeff", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BLOWZngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCLOWZ", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "TriLOWZkeff", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888743137150976*^9, 3.8887431512323427`*^9}, {
   3.888743287353896*^9, 3.888743314125313*^9}, 3.888743582880457*^9, {
   3.888743643867592*^9, 3.888743662544888*^9}, {3.888753935192675*^9, 
   3.888753941397023*^9}, {3.888754078285284*^9, 3.888754182525218*^9}, {
   3.895053050572571*^9, 3.895053055283751*^9}, {3.895053117883728*^9, 
   3.895053118647593*^9}, {3.895053178983204*^9, 3.8950531901049423`*^9}, {
   3.8951387353590307`*^9, 3.895138736806428*^9}, {3.895296139895823*^9, 
   3.895296141205783*^9}, 3.8954913840326347`*^9, 3.895492054353951*^9},
 CellLabel->
  "In[1244]:=",ExpressionUUID->"29f1517f-4eee-4f54-bc68-b310da3a72b9"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exports", "Subsection",
 CellChangeTimes->{{3.878560371527843*^9, 3.8785603734545107`*^9}, {
  3.894997602827498*^9, 
  3.8949976035927143`*^9}},ExpressionUUID->"f1cf552d-ccab-4d42-9d8b-\
c7a299445aca"],

Cell["Full P results w/o 4 sky correlation", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.878587121502376*^9, 
   3.878587124513818*^9}, 3.893855219037675*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"8a67f2da-d9dc-46a3-ad8b-4c5afac37bda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/Pfull4sky.mtx\>\"", ",", 
    RowBox[{
     RowBox[{"CombineMs", "[", 
      RowBox[{"{", 
       RowBox[{
       "CMASSNGCFisherFullPAP", ",", "CMASSSGCFisherFullPAP", ",", 
        "LOWZNGCFisherFullPAP", ",", "LOWZSGCFisherFullPAP"}], "}"}], "]"}], 
     "+", "Prior4sky"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/Pfullnoskycorr.mtx\>\"", ",", 
    RowBox[{
    "CMASSNGCFisherFullPAP", "+", "CMASSSGCFisherFullPAP", "+", 
     "LOWZNGCFisherFullPAP", "+", "LOWZSGCFisherFullPAP", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.87856042500806*^9, 3.8785604673657207`*^9}, {
   3.878560553541524*^9, 3.8785605538361073`*^9}, {3.878560775809699*^9, 
   3.878560782249176*^9}, {3.8785871284122257`*^9, 3.878587149579846*^9}, {
   3.878828934890606*^9, 3.87882893535982*^9}, {3.8794570495453777`*^9, 
   3.879457049750923*^9}, {3.88001554702491*^9, 3.880015548376131*^9}, {
   3.883948237202758*^9, 3.883948238568005*^9}, {3.885485725237483*^9, 
   3.885485727527134*^9}, {3.885498115035033*^9, 3.8854981150356703`*^9}, {
   3.887897102779814*^9, 3.887897102953498*^9}, {3.8890951213304853`*^9, 
   3.889095121465909*^9}, {3.8925452585686626`*^9, 3.892545260134911*^9}, 
   3.8926389466393147`*^9, {3.893773243532248*^9, 3.8937732435326977`*^9}, {
   3.893773770879241*^9, 3.893773771631104*^9}, {3.893775631840749*^9, 
   3.893775644266015*^9}, {3.89382806911416*^9, 3.8938280699186087`*^9}, {
   3.89382812005796*^9, 3.893828120058503*^9}, {3.893830723542562*^9, 
   3.893830723543215*^9}, {3.8942739212846518`*^9, 3.8942739217119007`*^9}, {
   3.894998341434393*^9, 3.894998341961759*^9}, 3.8949999891844683`*^9, {
   3.895562600424468*^9, 3.895562601208151*^9}, {3.8955629403580523`*^9, 
   3.895562984382148*^9}, {3.89627842606905*^9, 3.896278438743496*^9}, {
   3.8962942280989733`*^9, 3.896294228099409*^9}},
 CellLabel->
  "In[1435]:=",ExpressionUUID->"37dba326-65af-4d26-b164-a1ad89e1e956"],

Cell["Full PB cross w/o 4 sky correlation", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5f76c01c-6f03-4af7-adf3-68705ca399f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBcross4sky.mtx\>\"", ",", 
    RowBox[{
     RowBox[{"CombineMs", "[", 
      RowBox[{"{", 
       RowBox[{
       "CMASSNGCFisherFullPBAP", ",", "CMASSSGCFisherFullPBAP", ",", 
        "LOWZNGCFisherFullPBAP", ",", "LOWZSGCFisherFullPBAP"}], "}"}], "]"}],
      "+", "Prior4sky"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBcrossnoskycorr.mtx\>\"", ",", 
    RowBox[{
    "CMASSNGCFisherFullPBAP", "+", "CMASSSGCFisherFullPBAP", "+", 
     "LOWZNGCFisherFullPBAP", "+", "LOWZSGCFisherFullPBAP", "+", "Priors"}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQze6kEHrk6RvHP5uzo0C0VohhKohOOWgFpvle/mwA
0Q4/jzeC6N08fwrcn71x9OtjKATR3Op2ylXP3zgqOLqAaR2Pbde7XrxxDDh5
E0wvWcMgxf3hjeN/WzUwfczF9srPT28cCyQywHRaROKD/0B6XjSEjkr/6jj5
+xvHivi/YFo6zNbqzs83jucVncD0PIPC8hNMbx1DTCD068e/uU8BaZNnubwg
Oqvrue1jIH1VxdkORD9/zOgMotc8h9CKGYUdT4D0u3wIHbLT7cMe5reOcb0B
YFqpu71cnvWtY8vEKWB6j93JMCO2t44ld73CQXRGwL44EC10ISERRC9ycNrc
zw6059L1LSC6yrQ5azqQ7rCA0ACnbbaM
  "],
 CellLabel->
  "In[1437]:=",ExpressionUUID->"b5b26d45-7d33-458f-a27f-b68364d8263f"],

Cell["\<\
Numerical covariance Diagonals  w/o 4 sky correlation,  w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561149521277*^9, 3.878561157664*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"37b75b25-e553-400d-bfea-d3c56e625ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PNumD4sky.mtx\>\"", ",", 
    RowBox[{
     RowBox[{"CombineMs", "[", 
      RowBox[{"{", 
       RowBox[{
       "PFisherCMASSngcNumD", ",", "PFisherCMASSsgcNumD", ",", 
        "PFisherLOWZngcNumD", ",", "PFisherLOWZsgcNumD"}], "}"}], "]"}], "+", 
     "Prior4sky"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PNumDnoskycorr.mtx\>\"", ",", 
    RowBox[{
    "PFisherCMASSngcNumD", "+", "PFisherCMASSsgcNumD", "+", 
     "PFisherLOWZngcNumD", "+", "PFisherLOWZsgcNumD", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.87856042500806*^9, 3.8785604673657207`*^9}, {
   3.878560553541524*^9, 3.8785605538361073`*^9}, {3.8785606668845263`*^9, 
   3.8785607230883913`*^9}, 3.8785607958129473`*^9, {3.8785610497432823`*^9, 
   3.878561051473467*^9}, {3.878828937134749*^9, 3.878828937400586*^9}, {
   3.879457050333165*^9, 3.879457050606944*^9}, {3.880015552332807*^9, 
   3.8800155540154257`*^9}, {3.88394824256923*^9, 3.883948244238079*^9}, {
   3.885485733103675*^9, 3.88548573444699*^9}, {3.885498115046125*^9, 
   3.8854981150465603`*^9}, {3.8878971044546432`*^9, 3.887897104630121*^9}, {
   3.8890951225151463`*^9, 3.889095122674871*^9}, {3.893773243541869*^9, 
   3.8937732435422983`*^9}, {3.8938280845954723`*^9, 
   3.8938280855583973`*^9}, {3.893828120060096*^9, 3.8938281200606213`*^9}, {
   3.893830723545631*^9, 3.893830723546105*^9}, {3.8942739228767033`*^9, 
   3.894273923194788*^9}, {3.894275207837562*^9, 3.8942752086016006`*^9}, {
   3.894999997115469*^9, 3.894999997429391*^9}, {3.89556293428972*^9, 
   3.895562940358961*^9}, {3.8955630274330673`*^9, 3.895563055362879*^9}, {
   3.896278426071563*^9, 3.89627843874544*^9}, {3.896294228101523*^9, 
   3.896294228101902*^9}},
 CellLabel->
  "In[1439]:=",ExpressionUUID->"d3238f69-5d6e-4c32-9b6d-4171d1ad4664"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBNumD4sky.mtx\>\"", ",", 
    RowBox[{
     RowBox[{"CombineMs", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PFisherCMASSngcNumD", "+", "BFisherCMASSngcNumD"}], ",", 
        RowBox[{"PFisherCMASSsgcNumD", "+", "BFisherCMASSsgcNumD"}], ",", 
        RowBox[{"PFisherLOWZngcNumD", "+", "BFisherLOWZngcNumD"}], ",", 
        RowBox[{"PFisherLOWZsgcNumD", "+", "BFisherLOWZsgcNumD"}]}], "}"}], 
      "]"}], "+", "Prior4sky"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBNumDnoskycorr.mtx\>\"", ",", 
    RowBox[{
    "PFisherCMASSngcNumD", "+", "BFisherCMASSngcNumD", "+", 
     "PFisherCMASSsgcNumD", "+", "BFisherCMASSsgcNumD", "+", 
     "PFisherLOWZngcNumD", "+", "BFisherLOWZngcNumD", "+", 
     "PFisherLOWZsgcNumD", "+", "BFisherLOWZsgcNumD", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQXZRlNv3I0zeODO+TwHTuR905IPqLyZ/FILpkw6lC
92dvHNuaroNps6x05arnbxy9WXPBNMOyuhtdL944Fn9eAKa5dHZKcX8Aqg//
CqZ95CSu/vz0xnHetEAwfWxB4oP/QLpiCYSec1PZafL3N47BBppgWlKXwebO
zzeOJjuEwDR7TWH5Caa3jusaIHTEux92j4F0Q7G4PYhe+JXRGUQf+wWh2+oL
O54A6RXNELoupODDHua3jk5xtWCaw2FnuTzrW8cFd4+C6R7vk2FGbG8dZzd1
h4PoDPUjaWB+2J0MEF0f67S5n/2t44ZH17eAaA2v5qzpQHqtL4QGABrIp/0=

  "],
 CellLabel->
  "In[1441]:=",ExpressionUUID->"91b0e828-3b75-49c9-b1de-24b8e9337e22"],

Cell["Analytical covariance with BTree", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.889150780029705*^9, 3.889150781057974*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d3d9b3ed-2eb6-41e2-9db2-73d8cd50bbed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBanamufullzT.mtx\>\"", ",", 
    RowBox[{
    "FPCnewmu", "+", "FPLnewmu", "+", "FBCT", "+", "FBLT", "+", "Priors"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8891509345255203`*^9, 3.889150943841209*^9}, 
   3.8937732435516653`*^9, {3.8938280996751966`*^9, 3.893828120062434*^9}, 
   3.893830723548007*^9, 3.894273924293372*^9, 3.894999998881249*^9, 
   3.895562940360804*^9, {3.8955631832088003`*^9, 3.89556318778164*^9}, {
   3.896278426075741*^9, 3.896278438746909*^9}, 3.8962942281040163`*^9},
 CellLabel->
  "In[1443]:=",ExpressionUUID->"bc6814a5-fec0-4473-a699-eecabe68e84b"],

Cell["Analytical covariance with full redshift dependence,  w/o B", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"96f144a7-b42f-410f-af72-61653cd1744d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/Panafullz.mtx\>\"", ",", 
    RowBox[{"FPCnew", "+", "FPLnew", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBanafullz.mtx\>\"", ",", 
    RowBox[{
    "FPCnew", "+", "FPLnew", "+", "FBCnew", "+", "FBLnew", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQXcezdfORp28cbXI/bQfRLLWPC92fvXGcoPMMTL8P
LVKuev7GUd+hDUz/Frl9o+vFG8f6nz/BdN4yA2nuD28c11/IBNMaFxZf/fnp
jeMNn49guuZk4oP/QJrnLIROUbFymvz9jWPDPXswXd2qa3vn5xtHvSAnMH1C
K8luCcNbx2/3UsF0ybknbWuAtNLhF2D62d7C8hNMbx33HITQFefv1l4G0kuZ
PzSC6BMiEg6PQTQ7kzOIXtVf2PEESNdOgdAXn8/8sIf5reODhUvB9JXed+Xy
rG8dOxj+gekZk7vDjdjeOvLPhNDfAl6VgWiBiG3lIFqn1r8WRDftLAbTGeVO
m/vZ3zo6vbu+BURnRDdnTQfS1+IgNABKlrw8
  "],
 CellLabel->
  "In[1444]:=",ExpressionUUID->"5822b4d3-f6a2-49ec-b34b-b6824cf48774"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PanafullznoAP.mtx\>\"", ",", 
    RowBox[{"FPCnewnoAP", "+", "FPLnewnoAP", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBanafullznoAP.mtx\>\"", ",", 
    RowBox[{
    "FPCnewnoAP", "+", "FPLnewnoAP", "+", "FBCnewnoAP", "+", "FBLnewnoAP", 
     "+", "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.894278073972187*^9, 3.894278085247191*^9}, {
  3.89500000053529*^9, 3.89500000094811*^9}, {3.895562940363379*^9, 
  3.895562940363927*^9}, {3.895563200311699*^9, 3.895563213746739*^9}, {
  3.895563244539811*^9, 3.895563246197384*^9}, {3.896278426079563*^9, 
  3.896278438748767*^9}, {3.8962942281061707`*^9, 3.8962942281065197`*^9}},
 CellLabel->
  "In[1446]:=",ExpressionUUID->"b23f17ce-2881-431f-a5e2-5d620a7dbc49"],

Cell["\<\
Analytical covariance with full redshift dependence,  w/o B no shot noise \
(full mu)\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.8785632980473537`*^9, 3.87856330051934*^9}, {
   3.878563371022697*^9, 3.878563373199526*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"12256e2f-acd8-46f7-a4c0-5aece70337e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PanamufullzNS.mtx\>\"", ",", 
    RowBox[{"FPCNS", "+", "FPLNS", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBanamufullzNS.mtx\>\"", ",", 
    RowBox[{
    "FPCNS", "+", "FPLNS", "+", "FBCNS", "+", "FBLNS", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQXcezdfORp28cbXI/bQfRWfGhe48C6QmTTu8D0TwX
PpwA0VNmXDgJotmEPha6P3vj6MP1BUz/M5+jXPX8jeOCHavB9GYxmZtdL944
JpU6g+my45OkuT+8cWT4chJM13naXPv56Y2jg30DmP7zPvHBfyCd8RlCm3l/
4hb5/Max0biYB0RH7XsnCqJVOE0lQLTOv0Cnyd/fOM5riwDT30tN7e78BNof
HAamdZ4Xlp9geuv4/xWEZmFY6/AYSLsKMDmD6C2zCjueAOlt8yB03eHNH/Yw
v3Wc8X4fmHZ0M6qQZ33rOGumLZj2XtsdbsT21vH2Jgg9ZypnFYhmkReuA9FK
S5w297O/dVRguLEFRN/Pa86aDqRPFEJoADALu2M=
  "],
 CellLabel->
  "In[1448]:=",ExpressionUUID->"67e7c3f8-5337-4010-93c6-0ec9439fd52e"],

Cell["\<\
Analytical covariance with full redshift dependence full mu dependence,  w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878562694723263*^9, 3.878562699328602*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4d053112-6265-4848-93de-b3efcc95df7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/Panamufullz.mtx\>\"", ",", 
    RowBox[{"FPCnewmu", "+", "FPLnewmu", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBanamufullz.mtx\>\"", ",", 
    RowBox[{
    "FPCnewmu", "+", "FPLnewmu", "+", "FBCnewmu", "+", "FBLnewmu", "+", 
     "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQXcezdfORp28cbXI/bQfRdTbrC48C6Rq+2cUgevmr
v4Xuz944HotlLALRLIvuK1c9f+MocdFQBURbF6y92fXijeObdZfBdMgfVhnu
D28cebyMwfTNjQeu/fwEVL/8LZiuF0t68B9If5OE0KJPs50mf3/j2P2gEExH
HHtvd+fnG8eWPZL2IFqcr6j8BNNbx2JBCB1Twun4GEhfk2ByBtG3VhZ2PAHS
IusgtAz76Q97mN86flNW+wiid/QGVcizvnV8xFgEpm/t6g43Ynvr2LEfQm+S
cq4G0ZOWxtSB6F+bnTb3s791fMZxYwuIvlPenDUdSG+tgtAAGM6ilg==
  "],
 CellLabel->
  "In[1450]:=",ExpressionUUID->"5d4f376a-c9eb-4feb-96c4-71ac681e444c"],

Cell["Perturbative Prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878562694723263*^9, 3.878562699328602*^9}, {
   3.895054532385188*^9, 3.895054536060054*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"24afd76d-9632-47f0-a03d-f0fc70aedf72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/Ppertprior.mtx\>\"", ",", 
    RowBox[{"PPriorCMASS", "+", "PPriorLOWZ"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/BOSS/PBpertprior.mtx\>\"", ",", 
    RowBox[{
    "PPriorCMASS", "+", "PPriorLOWZ", "+", "BPriorCMASS", "+", 
     "BPriorLOWZ"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8950546527914953`*^9, 3.8950547352115717`*^9}, {
  3.895054790541091*^9, 3.895054856054175*^9}, {3.895138758004508*^9, 
  3.895138759859292*^9}, {3.895300529791774*^9, 3.895300531271885*^9}, {
  3.8955629403681498`*^9, 3.895562940369946*^9}, {3.89556338126552*^9, 
  3.895563391695134*^9}, {3.896278426086171*^9, 3.896278438752058*^9}, {
  3.896294228109499*^9, 3.896294228109898*^9}},
 CellLabel->
  "In[1251]:=",ExpressionUUID->"cf360b77-bd79-43c8-91f8-e536d95d9d41"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DESI", "Section",
 CellChangeTimes->{{3.873874436782016*^9, 3.873874440817452*^9}, {
  3.8739643915210037`*^9, 3.8739643916267567`*^9}, {3.8739713597098627`*^9, 
  3.873971360089781*^9}, {3.874335391625215*^9, 3.874335393416067*^9}, {
  3.8743951131865683`*^9, 3.874395114134469*^9}, {3.8783307046760273`*^9, 
  3.878330709107346*^9}, {3.8784125376829357`*^9, 
  3.8784125380319443`*^9}},ExpressionUUID->"9dc04e7d-2286-41d6-b255-\
e32bdb1eb20f"],

Cell[CellGroupData[{

Cell["DESI specifications and derivative computations", "Subsection",
 CellChangeTimes->{{3.878331664336233*^9, 3.878331667108832*^9}, {
  3.878331979807946*^9, 3.878331981863579*^9}, {3.8783783257461557`*^9, 
  3.8783783354989758`*^9}, {3.8784125428781147`*^9, 3.878412543313261*^9}, {
  3.878472169285952*^9, 
  3.8784721729778547`*^9}},ExpressionUUID->"e24b793c-dcc7-434b-8553-\
e45a2ce63b97"],

Cell["DESI numbers fully binned", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.8783836881286488`*^9}, {3.87847219786552*^9, 
  3.87847219890026*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9d114d1d-c15c-452d-a233-426b1543282b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "z", ",", "nb", ",", "V", ",", "N", ",", "Dg", ",", "fs", ",", "b1"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.885475406295229*^9, 3.885475406724741*^9}},
 CellLabel->
  "In[571]:=",ExpressionUUID->"cdc36615-81d6-4783-9871-f7d68c2eb144"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DESIspec", " ", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.65`", ",", "0.75`", ",", "0.85`", ",", "0.95`", ",", "1.05`", ",", 
       "1.15`", ",", "1.25`", ",", "1.35`", ",", "1.45`", ",", "1.55`", ",", 
       "1.65`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00016448669201520912`", ",", "0.0010084444444444446`", ",", 
       "0.0007375890410958904`", ",", "0.0007150243902439025`", ",", 
       "0.0004463274336283186`", ",", "0.00038736196319018404`", ",", 
       "0.0003585823754789272`", ",", "0.00013312727272727273`", ",", 
       "0.00011346086956521739`", ",", "0.00007715242881072026`", ",", 
       "0.000028682926829268292`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2.63`*^9", ",", "3.15`*^9", ",", "3.65`*^9", ",", 
       "4.0999999999999995`*^9", ",", "4.52`*^9", ",", "4.89`*^9", ",", 
       "5.22`*^9", ",", "5.5`*^9", ",", "5.75`*^9", ",", "5.97`*^9", ",", 
       "6.15`*^9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "432600.`", ",", "3.1766`*^6", ",", "2.6922`*^6", ",", "2.9316`*^6", 
       ",", "2.0174`*^6", ",", "1.8942`*^6", ",", "1.8718`*^6", ",", 
       "732200.`", ",", "652400.`", ",", "460600.`", ",", "176400.`"}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0.7147268398976079", ",", "0.6814195172840236", ",", 
       "0.6505961593752985", ",", "0.6220672608943191", ",", 
       "0.5956450407211369", ",", "0.5711494009737322", ",", 
       "0.5484113115796533", ",", "0.5272744484842405", ",", 
       "0.5075956926551383", ",", "0.4892449166420755", ",", 
       "0.47210435196678463"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.799023714461632", ",", "0.8226875527129273", ",", 
       "0.8429531428816396", ",", "0.8603132350398828", ",", 
       "0.8752024918671701", ",", "0.8879970333021452", ",", 
       "0.8990181249903924", ",", "0.9085378342658417", ",", 
       "0.9167853192345018", ",", "0.923952996823696", ",", 
       "0.9302022056485543"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.1752741790420782`", ",", "1.2327207816823922`", ",", 
       "1.2911235147876785`", ",", "1.350336294490677`", ",", 
       "1.4102358662854422`", ",", "1.4707185170253423`", ",", 
       "1.5316970716385292`", ",", "1.5930982478190507`", ",", 
       "1.6548603783576588`", ",", "1.716931482426688`", ",", 
       "1.7792676481387295`"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877265916864263*^9, 3.877265918514963*^9}, {
   3.878382336152431*^9, 3.878382338551983*^9}, {3.878382424749436*^9, 
   3.878382427765259*^9}, 3.87838246170047*^9, {3.878383826491439*^9, 
   3.8783838277095737`*^9}, {3.8784126741830482`*^9, 3.878412728189921*^9}, {
   3.878413729299*^9, 3.878413732493112*^9}, {3.883946997741747*^9, 
   3.8839470053838253`*^9}, {3.885475653516025*^9, 3.885475654368307*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"ebc1873c-3297-4227-95ca-674e0864e580"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DESIcut", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.878383193930118*^9, 3.878383199484385*^9}, {
  3.878412731287475*^9, 3.878412737223034*^9}, {3.8854754830606318`*^9, 
  3.8854754835922832`*^9}},
 CellLabel->
  "In[573]:=",ExpressionUUID->"cb03ec05-67eb-44a2-bed7-55d63236e263"],

Cell["Get zeffs and define cental values", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
   3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
   3.87387541354895*^9}, {3.878382212762868*^9, 3.878382216951807*^9}, 
   3.878382259950922*^9, 3.8783829477289057`*^9, {3.878383185752803*^9, 
   3.878383210959243*^9}, {3.878383719533955*^9, 3.878383723260166*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7684840b-5063-42b2-ba7e-a6b0c71fc10f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"D1spec", " ", "=", " ", 
   RowBox[{"DESIspec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{";;", "DESIcut"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D2spec", " ", "=", " ", 
   RowBox[{"DESIspec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"DESIcut", "+", "1"}], ";;"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87729569843889*^9, 3.8772957323200274`*^9}, {
   3.878382358668338*^9, 3.87838237967688*^9}, 3.878382526664139*^9, {
   3.878383218340361*^9, 3.878383219242804*^9}, {3.8784127697887297`*^9, 
   3.878412786626348*^9}, {3.8938299056183767`*^9, 3.893829905618813*^9}, {
   3.893830385110652*^9, 3.893830386397552*^9}},
 CellLabel->
  "In[574]:=",ExpressionUUID->"ad045768-9dbc-4c9b-8acf-1c5e11ef52d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dg84", "=", "0.6535721061961522"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dg122", " ", "=", "0.5528260185623496"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8784127675887203`*^9, 3.883947140355877*^9, 3.883947196669585*^9, {
   3.883948674054797*^9, 3.883948674933312*^9}},
 CellLabel->
  "In[576]:=",ExpressionUUID->"300402dd-b2d6-4e55-823c-67d534b7a5d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DESI1pk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"DESI1", ",", "0.84"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DESI2pk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"DESI2", ",", "1.23"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8727413630602694`*^9, 3.8727413655934258`*^9}, {
   3.8727546915351477`*^9, 3.872754694985199*^9}, {3.872766326967618*^9, 
   3.8727663281148233`*^9}, 3.872770560272434*^9, {3.873359960402536*^9, 
   3.8733599619315567`*^9}, {3.87346870319875*^9, 3.873468706946323*^9}, {
   3.8739667794686813`*^9, 3.8739667861596413`*^9}, {3.874402252136847*^9, 
   3.874402253720666*^9}, 3.878412807295249*^9, {3.8839471978510523`*^9, 
   3.883947197918229*^9}, {3.885487189241061*^9, 3.885487190032309*^9}, {
   3.89500006766357*^9, 3.895000070258225*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"bf49c247-3fd5-41ed-8817-172892ed057c"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.896415384854539*^9},
 CellLabel->
  "Out[578]=",ExpressionUUID->"74eb7c64-fe4f-4ed6-9ad6-02ecfab2c475"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.896415384964521*^9},
 CellLabel->
  "Out[579]=",ExpressionUUID->"e77eecb1-7eac-464b-9868-56b12481de27"]
}, Closed]],

Cell["\<\
Shotnoise estimates (these are not entering the covariance, so they are not \
very important) \
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.8784128456142693`*^9, 3.8784128674174213`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"03d88bcd-1a9d-476a-b75e-49c6b819a78b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbD1", " ", "=", " ", 
   RowBox[{"nb", "->", "0.0007967599137945827`"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbD2", " ", "=", " ", 
   RowBox[{"nb", "->", "0.0003225432700956092`"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873875438860836*^9, 3.873875447797975*^9}, 
   3.873964417558131*^9, {3.874994697144123*^9, 3.8749947131881104`*^9}, {
   3.877976102770084*^9, 3.8779761140267982`*^9}, {3.878157695711175*^9, 
   3.8781577092274923`*^9}, 3.8783854049941874`*^9, {3.878412843664546*^9, 
   3.878412850054669*^9}, {3.8784134875786963`*^9, 3.878413489915539*^9}, {
   3.8784744740677643`*^9, 3.878474538323855*^9}, {3.8784752846022997`*^9, 
   3.878475286598607*^9}},
 CellLabel->
  "In[512]:=",ExpressionUUID->"d24b71c7-6919-4b75-9781-02ba20b9b380"],

Cell["Get knls", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.8784128456142693`*^9, 3.8784128674174213`*^9}, {
  3.8788279868867903`*^9, 3.878827989607279*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"147c90f9-715a-43da-b6fa-0897a1be95bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"knlD1", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"knl", "->", 
    RowBox[{
     RowBox[{"Getknl", "[", 
      RowBox[{"DESI1pk", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"knlD2", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"knl", "->", 
    RowBox[{
     RowBox[{"Getknl", "[", 
      RowBox[{"DESI2pk", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.873875438860836*^9, 3.873875447797975*^9}, 
   3.873964417558131*^9, {3.874994697144123*^9, 3.8749947131881104`*^9}, {
   3.877976102770084*^9, 3.8779761140267982`*^9}, {3.878157695711175*^9, 
   3.8781577092274923`*^9}, 3.8783854049941874`*^9, {3.878412843664546*^9, 
   3.878412850054669*^9}, {3.8784134875786963`*^9, 3.878413489915539*^9}, {
   3.8784744740677643`*^9, 3.878474538323855*^9}, {3.8784752846022997`*^9, 
   3.878475286598607*^9}, {3.878828030959343*^9, 3.8788280822885647`*^9}, {
   3.8788281309424133`*^9, 3.8788281470172*^9}},
 CellLabel->
  "In[514]:=",ExpressionUUID->"669feba5-22fd-4ccf-abc2-da44dae88455"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"knl", "\[Rule]", "0.900781857042824`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878828069131722*^9, 3.878828083007677*^9}, 
   3.878828140560945*^9, 3.878895296746582*^9, 3.878895366128173*^9, 
   3.879162372174494*^9, 3.879167876231876*^9, 3.87927319962393*^9, 
   3.879464562629951*^9, 3.879614608711897*^9, 3.8798135714191*^9, 
   3.880016335289805*^9, 3.880051708898408*^9, 3.8839492125351133`*^9, 
   3.884003487231902*^9, 3.884253354502145*^9, 3.884325383256138*^9, 
   3.885487263582037*^9, 3.885555576162869*^9, 3.886840555980873*^9, 
   3.886935261956811*^9, 3.8878819596622057`*^9, 3.887891504141563*^9, 
   3.888396188890135*^9, 3.888755221442067*^9, 3.8891369618167763`*^9, 
   3.890668604594082*^9, 3.893777180175665*^9, 3.89379332656708*^9, 
   3.893799916112402*^9, 3.895000147281357*^9, 3.8951388517133713`*^9, 
   3.895563955208405*^9, 3.896287652138948*^9, 3.896328962918601*^9},
 CellLabel->
  "Out[514]=",ExpressionUUID->"c0207e09-e0d6-4352-a0f4-148c43dfe79b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"knl", "\[Rule]", "1.2853729499576831`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878828069131722*^9, 3.878828083007677*^9}, 
   3.878828140560945*^9, 3.878895296746582*^9, 3.878895366128173*^9, 
   3.879162372174494*^9, 3.879167876231876*^9, 3.87927319962393*^9, 
   3.879464562629951*^9, 3.879614608711897*^9, 3.8798135714191*^9, 
   3.880016335289805*^9, 3.880051708898408*^9, 3.8839492125351133`*^9, 
   3.884003487231902*^9, 3.884253354502145*^9, 3.884325383256138*^9, 
   3.885487263582037*^9, 3.885555576162869*^9, 3.886840555980873*^9, 
   3.886935261956811*^9, 3.8878819596622057`*^9, 3.887891504141563*^9, 
   3.888396188890135*^9, 3.888755221442067*^9, 3.8891369618167763`*^9, 
   3.890668604594082*^9, 3.893777180175665*^9, 3.89379332656708*^9, 
   3.893799916112402*^9, 3.895000147281357*^9, 3.8951388517133713`*^9, 
   3.895563955208405*^9, 3.896287652138948*^9, 3.896328963404681*^9},
 CellLabel->
  "Out[515]=",ExpressionUUID->"317d1da6-de22-43bd-afb3-232fd88a97b1"]
}, Closed]],

Cell["\<\
Parameters bestfit from BOSS, rescaled to DESI. We study \
ELG\[CloseCurlyQuote]s with b1 = 0.84/D(z) (arxiv: 1611.00036)\
\>", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
   3.878318564396934*^9, 3.8783185665840807`*^9}, {3.8783189236834927`*^9, 
   3.8783189249818363`*^9}, {3.8783193275467777`*^9, 3.878319330519642*^9}, {
   3.878412930164959*^9, 3.8784129331531353`*^9}, {3.878468739621086*^9, 
   3.878468764008396*^9}, 3.878468929463129*^9, {3.878472218988697*^9, 
   3.878472222141864*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"46c8be11-5b6a-4662-b143-c8c5d6924101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bzDESI", "=", 
   RowBox[{
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DESIspec", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"DESIspec", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "//", "Interpolation"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.885487221754717*^9, 3.8854872726545763`*^9}},
 CellLabel->
  "In[516]:=",ExpressionUUID->"4fcf7cdb-7b5f-429a-9577-3bc085e0de06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bfixD1", "=", 
   RowBox[{"bfixn", "[", 
    RowBox[{"1.2840552874707236`", ",", "bfixstoch"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bfixD2", "=", 
   RowBox[{"bfixn", "[", 
    RowBox[{"1.517557939573598`", ",", "bfixstoch"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878416120196289*^9, 3.878416123743026*^9}, {
  3.878468908844494*^9, 3.878468919782895*^9}, {3.880021147654973*^9, 
  3.88002117358323*^9}, {3.8800212040090113`*^9, 3.880021205303651*^9}, {
  3.885487439365295*^9, 3.885487459522163*^9}},
 CellLabel->
  "In[517]:=",ExpressionUUID->"ea010dae-35df-475e-a878-a2a956cbf13d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffixD1", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"bfixD1", ",", "fnlfix", ",", "paramfix", ",", "knlD1"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffixD2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"bfixD2", ",", "fnlfix", ",", "paramfix", ",", "knlD2"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.878413056459043*^9, 3.8784130699454308`*^9}, {
  3.878828148880385*^9, 3.878828154550186*^9}},
 CellLabel->
  "In[519]:=",ExpressionUUID->"87f1b74a-856f-48dd-92c9-161fc5aa9214"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffixD1NS", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Be1", "->", "0"}], "}"}], ",", "coeffixD1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffixD2NS", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Be1", "->", "0"}], "}"}], ",", "coeffixD2"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87838627110912*^9, 3.878386275887601*^9}, {
  3.878413076912022*^9, 3.878413089914109*^9}},
 CellLabel->
  "In[521]:=",ExpressionUUID->"ce00a6d4-1e7f-4fd7-b2db-b79cbd26280b"],

Cell["Binning sizes", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781577058616667`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"f9e4aeed-5db0-4d23-9b66-d54ede36857b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dkPD", " ", "=", " ", 
   RowBox[{"dk", "->", "0.005"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dkBD", "=", 
   RowBox[{"dk", "->", "0.02"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87841338734165*^9, 3.878413390596964*^9}, {
  3.878895198364472*^9, 3.878895200016375*^9}, {3.879272980867515*^9, 
  3.8792729937972116`*^9}, {3.879443486625546*^9, 3.879443486748362*^9}},
 CellLabel->
  "In[523]:=",ExpressionUUID->"232912b2-3d6b-4db3-bfaa-087868dedffc"],

Cell["New kmax", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878396838288425*^9, 3.878396840811236*^9}, {
  3.887878940174028*^9, 3.88787895498912*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7f80fef4-c35d-4017-b22d-49b58ec98d3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcD1TNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "DESI1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "DESI1pk", ",", "D1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcD2TNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "DESI2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "DESI2pk", ",", "D2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8883213342139587`*^9, 3.888321344542603*^9}, {
  3.8883222334019747`*^9, 3.8883222450217333`*^9}, {3.895474294925514*^9, 
  3.895474294926197*^9}},
 CellLabel->
  "In[525]:=",ExpressionUUID->"487d68f5-d8d0-4f1c-aeb9-0368ab107c03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcD1NS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "DESI1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "DESI1pk", ",", "D1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcD2NS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "DESI2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "DESI2pk", ",", "D2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895474294927011*^9, 3.8954742949275293`*^9}},
 CellLabel->
  "In[527]:=",ExpressionUUID->"88009036-0dc9-4235-9499-2d85267b895d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcD1NS2L", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory2L", "[", 
     RowBox[{"k", ",", "DESI1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "DESI1pk", ",", "D1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcD2NS2L", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory2L", "[", 
     RowBox[{"k", ",", "DESI2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "DESI2pk", ",", "D2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895474294928274*^9, 3.895474294928773*^9}},
 CellLabel->
  "In[529]:=",ExpressionUUID->"1a91335e-80e5-4f97-b755-002d2148a75e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxD1Tree", " ", "=", " ", 
  RowBox[{
   RowBox[{"GetkmaxT", "[", "funcD1TNS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxD2Tree", " ", "=", 
  RowBox[{
   RowBox[{"GetkmaxT", "[", "funcD2TNS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.88788945578306*^9, 3.887889469612871*^9}, {
  3.887889544719244*^9, 3.8878895541435833`*^9}, {3.888325038714127*^9, 
  3.8883250591134853`*^9}},
 CellLabel->
  "In[531]:=",ExpressionUUID->"4369a36a-1e7d-4cf2-a14d-cfb50eb4e6d2"],

Cell[BoxData["0.08388100643036428`"], "Output",
 CellChangeTimes->{3.8878895611407423`*^9, 3.8878915115109587`*^9, 
  3.888325083761134*^9, 3.888396201834279*^9, 3.8887552341973*^9, 
  3.889136974191633*^9, 3.890668616983884*^9, 3.8937771933311853`*^9, 
  3.8937933396011667`*^9, 3.893799928954615*^9, 3.895000159638335*^9, 
  3.895138863966775*^9, 3.895563967868286*^9, 3.896287665140339*^9, 
  3.896328975394167*^9},
 CellLabel->
  "Out[531]=",ExpressionUUID->"a0ba9e80-22b8-4162-85ca-0e384b87d9be"],

Cell[BoxData["0.09278944898719826`"], "Output",
 CellChangeTimes->{3.8878895611407423`*^9, 3.8878915115109587`*^9, 
  3.888325083761134*^9, 3.888396201834279*^9, 3.8887552341973*^9, 
  3.889136974191633*^9, 3.890668616983884*^9, 3.8937771933311853`*^9, 
  3.8937933396011667`*^9, 3.893799928954615*^9, 3.895000159638335*^9, 
  3.895138863966775*^9, 3.895563967868286*^9, 3.896287665140339*^9, 
  3.896328981767934*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"35c719c2-f0c6-4909-89c8-d11c1d75b54b"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxD1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Getkmax", "[", "funcD1NS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxD2", " ", "=", 
  RowBox[{
   RowBox[{"Getkmax", "[", "funcD2NS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "In[533]:=",ExpressionUUID->"5b57d09d-9be6-492b-ab54-0639bbed06ca"],

Cell[BoxData["0.18451084858764663`"], "Output",
 CellChangeTimes->{3.888325096594342*^9, 3.888396213394904*^9, 
  3.888755246164033*^9, 3.889136985741173*^9, 3.890668628558234*^9, 
  3.893777207694084*^9, 3.8937933537988653`*^9, 3.893799941656*^9, 
  3.895000172036256*^9, 3.895138876415204*^9, 3.8955639807009974`*^9, 
  3.896287678351309*^9, 3.896328987970669*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"764f1401-1613-4265-8132-56318c02b371"],

Cell[BoxData["0.22503093020552403`"], "Output",
 CellChangeTimes->{3.888325096594342*^9, 3.888396213394904*^9, 
  3.888755246164033*^9, 3.889136985741173*^9, 3.890668628558234*^9, 
  3.893777207694084*^9, 3.8937933537988653`*^9, 3.893799941656*^9, 
  3.895000172036256*^9, 3.895138876415204*^9, 3.8955639807009974`*^9, 
  3.896287678351309*^9, 3.896328996460868*^9},
 CellLabel->
  "Out[534]=",ExpressionUUID->"c052401c-ef5e-4fd4-856c-93edea8f056f"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxD12L", " ", "=", " ", 
  RowBox[{
   RowBox[{"Getkmax2L", "[", "funcD1NS2L", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxD22L", " ", "=", 
  RowBox[{
   RowBox[{"Getkmax2L", "[", "funcD2NS2L", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.888325047070911*^9, 3.888325065946267*^9}, {
  3.888325144379429*^9, 3.888325147422266*^9}},
 CellLabel->
  "In[535]:=",ExpressionUUID->"2bfd14c5-5673-46aa-b434-9af90fe6ca69"],

Cell[BoxData["0.2486190668444213`"], "Output",
 CellChangeTimes->{3.8883251402811823`*^9, 3.888325180777462*^9, 
  3.8883962273737097`*^9, 3.888755260370247*^9, 3.889136999536827*^9, 
  3.8906686420236197`*^9, 3.8937772215296097`*^9, 3.893793367736846*^9, 
  3.893799956718671*^9, 3.895000186862851*^9, 3.895138891275607*^9, 
  3.895563996321246*^9, 3.896287694140115*^9, 3.896329002992572*^9},
 CellLabel->
  "Out[535]=",ExpressionUUID->"097b6933-a611-434c-99e6-24f4103ffbd8"],

Cell[BoxData["0.3017720734997178`"], "Output",
 CellChangeTimes->{3.8883251402811823`*^9, 3.888325180777462*^9, 
  3.8883962273737097`*^9, 3.888755260370247*^9, 3.889136999536827*^9, 
  3.8906686420236197`*^9, 3.8937772215296097`*^9, 3.893793367736846*^9, 
  3.893799956718671*^9, 3.895000186862851*^9, 3.895138891275607*^9, 
  3.895563996321246*^9, 3.896287694140115*^9, 3.89632901191451*^9},
 CellLabel->
  "Out[536]=",ExpressionUUID->"13050e8d-28de-4d79-a625-fe5203eb58ff"]
}, Closed]],

Cell["Get triangles and ktabs", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.878413323616858*^9, 
  3.878413329145935*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"b459a432-99dd-4f0a-a33b-50711b20077a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabDESI1", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxD1"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktabDESI2", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxD2"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878416313557293*^9, 3.878416313604795*^9}, {
  3.8784696138095818`*^9, 3.878469623177285*^9}},
 CellLabel->
  "In[537]:=",ExpressionUUID->"63d5f455-69c8-4e76-b000-b112fc6cf649"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabDESI12L", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxD12L"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktabDESI22L", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxD22L"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8785584476721*^9, 3.878558472747843*^9}, {
  3.878828445074198*^9, 3.878828447624235*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"bd946261-6582-43d5-a07b-7cfd643a3178"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keffDESI1", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD1", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffDESI2", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD2", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DESItriangs1", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD1", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DESItriangs2", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD2", "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873468583303989*^9, 3.873468660291182*^9}, {
   3.87387514677607*^9, 3.873875146950919*^9}, {3.873964428032702*^9, 
   3.873964462207315*^9}, 3.8739665707698593`*^9, {3.87396675335675*^9, 
   3.8739667596310387`*^9}, {3.873971006821004*^9, 3.873971008067816*^9}, {
   3.8783319345931463`*^9, 3.878331935928195*^9}, {3.8784131133383417`*^9, 
   3.878413114721896*^9}, 3.878413177209508*^9, {3.87841329842533*^9, 
   3.8784133219391823`*^9}, {3.878413355587755*^9, 3.878413371590088*^9}, {
   3.878416309245821*^9, 3.8784163112058496`*^9}, {3.878469617381531*^9, 
   3.878469631412734*^9}, 3.8791625847409887`*^9},
 CellLabel->
  "In[541]:=",ExpressionUUID->"a0dc2caf-42d8-486b-b6c0-76d154ef45ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keffDESI1T", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD1Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffDESI2T", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD2Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DESItriangs1T", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD1Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DESItriangs2T", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxD2Tree", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879443679782651*^9, 3.879443692204735*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"64d79caf-c8ca-4974-ac73-4907a1c66abd"],

Cell["Analytical Covariance", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.878383948812495*^9, 3.878383950482119*^9}, {
  3.878386152574986*^9, 3.8783861554874563`*^9}, {3.8783863995820503`*^9, 
  3.8783864090286303`*^9}, {3.878389253828569*^9, 3.878389261403257*^9}, {
  3.878389696132431*^9, 3.878389697083682*^9}, {3.878391368215104*^9, 
  3.878391370393168*^9}, {3.879444021037825*^9, 3.879444022109733*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"10ef4e9f-e56a-41cb-9e6c-b7e59d2c5f47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVD1P", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabDESI1", ",", "DESI1pk", ",", "D1spec", ",", "bfixstoch", ",", 
     "dkPD"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVD2P", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabDESI2", ",", "DESI2pk", ",", "D2spec", ",", "bfixstoch", ",", 
     "dkPD"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878413397061933*^9, 3.878413454346937*^9}, {
  3.885487767883708*^9, 3.8854877696786337`*^9}, {3.89547429492945*^9, 
  3.8954742949298553`*^9}},
 CellLabel->
  "In[549]:=",ExpressionUUID->"80f78020-7985-47a8-bc7a-ddac7aa8f245"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVD1P2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabDESI12L", ",", "DESI1pk", ",", "D1spec", ",", "bfixstoch", ",", 
     "dkPD"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVD2P2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabDESI22L", ",", "DESI2pk", ",", "D2spec", ",", "bfixstoch", ",", 
     "dkPD"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878558434307478*^9, 3.8785584361033487`*^9}, {
  3.8785584788055162`*^9, 3.878558481015215*^9}, {3.885487773150749*^9, 
  3.885487775052058*^9}, {3.89547429493047*^9, 3.8954742949308567`*^9}},
 CellLabel->
  "In[551]:=",ExpressionUUID->"109a8bd2-fc0d-4f42-8f3a-15e9135e5c80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVD1B", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "DESItriangs1", ",", "DESI1pk", ",", "D1spec", ",", "bfixstoch", ",", 
     "dkBD"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVD2B", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "DESItriangs2", ",", "DESI2pk", ",", "D2spec", ",", "bfixstoch", ",", 
     "dkBD"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8783896333113213`*^9, 3.87838968310667*^9}, {
  3.8784134045571423`*^9, 3.8784134085948544`*^9}, {3.8784137993589277`*^9, 
  3.8784138395801277`*^9}, {3.885487778220949*^9, 3.88548778383253*^9}, {
  3.895474420606536*^9, 3.895474420607011*^9}},
 CellLabel->
  "In[553]:=",ExpressionUUID->"fc5a314f-7058-4193-beeb-77bc3e94ac1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVD1BTree", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "DESItriangs1T", ",", "DESI1pk", ",", "D1spec", ",", "bfixstoch", ",", 
     "dkBD"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVD2BTree", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "DESItriangs2T", ",", "DESI2pk", ",", "D2spec", ",", "bfixstoch", ",", 
     "dkBD"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879443702925356*^9, 3.879443718673381*^9}, {
  3.8854877903105297`*^9, 3.885487792418387*^9}, {3.895474420607696*^9, 
  3.895474420608159*^9}},
 CellLabel->
  "In[555]:=",ExpressionUUID->"175a5ae1-bcbf-4d0e-9d02-9a5910b3405b"],

Cell["Analytical Covariance with Full redshift- No shot noise", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.878383948812495*^9, 3.878383950482119*^9}, {
  3.878386152574986*^9, 3.8783861554874563`*^9}, {3.8783863995820503`*^9, 
  3.8783864090286303`*^9}, {3.878389253828569*^9, 3.878389261403257*^9}, {
  3.878389696132431*^9, 3.878389697083682*^9}, {3.878391368215104*^9, 
  3.878391370393168*^9}, {3.8783917561480427`*^9, 3.878391759615937*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2fe4f3ca-47bc-48c2-9a80-2c3b05cd7b75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVD1PNS", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabDESI1", ",", "DESI1pk", ",", "D1spec", ",", "bfixstochNS", ",", 
     "dkPD"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVD2PNS", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabDESI2", ",", "DESI2pk", ",", "D2spec", ",", "bfixstochNS", ",", 
     "dkPD"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8783917610267467`*^9, 3.878391811683134*^9}, {
  3.87841377765718*^9, 3.878413785369425*^9}, {3.885487799618672*^9, 
  3.885487809317132*^9}, {3.895474294931479*^9, 3.895474294931904*^9}},
 CellLabel->
  "In[557]:=",ExpressionUUID->"0f946115-eebb-4f7f-86b9-4caabd1c060e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVD1BNS", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "DESItriangs1", ",", "DESI1pk", ",", "D1spec", ",", "bfixstochNS", ",", 
     "dkBD"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVD2BNS", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "DESItriangs2", ",", "DESI2pk", ",", "D2spec", ",", "bfixstochNS", ",", 
     "dkBD"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8783896333113213`*^9, 3.87838968310667*^9}, {
  3.878391763493541*^9, 3.878391769578429*^9}, {3.878391963015897*^9, 
  3.878391965147833*^9}, {3.8784138495762*^9, 3.878413856324275*^9}, {
  3.8854878105211287`*^9, 3.8854878188473682`*^9}, {3.885551573539637*^9, 
  3.885551575649675*^9}, {3.895474420608839*^9, 3.895474420609281*^9}},
 CellLabel->
  "In[559]:=",ExpressionUUID->"88038be2-c7df-4c4c-83fd-0a9267457bde"],

Cell["Powerspectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332301420657*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"6ee912e9-2be6-4fba-a41a-d7fdbe58ca20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PD1derivs", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"P1Loopderivs", "[", 
        RowBox[{
         RowBox[{"ktabDESI1", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "DESI1pk"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabDESI1", "]"}]}], "}"}]}], "]"}], "/.", 
     "coeffixD1"}], "/.", "nbD1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PD2derivs", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"P1Loopderivs", "[", 
        RowBox[{
         RowBox[{"ktabDESI2", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "DESI2pk"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabDESI2", "]"}]}], "}"}]}], "]"}], "/.", 
     "coeffixD2"}], "/.", "nbD2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873518998897326*^9, 3.873519007688743*^9}, {
   3.873519068623493*^9, 3.873519077607183*^9}, {3.873519615193363*^9, 
   3.873519620203136*^9}, {3.8735196572278223`*^9, 3.8735196641762877`*^9}, {
   3.873875798249857*^9, 3.873875813066736*^9}, {3.873966975417568*^9, 
   3.87396704163301*^9}, 3.873967115591464*^9, 3.878332335499425*^9, {
   3.878385477696348*^9, 3.878385485946587*^9}, {3.878469768836133*^9, 
   3.878469827807899*^9}},
 CellLabel->
  "In[561]:=",ExpressionUUID->"e3de954a-76d9-4750-a916-3aabd0e360ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PD1derivs2L", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"P1Loopderivs", "[", 
        RowBox[{
         RowBox[{"ktabDESI12L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "DESI1pk"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabDESI12L", "]"}]}], "}"}]}], "]"}], "/.", 
     "coeffixD1"}], "/.", "nbD1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PD2derivs2L", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"P1Loopderivs", "[", 
        RowBox[{
         RowBox[{"ktabDESI22L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "DESI2pk"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabDESI12L", "]"}]}], "}"}]}], "]"}], "/.", 
     "coeffixD2"}], "/.", "nbD2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878558488013879*^9, 3.878558503187212*^9}},
 CellLabel->
  "In[563]:=",ExpressionUUID->"8bfac2f6-3470-45a9-a932-e94974886974"],

Cell["Bispectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ced054ce-f201-43aa-bef6-c5c3c87ffb89"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BD1derivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"keffDESI1T", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "DESI1pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixD1", "]"}]}], "/.", "nbD1"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffDESI1T", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BD2derivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"keffDESI2T", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "DESI2pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixD2", "]"}]}], "/.", "nbD2"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffDESI2T", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.879245916889481*^9, 3.8792459222897463`*^9}, {
   3.879272284429164*^9, 3.879272308042398*^9}, {3.879273540000227*^9, 
   3.879273585850821*^9}, {3.879443765001204*^9, 3.879443801574843*^9}, {
   3.87944395577462*^9, 3.8794439612924356`*^9}, {3.879614464369382*^9, 
   3.8796144653868237`*^9}, 3.888326036844542*^9},
 CellLabel->
  "In[565]:=",ExpressionUUID->"60b9f31d-ee0d-4152-a17f-53d559da6b38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.911963`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.879245994377934*^9, {3.879272298200151*^9, 3.8792723063282747`*^9}, 
   3.879272762779117*^9, 3.879275261969735*^9, 3.879538141485125*^9, 
   3.879614754495426*^9, 3.880017166590521*^9, 3.8800526159821653`*^9, 
   3.884004293825638*^9, 3.885489349718595*^9, 3.885556367194944*^9, 
   3.886841351352572*^9, 3.887012226079535*^9, 3.887895040811264*^9, 
   3.8883259963603086`*^9, 3.888397042939661*^9, 3.888756170420348*^9, 
   3.8937779074415092`*^9, 3.893800774649721*^9, 3.895000993858197*^9, 
   3.895139110773234*^9, 3.8955647859514713`*^9, 3.896288533623783*^9, 
   3.8963297999578333`*^9},
 CellLabel->
  "Out[565]=",ExpressionUUID->"9054a439-a155-48f3-944b-69f2639497ab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.927507`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.879245994377934*^9, {3.879272298200151*^9, 3.8792723063282747`*^9}, 
   3.879272762779117*^9, 3.879275261969735*^9, 3.879538141485125*^9, 
   3.879614754495426*^9, 3.880017166590521*^9, 3.8800526159821653`*^9, 
   3.884004293825638*^9, 3.885489349718595*^9, 3.885556367194944*^9, 
   3.886841351352572*^9, 3.887012226079535*^9, 3.887895040811264*^9, 
   3.8883259963603086`*^9, 3.888397042939661*^9, 3.888756170420348*^9, 
   3.8937779074415092`*^9, 3.893800774649721*^9, 3.895000993858197*^9, 
   3.895139110773234*^9, 3.8955647859514713`*^9, 3.896288533623783*^9, 
   3.896329801884935*^9},
 CellLabel->
  "Out[566]=",ExpressionUUID->"10d6d91f-aa02-4476-8c91-0cb0701c950b"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BD1derivspre", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"B1Loopderivs", "[", 
           RowBox[{
            RowBox[{"keffDESI1", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "DESI1pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixD1", "]"}]}], "/.", "nbD1"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffDESI1", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BD2derivspre", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"B1Loopderivs", "[", 
           RowBox[{
            RowBox[{"keffDESI2", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "DESI2pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixD2", "]"}]}], "/.", "nbD2"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffDESI2", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8785521935616207`*^9, 3.8785522163665543`*^9}, {
   3.87884158011763*^9, 3.8788415890454407`*^9}, {3.878841624574361*^9, 
   3.878841628821933*^9}, {3.878841672075293*^9, 3.878841692043252*^9}, {
   3.879272382126865*^9, 3.879272382548891*^9}, 3.879272437352563*^9, {
   3.879273597040414*^9, 3.879273657311171*^9}, {3.879275535764578*^9, 
   3.879275542273411*^9}, {3.879443755201642*^9, 3.8794437586852493`*^9}, {
   3.879443950237886*^9, 3.879443953443111*^9}, {3.888046840633658*^9, 
   3.888046843435813*^9}, 3.888326035216516*^9},
 CellLabel->
  "In[567]:=",ExpressionUUID->"78c4a38b-0a7a-49bd-88c2-578d1d029185"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"333.108297`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.878841587504867*^9, 3.878841598064604*^9}, 
   3.878841640871646*^9, {3.87884167462574*^9, 3.878841698183589*^9}, 
   3.878843692285396*^9, 3.879179364663685*^9, 3.879275597923889*^9, 
   3.879538498841076*^9, 3.8800174081213913`*^9, 3.880052851937043*^9, 
   3.884004535624173*^9, 3.885489610076766*^9, 3.885556628570943*^9, 
   3.886841607405056*^9, 3.8870124888047743`*^9, 3.887895388244794*^9, 
   3.888326338422782*^9, 3.888397392100583*^9, 3.888756512177952*^9, 
   3.89377816172011*^9, 3.893801127359481*^9, 3.895001329901266*^9, 
   3.895139456787993*^9, 3.895565126279496*^9, 3.8962889107425117`*^9, 
   3.8963301350613527`*^9},
 CellLabel->
  "Out[567]=",ExpressionUUID->"77e33e00-bc1e-4c60-b37c-d78e8a4f9268"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"558.201997`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.878841587504867*^9, 3.878841598064604*^9}, 
   3.878841640871646*^9, {3.87884167462574*^9, 3.878841698183589*^9}, 
   3.878843692285396*^9, 3.879179364663685*^9, 3.879275597923889*^9, 
   3.879538498841076*^9, 3.8800174081213913`*^9, 3.880052851937043*^9, 
   3.884004535624173*^9, 3.885489610076766*^9, 3.885556628570943*^9, 
   3.886841607405056*^9, 3.8870124888047743`*^9, 3.887895388244794*^9, 
   3.888326338422782*^9, 3.888397392100583*^9, 3.888756512177952*^9, 
   3.89377816172011*^9, 3.893801127359481*^9, 3.895001329901266*^9, 
   3.895139456787993*^9, 3.895565126279496*^9, 3.8962889107425117`*^9, 
   3.896330693256007*^9},
 CellLabel->
  "Out[568]=",ExpressionUUID->"f68d8144-9720-4169-a1f9-4b7caf1a3bbf"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoopsubD1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BLoopsub", "[", "DESI1pk", "]"}], "/.", 
     RowBox[{"Dispatch", "[", "coeffixD1", "]"}]}], "/.", "nbD1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoopsubD2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BLoopsub", "[", "DESI2pk", "]"}], "/.", 
     RowBox[{"Dispatch", "[", "coeffixD2", "]"}]}], "/.", "nbD2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.886508613967452*^9, 3.886508635644329*^9}, {
  3.8865127726273127`*^9, 3.886512784255369*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"61b927ce-9135-48da-a044-8ccd867ff4e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BD1derivs", "=", 
   RowBox[{"BD1derivspre", "-", 
    RowBox[{"Table", "[", 
     RowBox[{"LoopsubD1", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffDESI1", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BD2derivs", "=", 
   RowBox[{"BD2derivspre", "-", 
    RowBox[{"Table", "[", 
     RowBox[{"LoopsubD2", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffDESI2", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.886508629228701*^9, 3.886508646094849*^9}, {
  3.886512750141049*^9, 3.886512750831511*^9}, {3.886512798563549*^9, 
  3.88651281175152*^9}, {3.888053590913364*^9, 3.888053591687595*^9}},
 CellLabel->
  "In[571]:=",ExpressionUUID->"f279a0c1-c595-43f1-ae03-cdccaa3cd839"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fishers ", "Subsection",
 CellChangeTimes->{{3.8783910593521233`*^9, 3.8783910828550453`*^9}, {
   3.87841255670513*^9, 3.878412558622801*^9}, {3.87847106765874*^9, 
   3.878471075603257*^9}, 
   3.878472306372485*^9},ExpressionUUID->"78ee43c8-7e61-449e-b398-\
91c46b25552f"],

Cell["Reduce P-derivatives to monopole and quadrupole", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391400909933*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"cafaed17-883c-45b4-be64-ccc1d210a0db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PD1monoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PD1derivs", "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PD2monoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PD2derivs", "]"}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8783854974202147`*^9, {3.878391156242745*^9, 3.878391178604154*^9}, {
   3.87839131726943*^9, 3.8783913246578836`*^9}, {3.8784703488075943`*^9, 
   3.878470362719586*^9}},
 CellLabel->
  "In[573]:=",ExpressionUUID->"45fca56e-c8b2-4172-a3c1-dd0a1d9234af"],

Cell["Powerspectrum Fishers monoquad", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471130667965*^9, 3.8784711318254747`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"cbc1a5bb-e882-45d3-8287-6629a63658bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPD1", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD1monoquad", ",", "COVD1P"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPD2", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD2monoquad", ",", "COVD2P"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877298767724556*^9, 3.8772987953889217`*^9}, {
  3.8783912080268583`*^9, 3.878391210249255*^9}, {3.878470369143877*^9, 
  3.878470402858488*^9}, {3.885479599377206*^9, 3.8854795993775578`*^9}},
 CellLabel->
  "In[575]:=",ExpressionUUID->"f1aec65b-c276-4278-a0b7-559555cb7683"],

Cell["Bispectrum Fishers - mono", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391430313566*^9}, {
  3.878409282105134*^9, 3.878409283129027*^9}, {3.8784711373327293`*^9, 
  3.878471138379108*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"f870e263-3aa8-4f1d-b827-c872e700fe23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBD1", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD1derivs", ",", "COVD1B", ",", "Loopmastermono"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBD2", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD2derivs", ",", "COVD2B", ",", "Loopmastermono"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.877299183948834*^9, 3.877299194957054*^9}, 
   3.878411016536647*^9, {3.878470406485463*^9, 3.878470430487794*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"736dbbd3-1f6c-4310-91be-fec87bd01984"],

Cell["Powerspectrum Fisher full \[Mu]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471134226358*^9}, {3.879443915347649*^9, 
  3.879443918285894*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"58f09e68-1e82-41db-9ed6-ffff1e8dbe38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPD1mu", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD1derivs", ",", "COVD1P"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPD2mu", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD2derivs", ",", "COVD2P"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8854795993784027`*^9, 3.885479599378746*^9}},
 CellLabel->
  "In[579]:=",ExpressionUUID->"821d8f5c-062c-4af8-996f-c3bbaa9a9895"],

Cell["Powerspectrum Fisher full \[Mu] 2 loop", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471134226358*^9}, {3.879443915347649*^9, 
  3.8794439241120777`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2dd8b46d-b186-4a8f-8576-981c53ee7c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPD1mu2L", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD1derivs2L", ",", "COVD1P2L"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPD2mu2L", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD2derivs2L", ",", "COVD2P2L"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8785585229632072`*^9, 3.8785585329182167`*^9}, {
  3.885479599379583*^9, 3.88547959937992*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"be711ebb-402f-4d6c-a9a3-469cc5a020df"],

Cell["Bispectrum Fishers full \[Mu]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.8794439390888777`*^9, 
  3.8794439401353083`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"f8707dbd-1ef6-44bf-88e3-05a9b80e9425"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBD1mu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD1derivs", ",", "COVD1B", ",", "Loopmaster"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBD2mu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD2derivs", ",", "COVD2B", ",", "Loopmaster"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878471150568904*^9, 3.8784711611799793`*^9}},
 CellLabel->
  "In[583]:=",ExpressionUUID->"081fa105-d7df-47e7-bc2a-59989ac4d568"],

Cell["Bispectrum Fishers full \[Mu] Tree", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.8794439390888777`*^9, 
  3.8794439401353083`*^9}, {3.879443983047256*^9, 3.87944398400249*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bc615f89-509a-46bb-b43e-c0db79590353"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBD1muT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD1derivsT", ",", "COVD1BTree", ",", "Loopmaster"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBD2muT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD2derivsT", ",", "COVD2BTree", ",", "Loopmaster"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879443988835162*^9, 3.879443994883703*^9}, {
  3.879614772856391*^9, 3.879614775446822*^9}},
 CellLabel->
  "In[585]:=",ExpressionUUID->"116cd257-5c7b-42a6-bc3f-af3fe7cf7a76"],

Cell["Powerspectrum Fishers full NS", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471134226358*^9}, {3.878564573833262*^9, 
  3.878564574406427*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bfe78f5b-575e-460a-882e-86015a9cb24e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPD1muNS", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD1derivs", ",", "COVD1PNS"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPD2muNS", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PD2derivs", ",", "COVD2PNS"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878564578022971*^9, 3.878564580151161*^9}, {
  3.8785646417973623`*^9, 3.878564646416222*^9}, {3.885479599380733*^9, 
  3.88547959938105*^9}},
 CellLabel->
  "In[587]:=",ExpressionUUID->"bf361b9f-e4c5-430f-9e5b-86879142d6b9"],

Cell["Bispectrum Fishers full NS", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.878564575577601*^9, 
  3.878564576199335*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7ab15b8d-6618-420d-9045-2af5aa9b0cdb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBD1muNS", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD1derivs", ",", "COVD1BNS", ",", "Loopmaster"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBD2muNS", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BD2derivs", ",", "COVD2BNS", ",", "Loopmaster"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878471150568904*^9, 3.8784711611799793`*^9}, {
  3.878564585087564*^9, 3.878564586970866*^9}, {3.8785646515412292`*^9, 
  3.8785646529561357`*^9}},
 CellLabel->
  "In[589]:=",ExpressionUUID->"fe911d3f-9329-4dfb-82f8-906094c05c99"]
}, Closed]],

Cell[CellGroupData[{

Cell["Perturbative Prior ", "Subsection",
 CellChangeTimes->{{3.895054428919343*^9, 3.895054448809629*^9}, {
   3.896345981647279*^9, 3.896345983466001*^9}, 
   3.896381488662978*^9},ExpressionUUID->"12cc2de2-8291-4b38-b1a4-\
55d6a2cb4c0a"],

Cell[CellGroupData[{

Cell["Powerspectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.88874151521391*^9}},ExpressionUUID->"2b77721a-e427-4071-91a5-\
d8b8e9a7c9d5"],

Cell["scaling  bias  computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
   3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
   3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
   3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
   3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
   3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
   3.8887536509125*^9, 3.888753659481193*^9}, 3.894539283215518*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d74c8d4a-f8f0-490a-b7ca-9dbfba9a1937"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PD1Loop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabDESI1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "DESI1pk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabDESI1", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixD1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PD2Loop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabDESI2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "DESI2pk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabDESI2", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixD2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741261612136*^9, 3.88874127220191*^9}, 
   3.88875333043812*^9, {3.8887533861313133`*^9, 3.888753396861267*^9}, {
   3.888754416678398*^9, 3.888754434715231*^9}, 3.8950549661329603`*^9, {
   3.8963460308107224`*^9, 3.896346035883583*^9}, {3.8963460815016623`*^9, 
   3.8963460833257504`*^9}, {3.89634630668791*^9, 3.896346314441248*^9}},
 CellLabel->
  "In[1253]:=",ExpressionUUID->"0819d358-2f22-4560-9fbb-195385f2a4af"],

Cell["PTree computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
  3.888741162977934*^9, 3.888741164492325*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9f9a0971-c9b7-4b5a-9d75-353e938ea538"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PD1Tree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabDESI1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "DESI1pk"}], "]"}], "/.", 
        "coeffixD1"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabDESI1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PD2Tree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabDESI2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "DESI2pk"}], "]"}], "/.", 
        "coeffixD2"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabDESI2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741178216148*^9, 3.888741205021223*^9}, 
   3.888745462695631*^9, 3.895054979145851*^9},
 CellLabel->
  "In[1255]:=",ExpressionUUID->"95b9eb6f-271a-4a75-a2de-4925c194dc1d"],

Cell["\[Sigma] computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
  3.888740413660467*^9, 3.8887404139676857`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4588ef0d-d9a8-4d5c-be18-219616c9058f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcD1", "[", "k_", "]"}], "=", 
   SqrtBox[
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{
        RowBox[{"GetFullzCovPInv", "[", 
         RowBox[{
         "ktabraw", ",", "DESI1pk", ",", "D1spec", ",", "bfixstoch", ",", 
          "dkPD"}], "]"}], "/.", 
        RowBox[{"\[Mu]", "->", "0"}]}]}], "]"}], "[", "k", "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcD2", "[", "k_", "]"}], "=", 
   SqrtBox[
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{
        RowBox[{"GetFullzCovPInv", "[", 
         RowBox[{
         "ktabraw", ",", "DESI2pk", ",", "D2spec", ",", "bfixstoch", ",", 
          "dkPD"}], "]"}], "/.", 
        RowBox[{"\[Mu]", "->", "0"}]}]}], "]"}], "[", "k", "]"}]]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740432992057*^9, 3.888740457002887*^9}, {
  3.8887405566797333`*^9, 3.8887405983128567`*^9}, {3.888740634886725*^9, 
  3.88874063767188*^9}, {3.888741118670182*^9, 3.888741121830488*^9}, {
  3.888755168282782*^9, 3.888755168616124*^9}, {3.888755212474147*^9, 
  3.888755212892293*^9}, {3.8887553185172977`*^9, 3.888755333641263*^9}, {
  3.888755406547153*^9, 3.888755420384659*^9}, {3.895299922105454*^9, 
  3.895299922968943*^9}, {3.8954742949333563`*^9, 3.895474294933807*^9}},
 CellLabel->
  "In[1257]:=",ExpressionUUID->"b02153a8-115a-473f-bfc4-fb1a9a89a11b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]D1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcD1", "[", 
      RowBox[{"ktabDESI1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabDESI1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]D2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcD2", "[", 
      RowBox[{"ktabDESI2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabDESI2", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740435898135*^9, 3.888740464811185*^9}, {
  3.888755168799716*^9, 3.88875516936604*^9}, {3.888755213091127*^9, 
  3.88875521372425*^9}, {3.888755285292038*^9, 3.888755298575753*^9}},
 CellLabel->
  "In[1259]:=",ExpressionUUID->"960fc354-2f16-4eb9-9169-c28056910a9f"],

Cell["Get \[OpenCurlyDoubleQuote]correct\[CloseCurlyDoubleQuote] \
powerspectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.8950518293200827`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7c4b4194-c8c0-40c7-b0da-10ea62cf48bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1LCD1", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PD1Loop", ",", "\[Sigma]D1tab", ",", "PD1Tree"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1LCD2", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PD2Loop", ",", "\[Sigma]D2tab", ",", "PD2Tree"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888753553372282*^9, 3.888753584704721*^9}, {
  3.895001710873721*^9, 3.895001711694565*^9}, {3.895051621578108*^9, 
  3.895051657499125*^9}, {3.895055012063528*^9, 3.895055026561247*^9}},
 CellLabel->
  "In[1261]:=",ExpressionUUID->"350d0903-37e1-4b1b-978c-11b7a32f806f"],

Cell["Get powerspectrum priors", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.895051842826643*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0c4a10db-27c3-4121-b5f1-537cfe066b79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPriorD1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabDESI1", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabDESI1", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "DESI1pk", ",", " ", 
             RowBox[{"P1LCD1", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabDESI1", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", 
      RowBox[{"\[Mu]", "->", "0"}]}], "/.", "coeffixD1"}], "/.", "nbD1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPriorD2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabDESI2", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabDESI2", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "DESI2pk", ",", " ", 
             RowBox[{"P1LCD2", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabDESI2", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", 
      RowBox[{"\[Mu]", "->", "0"}]}], "/.", "coeffixD2"}], "/.", "nbD2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895055040761423*^9, 3.895055065971439*^9}, {
  3.8951387897968073`*^9, 3.895138801239835*^9}, {3.895567024745542*^9, 
  3.8955670367297907`*^9}},
 CellLabel->
  "In[1263]:=",ExpressionUUID->"6e4ef88f-391a-4e24-af15-afaf4a435f38"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bispectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.888741528575953*^9}},ExpressionUUID->"460fb067-8a60-4e7d-a184-\
d7faa34c819f"],

Cell["Bispectrum - Background  Tree and Loop", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741616313279*^9, 3.8887416248599854`*^9}, {
  3.8887416567266483`*^9, 3.888741660704743*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bacf80bc-87af-465c-853e-6dc9b790d231"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BD1Loopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Bloopscale", "[", 
         RowBox[{
          RowBox[{"keffDESI1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "DESI1pk"}], "]"}], "/.", 
        RowBox[{"Dispatch", "[", "coeffixD1", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffDESI1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BD2Loopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Bloopscale", "[", 
         RowBox[{
          RowBox[{"keffDESI2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "DESI2pk"}], "]"}], "/.", 
        RowBox[{"Dispatch", "[", "coeffixD2", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffDESI2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887870506613146*^9, 3.887870526214724*^9}, {
   3.888045960956028*^9, 3.888045982568386*^9}, 3.8886762373468113`*^9, {
   3.888755179740827*^9, 3.888755180708872*^9}, {3.8887552242490683`*^9, 
   3.88875522526589*^9}, {3.888755320124936*^9, 3.8887553729582777`*^9}, {
   3.888755512955844*^9, 3.888755514140646*^9}, {3.8887555891094103`*^9, 
   3.8887556059686403`*^9}, {3.8963460600026484`*^9, 3.896346076071698*^9}, {
   3.896346340147256*^9, 3.896346342325602*^9}},
 CellLabel->
  "In[1265]:=",ExpressionUUID->"054fc2f6-78e8-4808-922b-9c31c3c54419"],

Cell["Bispectrum - Derivatives of Loop only", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"043dbad9-e00d-4009-9650-ae72ea097bf4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CorrectionD1", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"keffDESI1", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "DESI1pk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixD1", "]"}]}], "/.", "nbD1"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffDESI1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CorrectionD2", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"keffDESI2", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "DESI2pk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixD2", "]"}]}], "/.", "nbD2"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffDESI2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887869756685066*^9, 3.887869779195531*^9}, {
  3.888755180899663*^9, 3.888755181700437*^9}, {3.8887552254749537`*^9, 
  3.888755226283332*^9}, {3.8887553203424063`*^9, 3.888755373142469*^9}, {
  3.88875552243512*^9, 3.888755523704595*^9}, {3.888755589509716*^9, 
  3.888755606401744*^9}},
 CellLabel->
  "In[1084]:=",ExpressionUUID->"f9cfb1fd-fb5e-4665-8fc1-eae58631d19d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BD1ngcLoopderivs", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BD1derivs", "+", "CorrectionD1"}], ")"}], ".", 
    "Blooplistreal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BD2ngcLoopderivs", "  ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BD2derivs", "+", "CorrectionD2"}], ")"}], ".", 
    "Blooplistreal"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8868385093651257`*^9, 3.886838510201589*^9}, {
   3.886838918810886*^9, 3.886838923398671*^9}, 3.8868395694779863`*^9, 
   3.8868423371525383`*^9, {3.887869794724497*^9, 3.887869828310582*^9}, {
   3.887869867058724*^9, 3.8878698800661917`*^9}, {3.887961854062598*^9, 
   3.887961855134948*^9}, {3.888755181898987*^9, 3.888755182508569*^9}, {
   3.888755226499262*^9, 3.8887552271335783`*^9}, {3.888757711586331*^9, 
   3.888757731629743*^9}, {3.8951388100615253`*^9, 3.895138811873642*^9}, {
   3.895299933789439*^9, 3.895299946230927*^9}},
 CellLabel->
  "In[1267]:=",ExpressionUUID->"82490c3e-ed5b-47a2-bea7-75a8d409ab70"],

Cell["Symmetric P1LC", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}, {
  3.8950532854616213`*^9, 3.895053290570174*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"439441bd-a0f7-46bf-8f4d-e6949df6a120"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PTtritabD1", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"keffDESI1", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "DESI1pk"}], "]"}],
           "/.", "coeffixD1"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffDESI1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PTtritabD2", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"keffDESI2", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "DESI2pk"}], "]"}],
           "/.", "coeffixD2"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffDESI2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743170297797*^9, 3.888743178232419*^9}, {
  3.888743239420354*^9, 3.8887432774648733`*^9}, {3.888743593628655*^9, 
  3.888743613564752*^9}, {3.8887538943446207`*^9, 3.8887538992824593`*^9}, {
  3.8887539507915707`*^9, 3.8887540245086727`*^9}, {3.8887551896332703`*^9, 
  3.8887551904843197`*^9}, {3.888755234532494*^9, 3.888755235382784*^9}, {
  3.88875532097534*^9, 3.888755373342001*^9}, {3.888755540603545*^9, 
  3.88875554247409*^9}, {3.888755591236051*^9, 3.88875560833599*^9}, {
  3.896346350110227*^9, 3.896346375624229*^9}},
 CellLabel->
  "In[1269]:=",ExpressionUUID->"b247d58a-d483-42b7-a63c-c9d07369c59b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PsymtabD1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"keffDESI1", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "DESI1pk", ",", 
        RowBox[{"PTtritabD1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffDESI1", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixD1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsymtabD2", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"keffDESI2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "DESI2pk", ",", 
        RowBox[{"PTtritabD2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffDESI2", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixD2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743595979177*^9, 3.8887436284098597`*^9}, {
  3.888753901299285*^9, 3.888753903432684*^9}, {3.888753952413186*^9, 
  3.888753953499566*^9}, {3.888753996437364*^9, 3.888753999316115*^9}, {
  3.8887551906743107`*^9, 3.888755191574905*^9}, {3.888755235591964*^9, 
  3.888755236449566*^9}, {3.888755321174719*^9, 3.888755336499699*^9}, {
  3.888755544908473*^9, 3.88875554625144*^9}, {3.888755591618659*^9, 
  3.8887556087439938`*^9}},
 CellLabel->
  "In[1271]:=",ExpressionUUID->"41754a08-88c8-40a4-9523-393907cbccd1"],

Cell["Bispectrum \[OpenCurlyQuote]correct\[CloseCurlyQuote]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.89505326165967*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"088c5eed-7e9e-4f06-86ed-62914e028c10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B1LCD1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BD1Loopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVD1B", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabD1", ",", "PD1Loop", 
        ",", "\[Sigma]D1tab", ",", "PD1Tree"}], "]"}], "/.", "coeffixD1"}], "/.",
      "nbD1"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1LCD2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BD2Loopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVD2B", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabD2", ",", "PD2Loop", 
        ",", "\[Sigma]D2tab", ",", "PD2Tree"}], "]"}], "/.", "coeffixD2"}], "/.",
      "nbD2"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743598646628*^9, 3.888743598924089*^9}, {
  3.8887436318956842`*^9, 3.888743635015679*^9}, {3.888745932066663*^9, 
  3.888745933074651*^9}, {3.8887539075778713`*^9, 3.8887539557330914`*^9}, {
  3.888754032089074*^9, 3.888754068197426*^9}, {3.8887541078730497`*^9, 
  3.8887541151628428`*^9}, {3.888754160444756*^9, 3.8887541755244904`*^9}, {
  3.895053039641955*^9, 3.8950530471332006`*^9}, {3.895055231608708*^9, 
  3.895055263905095*^9}, {3.895055409690301*^9, 3.895055413803789*^9}},
 CellLabel->
  "In[1273]:=",ExpressionUUID->"89108ce5-4184-48c7-b900-ddf6f287e590"],

Cell["Bispectrum prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.895053268869812*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ef199d57-56de-426c-8c1f-be4bd2748cbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BPriorD1", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "keffDESI1", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BD1ngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCD1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffDESI1", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BPriorD2", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "keffDESI2", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BD2ngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCD2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffDESI2", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.89505526942714*^9, 3.895055283404625*^9}, {
  3.895055376016219*^9, 3.895055378845052*^9}, {3.8951388187532043`*^9, 
  3.8951388200994473`*^9}, {3.8952999542397346`*^9, 3.895299955522195*^9}},
 CellLabel->
  "In[1275]:=",ExpressionUUID->"ca9815c2-bdae-44a7-b373-aac81dbee11b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DESI Exports", "Subsection",
 CellChangeTimes->{{3.878564059914957*^9, 
  3.8785640633698683`*^9}},ExpressionUUID->"ee286689-c987-4068-ba15-\
c19507256eda"],

Cell["Analytical covariance with full redshift dependence,  w/o B", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5174cacd-f9ac-4809-981b-8fc67ea10c89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/Panafullz.mtx\>\"", ",", 
    RowBox[{"FPD1", "+", "FPD2", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/PBanafullz.mtx\>\"", ",", 
    RowBox[{"FPD1", "+", "FPD2", "+", "FBD1", "+", "FBD2", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.878561181657775*^9, 3.8785612155758343`*^9}, {
  3.8785641097270517`*^9, 3.8785641442407627`*^9}, {3.878828948253819*^9, 
  3.878828948359931*^9}, {3.879164021161697*^9, 3.8791640229525023`*^9}, {
  3.879457377861217*^9, 3.879457378011126*^9}, {3.8800166485141163`*^9, 
  3.880016649608354*^9}, {3.8839492995791273`*^9, 3.883949302397707*^9}, {
  3.885493232129957*^9, 3.885493233455442*^9}, {3.8854981150692377`*^9, 
  3.8854981150696077`*^9}, {3.8878971082143784`*^9, 3.88789710841581*^9}, {
  3.889095166165634*^9, 3.889095166900667*^9}, {3.893773243568715*^9, 
  3.893773243569072*^9}, {3.8938281200661983`*^9, 3.893828120066675*^9}, {
  3.89500210753051*^9, 3.895002107676899*^9}, {3.895562940371097*^9, 
  3.8955629403716087`*^9}, {3.895566039860977*^9, 3.8955660570246058`*^9}, {
  3.8962784260886908`*^9, 3.8962784387531853`*^9}, {3.896294228110799*^9, 
  3.8962942281111517`*^9}},
 CellLabel->
  "In[1481]:=",ExpressionUUID->"7f15b574-f94c-4893-b374-39855b7cffc1"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles,  w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"53a1c2a2-b217-43b1-94fd-1484f19ff916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/Panamufullz.mtx\>\"", ",", 
    RowBox[{"FPD1mu", "+", "FPD2mu", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/PBanamufullz.mtx\>\"", ",", 
    RowBox[{
    "FPD1mu", "+", "FPD2mu", "+", "FBD1mu", "+", "FBD2mu", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQXcezdfORp28cbXI/bQfRTC7bFY8B6dvnL2uDaHVf
eyMQ3bW7GUxbLZha5P7sjWPMnJlgOm8xJ/9rIC1sbgCmK3YF+FQ9f+PINS8G
TNtxRSd2v3jj6LNpGpiWS/g5j/vDG0eXqerzQXRVfUjd309vHHfNaQLTs0KS
HvwH0s/CIfR824VOk7+/cTyVsBxMFzcxud35CdSnzg+mn8QVlZ9geutomQSh
16gzOT8G0g3aENrhZlu9AutbxzrNHjAt96o73IjtrePdtxD6Uemsu8ZAWqyr
8B6IrmkMfwKiny3rAtOST50297O/dVyscGMLiO6b3Jw1HUjnTYPQAJHDp8A=

  "],
 CellLabel->
  "In[1483]:=",ExpressionUUID->"0e327cc9-270f-4c98-90c7-330e4c4d9ac9"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles, 2loop,  \
w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}, {
   3.878564270615465*^9, 3.87856427222081*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"8b105f5a-e2e3-48b6-8ca0-b82322bc234c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/Panamufullz2L.mtx\>\"", ",", 
    RowBox[{"FPD1mu2L", "+", "FPD2mu2L", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/PBanamufullz2L.mtx\>\"", ",", 
    RowBox[{
    "FPD1mu2L", "+", "FPD2mu2L", "+", "FBD1mu", "+", "FBD2mu", "+", 
     "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQXcezdfORp28cbXI/bQfRTC7bFY8B6dvnL2uDaHVf
eyMQvffIVnMQzdO4vMj92RtHh7x1YHrN30r+10D6zdnNYPrtzlyfqudvHKOC
isH0m679id0v3jhusHsHpkOOBM/n/vDGccLxVjBdcmRd3d9Pbxxljt0F01uK
kh78B9L7SiG0TdRup8nf3ziGpR8C059+irjd+fnGcR2PFJg+lVtUfoLpreOR
Agh93YDJ+TGQXmUCoUX+zKtXYH3r+GbdEjBt87k73IjtreP3bxA6ve7yPWMg
faJO+AGItph75AmILmN/D6b7vjpt7md/6yinfWMLiC6Y3Zw1HUgHzYPQABN2
sVc=
  "],
 CellLabel->
  "In[1485]:=",ExpressionUUID->"ea934540-4500-462f-90f2-6a07c5a24922"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles, Tree B \
w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}, {
   3.878564270615465*^9, 3.87856427222081*^9}, {3.8794571676476088`*^9, 
   3.879457175011805*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"aff3c40e-68f2-4799-8dbc-b89095b8ae49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/PBanamufullzT.mtx\>\"", ",", 
    RowBox[{
    "FPD1mu", "+", "FPD2mu", "+", "FBD1muT", "+", "FBD2muT", "+", 
     "Priors"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.878561181657775*^9, 3.8785612155758343`*^9}, {
   3.8785641097270517`*^9, 3.878564190619123*^9}, {3.878564241978168*^9, 
   3.878564285680266*^9}, {3.878828949234503*^9, 3.8788289494509583`*^9}, {
   3.879164027812216*^9, 3.879164029618887*^9}, {3.879457177071039*^9, 
   3.879457210700491*^9}, 3.879457380313807*^9, 3.880016656581794*^9, {
   3.8839493098391848`*^9, 3.883949309862892*^9}, {3.8854932411365213`*^9, 
   3.885493241500922*^9}, 3.885498115080144*^9, 3.8878971107253036`*^9, 
   3.889095216972324*^9, 3.8937732435775337`*^9, 3.893828120069569*^9, 
   3.895002109750824*^9, 3.8955629403744907`*^9, {3.8955660841569233`*^9, 
   3.8955660858433447`*^9}, 3.8955661216374073`*^9, {3.896278426094131*^9, 
   3.896278438755743*^9}, 3.896294228113592*^9},
 CellLabel->
  "In[1487]:=",ExpressionUUID->"6e00337b-8cbc-47e2-bab3-d6338a9a6212"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles, NS,  w/o \
B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}, {
   3.878564270615465*^9, 3.87856427222081*^9}, {3.878564689987937*^9, 
   3.878564691669018*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"6e3a1749-60ea-45cf-b90e-144a0a5a7c9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/PanamufullzNS.mtx\>\"", ",", 
    RowBox[{"FPD1muNS", "+", "FPD2muNS", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/PBanamufullzNS.mtx\>\"", ",", 
    RowBox[{
    "FPD1muNS", "+", "FPD2muNS", "+", "FBD1muNS", "+", "FBD2muNS", "+", 
     "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQXcezdfORp28cbXI/bQfRTC7bFY8B6dvnL2uDaHVf
eyMQvffIVnMQvSN6cxaIXu4rmAOiz/nll4Doxpi9YLr02c4i92dvHHni9oJp
T5ty+xQgfZZlK5hecuQT/2sgfUxKXgBEiz7d41P1/I1jRNRbMP36mH1S94s3
jrbu+WD63uWX87k/vHE0aVBeAKK5FiTU//0ENC/iEJhuWZD04D+QXr0YQpv0
P3Wa/P2N46eNb8A0k56K252fbxy/y2mB6YyWovITTG8di9ohdLg9k/NjIO3g
DKGvMR6pV2B96/gl9B2Y9mHsCTdie+v4ggVCd0SqPjQG0jnZ3U9B9AUe5839
7EDzzG9sAdH9y5uzpgPpzFUQGgAUBb77
  "],
 CellLabel->
  "In[1488]:=",ExpressionUUID->"dcfb474e-6fac-4871-9044-f16dff05f916"],

Cell["Perturbative Prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878562694723263*^9, 3.878562699328602*^9}, {
   3.895054532385188*^9, 3.895054536060054*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1584ee36-673e-408a-9002-06567143a7f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/Ppertprior.mtx\>\"", ",", 
    RowBox[{"PPriorD1", "+", "PPriorD2"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/DESI/PBpertprior.mtx\>\"", ",", 
    RowBox[{"PPriorD1", "+", "PPriorD2", "+", "BPriorD1", "+", "BPriorD2"}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8950546527914953`*^9, 3.8950547352115717`*^9}, {
  3.895054790541091*^9, 3.895054856054175*^9}, {3.895055440260354*^9, 
  3.895055459519186*^9}, {3.895138824300275*^9, 3.8951388254786463`*^9}, {
  3.895300522976356*^9, 3.895300524219591*^9}, {3.8955629403762293`*^9, 
  3.895562940376623*^9}, {3.895563381267695*^9, 3.895563381268241*^9}, {
  3.8955661022442408`*^9, 3.8955661287960033`*^9}, {3.895568765198922*^9, 
  3.8955687666721907`*^9}, {3.896278426097115*^9, 3.896278438757739*^9}, {
  3.896294228115158*^9, 3.89629422811558*^9}},
 CellLabel->
  "In[1282]:=",ExpressionUUID->"b1992beb-df07-4778-a06c-8dea0875d976"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MegaMapper - optimistic", "Section",
 CellChangeTimes->{{3.873874436782016*^9, 3.873874440817452*^9}, {
   3.8739643915210037`*^9, 3.8739643916267567`*^9}, {3.8739713597098627`*^9, 
   3.873971360089781*^9}, {3.874335391625215*^9, 3.874335393416067*^9}, {
   3.8743951131865683`*^9, 3.874395114134469*^9}, {3.8783307046760273`*^9, 
   3.878330709107346*^9}, {3.8784125376829357`*^9, 3.8784125380319443`*^9}, 
   3.8784722874667263`*^9},ExpressionUUID->"64e897b7-4288-4a27-a308-\
ca0e744fefdd"],

Cell[CellGroupData[{

Cell["MMo specifications and derivative computations", "Subsection",
 CellChangeTimes->{{3.878331664336233*^9, 3.878331667108832*^9}, {
  3.878331979807946*^9, 3.878331981863579*^9}, {3.8783783257461557`*^9, 
  3.8783783354989758`*^9}, {3.8784125428781147`*^9, 3.878412543313261*^9}, {
  3.878472169285952*^9, 3.8784721729778547`*^9}, {3.878472292821085*^9, 
  3.878472294722699*^9}},ExpressionUUID->"8e6029c3-674b-407e-b9b8-\
4006e4ff5404"],

Cell["\<\
MMo numbers fully binned (section 1.2 in arxiv 2209.04322, then arxiv \
1903.09208 Table 1 )\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.8783836881286488`*^9}, {3.87847219786552*^9, 
  3.87847219890026*^9}, {3.878472471108636*^9, 3.878472471610229*^9}, {
  3.878472564963822*^9, 3.8784725710239973`*^9}, {3.878472722061098*^9, 
  3.878472737813615*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5e3ab161-0bd1-452a-82a8-ad717b0cca0a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "z", ",", "nb", ",", "V", ",", "N", ",", "Dg", ",", "fs", ",", "b1"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.885494480207396*^9, 3.885494481937111*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"36de0879-e261-4941-a708-6f44e7b18851"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMospec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2", ",", "2.5", ",", "3", ",", "3.5", ",", "4", ",", "4.5", ",", "5"}],
       "}"}], ",", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]], 
      RowBox[{"{", 
       RowBox[{
       "25", ",", "12", ",", "6", ",", "3", ",", "1.5", ",", "0.8", ",", 
        "0.4"}], "}"}]}], ",", 
     RowBox[{
      SuperscriptBox["10", "9"], 
      RowBox[{"{", 
       RowBox[{
       "26.986863", ",", "27.63312497", ",", "27.20703913", ",", 
        "26.25383626", ",", "25.06712437", ",", "23.80296403", ",", 
        "22.54324749"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "6.74671575`*^7", ",", "3.3159749963999998`*^7", ",", 
       "1.6324223477999998`*^7", ",", "7.876150878`*^6", ",", 
       "3.7600686555000003`*^6", ",", "1.9042371224000002`*^6", ",", 
       "901729.8996000001`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.42020110428342006", ",", "0.36272799579672305", ",", 
       "0.3188745725930273", ",", "0.2844001952601862", ",", 
       "0.25662379231412885", ",", "0.23378307001365894", ",", 
       "0.2146779141872147"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.9466075281915435", ",", "0.9606657166004888", ",", 
       "0.9687825324004987", ",", "0.973748370874903", ",", 
       "0.9769321736957639", ",", "0.9790517015436108", ",", 
       "0.9805057101340311"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2.5", ",", "3.3", ",", "4.1", ",", "4.9", ",", "5.8", ",", "6.6", ",", 
       "7.4"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877265916864263*^9, 3.877265918514963*^9}, {
   3.878382336152431*^9, 3.878382338551983*^9}, {3.878382424749436*^9, 
   3.878382427765259*^9}, 3.87838246170047*^9, {3.878383826491439*^9, 
   3.8783838277095737`*^9}, {3.8784126741830482`*^9, 3.878412728189921*^9}, {
   3.878413729299*^9, 3.878413732493112*^9}, {3.878472790586163*^9, 
   3.878472832692236*^9}, {3.883947292973507*^9, 3.883947322380765*^9}, {
   3.8852351336347857`*^9, 3.885235133949136*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"2a45666b-8553-4051-a745-eb02f9f64a06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMocut", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.878383193930118*^9, 3.878383199484385*^9}, {
  3.878412731287475*^9, 3.878412737223034*^9}, {3.8784727983966837`*^9, 
  3.878472798776726*^9}, {3.8784728670564117`*^9, 3.878472883733088*^9}, {
  3.878472939776085*^9, 3.878472972829179*^9}, {3.878473104297081*^9, 
  3.878473104336568*^9}, {3.8784731705186033`*^9, 3.878473170546286*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"dc7f48a3-4410-49f9-9e4c-37ce4b5f6a8d"],

Cell["Get zeffs and define cental values", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
   3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
   3.87387541354895*^9}, {3.878382212762868*^9, 3.878382216951807*^9}, 
   3.878382259950922*^9, 3.8783829477289057`*^9, {3.878383185752803*^9, 
   3.878383210959243*^9}, {3.878383719533955*^9, 3.878383723260166*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"660a92f4-d8aa-4475-ba7c-5a81c7cf03ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Getzeffs", "[", 
  RowBox[{"MMospec", ",", "MMocut"}], "]"}]], "Input",
 CellChangeTimes->{{3.87838307836555*^9, 3.878383132044235*^9}, {
  3.878383162397768*^9, 3.87838317567303*^9}, {3.878412751221225*^9, 
  3.878412751465184*^9}, {3.878472840936388*^9, 3.878472843935214*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"eea233f6-eda1-4913-a3d9-22fba7d19de8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.3582415969089476`", ",", "4.282339078228379`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878383175890967*^9, 3.878383201054626*^9}, 
   3.878412754570765*^9, 3.87841373570604*^9, {3.8784728446988373`*^9, 
   3.878472885063695*^9}, {3.8784729413579493`*^9, 3.878472974279441*^9}, 
   3.878473105567445*^9, 3.878473172960182*^9, 3.8784740854781637`*^9, 
   3.878495704444726*^9, 3.878733753926289*^9, 3.87882915877078*^9, 
   3.878840931906015*^9, 3.878894300784103*^9, 3.879163404543695*^9, 
   3.879172202658609*^9, 3.879276856328685*^9, 3.879328345416523*^9, 
   3.8793309555300827`*^9, 3.879539313903426*^9, 3.8798295938439617`*^9, 
   3.879880533347925*^9, 3.879896031996364*^9, 3.879913626171336*^9, 
   3.88001945398079*^9, 3.880490819394163*^9, 3.883947355332513*^9, 
   3.884005501681715*^9, 3.885232907559238*^9, 3.885276457572509*^9, 
   3.885377789187709*^9, 3.885421327539756*^9, 3.885494529640914*^9, 
   3.885508534401119*^9, 3.885540555346095*^9, 3.885557715189687*^9, 
   3.885579711001925*^9, 3.887882312428072*^9, 3.88789179796659*^9, 
   3.888350794234486*^9, 3.8887580383192997`*^9, 3.8891367166337643`*^9, 
   3.8906703734389057`*^9, 3.89378116935174*^9, 3.893793041716576*^9, 
   3.893802146715395*^9, 3.893825354252639*^9, 3.893830916535327*^9, 
   3.89384347100159*^9, 3.893867380091567*^9, 3.895002180037097*^9, 
   3.895144509611176*^9, 3.895483441788602*^9, 3.895998464342647*^9, 
   3.8962912853800707`*^9, 3.8962943058551607`*^9, 3.89629817055235*^9, 
   3.8963309869445047`*^9, 3.896412956889407*^9},
 CellLabel->
  "Out[283]=",ExpressionUUID->"2e3c58b1-a39f-45f9-b5e1-8d727a661249"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MMo1spec", " ", "=", " ", 
   RowBox[{"MMospec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{";;", "MMocut"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMo2spec", " ", "=", " ", 
   RowBox[{"MMospec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"MMocut", "+", "1"}], ";;"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87729569843889*^9, 3.8772957323200274`*^9}, {
   3.878382358668338*^9, 3.87838237967688*^9}, 3.878382526664139*^9, {
   3.878383218340361*^9, 3.878383219242804*^9}, {3.8784127697887297`*^9, 
   3.878412786626348*^9}, {3.878473179054512*^9, 3.878473195476676*^9}, {
   3.878473237146793*^9, 3.878473239106249*^9}, {3.893829905619985*^9, 
   3.8938299056203833`*^9}, {3.8938304077707653`*^9, 3.8938304085220747`*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"1feddf25-a946-40e6-b8ce-41acf8df776e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dg236", "=", "0.37721157585659637"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dg428", " ", "=", "0.2433118256462636"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8784127675887203`*^9, {3.878474029012005*^9, 3.87847405670301*^9}, 
   3.883947390859975*^9, 3.883947535555977*^9},
 CellLabel->
  "In[286]:=",ExpressionUUID->"d590fae2-59ad-4ec7-afe2-7235692c1dab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MMo1pk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"MMo1", ",", "2.36"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMo2pk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"MMo2", ",", "4.28"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8727413630602694`*^9, 3.8727413655934258`*^9}, {
   3.8727546915351477`*^9, 3.872754694985199*^9}, {3.872766326967618*^9, 
   3.8727663281148233`*^9}, 3.872770560272434*^9, {3.873359960402536*^9, 
   3.8733599619315567`*^9}, {3.87346870319875*^9, 3.873468706946323*^9}, {
   3.8739667794686813`*^9, 3.8739667861596413`*^9}, {3.874402252136847*^9, 
   3.874402253720666*^9}, 3.878412807295249*^9, {3.8784731964668617`*^9, 
   3.878473198274949*^9}, {3.87847406114918*^9, 3.87847407740851*^9}, {
   3.885232815319771*^9, 3.88523281575315*^9}, {3.885494533882448*^9, 
   3.885494535545813*^9}, {3.89500218813035*^9, 3.895002189242797*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"33537ee4-c096-44c2-a174-7fd26e730775"],

Cell["\<\
Shotnoise estimates (these are not entering the covariance, so they are not \
very important) \
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.8784128456142693`*^9, 3.8784128674174213`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bd2546bf-5327-43e0-ae94-67008e725db5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Getnbeff", "[", 
  RowBox[{"MMospec", ",", "MMocut"}], "]"}]], "Input",
 CellChangeTimes->{{3.878475319301682*^9, 3.878475320618101*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"4903dd6e-4fda-45fa-aec2-b93538404633"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0017673778507420201`", ",", "0.00011459250315671164`"}], 
  "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGAwBOLTT82Pz3r6xtEt/sahJUBarvDSFPdnbxyfWIeG+AJp
u5kJyelAetKpiJOvgDTTJz3R90Ba69YrPaXnbxwDZL4FWQPpTfm8M22AtIHA
tdBFQHrfz0tCBi/eOIYtD/rkAaQTBKuaA4D09az3UpFAWu6hy/EeIF00k+FD
0cs3jtOa3cTVP7xx1Gu5s2bypzeOk7cvUT8KpJOy2jJvAel+Xh2tf0Da5O7i
/yyf3zgqJZosEgHSbw75MMsCaSuJNQfUgXTKCQ+hnu9vHM0fHdg8AUSb814q
+PHGUVPk2Wrzn28cm0xrJ30A0mkd+3Lv/nnjyJdhFH+G6a3jutUc2peA9Izb
gXOvAWmmCMNPD4H0rl9GW54Aac+JpadfgcQn9pV/A9I3s3dPUmB963hg902B
NCCtN2nuXG62t0B/feBgZ3/rmLNUkmUakPapiy+dDqRX7QlrB9FFH3USZgJp
1X0JaSuBtMjJLTkXgTQAwVDP3A==
  "],
 CellLabel->
  "Out[290]=",ExpressionUUID->"1bd67681-2401-4925-88c0-f120ee847553"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbMMo1", " ", "=", " ", 
   RowBox[{"nb", "->", "0.0017673778507420201`"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbMMo2", " ", "=", " ", 
   RowBox[{"nb", "->", "0.00011459250315671164`"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873875438860836*^9, 3.873875447797975*^9}, 
   3.873964417558131*^9, {3.874994697144123*^9, 3.8749947131881104`*^9}, {
   3.877976102770084*^9, 3.8779761140267982`*^9}, {3.878157695711175*^9, 
   3.8781577092274923`*^9}, 3.8783854049941874`*^9, {3.878412843664546*^9, 
   3.878412850054669*^9}, {3.8784134875786963`*^9, 3.878413489915539*^9}, {
   3.8784753316640368`*^9, 3.878475340376177*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"376cc508-2889-4b1f-897d-53d62672a9f3"],

Cell["Get knls", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.8784128456142693`*^9, 3.8784128674174213`*^9}, {
  3.8788279868867903`*^9, 3.878827989607279*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9a4cb599-3a68-48bb-a00c-81026eedd739"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"knlMMo1", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"knl", "->", 
    RowBox[{
     RowBox[{"Getknl", "[", 
      RowBox[{"MMo1pk", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"knlMMo2", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"knl", "->", 
    RowBox[{
     RowBox[{"Getknl", "[", 
      RowBox[{"MMo2pk", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.873875438860836*^9, 3.873875447797975*^9}, 
   3.873964417558131*^9, {3.874994697144123*^9, 3.8749947131881104`*^9}, {
   3.877976102770084*^9, 3.8779761140267982`*^9}, {3.878157695711175*^9, 
   3.8781577092274923`*^9}, 3.8783854049941874`*^9, {3.878412843664546*^9, 
   3.878412850054669*^9}, {3.8784134875786963`*^9, 3.878413489915539*^9}, {
   3.8784744740677643`*^9, 3.878474538323855*^9}, {3.8784752846022997`*^9, 
   3.878475286598607*^9}, {3.878828030959343*^9, 3.8788280822885647`*^9}, {
   3.8788281309424133`*^9, 3.8788281470172*^9}, {3.878829048286887*^9, 
   3.878829064210805*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"f73eb374-6289-4811-9ce9-010c9ec4ab97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"knl", "\[Rule]", "3.1932303399222066`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878828069131722*^9, 3.878828083007677*^9}, 
   3.878828140560945*^9, 3.878829223283834*^9, 3.8788409953621283`*^9, 
   3.878894363704616*^9, 3.879163467475979*^9, 3.879172266267252*^9, 
   3.879276920044862*^9, 3.8793284083943253`*^9, 3.879331017112259*^9, 
   3.879539375375239*^9, 3.879829655270218*^9, 3.8798805953731623`*^9, 
   3.879896092499894*^9, 3.879913688189045*^9, 3.880019514838876*^9, 
   3.880490880713174*^9, 3.8840055628870173`*^9, 3.88523532313313*^9, 
   3.885276519590814*^9, 3.88537785387962*^9, 3.885421388908289*^9, 
   3.885494610108018*^9, 3.88550860581643*^9, 3.8855406263248043`*^9, 
   3.885557787085182*^9, 3.885579782070057*^9, 3.8878823869796658`*^9, 
   3.8878918707190657`*^9, 3.888350865091792*^9, 3.8887581118950043`*^9, 
   3.88913678858181*^9, 3.890670446659072*^9, 3.893781242249016*^9, 
   3.89379311292525*^9, 3.893802219281725*^9, 3.8938254262280207`*^9, 
   3.893831074283984*^9, 3.8938435483636103`*^9, 3.893867453165007*^9, 
   3.895002262554552*^9, 3.895144583531274*^9, 3.89548362966117*^9, 
   3.8959985362116337`*^9, 3.8962913615377007`*^9, 3.896294315255802*^9, 
   3.8962944594044228`*^9, 3.896298242084393*^9, 3.896331059719339*^9, 
   3.896413030375237*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"3529c984-872f-4798-91c2-0244a843e8f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"knl", "\[Rule]", "10.107280269293533`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878828069131722*^9, 3.878828083007677*^9}, 
   3.878828140560945*^9, 3.878829223283834*^9, 3.8788409953621283`*^9, 
   3.878894363704616*^9, 3.879163467475979*^9, 3.879172266267252*^9, 
   3.879276920044862*^9, 3.8793284083943253`*^9, 3.879331017112259*^9, 
   3.879539375375239*^9, 3.879829655270218*^9, 3.8798805953731623`*^9, 
   3.879896092499894*^9, 3.879913688189045*^9, 3.880019514838876*^9, 
   3.880490880713174*^9, 3.8840055628870173`*^9, 3.88523532313313*^9, 
   3.885276519590814*^9, 3.88537785387962*^9, 3.885421388908289*^9, 
   3.885494610108018*^9, 3.88550860581643*^9, 3.8855406263248043`*^9, 
   3.885557787085182*^9, 3.885579782070057*^9, 3.8878823869796658`*^9, 
   3.8878918707190657`*^9, 3.888350865091792*^9, 3.8887581118950043`*^9, 
   3.88913678858181*^9, 3.890670446659072*^9, 3.893781242249016*^9, 
   3.89379311292525*^9, 3.893802219281725*^9, 3.8938254262280207`*^9, 
   3.893831074283984*^9, 3.8938435483636103`*^9, 3.893867453165007*^9, 
   3.895002262554552*^9, 3.895144583531274*^9, 3.89548362966117*^9, 
   3.8959985362116337`*^9, 3.8962913615377007`*^9, 3.896294315255802*^9, 
   3.8962944594044228`*^9, 3.896298242084393*^9, 3.896331059719339*^9, 
   3.896413031166745*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"c51fe0ad-3686-48e5-affb-0014d4d6a3aa"]
}, Closed]],

Cell["\<\
Parameters bestfit from BOSS, rescaled to MMo. (arxiv 1903.09208 Table 1)\
\>", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
   3.878318564396934*^9, 3.8783185665840807`*^9}, {3.8783189236834927`*^9, 
   3.8783189249818363`*^9}, {3.8783193275467777`*^9, 3.878319330519642*^9}, {
   3.878412930164959*^9, 3.8784129331531353`*^9}, {3.878468739621086*^9, 
   3.878468764008396*^9}, 3.878468929463129*^9, {3.878472218988697*^9, 
   3.878472222141864*^9}, 3.8784732045518923`*^9, {3.878476114900951*^9, 
   3.878476147291431*^9}, {3.878476987119795*^9, 3.878477009819968*^9}, 
   3.885626209117853*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a87c4527-1f3c-4fd0-9dea-3f0332fefe7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bzMMo", "=", 
   RowBox[{
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MMospec", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"MMospec", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "//", "Interpolation"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8854945135615063`*^9, 3.8854945206780376`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"6b473312-a3eb-432f-9380-cf251775c7fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bzMMo", "[", 
  RowBox[{"Getzeffs", "[", 
   RowBox[{"MMospec", ",", "MMocut"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8854945498183813`*^9, 3.88549455189738*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"50cae36e-775e-4b24-8c7d-0d07e2589aeb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.073186555054316`", ",", "6.257622960678745`"}], "}"}]], "Output",
 CellChangeTimes->{3.885494610925201*^9, 3.885508606637697*^9, 
  3.885540627100512*^9, 3.8855577878816853`*^9, 3.88557978285318*^9, 
  3.887882387795813*^9, 3.887891871548225*^9, 3.8883508658788023`*^9, 
  3.8887581127229853`*^9, 3.889136789370103*^9, 3.890670447472054*^9, 
  3.893781243042017*^9, 3.8937931136952047`*^9, 3.8938022201063557`*^9, 
  3.893825427042059*^9, 3.8938310752121897`*^9, 3.893843572612659*^9, 
  3.893867453974061*^9, 3.89500226337719*^9, 3.895144584375311*^9, 
  3.895483630470078*^9, 3.895998536999487*^9, 3.896291362396144*^9, 
  3.896294315477861*^9, 3.8962944602061777`*^9, 3.8962982428803263`*^9, 
  3.8963310605288877`*^9, 3.896413031182019*^9},
 CellLabel->
  "Out[296]=",ExpressionUUID->"45763b4f-9477-406a-bfea-422bc4e25d00"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bfixMMo1", "=", 
   RowBox[{"bfixn", "[", 
    RowBox[{"3.073186555054316`", ",", "bfixstoch"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bfixMMo2", "=", 
   RowBox[{"bfixn", "[", 
    RowBox[{"6.257622960678745`", ",", "bfixstoch"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.885494569251248*^9, 3.885494572042048*^9}, {
  3.885494618844261*^9, 3.885494623621262*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"9a72dbbb-e889-4673-920a-c3010d153fd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffixMMo1", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"bfixMMo1", ",", "fnlfix", ",", "paramfix", ",", "knlMMo1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffixMMo2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"bfixMMo2", ",", "fnlfix", ",", "paramfix", ",", "knlMMo2"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878413056459043*^9, 3.8784130699454308`*^9}, {
  3.878477083190627*^9, 3.8784770876410427`*^9}, {3.878829070430307*^9, 
  3.8788290726021976`*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"6b3b3103-314e-46e8-8b60-b23206eb5dfb"],

Cell["Binning sizes", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781577058616667`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"039bc322-ab77-4695-bd57-fe3dab778bbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dkPMM", " ", "=", " ", 
   RowBox[{"dk", "->", "0.005"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dkBMM", "=", 
   RowBox[{"dk", "->", "0.02"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87841338734165*^9, 3.878413390596964*^9}, {
  3.878477111413334*^9, 3.878477113441815*^9}, {3.878895451541523*^9, 
  3.878895451695315*^9}, {3.879245800987814*^9, 3.87924580519803*^9}, {
  3.8794477453912983`*^9, 3.879447745659726*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"d71ab4e3-225e-4384-8f8e-ec877b64a2da"],

Cell["New kmax", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878396838288425*^9, 3.878396840811236*^9}, {
  3.887878940174028*^9, 3.88787895498912*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"df45c135-c1df-42f3-836a-d247bac563b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcMMo1TNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "MMo1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcMMo2TNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "MMo2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8883213342139587`*^9, 3.888321344542603*^9}, {
  3.8883222334019747`*^9, 3.8883222450217333`*^9}, {3.888325974577829*^9, 
  3.888326019377328*^9}, {3.895474294935298*^9, 3.895474294935732*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"1735f659-c333-4b51-8c1b-eb89da4b8a1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcMMo1NS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "MMo1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcMMo2NS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "MMo2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8883259748935747`*^9, 3.888326019859079*^9}, {
  3.8954742949369507`*^9, 3.89547429493738*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"c4367df5-56a4-478c-80d9-68f6e442b5d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcMMo1NS2L", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory2L", "[", 
     RowBox[{"k", ",", "MMo1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcMMo2NS2L", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory2L", "[", 
     RowBox[{"k", ",", "MMo2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888325975224154*^9, 3.888326023551197*^9}, {
  3.895474294938568*^9, 3.895474294938987*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"237b93c8-f379-4a2e-aa65-be589f599019"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxMMo1Tree", " ", "=", " ", 
  RowBox[{
   RowBox[{"GetkmaxT", "[", "funcMMo1TNS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxMMo2Tree", " ", "=", 
  RowBox[{
   RowBox[{"GetkmaxT", "[", "funcMMo2TNS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.88788945578306*^9, 3.887889469612871*^9}, {
  3.887889544719244*^9, 3.8878895541435833`*^9}, {3.888325038714127*^9, 
  3.8883250591134853`*^9}, {3.888325975510754*^9, 3.888325987901361*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"2d5060dc-c0bc-44aa-b527-e8be30424c44"],

Cell[BoxData["0.14449481292987867`"], "Output",
 CellChangeTimes->{3.8878895611407423`*^9, 3.8878915115109587`*^9, 
  3.888325083761134*^9, 3.8883269622203074`*^9, 3.888350879903104*^9, 
  3.8887581274255733`*^9, 3.8891368034513693`*^9, 3.890670462014636*^9, 
  3.893781259471155*^9, 3.893793129514864*^9, 3.8938022346479187`*^9, 
  3.8938254414102983`*^9, 3.893831089661392*^9, 3.893843595285452*^9, 
  3.893867468337244*^9, 3.8950022783293047`*^9, 3.895144599279029*^9, 
  3.895483645259243*^9, 3.8959985511398993`*^9, 3.896291377526684*^9, 
  3.896294474585658*^9, 3.8962982571169147`*^9, 3.896331075051021*^9, 
  3.896413046155046*^9},
 CellLabel->
  "Out[309]=",ExpressionUUID->"ca68273a-1d0a-4e3b-b404-aec8a0b22acc"],

Cell[BoxData["0.27763487479852916`"], "Output",
 CellChangeTimes->{3.8878895611407423`*^9, 3.8878915115109587`*^9, 
  3.888325083761134*^9, 3.8883269622203074`*^9, 3.888350879903104*^9, 
  3.8887581274255733`*^9, 3.8891368034513693`*^9, 3.890670462014636*^9, 
  3.893781259471155*^9, 3.893793129514864*^9, 3.8938022346479187`*^9, 
  3.8938254414102983`*^9, 3.893831089661392*^9, 3.893843595285452*^9, 
  3.893867468337244*^9, 3.8950022783293047`*^9, 3.895144599279029*^9, 
  3.895483645259243*^9, 3.8959985511398993`*^9, 3.896291377526684*^9, 
  3.896294474585658*^9, 3.8962982571169147`*^9, 3.896331075051021*^9, 
  3.896413061354101*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"43b786bb-0b30-4221-9020-908bbab4f4ad"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxMMo1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Getkmax", "[", "funcMMo1NS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxMMo2", " ", "=", 
  RowBox[{
   RowBox[{"Getkmax", "[", "funcMMo2NS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8883259758435783`*^9, 3.8883259887268057`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"f994bcd7-30eb-40c5-a777-14c9fb58d948"],

Cell[BoxData["0.36145775545948666`"], "Output",
 CellChangeTimes->{3.888325096594342*^9, 3.888326991661993*^9, 
  3.888350907399737*^9, 3.888350939795477*^9, 3.8887581560689163`*^9, 
  3.889136831496739*^9, 3.890670490366743*^9, 3.8937812849148283`*^9, 
  3.8937931542844*^9, 3.893802261797385*^9, 3.893825468211336*^9, 
  3.893831116886471*^9, 3.893843621961125*^9, 3.893867495378981*^9, 
  3.895002306604031*^9, 3.895144627455513*^9, 3.895483673310697*^9, 
  3.895998577578248*^9, 3.8962914060354652`*^9, 3.896294501546564*^9, 
  3.896298284154893*^9, 3.89633110246099*^9, 3.8964130743759813`*^9},
 CellLabel->
  "Out[311]=",ExpressionUUID->"9d912502-5364-491f-8582-594b456d93f3"],

Cell[BoxData["0.7616942953733469`"], "Output",
 CellChangeTimes->{3.888325096594342*^9, 3.888326991661993*^9, 
  3.888350907399737*^9, 3.888350939795477*^9, 3.8887581560689163`*^9, 
  3.889136831496739*^9, 3.890670490366743*^9, 3.8937812849148283`*^9, 
  3.8937931542844*^9, 3.893802261797385*^9, 3.893825468211336*^9, 
  3.893831116886471*^9, 3.893843621961125*^9, 3.893867495378981*^9, 
  3.895002306604031*^9, 3.895144627455513*^9, 3.895483673310697*^9, 
  3.895998577578248*^9, 3.8962914060354652`*^9, 3.896294501546564*^9, 
  3.896298284154893*^9, 3.89633110246099*^9, 3.896413087135393*^9},
 CellLabel->
  "Out[312]=",ExpressionUUID->"7f51bc3c-9ad8-4391-9bb2-45096fc7f44d"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxMMo12L", " ", "=", " ", 
  RowBox[{
   RowBox[{"Getkmax2L", "[", "funcMMo1NS2L", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxMMo22L", " ", "=", 
  RowBox[{
   RowBox[{"Getkmax2L", "[", "funcMMo2NS2L", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.888325047070911*^9, 3.888325065946267*^9}, {
  3.888325144379429*^9, 3.888325147422266*^9}, {3.88832597700211*^9, 
  3.888325990369556*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"0ff52f5f-08aa-425e-aa3f-ba641bcc1ad2"],

Cell[BoxData["0.5157131137659995`"], "Output",
 CellChangeTimes->{3.8883251402811823`*^9, 3.888325180777462*^9, 
  3.88832702640661*^9, 3.888350973763589*^9, 3.888758190857007*^9, 
  3.889136866224629*^9, 3.89067052525913*^9, 3.893781325408235*^9, 
  3.893793194845628*^9, 3.8938022966204576`*^9, 3.8938255026845016`*^9, 
  3.893831152090753*^9, 3.893843656094205*^9, 3.893867529162768*^9, 
  3.8950023421808863`*^9, 3.895144662196447*^9, 3.895483709961083*^9, 
  3.895998611636634*^9, 3.896291442347974*^9, 3.896294535501544*^9, 
  3.896298318597808*^9, 3.896331137498679*^9, 3.896413109462433*^9},
 CellLabel->
  "Out[313]=",ExpressionUUID->"84b1b3a2-209d-4e0e-83c2-7055514d6fd1"],

Cell[BoxData["1.1301533224026636`"], "Output",
 CellChangeTimes->{3.8883251402811823`*^9, 3.888325180777462*^9, 
  3.88832702640661*^9, 3.888350973763589*^9, 3.888758190857007*^9, 
  3.889136866224629*^9, 3.89067052525913*^9, 3.893781325408235*^9, 
  3.893793194845628*^9, 3.8938022966204576`*^9, 3.8938255026845016`*^9, 
  3.893831152090753*^9, 3.893843656094205*^9, 3.893867529162768*^9, 
  3.8950023421808863`*^9, 3.895144662196447*^9, 3.895483709961083*^9, 
  3.895998611636634*^9, 3.896291442347974*^9, 3.896294535501544*^9, 
  3.896298318597808*^9, 3.896331137498679*^9, 3.896413132087027*^9},
 CellLabel->
  "Out[314]=",ExpressionUUID->"8ec7f2d4-776b-43b8-8511-4e1c67e17a1d"]
}, Closed]],

Cell["Get triangles and ktabs", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.878413323616858*^9, 
  3.878413329145935*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9cec99f9-769e-49fd-8d2d-b041d866c561"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabMMo1", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxMMo1"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktabMMo2", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxMMo2"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878416313557293*^9, 3.878416313604795*^9}, {
   3.8784696138095818`*^9, 3.878469623177285*^9}, {3.8784732117419443`*^9, 
   3.878473212223881*^9}, 3.878477390328534*^9, 3.878477425150929*^9},
 CellLabel->
  "In[315]:=",ExpressionUUID->"1dc0925c-83ae-47da-bc32-13b8d96be112"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabMMo12L", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxMMo12L"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktabMMo22L", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "1"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879887561312545*^9, 3.8798875679874153`*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"39c9d17d-fada-4fe6-a294-c831f024f32e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keffMMo1", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo1", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffMMo2", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo2", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMotriangs1", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo1", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMotriangs2", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo2", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873468583303989*^9, 3.873468660291182*^9}, {
   3.87387514677607*^9, 3.873875146950919*^9}, {3.873964428032702*^9, 
   3.873964462207315*^9}, 3.8739665707698593`*^9, {3.87396675335675*^9, 
   3.8739667596310387`*^9}, {3.873971006821004*^9, 3.873971008067816*^9}, {
   3.8783319345931463`*^9, 3.878331935928195*^9}, {3.8784131133383417`*^9, 
   3.878413114721896*^9}, 3.878413177209508*^9, {3.87841329842533*^9, 
   3.8784133219391823`*^9}, {3.878413355587755*^9, 3.878413371590088*^9}, {
   3.878416309245821*^9, 3.8784163112058496`*^9}, {3.878469617381531*^9, 
   3.878469631412734*^9}, {3.878473212658925*^9, 3.87847321423339*^9}, {
   3.878477390776503*^9, 3.878477391109002*^9}, {3.8784774254291143`*^9, 
   3.8784774256897173`*^9}, {3.87884120614884*^9, 3.8788412130687733`*^9}, {
   3.879163625822709*^9, 3.879163630435944*^9}, {3.879245821196266*^9, 
   3.879245828485385*^9}, {3.87944795942017*^9, 3.87944796186674*^9}, {
   3.8852392462795*^9, 3.885239246583995*^9}},
 CellLabel->
  "In[319]:=",ExpressionUUID->"88c3af0a-90cf-4bb6-a528-5446e8fae155"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keffMMo1T", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo1Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffMMo2T", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo2Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMotriangs1T", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo1Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMotriangs2T", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMo2Tree", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879447984383417*^9, 3.879448006416136*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"79d400e0-df6a-422c-bb49-dfeab15de456"],

Cell["Analytical Covariance with Full redshift", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.878383948812495*^9, 3.878383950482119*^9}, {
  3.878386152574986*^9, 3.8783861554874563`*^9}, {3.8783863995820503`*^9, 
  3.8783864090286303`*^9}, {3.878389253828569*^9, 3.878389261403257*^9}, {
  3.878389696132431*^9, 3.878389697083682*^9}, {3.878391368215104*^9, 
  3.878391370393168*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ed624cde-d2f9-4f25-9cff-0e630d13e76f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMo1P", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo1", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMo2P", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo2", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8852370364307337`*^9, 3.885237097953294*^9}, {
   3.885237145828494*^9, 3.885237186384832*^9}, {3.885238830302793*^9, 
   3.8852388644419117`*^9}, {3.885495275788561*^9, 3.885495301039796*^9}, 
   3.8890941594863653`*^9, {3.895474294940056*^9, 3.895474294940379*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"1e829e00-a739-4a48-9e88-db5017c51792"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMo1P2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo12L", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMo2P2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo22L", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879887577258407*^9, 3.879887583136751*^9}, {
  3.880491273586534*^9, 3.880491273850292*^9}, {3.885238889182351*^9, 
  3.8852388900050173`*^9}, {3.8854952799963627`*^9, 3.885495309325123*^9}, {
  3.895474294941687*^9, 3.895474294942017*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"fa02e27e-628a-4e43-b5c8-8a243a8b5bf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMo1B", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMotriangs1", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMo2B", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMotriangs2", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879272884949*^9, 3.8792728949043427`*^9}, {
   3.885238888029283*^9, 3.8852388938708878`*^9}, {3.885495285091831*^9, 
   3.885495290166419*^9}, {3.88549532073311*^9, 3.885495327497261*^9}, 
   3.8890941649068327`*^9, {3.893781175148108*^9, 3.8937811768692293`*^9}, 
   3.893867256731427*^9, {3.89547442061075*^9, 3.8954744206111298`*^9}, {
   3.896426576438279*^9, 
   3.896426578161923*^9}},ExpressionUUID->"04269b6e-e323-4ce1-92b5-\
327dc037060e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMo1BTree", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMotriangs1T", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMo2BTree", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMotriangs2T", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879272884949*^9, 3.8792728949043427`*^9}, {
   3.8794481200222387`*^9, 3.8794481352803297`*^9}, {3.879448171284606*^9, 
   3.879448174363303*^9}, {3.885495346983404*^9, 3.885495348876062*^9}, {
   3.895474420612216*^9, 3.895474420612602*^9}, 3.895484925573065*^9, {
   3.8964265830612297`*^9, 
   3.8964265847685623`*^9}},ExpressionUUID->"50c9bbc2-2cab-41eb-b683-\
dd3c839ad446"],

Cell["Analytical Covariance with Full redshift- No shot noise", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.878383948812495*^9, 3.878383950482119*^9}, {
  3.878386152574986*^9, 3.8783861554874563`*^9}, {3.8783863995820503`*^9, 
  3.8783864090286303`*^9}, {3.878389253828569*^9, 3.878389261403257*^9}, {
  3.878389696132431*^9, 3.878389697083682*^9}, {3.878391368215104*^9, 
  3.878391370393168*^9}, {3.8783917561480427`*^9, 3.878391759615937*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ed7c620f-e245-46a5-8529-161e2a429b59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMo1PNS", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo1", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstochNS", ",", 
     "dkPMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMo2PNS", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo2", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstochNS", ",", 
     "dkPMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8783917610267467`*^9, 3.878391811683134*^9}, {
  3.87841377765718*^9, 3.878413785369425*^9}, {3.878473218559148*^9, 
  3.878473219222835*^9}, {3.878477393376292*^9, 3.8784773938926353`*^9}, {
  3.878477427196947*^9, 3.878477427848215*^9}, {3.8784776732279*^9, 
  3.8784776780998297`*^9}, {3.8788963327550077`*^9, 3.878896333516057*^9}, {
  3.885239263122575*^9, 3.8852392666311703`*^9}, {3.885495363426927*^9, 
  3.885495382158422*^9}, {3.895474294942923*^9, 3.895474294943284*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"71a51fba-3308-48b6-9ae6-bf9937b2f8e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMo1PNS2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo12L", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstochNS", ",", 
     "dkPMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMo2PNS2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMo22L", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstochNS", ",", 
     "dkPMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879887600530485*^9, 3.879887605551531*^9}, {
  3.8852392744009457`*^9, 3.885239275186656*^9}, {3.8854953787798767`*^9, 
  3.88549540364633*^9}, {3.895474294944188*^9, 3.8954742949445133`*^9}},
 CellLabel->
  "In[341]:=",ExpressionUUID->"f7258f6d-c7fc-4622-a8cb-42d0a2950b2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMo1BNS", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMotriangs1", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstochNS", ",", 
     "dkBMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMo2BNS", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMotriangs2", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstochNS", ",", 
     "dkBMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8783896333113213`*^9, 3.87838968310667*^9}, {
   3.878391763493541*^9, 3.878391769578429*^9}, {3.878391963015897*^9, 
   3.878391965147833*^9}, {3.8784138495762*^9, 3.878413856324275*^9}, {
   3.878473219380501*^9, 3.878473220172638*^9}, {3.878477394151277*^9, 
   3.878477394600235*^9}, {3.878477428393903*^9, 3.878477429011702*^9}, {
   3.878477674196205*^9, 3.8784776790928917`*^9}, {3.87916393323487*^9, 
   3.8791639334056263`*^9}, 3.879902918486341*^9, {3.8799140499758387`*^9, 
   3.8799140501457567`*^9}, 3.880021795246334*^9, {3.885239281918829*^9, 
   3.88523928296945*^9}, {3.885378004836475*^9, 3.885378009111669*^9}, {
   3.8854953567842503`*^9, 3.885495357645015*^9}, {3.885495398824473*^9, 
   3.8854954054841633`*^9}, 3.889094292442172*^9, {3.893784534094627*^9, 
   3.893784537016527*^9}, 3.893867266412455*^9, {3.895474420613565*^9, 
   3.8954744206139383`*^9}, {3.896426593220561*^9, 
   3.8964265950780153`*^9}},ExpressionUUID->"92353e13-41bf-4485-919d-\
bc4924859739"],

Cell["Powerspectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332301420657*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"fb3679b2-54b7-48fa-8700-a39ded94e98f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMo1derivs", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMo1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMo1pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMo1", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMo1"}], "/.", "nbMMo1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMo2derivs", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMo2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMo2pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMo2", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMo2"}], "/.", "nbMMo2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873518998897326*^9, 3.873519007688743*^9}, {
   3.873519068623493*^9, 3.873519077607183*^9}, {3.873519615193363*^9, 
   3.873519620203136*^9}, {3.8735196572278223`*^9, 3.8735196641762877`*^9}, {
   3.873875798249857*^9, 3.873875813066736*^9}, {3.873966975417568*^9, 
   3.87396704163301*^9}, 3.873967115591464*^9, 3.878332335499425*^9, {
   3.878385477696348*^9, 3.878385485946587*^9}, {3.878469768836133*^9, 
   3.878469827807899*^9}, {3.87847322078467*^9, 3.878473222382102*^9}, {
   3.87847739485341*^9, 3.878477395351128*^9}, {3.878477429551351*^9, 
   3.87847743083393*^9}, {3.878841502314423*^9, 3.878841519159898*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"4bf7698c-a944-42af-9d66-995bd1866309"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMo1derivs2L", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMo12L", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMo1pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMo12L", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMo1"}], "/.", "nbMMo1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMo2derivs2L", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMo22L", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMo2pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMo22L", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMo2"}], "/.", "nbMMo2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879887616598456*^9, 3.879887631545321*^9}},
 CellLabel->
  "In[349]:=",ExpressionUUID->"b9965a87-2010-450b-9ca5-6f05b61628b3"],

Cell["Bispectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"6a83ea96-777f-4198-9aa8-235b075368e0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BMMo1derivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"keffMMo1T", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMo1pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMo1", "]"}]}], "/.", "nbMMo1"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMo1T", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BMMo2derivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"keffMMo2T", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMo2pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMo2", "]"}]}], "/.", "nbMMo2"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMo2T", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.879245916889481*^9, 3.8792459222897463`*^9}, {
   3.879272284429164*^9, 3.879272308042398*^9}, {3.879273540000227*^9, 
   3.879273585850821*^9}, {3.879443765001204*^9, 3.879443801574843*^9}, {
   3.87944395577462*^9, 3.8794439612924356`*^9}, {3.879448260727165*^9, 
   3.879448310603842*^9}, {3.879614392098673*^9, 3.879614397485928*^9}, 
   3.885495482928049*^9},
 CellLabel->
  "In[703]:=",ExpressionUUID->"f27341e1-0821-4bf4-8395-0aa27ae2062d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.882855`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.879245994377934*^9, {3.879272298200151*^9, 3.8792723063282747`*^9}, 
   3.879272762779117*^9, 3.879275261969735*^9, 3.879582063505431*^9, 
   3.879614407775579*^9, 3.880027366766055*^9, 3.8840111809120207`*^9, 
   3.885239388786462*^9, 3.88524753521918*^9, 3.885390048357486*^9, 
   3.885580720513332*^9, 3.8883380844801903`*^9, 3.888384271237115*^9, 
   3.888758596917252*^9, 3.893867929975911*^9, 3.895002795899619*^9, 
   3.895144765985918*^9, 3.895483934563089*^9, 3.896291651838585*^9, 
   3.8963313351640167`*^9},
 CellLabel->
  "Out[703]=",ExpressionUUID->"02fb1cd5-5bba-44db-bcde-c10a70edc4d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32.923803`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.879245994377934*^9, {3.879272298200151*^9, 3.8792723063282747`*^9}, 
   3.879272762779117*^9, 3.879275261969735*^9, 3.879582063505431*^9, 
   3.879614407775579*^9, 3.880027366766055*^9, 3.8840111809120207`*^9, 
   3.885239388786462*^9, 3.88524753521918*^9, 3.885390048357486*^9, 
   3.885580720513332*^9, 3.8883380844801903`*^9, 3.888384271237115*^9, 
   3.888758596917252*^9, 3.893867929975911*^9, 3.895002795899619*^9, 
   3.895144765985918*^9, 3.895483934563089*^9, 3.896291651838585*^9, 
   3.896331368088382*^9},
 CellLabel->
  "Out[704]=",ExpressionUUID->"68e29abb-0949-4e69-9236-5f05b4f38ffe"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BMMo1derivspre", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"B1Loopderivs", "[", 
           RowBox[{
            RowBox[{"keffMMo1", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMo1pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMo1", "]"}]}], "/.", "nbMMo1"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMo1", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BMMo2derivspre", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"B1Loopderivs", "[", 
           RowBox[{
            RowBox[{"keffMMo2", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMo2pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMo2", "]"}]}], "/.", "nbMMo2"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMo2", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8785521935616207`*^9, 3.8785522163665543`*^9}, {
   3.87884158011763*^9, 3.8788415890454407`*^9}, {3.878841624574361*^9, 
   3.878841628821933*^9}, {3.878841672075293*^9, 3.878841692043252*^9}, {
   3.879272382126865*^9, 3.879272382548891*^9}, 3.879272437352563*^9, {
   3.879273597040414*^9, 3.879273657311171*^9}, {3.879275535764578*^9, 
   3.879275542273411*^9}, {3.879443755201642*^9, 3.8794437586852493`*^9}, {
   3.879443950237886*^9, 3.879443953443111*^9}, {3.879448313090073*^9, 
   3.879448379609747*^9}, 3.8799013753959637`*^9, {3.879914066714028*^9, 
   3.879914066860073*^9}, {3.8853903374710903`*^9, 3.885390338196616*^9}, {
   3.8854954485459642`*^9, 3.8854954816649647`*^9}, {3.8856261662378807`*^9, 
   3.885626169814085*^9}, {3.885626839445759*^9, 3.885626841923852*^9}, {
   3.888333063483485*^9, 3.888333065146494*^9}, {3.888351199483493*^9, 
   3.888351209721497*^9}, {3.889094308016033*^9, 3.889094324154984*^9}, {
   3.893784561499537*^9, 3.893784580157346*^9}, {3.893792775916584*^9, 
   3.89379277634805*^9}, {3.8938672845004997`*^9, 3.893867304913752*^9}, {
   3.895002632494956*^9, 3.895002633312145*^9}, {3.8962941949916973`*^9, 
   3.896294201096483*^9}, {3.896294782181816*^9, 3.8962947943334007`*^9}, {
   3.896326858740733*^9, 3.8963268674966793`*^9}, {3.89642660697993*^9, 
   3.896426613576357*^9}, {3.896609631593528*^9, 
   3.896609633625504*^9}},ExpressionUUID->"2eb4e522-76bb-4636-a9a6-\
b5573aea1b79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoopsubMMo1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BLoopsub", "[", "MMo1pk", "]"}], "/.", 
     RowBox[{"Dispatch", "[", "coeffixMMo1", "]"}]}], "/.", "nbMMo1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoopsubMMo2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BLoopsub", "[", "MMo2pk", "]"}], "/.", 
     RowBox[{"Dispatch", "[", "coeffixMMo2", "]"}]}], "/.", "nbMMo2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.886508613967452*^9, 3.886508635644329*^9}, {
  3.8865127726273127`*^9, 3.886512784255369*^9}, {3.896603738538004*^9, 
  3.896603766309828*^9}},
 CellLabel->
  "In[360]:=",ExpressionUUID->"bd3e69cc-cc9d-43b5-9859-a5c7170a3f8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BMMo1derivs", "=", 
   RowBox[{"BMMo1derivspre", "-", 
    RowBox[{"Table", "[", 
     RowBox[{"LoopsubMMo1", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMo1", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMMo2derivs", "=", 
   RowBox[{"BMMo2derivspre", "-", 
    RowBox[{"Table", "[", 
     RowBox[{"LoopsubMMo2", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMo2", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.886508629228701*^9, 3.886508646094849*^9}, {
  3.886512750141049*^9, 3.886512750831511*^9}, {3.886512798563549*^9, 
  3.88651281175152*^9}, {3.888053590913364*^9, 3.888053591687595*^9}, {
  3.896603768159939*^9, 3.8966037980407743`*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"800cde81-117a-4faa-a8cf-c16cebc1c40d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fishers ", "Subsection",
 CellChangeTimes->{{3.8783910593521233`*^9, 3.8783910828550453`*^9}, {
   3.87841255670513*^9, 3.878412558622801*^9}, {3.87847106765874*^9, 
   3.878471075603257*^9}, 
   3.878472309210397*^9},ExpressionUUID->"e3546dad-f61d-4d1b-be1d-\
3541ca0e04fd"],

Cell["Reduce P-derivatives to monopole and quadrupole", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391400909933*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9ababc24-1e10-4637-99dc-a75f4c60ac75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMo1monoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PMMo1derivs", "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMo2monoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PMMo2derivs", "]"}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8783854974202147`*^9, {3.878391156242745*^9, 3.878391178604154*^9}, {
   3.87839131726943*^9, 3.8783913246578836`*^9}, {3.8784703488075943`*^9, 
   3.878470362719586*^9}, {3.878477399801289*^9, 3.8784774000930023`*^9}, {
   3.878477432649067*^9, 3.878477432799201*^9}},
 CellLabel->
  "In[709]:=",ExpressionUUID->"5bd1dc5a-0dd4-4d07-86b6-c9aa5f49f0b0"],

Cell["Powerspectrum Fishers monoquad", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471130667965*^9, 3.8784711318254747`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bc583427-5930-48c1-8dfa-2873006153d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPMMo1", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo1monoquad", ",", "COVMMo1P"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPMMo2", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo2monoquad", ",", "COVMMo2P"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877298767724556*^9, 3.8772987953889217`*^9}, {
  3.8783912080268583`*^9, 3.878391210249255*^9}, {3.878470369143877*^9, 
  3.878470402858488*^9}, {3.8784774004422607`*^9, 3.878477401367791*^9}, {
  3.8784774329677067`*^9, 3.878477433932514*^9}, {3.88547959938271*^9, 
  3.885479599383039*^9}},
 CellLabel->
  "In[711]:=",ExpressionUUID->"8070f488-ec3a-43c0-9bff-cc2998147602"],

Cell["Bispectrum Fishers - mono", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391430313566*^9}, {
  3.878409282105134*^9, 3.878409283129027*^9}, {3.8784711373327293`*^9, 
  3.878471138379108*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"94486964-1887-4219-abdf-ab76519ce540"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBMMo1", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo1derivs", ",", "COVMMo1B", ",", "Loopmastermono"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBMMo2", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo2derivs", ",", "COVMMo2B", ",", "Loopmastermono"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.877299183948834*^9, 3.877299194957054*^9}, 
   3.878411016536647*^9, {3.878470406485463*^9, 3.878470430487794*^9}, {
   3.878477401900421*^9, 3.8784774026923637`*^9}, {3.878477434779148*^9, 
   3.878477436021389*^9}},
 CellLabel->
  "In[713]:=",ExpressionUUID->"25855e8d-7dd6-4a59-8795-5c40e99c822c"],

Cell["Powerspectrum Fishers full \[Mu]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471134226358*^9}, {3.879448514674612*^9, 
  3.879448515671617*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0af05373-6cbd-4b3d-b547-6fca504d86b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPMMo1mu", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo1derivs", ",", "COVMMo1P"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPMMo2mu", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo2derivs", ",", "COVMMo2P"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8784774035354643`*^9, 3.878477404409371*^9}, {
  3.878477437007348*^9, 3.878477438371073*^9}, {3.8788873307241793`*^9, 
  3.87888733154928*^9}, {3.885479599383809*^9, 3.885479599384107*^9}},
 CellLabel->
  "In[715]:=",ExpressionUUID->"d7e8bab2-962c-4844-8b90-c353f7af1455"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPMMo1mu2L", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo1derivs2L", ",", "COVMMo1P2L"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPMMo2mu2L", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo2derivs2L", ",", "COVMMo2P2L"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879887646471279*^9, 3.879887658947791*^9}, {
  3.88547959938484*^9, 3.885479599385147*^9}},
 CellLabel->
  "In[717]:=",ExpressionUUID->"6f8a9b42-524a-4e9f-8a3e-bff0149f0ec8"],

Cell["Bispectrum Fishers full \[Mu]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.879448521901677*^9, 
  3.87944852339006*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a50e7990-997d-4a79-b921-73c276a275ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBMMo1mu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo1derivs", ",", "COVMMo1B", ",", "Loopmaster"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBMMo2mu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo2derivs", ",", "COVMMo2B", ",", "Loopmaster"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878471150568904*^9, 3.8784711611799793`*^9}, {
  3.8784774048729*^9, 3.878477407951654*^9}, {3.878477446491733*^9, 
  3.87847744746169*^9}},
 CellLabel->
  "In[719]:=",ExpressionUUID->"986f2849-101f-4085-82ed-2fcfcd3bce75"],

Cell["Bispectrum Fishers full \[Mu] Tree", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.8794439390888777`*^9, 
  3.8794439401353083`*^9}, {3.879443983047256*^9, 3.87944398400249*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9f580b19-12ea-4f55-ba3e-f8fb4551438e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBMMo1muT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo1derivsT", ",", "COVMMo1BTree", ",", "Loopmaster"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBMMo2muT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo2derivsT", ",", "COVMMo2BTree", ",", "Loopmaster"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.878471150568904*^9, 3.8784711611799793`*^9}, {
  3.8784774048729*^9, 3.878477407951654*^9}, {3.878477446491733*^9, 
  3.87847744746169*^9}, {3.87944861150875*^9, 3.879448636279298*^9}, {
  3.879614303605589*^9, 3.8796143095599213`*^9}},
 CellLabel->
  "In[721]:=",ExpressionUUID->"41e8c784-fc12-4e84-92eb-15c7d93cfacf"],

Cell["Powerspectrum Fishers full NS", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471134226358*^9}, {3.878564849887862*^9, 
  3.878564850295282*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"8a58e4e2-04bc-4393-b778-d1e03d5d28c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPMMo1muNS", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo1derivs", ",", "COVMMo1PNS"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPMMo2muNS", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMo2derivs", ",", "COVMMo2PNS"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8784774035354643`*^9, 3.878477404409371*^9}, {
  3.878477437007348*^9, 3.878477438371073*^9}, {3.8785543478561296`*^9, 
  3.878554349574971*^9}, {3.878564853088325*^9, 3.878564853171564*^9}, {
  3.878564902111504*^9, 3.878564954529625*^9}, {3.878887419418124*^9, 
  3.878887419423029*^9}, {3.885479599386529*^9, 3.885479599386845*^9}},
 CellLabel->
  "In[723]:=",ExpressionUUID->"6ca2e0a6-243e-422d-924a-8e66374c1d85"],

Cell["Bispectrum Fishers full NS", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.878564851296236*^9, 
  3.878564851715537*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0b999aa3-e750-4ad0-b3ea-eab074f90d38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBMMo1muNS", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo1derivs", ",", "COVMMo1BNS", ",", "Loopmaster"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBMMo2muNS", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMo2derivs", ",", "COVMMo2BNS", ",", "Loopmaster"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879903297716895*^9, 3.8799033031726017`*^9}, {
  3.879914084088233*^9, 3.879914111173686*^9}, {3.880019716347781*^9, 
  3.880019716887642*^9}},
 CellLabel->
  "In[725]:=",ExpressionUUID->"e01999fc-a8d8-492a-ad5b-71a9c0e10c4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Perturbative Prior ", "Subsection",
 CellChangeTimes->{{3.895054428919343*^9, 3.895054448809629*^9}, {
   3.896345991464592*^9, 3.896345993053648*^9}, 
   3.896381880169745*^9},ExpressionUUID->"21cbaf8f-dea8-4d8e-b8f9-\
f1ede6f22f0d"],

Cell[CellGroupData[{

Cell["Powerspectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.88874151521391*^9}},ExpressionUUID->"0a8b2234-2436-4fd0-8549-\
2f803bcffaa0"],

Cell["scaling  bias  computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
   3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
   3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
   3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
   3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
   3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
   3.8887536509125*^9, 3.888753659481193*^9}, 3.894539283215518*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2c0e4fca-021d-4a49-a851-749b80b3647c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMo1Loop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabMMo1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMo1pk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabMMo1", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixMMo1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMo2Loop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabMMo2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMo2pk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabMMo2", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixMMo2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741261612136*^9, 3.88874127220191*^9}, 
   3.88875333043812*^9, {3.8887533861313133`*^9, 3.888753396861267*^9}, {
   3.888754416678398*^9, 3.888754434715231*^9}, 3.8950549661329603`*^9, {
   3.895056052149311*^9, 3.895056119622072*^9}, {3.895056153206499*^9, 
   3.895056153902245*^9}, {3.896346399774663*^9, 3.896346414924839*^9}},
 CellLabel->
  "In[1284]:=",ExpressionUUID->"b9c4f656-1ccf-4770-8458-822cf1a31b53"],

Cell["PTree computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
  3.888741162977934*^9, 3.888741164492325*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a10c18a8-5631-4d17-bdf2-f5340f0e17da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMo1Tree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabMMo1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMo1pk"}], "]"}], "/.", 
        "coeffixMMo1"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabMMo1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMo2Tree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabMMo2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMo2pk"}], "]"}], "/.", 
        "coeffixMMo2"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabMMo2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741178216148*^9, 3.888741205021223*^9}, 
   3.888745462695631*^9, 3.895054979145851*^9, {3.895056052652766*^9, 
   3.895056120544305*^9}, {3.895056154116026*^9, 3.895056154525999*^9}},
 CellLabel->
  "In[1286]:=",ExpressionUUID->"f6310f9d-e508-4471-9a42-4af4490a8f62"],

Cell["\[Sigma] computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
  3.888740413660467*^9, 3.8887404139676857`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"776de225-6618-4c19-a633-12434a422b02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcMMo1", "[", "k_", "]"}], "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{
        RowBox[{"GetFullzCovPInv", "[", 
         RowBox[{
         "ktabraw", ",", "MMo1pk", ",", "MMo1spec", ",", "bfixstoch", ",", 
          "dkPMM"}], "]"}], "/.", 
        RowBox[{"\[Mu]", "->", "0"}]}]}], "]"}], "[", "k", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcMMo2", "[", "k_", "]"}], "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{
        RowBox[{"GetFullzCovPInv", "[", 
         RowBox[{
         "ktabraw", ",", "MMo2pk", ",", "MMo2spec", ",", "bfixstoch", ",", 
          "dkPMM"}], "]"}], "/.", 
        RowBox[{"\[Mu]", "->", "0"}]}]}], "]"}], "[", "k", "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740432992057*^9, 3.888740457002887*^9}, {
   3.8887405566797333`*^9, 3.8887405983128567`*^9}, {3.888740634886725*^9, 
   3.88874063767188*^9}, {3.888741118670182*^9, 3.888741121830488*^9}, {
   3.888755168282782*^9, 3.888755168616124*^9}, {3.888755212474147*^9, 
   3.888755212892293*^9}, {3.8887553185172977`*^9, 3.888755333641263*^9}, {
   3.888755406547153*^9, 3.888755420384659*^9}, {3.8950560618360367`*^9, 
   3.8950561207028646`*^9}, 3.8950561547091007`*^9, {3.895056202374798*^9, 
   3.895056205924859*^9}, {3.895300195791605*^9, 3.8953001982620287`*^9}, {
   3.895474294945806*^9, 3.8954742949462233`*^9}},
 CellLabel->
  "In[1288]:=",ExpressionUUID->"389c75b4-9b50-4f53-993e-d8f267c7aeec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]MMo1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcMMo1", "[", 
      RowBox[{"ktabMMo1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabMMo1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]MMo2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcMMo2", "[", 
      RowBox[{"ktabMMo2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabMMo2", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740435898135*^9, 3.888740464811185*^9}, {
  3.888755168799716*^9, 3.88875516936604*^9}, {3.888755213091127*^9, 
  3.88875521372425*^9}, {3.888755285292038*^9, 3.888755298575753*^9}, {
  3.895056062202775*^9, 3.895056121011249*^9}, {3.895056154896344*^9, 
  3.8950561551179647`*^9}},
 CellLabel->
  "In[1290]:=",ExpressionUUID->"7127806b-c16c-4bf1-8e10-1d3a075f6f0b"],

Cell["Get \[OpenCurlyDoubleQuote]correct\[CloseCurlyDoubleQuote] \
powerspectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.8950518293200827`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bd11d1c2-7e90-4df0-a34a-e1ba1c321de5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1LCMMo1", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PMMo1Loop", ",", "\[Sigma]MMo1tab", ",", "PMMo1Tree"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1LCMMo2", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PMMo2Loop", ",", "\[Sigma]MMo2tab", ",", "PMMo2Tree"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888753553372282*^9, 3.888753584704721*^9}, {
  3.895001710873721*^9, 3.895001711694565*^9}, {3.895051621578108*^9, 
  3.895051657499125*^9}, {3.895055012063528*^9, 3.895055026561247*^9}, {
  3.895056062611322*^9, 3.895056092527287*^9}},
 CellLabel->
  "In[1292]:=",ExpressionUUID->"8cd91344-7b24-4cc6-8a06-fb88a3d34696"],

Cell["Get powerspectrum priors", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.895051842826643*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"031536cb-d8af-4717-bb8a-afac3d37a8b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPriorMMo1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabMMo1", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabMMo1", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "MMo1pk", ",", " ", 
             RowBox[{"P1LCMMo1", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabMMo1", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", 
      RowBox[{"\[Mu]", "->", "0"}]}], "/.", "coeffixMMo1"}], "/.", 
    "nbMMo1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPriorMMo2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabMMo2", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabMMo2", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "MMo2pk", ",", " ", 
             RowBox[{"P1LCMMo2", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabMMo2", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", 
      RowBox[{"\[Mu]", "->", "0"}]}], "/.", "coeffixMMo2"}], "/.", 
    "nbMMo2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895055040761423*^9, 3.895055065971439*^9}, {
  3.89505606403668*^9, 3.895056121896224*^9}, {3.895056155737891*^9, 
  3.8950561570047493`*^9}, {3.895144529824315*^9, 3.895144538163705*^9}, {
  3.89556699639074*^9, 3.895566999761866*^9}},
 CellLabel->
  "In[1294]:=",ExpressionUUID->"4a46de51-0d03-4608-ac80-bf87a106e9e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bispectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.888741528575953*^9}},ExpressionUUID->"ac61c198-0815-400d-ba96-\
352aa72d5cba"],

Cell["Bispectrum - Background  Tree and Loop", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741616313279*^9, 3.8887416248599854`*^9}, {
  3.8887416567266483`*^9, 3.888741660704743*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"aa6e7294-75cc-4ddb-a719-af713a7c863d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BMMo1Loopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Bloopscale", "[", 
         RowBox[{
          RowBox[{"keffMMo1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMo1pk"}], "]"}], "/.", 
        RowBox[{"Dispatch", "[", "coeffixMMo1", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMo1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMMo2Loopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Bloopscale", "[", 
         RowBox[{
          RowBox[{"keffMMo2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMo2pk"}], "]"}], "/.", 
        RowBox[{"Dispatch", "[", "coeffixMMo2", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMo2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887870506613146*^9, 3.887870526214724*^9}, {
   3.888045960956028*^9, 3.888045982568386*^9}, 3.8886762373468113`*^9, {
   3.888755179740827*^9, 3.888755180708872*^9}, {3.8887552242490683`*^9, 
   3.88875522526589*^9}, {3.888755320124936*^9, 3.8887553729582777`*^9}, {
   3.888755512955844*^9, 3.888755514140646*^9}, {3.8887555891094103`*^9, 
   3.8887556059686403`*^9}, {3.895056065594676*^9, 3.895056124684389*^9}, {
   3.895056160987278*^9, 3.895056162262398*^9}, 3.895056754844688*^9, {
   3.896346425224574*^9, 3.896346441910915*^9}},
 CellLabel->
  "In[1296]:=",ExpressionUUID->"aefb0dfd-7861-4e41-a2bf-4bf69d9bc1c4"],

Cell["Bispectrum - Derivatives of Loop only", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"cffdf7e9-cf7f-4a8f-a5f1-403a95fa4949"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CorrectionMMo1", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"keffMMo1", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "MMo1pk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixMMo1", "]"}]}], "/.", "nbMMo1"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMo1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CorrectionMMo2", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"keffMMo2", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "MMo2pk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixMMo2", "]"}]}], "/.", "nbMMo2"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMo2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887869756685066*^9, 3.887869779195531*^9}, {
   3.888755180899663*^9, 3.888755181700437*^9}, {3.8887552254749537`*^9, 
   3.888755226283332*^9}, {3.8887553203424063`*^9, 3.888755373142469*^9}, {
   3.88875552243512*^9, 3.888755523704595*^9}, {3.888755589509716*^9, 
   3.888755606401744*^9}, {3.895056066361334*^9, 3.895056125224794*^9}, {
   3.895056162996407*^9, 3.895056163823646*^9}, 3.895056762840891*^9, {
   3.895144549728813*^9, 3.89514455142511*^9}, 3.895147907625948*^9, {
   3.896381985114154*^9, 3.896381986822407*^9}, 3.896382692411488*^9, {
   3.896426620272553*^9, 
   3.896426622053463*^9}},ExpressionUUID->"69b93b05-aa47-47b6-993e-\
fcb605e0cbe1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BMMo1ngcLoopderivs", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BMMo1derivs", "+", "CorrectionMMo1"}], ")"}], ".", 
    "Blooplistreal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMMo2ngcLoopderivs", "  ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BMMo2derivs", "+", "CorrectionMMo2"}], ")"}], ".", 
    "Blooplistreal"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8868385093651257`*^9, 3.886838510201589*^9}, {
   3.886838918810886*^9, 3.886838923398671*^9}, 3.8868395694779863`*^9, 
   3.8868423371525383`*^9, {3.887869794724497*^9, 3.887869828310582*^9}, {
   3.887869867058724*^9, 3.8878698800661917`*^9}, {3.887961854062598*^9, 
   3.887961855134948*^9}, {3.888755181898987*^9, 3.888755182508569*^9}, {
   3.888755226499262*^9, 3.8887552271335783`*^9}, {3.888757711586331*^9, 
   3.888757731629743*^9}, {3.8950560669529123`*^9, 3.895056097147223*^9}, {
   3.8951445458004436`*^9, 3.8951445470791607`*^9}, {3.895300031049137*^9, 
   3.895300035718266*^9}, {3.8954854955893173`*^9, 3.8954854960952797`*^9}},
 CellLabel->
  "In[1301]:=",ExpressionUUID->"612eee63-d1c9-4a90-a020-39f568ad3bcd"],

Cell["Symmetric P1LC", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}, {
  3.8950532854616213`*^9, 3.895053290570174*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7be4eff3-d21c-43e3-8226-103ff7c43356"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PTtritabMMo1", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"keffMMo1", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "MMo1pk"}], "]"}], 
          "/.", "coeffixMMo1"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMo1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PTtritabMMo2", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"keffMMo2", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "MMo2pk"}], "]"}], 
          "/.", "coeffixMMo2"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMo2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743170297797*^9, 3.888743178232419*^9}, {
   3.888743239420354*^9, 3.8887432774648733`*^9}, {3.888743593628655*^9, 
   3.888743613564752*^9}, {3.8887538943446207`*^9, 3.8887538992824593`*^9}, {
   3.8887539507915707`*^9, 3.8887540245086727`*^9}, {3.8887551896332703`*^9, 
   3.8887551904843197`*^9}, {3.888755234532494*^9, 3.888755235382784*^9}, {
   3.88875532097534*^9, 3.888755373342001*^9}, {3.888755540603545*^9, 
   3.88875554247409*^9}, {3.888755591236051*^9, 3.88875560833599*^9}, {
   3.8950560675529327`*^9, 3.895056125783257*^9}, {3.8950561648659267`*^9, 
   3.8950561657796164`*^9}, 3.895056856974148*^9, {3.8963464494121647`*^9, 
   3.896346467489715*^9}},
 CellLabel->
  "In[1303]:=",ExpressionUUID->"8e97559a-a66f-422d-a245-960efdb1b65e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PsymtabMMo1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"keffMMo1", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "MMo1pk", ",", 
        RowBox[{"PTtritabMMo1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMo1", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixMMo1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsymtabMMo2", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"keffMMo2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "MMo2pk", ",", 
        RowBox[{"PTtritabMMo2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMo2", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixMMo2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743595979177*^9, 3.8887436284098597`*^9}, {
  3.888753901299285*^9, 3.888753903432684*^9}, {3.888753952413186*^9, 
  3.888753953499566*^9}, {3.888753996437364*^9, 3.888753999316115*^9}, {
  3.8887551906743107`*^9, 3.888755191574905*^9}, {3.888755235591964*^9, 
  3.888755236449566*^9}, {3.888755321174719*^9, 3.888755336499699*^9}, {
  3.888755544908473*^9, 3.88875554625144*^9}, {3.888755591618659*^9, 
  3.8887556087439938`*^9}, {3.8950560681615267`*^9, 3.895056127472228*^9}, {
  3.8950561661780148`*^9, 3.895056167229443*^9}},
 CellLabel->
  "In[1305]:=",ExpressionUUID->"f98471a0-982d-471f-9b15-2900944593c2"],

Cell["Bispectrum \[OpenCurlyQuote]correct\[CloseCurlyQuote]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.89505326165967*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4c7b1b84-0254-4ccf-8acc-d78261337a03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B1LCMMo1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BMMo1Loopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVMMo1B", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabMMo1", ",", 
        "PMMo1Loop", ",", "\[Sigma]MMo1tab", ",", "PMMo1Tree"}], "]"}], "/.", 
      "coeffixMMo1"}], "/.", "nbMMo1"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1LCMMo2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BMMo2Loopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVMMo2B", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabMMo2", ",", 
        "PMMo2Loop", ",", "\[Sigma]MMo2tab", ",", "PMMo2Tree"}], "]"}], "/.", 
      "coeffixMMo2"}], "/.", "nbMMo2"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743598646628*^9, 3.888743598924089*^9}, {
  3.8887436318956842`*^9, 3.888743635015679*^9}, {3.888745932066663*^9, 
  3.888745933074651*^9}, {3.8887539075778713`*^9, 3.8887539557330914`*^9}, {
  3.888754032089074*^9, 3.888754068197426*^9}, {3.8887541078730497`*^9, 
  3.8887541151628428`*^9}, {3.888754160444756*^9, 3.8887541755244904`*^9}, {
  3.895053039641955*^9, 3.8950530471332006`*^9}, {3.895055231608708*^9, 
  3.895055263905095*^9}, {3.895055409690301*^9, 3.895055413803789*^9}, {
  3.8950560691394167`*^9, 3.895056102989215*^9}},
 CellLabel->
  "In[1307]:=",ExpressionUUID->"f7745b6c-8969-47b0-9a4a-f620bceb02ca"],

Cell["Bispectrum prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.895053268869812*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"123e92a0-e5d3-475d-85d0-17f89096ad96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BPriorMMo1", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "keffMMo1", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BMMo1ngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCMMo1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMo1", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BPriorMMo2", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "keffMMo2", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BMMo2ngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCMMo2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMo2", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.89505526942714*^9, 3.895055283404625*^9}, {
   3.895055376016219*^9, 3.895055378845052*^9}, {3.895056072412477*^9, 
   3.8950561285853662`*^9}, 3.895056169154029*^9, {3.895057052929665*^9, 
   3.895057053521905*^9}, {3.89514504799305*^9, 3.895145049662807*^9}, {
   3.89530003972154*^9, 3.895300041303979*^9}, {3.89634672162141*^9, 
   3.896346723540469*^9}},
 CellLabel->
  "In[1309]:=",ExpressionUUID->"ef181199-05b9-42cb-8c5a-df1b557a2297"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exports", "Subsection",
 CellChangeTimes->{{3.878564059914957*^9, 3.8785640633698683`*^9}, {
   3.878564297799753*^9, 3.878564304515422*^9}, 
   3.8950007380530157`*^9},ExpressionUUID->"1770809b-e0f7-47f4-8d18-\
4cacbb401027"],

Cell["Analytical covariance with full redshift dependence,  w/o B", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7667791b-b4ac-4604-acfa-3878e3a8812d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/Panafullz.mtx\>\"", ",", 
    RowBox[{"FPMMo1", "+", "FPMMo2", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/PBanafullz.mtx\>\"", ",", 
    RowBox[{
    "FPMMo1", "+", "FPMMo2", "+", "FBMMo1", "+", "FBMMo2", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQXcezdfORp28cbXI/bQfRTC7bFY8B6ZAt7Gog+jrH
NCsQrdGtaA+i9xVfK3J/9sZR4c1NMK24VlIhA0hXLJcD0yvktmu+B9ITzZ6A
6UtMUYFVz984bmGH0DOvbc7sfvHG8cr0O2D62oUp/3qA9KIZq8A0V5Ieg+aH
N47ZoclgumdH2PfGT28c/xXz/wbRl7ZpVdwC0vsaw8C03d+ZT/8D6akMs8A0
w96Q1cyf3zgmXC0E03/uqv1o+PHG0aUmH0xP+azvdufnG8dkV1MwPedBUfkJ
preOQU8h9Et3JufHQPqRN4SOen8gUZH1rWPnpaNg+oB4T7gR21tHEXkI/Yuj
v9oExE9PrQHRx2KiGkH0mzMsTSCax9B5cz/7W8cKjxtbQHTJzuas6UD6xh4I
DQAtos8y
  "],
 CellLabel->
  "In[1533]:=",ExpressionUUID->"add6f0fa-2d1f-4886-bb7f-1f9ae7b87d9f"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles,  w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1943440b-fc2b-457c-8efe-4bb021a3d933"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/Panamufullz.mtx\>\"", ",", 
    RowBox[{"FPMMo1mu", "+", "FPMMo2mu", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/PBanamufullz.mtx\>\"", ",", 
    RowBox[{
    "FPMMo1mu", "+", "FPMMo2mu", "+", "FBMMo1mu", "+", "FBMMo2mu", "+", 
     "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQXcezdfORp28cbXI/bQfRTC7bFY8B6dvnL2uDaHVf
eyMQ3bW7GUzzfzSxAdFi05bbg+gtUk+L3J+9cQye/AJMq9ToKGQAaQ82QzB9
976O1nsgHSCXAqanKEYFVj1/47hMBUJPaxPO6n7xxjG62hJMS9zcwaD54Y2j
99oXYNrI5svvxk9vHEPbmv+A6EUHt1TcAtKXUu+DaT/ZWU//A+k0BQitV1+7
mvnzG8d5Ms1gOqJszo+GH28cb10/CaZrb1u53fn5xnHxXgcwfe5zUfkJpreO
j75D6I4QJufHQPp4BIS+5no6UZH1rSPzhQtgWlu1J9yI7a0jryaEli89X2MC
pO28mOpA9KM0zSYQvT4nCEzXOzhv7mcHygfc2AKiNx5szpoOpDWOQmgANITL
KA==
  "],
 CellLabel->
  "In[1535]:=",ExpressionUUID->"309d4e2a-e206-41cd-92c5-1ce0e62d6e17"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles, Tree B \
w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}, {
   3.878564270615465*^9, 3.87856427222081*^9}, {3.8794571676476088`*^9, 
   3.879457175011805*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c0dd1e24-2e08-42c5-bce7-54e955bf6478"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/PBanamufullzT.mtx\>\"", ",", 
    RowBox[{
    "FPMMo1mu", "+", "FPMMo2mu", "+", "FBMMo1muT", "+", "FBMMo2muT", "+", 
     "Priors"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.878561181657775*^9, 3.8785612155758343`*^9}, {
   3.8785641097270517`*^9, 3.878564190619123*^9}, {3.878564241978168*^9, 
   3.878564285680266*^9}, {3.878828949234503*^9, 3.8788289494509583`*^9}, {
   3.879164027812216*^9, 3.879164029618887*^9}, {3.879457177071039*^9, 
   3.879457210700491*^9}, 3.879457380313807*^9, {3.8794574840110407`*^9, 
   3.879457497751718*^9}, 3.880016723080578*^9, {3.8840094809313173`*^9, 
   3.884009480991098*^9}, {3.885240294010165*^9, 3.8852402952640657`*^9}, 
   3.8854215133389606`*^9, 3.885498156819551*^9, 3.8855058842557583`*^9, {
   3.888383944088387*^9, 3.8883839441636553`*^9}, 3.889095218223415*^9, 
   3.893773243594293*^9, 3.893828120074058*^9, 3.8950039186937313`*^9, 
   3.895562940380699*^9, {3.895567346462862*^9, 3.8955673491335382`*^9}, 
   3.895567380677968*^9, {3.896278426103269*^9, 3.896278438760276*^9}, 
   3.8962942281188517`*^9},
 CellLabel->
  "In[1537]:=",ExpressionUUID->"ba3e3a65-ec76-403b-a5e5-49338298ae84"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles,  NS w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}, {
   3.8785649845498047`*^9, 3.878564985199294*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4ff60dc5-37c0-43b4-b4ba-f52c05efc987"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/PanamufullzNS.mtx\>\"", ",", 
    RowBox[{"FPMMo1muNS", "+", "FPMMo2muNS", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/PBanamufullzNS.mtx\>\"", ",", 
    RowBox[{
    "FPMMo1muNS", "+", "FPMMo2muNS", "+", "FBMMo1muNS", "+", "FBMMo2muNS", 
     "+", "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQXcezdfORp28cbXI/bQfRTC7bFY8B6dvnL2uDaHVf
eyMQ3bW7GUzzfzSxAdFi05bbg2izl0n9INrG7scEEF1S9bnI/dkbR4n8b2A6
6mmYQgaQ/rMjGkxvXRam/R5IR6xfCqZftUYFVj1/41jUBaGf/pmW1f3ijeOb
TQfAtJJkDKPmhzeOj80Wgek1Mv5/Gz+9cbzB8B5Mz25MrbwFpHUrFoBpFo9Z
T/8D6aXeEPpo45TVzJ/fOO45uQJMb1hj8LPhxxvHafPTwPSLAz5ud36+cfxi
GgqmXfmLy08wvXXcJgSh9VKYnB8DacUMCF0R8ChRkfWt45JUjiQQ/cmkJ9yI
7a3jFgsIbSbAWm8CpK+Kvm0C0dIRzpv72d867om+sQVEv7vUnDUdSHddg9AA
RifSKg==
  "],
 CellLabel->
  "In[1538]:=",ExpressionUUID->"be0e2cc4-a134-4188-bb4b-1d9f236ff0e4"],

Cell["Perturbative Prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878562694723263*^9, 3.878562699328602*^9}, {
   3.895054532385188*^9, 3.895054536060054*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"9c01328f-3294-45fc-ad17-55b74a980330"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/Ppertprior.mtx\>\"", ",", 
    RowBox[{"PPriorMMo1", "+", "PPriorMMo2"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/PBpertprior.mtx\>\"", ",", 
    RowBox[{
    "PPriorMMo1", "+", "PPriorMMo2", "+", "BPriorMMo1", "+", "BPriorMMo2"}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8950546527914953`*^9, 3.8950547352115717`*^9}, {
  3.895054790541091*^9, 3.895054856054175*^9}, {3.895055440260354*^9, 
  3.895055459519186*^9}, {3.895056936300846*^9, 3.8950569498250647`*^9}, {
  3.895057350664344*^9, 3.895057351027051*^9}, {3.89514505870582*^9, 
  3.895145060095993*^9}, {3.895300514201572*^9, 3.895300515746581*^9}, {
  3.895562940382682*^9, 3.895562940383152*^9}, {3.895563381289332*^9, 
  3.895563381289875*^9}, {3.8955673611167*^9, 3.89556738688293*^9}, {
  3.8955687800522537`*^9, 3.895568781616242*^9}, {3.896278426109469*^9, 
  3.896278438762126*^9}, {3.896294228120417*^9, 3.89629422812082*^9}},
 CellLabel->
  "In[1325]:=",ExpressionUUID->"f77ff0d5-03a0-427c-962f-9772a9bf3b25"],

Cell["2L", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878562694723263*^9, 3.878562699328602*^9}, {
   3.895054532385188*^9, 3.895054536060054*^9}, {3.895999585079019*^9, 
   3.895999585291972*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ee44d842-8ba3-4201-8b1b-a77a3f1fa308"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/Panamufullz2L.mtx\>\"", ",", 
    RowBox[{"FPMMo1mu2L", "+", "FPMMo2mu2L", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMo/PBanamufullz2L.mtx\>\"", ",", 
    RowBox[{
    "FPMMo1mu2L", "+", "FPMMo2mu2L", "+", "FBMMo1mu", "+", "FBMMo2mu", "+", 
     "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895999589442648*^9, 3.895999605013795*^9}, {
  3.896278426111589*^9, 3.896278438763055*^9}, {3.89629422812143*^9, 
  3.8962942281218643`*^9}},
 CellLabel->
  "In[1542]:=",ExpressionUUID->"01850a3a-ddbc-48b1-9a2b-2ad92c03a784"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.895999588214435*^9},
 CellLabel->
  "In[1544]:=",ExpressionUUID->"494ac08f-fd16-4d3c-a51c-6be8d48ff8cf"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MegaMapper - pessimistic", "Section",
 CellChangeTimes->{{3.873874436782016*^9, 3.873874440817452*^9}, {
   3.8739643915210037`*^9, 3.8739643916267567`*^9}, {3.8739713597098627`*^9, 
   3.873971360089781*^9}, {3.874335391625215*^9, 3.874335393416067*^9}, {
   3.8743951131865683`*^9, 3.874395114134469*^9}, {3.8783307046760273`*^9, 
   3.878330709107346*^9}, {3.8784125376829357`*^9, 3.8784125380319443`*^9}, 
   3.8784722874667263`*^9, {3.8785538874070377`*^9, 3.878553890219912*^9}, 
   3.878555653389566*^9, 
   3.878561304241454*^9},ExpressionUUID->"19f61ac9-51db-46db-8f82-\
362ba5a0a13a"],

Cell[CellGroupData[{

Cell["MMp specifications and derivative computations", "Subsection",
 CellChangeTimes->{{3.878331664336233*^9, 3.878331667108832*^9}, {
  3.878331979807946*^9, 3.878331981863579*^9}, {3.8783783257461557`*^9, 
  3.8783783354989758`*^9}, {3.8784125428781147`*^9, 3.878412543313261*^9}, {
  3.878472169285952*^9, 3.8784721729778547`*^9}, {3.878472292821085*^9, 
  3.878472294722699*^9}, {3.888326241152813*^9, 
  3.888326241192115*^9}},ExpressionUUID->"157101cd-0cb1-4b6d-9f46-\
05116d7a415e"],

Cell["\<\
MMp numbers fully binned (section 1.2 in arxiv 2209.04322, then arxiv \
1903.09208 Table 1 )\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
   3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
   3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
   3.878383674525436*^9, 3.8783836881286488`*^9}, {3.87847219786552*^9, 
   3.87847219890026*^9}, {3.878472471108636*^9, 3.878472471610229*^9}, {
   3.878472564963822*^9, 3.8784725710239973`*^9}, {3.878472722061098*^9, 
   3.878472737813615*^9}, 3.8950570946408997`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"809867a1-c880-4ddb-8147-4cce34254cd6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"z", ",", "nb", ",", "V", ",", "N", ",", "Dg", ",", "fs"}], 
  "*)"}]], "Input",
 CellLabel->
  "In[1327]:=",ExpressionUUID->"d5752fef-6c59-4b51-89df-982aa4d46869"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMpspec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]], 
      RowBox[{"{", 
       RowBox[{"9.8", ",", "1.2", ",", "1", ",", "0.4"}], "}"}]}], ",", 
     RowBox[{
      SuperscriptBox["10", "9"], 
      RowBox[{"{", 
       RowBox[{
       "53.47254431", ",", "54.28608766", ",", "50.11599096", ",", 
        "45.09835607"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "5.240309342380001`*^7", ",", "6.5143305192`*^6", ",", 
       "5.011599096`*^6", ",", "1.8039342428000001`*^6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.42020110428342006", ",", "0.3188745725930273", ",", 
       "0.25662379231412885", ",", "0.2146779141872147"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.9466075281915435", ",", "0.9687825324004987", ",", 
       "0.9769321736957639", ",", "0.9805057101340311"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.5", ",", "4", ",", "3.5", ",", "5.5"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.877265916864263*^9, 3.877265918514963*^9}, {
   3.878382336152431*^9, 3.878382338551983*^9}, {3.878382424749436*^9, 
   3.878382427765259*^9}, 3.87838246170047*^9, {3.878383826491439*^9, 
   3.8783838277095737`*^9}, {3.8784126741830482`*^9, 3.878412728189921*^9}, {
   3.878413729299*^9, 3.878413732493112*^9}, {3.878472790586163*^9, 
   3.878472832692236*^9}, {3.87855390789188*^9, 3.8785539336908703`*^9}, {
   3.8785541250990553`*^9, 3.878554243977433*^9}, {3.883947850375042*^9, 
   3.883947859076395*^9}, {3.8852773551384077`*^9, 3.885277392101392*^9}},
 CellLabel->
  "In[1328]:=",ExpressionUUID->"45db2d66-0d71-4a96-8f90-bb7675b10776"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMpcut", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.878383193930118*^9, 3.878383199484385*^9}, {
  3.878412731287475*^9, 3.878412737223034*^9}, {3.8784727983966837`*^9, 
  3.878472798776726*^9}, {3.8784728670564117`*^9, 3.878472883733088*^9}, {
  3.878472939776085*^9, 3.878472972829179*^9}, {3.878473104297081*^9, 
  3.878473104336568*^9}, {3.8784731705186033`*^9, 3.878473170546286*^9}, {
  3.878554247995776*^9, 3.878554250068946*^9}},
 CellLabel->
  "In[1329]:=",ExpressionUUID->"5562da08-84bb-473f-b1c2-4f02cb14e4c6"],

Cell["Get zeffs and define cental values", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
   3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
   3.87387541354895*^9}, {3.878382212762868*^9, 3.878382216951807*^9}, 
   3.878382259950922*^9, 3.8783829477289057`*^9, {3.878383185752803*^9, 
   3.878383210959243*^9}, {3.878383719533955*^9, 3.878383723260166*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"45fd71d8-be0b-4940-925c-5fc539c90688"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Getzeffs", "[", 
  RowBox[{"MMpspec", ",", "MMpcut"}], "]"}]], "Input",
 CellChangeTimes->{{3.87838307836555*^9, 3.878383132044235*^9}, {
  3.878383162397768*^9, 3.87838317567303*^9}, {3.878412751221225*^9, 
  3.878412751465184*^9}, {3.878472840936388*^9, 3.878472843935214*^9}, {
  3.878554262877997*^9, 3.87855426398685*^9}},
 CellLabel->
  "In[1330]:=",ExpressionUUID->"183b580f-5ebc-4f51-8534-64c0acc98468"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.1105671307948275`", ",", "4.264679835476766`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878383175890967*^9, 3.878383201054626*^9}, 
   3.878412754570765*^9, 3.87841373570604*^9, {3.8784728446988373`*^9, 
   3.878472885063695*^9}, {3.8784729413579493`*^9, 3.878472974279441*^9}, 
   3.878473105567445*^9, 3.878473172960182*^9, 3.8784740854781637`*^9, 
   3.878495704444726*^9, 3.878554268123802*^9, 3.878573572562455*^9, 
   3.879615003057884*^9, 3.879691014213435*^9, 3.879698543689053*^9, 
   3.883947876072391*^9, 3.8840274719655*^9, 3.8840647605537453`*^9, 
   3.885277395929585*^9, 3.885497074760674*^9, 3.8855856351781054`*^9, 
   3.885622529792976*^9, 3.888922061811007*^9, 3.8891432216088123`*^9, 
   3.893874226113505*^9, 3.895003957620043*^9, 3.895147706009059*^9, 
   3.895567403830624*^9, 3.895998806021243*^9, 3.896292393336219*^9, 
   3.8963147689256287`*^9, 3.896332196957481*^9, 3.896420859249003*^9},
 CellLabel->
  "Out[1330]=",ExpressionUUID->"7d9c04ec-eccc-4740-b022-1bf9ae5d0038"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MMp1spec", " ", "=", " ", 
   RowBox[{"MMpspec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{";;", "MMpcut"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMp2spec", " ", "=", " ", 
   RowBox[{"MMpspec", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"MMpcut", "+", "1"}], ";;"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87729569843889*^9, 3.8772957323200274`*^9}, {
   3.878382358668338*^9, 3.87838237967688*^9}, 3.878382526664139*^9, {
   3.878383218340361*^9, 3.878383219242804*^9}, {3.8784127697887297`*^9, 
   3.878412786626348*^9}, {3.878473179054512*^9, 3.878473195476676*^9}, {
   3.878473237146793*^9, 3.878473239106249*^9}, {3.878554283450697*^9, 
   3.878554287656163*^9}, {3.893829905624875*^9, 3.8938299056253366`*^9}, {
   3.893830414759047*^9, 3.893830415626993*^9}},
 CellLabel->
  "In[1331]:=",ExpressionUUID->"57c4676a-6e19-491d-8860-43129c56ab13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dg211", "=", "0.4060902797154226"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dg426", " ", "=", "0.24421674005370525"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8784127675887203`*^9, {3.878474029012005*^9, 3.87847405670301*^9}, {
   3.8785544771930656`*^9, 3.878554478925105*^9}, {3.878554517111661*^9, 
   3.878554525382721*^9}, 3.883947891678347*^9, 3.8839479532965107`*^9},
 CellLabel->
  "In[1333]:=",ExpressionUUID->"9e53871d-301c-44ad-ac82-adeb8406a45a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MMp1pk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"MMp1", ",", "2.11"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMp2pk", " ", "=", " ", 
   RowBox[{"PlinsubsT", "[", 
    RowBox[{"MMp2", ",", "4.26"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8727413630602694`*^9, 3.8727413655934258`*^9}, {
   3.8727546915351477`*^9, 3.872754694985199*^9}, {3.872766326967618*^9, 
   3.8727663281148233`*^9}, 3.872770560272434*^9, {3.873359960402536*^9, 
   3.8733599619315567`*^9}, {3.87346870319875*^9, 3.873468706946323*^9}, {
   3.8739667794686813`*^9, 3.8739667861596413`*^9}, {3.874402252136847*^9, 
   3.874402253720666*^9}, 3.878412807295249*^9, {3.8784731964668617`*^9, 
   3.878473198274949*^9}, {3.87847406114918*^9, 3.87847407740851*^9}, {
   3.878554289014183*^9, 3.878554290108238*^9}, {3.8785544722696342`*^9, 
   3.878554474957405*^9}, {3.885497083871132*^9, 3.885497085875828*^9}, {
   3.895003945149642*^9, 3.895003946752289*^9}},
 CellLabel->
  "In[1335]:=",ExpressionUUID->"4044638f-56b0-470c-bf92-cf9cb93b55a1"],

Cell["\<\
Shotnoise estimates (these are not entering the covariance, so they are not \
very important) \
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.8784128456142693`*^9, 3.8784128674174213`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"dc15d66f-9b29-4ebd-9c7b-2051205f0f12"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Getnbeff", "[", 
  RowBox[{"MMpspec", ",", "MMpcut"}], "]"}]], "Input",
 CellChangeTimes->{{3.878475319301682*^9, 3.878475320618101*^9}, {
  3.878554297171896*^9, 3.878554298036351*^9}},
 CellLabel->
  "In[1337]:=",ExpressionUUID->"54dc31e0-8879-40a6-8aea-459285a62592"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0008849122675164482`", ",", "0.00008411920987139401`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.878475321746801*^9, 3.87849576676163*^9, 
  3.878554569154397*^9, 3.878555680056675*^9, 3.878573633652384*^9, 
  3.879615063681632*^9, 3.87969107493999*^9, 3.879698606258191*^9, 
  3.884027535584568*^9, 3.884064821994594*^9, 3.885497735523974*^9, 
  3.8855857067386208`*^9, 3.88562260400252*^9, 3.88892213383821*^9, 
  3.889143292703314*^9, 3.893874297960122*^9, 3.89500403046313*^9, 
  3.895147779314007*^9, 3.895567476588004*^9, 3.895998877035254*^9, 
  3.8962924705154333`*^9, 3.896314841030756*^9, 3.896332268820101*^9, 
  3.8964209335503407`*^9},
 CellLabel->
  "Out[1337]=",ExpressionUUID->"db7de1e2-c943-4d83-b52b-05aedef3a62b"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbMMp1", " ", "=", " ", 
   RowBox[{"nb", "->", "0.0008849122675164482`"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbMMp2", " ", "=", " ", 
   RowBox[{"nb", "->", "0.00008411920987139401`"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873875438860836*^9, 3.873875447797975*^9}, 
   3.873964417558131*^9, {3.874994697144123*^9, 3.8749947131881104`*^9}, {
   3.877976102770084*^9, 3.8779761140267982`*^9}, {3.878157695711175*^9, 
   3.8781577092274923`*^9}, 3.8783854049941874`*^9, {3.878412843664546*^9, 
   3.878412850054669*^9}, {3.8784134875786963`*^9, 3.878413489915539*^9}, {
   3.8784753316640368`*^9, 3.878475340376177*^9}, {3.87855429893152*^9, 
   3.878554299919037*^9}, {3.8785546321758947`*^9, 3.878554639755415*^9}},
 CellLabel->
  "In[1338]:=",ExpressionUUID->"0b3e89c6-da06-454f-85e2-12343b53427a"],

Cell["Get knls", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.8784128456142693`*^9, 3.8784128674174213`*^9}, {
  3.8788279868867903`*^9, 3.878827989607279*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5a18e548-7ef2-4af2-b5e6-9ca181edd5a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Getknl", "[", "pk_", "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         SuperscriptBox["\[Pi]", "2"]}]], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["k", "2"], 
          RowBox[{"pk", "[", "k", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], ",", "kn"}], "}"}]}], "]"}]}], "-", 
      "1.1525490955287694`"}], ",", 
     RowBox[{"{", 
      RowBox[{"kn", ",", "0.5"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{3.878828025075756*^9},
 CellLabel->
  "In[1340]:=",ExpressionUUID->"9114a757-c63b-491b-a66f-7675fdbb4686"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"knlMMp1", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"knl", "->", 
    RowBox[{
     RowBox[{"Getknl", "[", 
      RowBox[{"MMp1pk", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"knlMMp2", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"knl", "->", 
    RowBox[{
     RowBox[{"Getknl", "[", 
      RowBox[{"MMp2pk", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.873875438860836*^9, 3.873875447797975*^9}, 
   3.873964417558131*^9, {3.874994697144123*^9, 3.8749947131881104`*^9}, {
   3.877976102770084*^9, 3.8779761140267982`*^9}, {3.878157695711175*^9, 
   3.8781577092274923`*^9}, 3.8783854049941874`*^9, {3.878412843664546*^9, 
   3.878412850054669*^9}, {3.8784134875786963`*^9, 3.878413489915539*^9}, {
   3.8784744740677643`*^9, 3.878474538323855*^9}, {3.8784752846022997`*^9, 
   3.878475286598607*^9}, {3.878828030959343*^9, 3.8788280822885647`*^9}, {
   3.8788281309424133`*^9, 3.8788281470172*^9}, {3.878829048286887*^9, 
   3.878829064210805*^9}, {3.879615148718213*^9, 3.879615153188971*^9}},
 CellLabel->
  "In[1341]:=",ExpressionUUID->"0fd6fcf7-3a2b-4727-8a97-aaebd714317f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"knl", "\[Rule]", "2.2165280081661782`"}], "}"}]], "Output",
 CellChangeTimes->{3.8796151555693073`*^9, 3.8796910756057587`*^9, 
  3.879698606967976*^9, 3.884027536282588*^9, 3.884064822711565*^9, 
  3.885277481076721*^9, 3.8854977415546207`*^9, 3.885585707413348*^9, 
  3.885622604723031*^9, 3.8889221345051937`*^9, 3.889143293371393*^9, 
  3.893874298632655*^9, 3.895004031132728*^9, 3.8951477799884663`*^9, 
  3.8955674772676163`*^9, 3.895998877692958*^9, 3.896292471293735*^9, 
  3.896314841711343*^9, 3.8963322695321083`*^9, 3.8964209342105217`*^9},
 CellLabel->
  "Out[1341]=",ExpressionUUID->"7c1f4882-4b62-4fe9-bda6-cc4aef9f6a90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"knl", "\[Rule]", "8.198766809084546`"}], "}"}]], "Output",
 CellChangeTimes->{3.8796151555693073`*^9, 3.8796910756057587`*^9, 
  3.879698606967976*^9, 3.884027536282588*^9, 3.884064822711565*^9, 
  3.885277481076721*^9, 3.8854977415546207`*^9, 3.885585707413348*^9, 
  3.885622604723031*^9, 3.8889221345051937`*^9, 3.889143293371393*^9, 
  3.893874298632655*^9, 3.895004031132728*^9, 3.8951477799884663`*^9, 
  3.8955674772676163`*^9, 3.895998877692958*^9, 3.896292471293735*^9, 
  3.896314841711343*^9, 3.8963322695321083`*^9, 3.896420935035536*^9},
 CellLabel->
  "Out[1342]=",ExpressionUUID->"c826a449-b4bc-40b1-b52c-5a6cd5aa5065"]
}, Closed]],

Cell["\<\
Parameters bestfit from BOSS, rescaled to MMp.  (arxiv 1903.09208 Table 1)\
\>", "Text",
 CellChangeTimes->{{3.878318392835229*^9, 3.878318399686548*^9}, {
   3.878318564396934*^9, 3.8783185665840807`*^9}, {3.8783189236834927`*^9, 
   3.8783189249818363`*^9}, {3.8783193275467777`*^9, 3.878319330519642*^9}, {
   3.878412930164959*^9, 3.8784129331531353`*^9}, {3.878468739621086*^9, 
   3.878468764008396*^9}, 3.878468929463129*^9, {3.878472218988697*^9, 
   3.878472222141864*^9}, 3.8784732045518923`*^9, {3.878476114900951*^9, 
   3.878476147291431*^9}, {3.878476987119795*^9, 3.878477009819968*^9}, 
   3.878554301256064*^9, 3.885626199292804*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"fd8c1716-1505-4fdc-8d3b-f1a275652f2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bzMMp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.5", ",", "4"}], "}"}]}], "}"}], "//", "Transpose"}], "//",
      "Interpolation"}], "//", "Quiet"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bzMMp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.5", ",", "5.5"}], "}"}]}], "}"}], "//", "Transpose"}], "//",
      "Interpolation"}], "//", "Quiet"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.885497263676347*^9},
 CellLabel->
  "In[1343]:=",ExpressionUUID->"8ac81315-3b1d-4757-af79-50312d97f6db"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bzMMp1", "[", 
  RowBox[{
   RowBox[{"Getzeffs", "[", 
    RowBox[{"MMpspec", ",", "MMpcut"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"bzMMp2", "[", 
  RowBox[{
   RowBox[{"Getzeffs", "[", 
    RowBox[{"MMpspec", ",", "MMpcut"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.885497266876886*^9, 3.885497267864336*^9}},
 CellLabel->
  "In[1345]:=",ExpressionUUID->"cbc40ab1-a9e0-4e51-bd12-ed96b4559433"],

Cell[BoxData["2.6658506961922415`"], "Output",
 CellChangeTimes->{{3.885497270207767*^9, 3.8854972724733877`*^9}, 
   3.885497749807641*^9, 3.8855857082689447`*^9, 3.885622605555447*^9, 
   3.888922135308276*^9, 3.889143294183854*^9, 3.893874299460516*^9, 
   3.895004031979477*^9, 3.895147780825931*^9, 3.895567478099598*^9, 
   3.8959988784917316`*^9, 3.896292472197564*^9, 3.896314842536059*^9, 
   3.89633227034722*^9, 3.896420935085547*^9},
 CellLabel->
  "Out[1345]=",ExpressionUUID->"ef01db97-5ab8-4e6a-bf57-36ff6be1f542"],

Cell[BoxData["4.029359670953532`"], "Output",
 CellChangeTimes->{{3.885497270207767*^9, 3.8854972724733877`*^9}, 
   3.885497749807641*^9, 3.8855857082689447`*^9, 3.885622605555447*^9, 
   3.888922135308276*^9, 3.889143294183854*^9, 3.893874299460516*^9, 
   3.895004031979477*^9, 3.895147780825931*^9, 3.895567478099598*^9, 
   3.8959988784917316`*^9, 3.896292472197564*^9, 3.896314842536059*^9, 
   3.89633227034722*^9, 3.896420935086557*^9},
 CellLabel->
  "Out[1346]=",ExpressionUUID->"60c4a646-51bd-420d-bb72-844aeaaa28ce"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bfixMMp1", "=", 
   RowBox[{"bfixn", "[", 
    RowBox[{"2.6658506961922415`", ",", "bfixstoch"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bfixMMp2", "=", 
   RowBox[{"bfixn", "[", 
    RowBox[{"4.029359670953532`", ",", "bfixstoch"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878416120196289*^9, 3.878416123743026*^9}, {
  3.878468908844494*^9, 3.878468919782895*^9}, {3.8784769213032427`*^9, 
  3.878476923710506*^9}, {3.878477052550538*^9, 3.87847706894711*^9}, {
  3.8785543030929127`*^9, 3.878554303306093*^9}, {3.878554645489262*^9, 
  3.878554648451467*^9}, {3.885497773804606*^9, 3.885497785942708*^9}},
 CellLabel->
  "In[1347]:=",ExpressionUUID->"f9f0f214-0c6a-4632-b600-189217849493"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffixMMp1", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"bfixMMp1", ",", "fnlfix", ",", "paramfix", ",", "knlMMp1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffixMMp2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"bfixMMp2", ",", "fnlfix", ",", "paramfix", ",", "knlMMp2"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878413056459043*^9, 3.8784130699454308`*^9}, {
  3.878477083190627*^9, 3.8784770876410427`*^9}, {3.878554303501235*^9, 
  3.878554304303378*^9}, {3.879690923943129*^9, 3.8796909269631042`*^9}},
 CellLabel->
  "In[1349]:=",ExpressionUUID->"70529bd7-c52c-4832-a98a-168309ecbb58"],

Cell["Base tab and setting kmax ", "Text",
 CellChangeTimes->{{3.8380346254163866`*^9, 3.8380346366851645`*^9}, {
  3.853402648549384*^9, 3.853402655221554*^9}, {3.872297245424074*^9, 
  3.872297247278839*^9}, {3.8738708899346247`*^9, 3.8738708927083797`*^9}, {
  3.87841313542971*^9, 3.8784131420677233`*^9}, {3.878413179679388*^9, 
  3.878413201424553*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a27abde6-d95f-43df-863f-38f843b14b1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ktabraw", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"0.001`", "+", 
      RowBox[{"i", " ", "0.005"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "300"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878895579618306*^9, 3.8788955804938707`*^9}, {
  3.8788956284897118`*^9, 3.878895630748551*^9}, {3.8788956611838913`*^9, 
  3.878895661414843*^9}, {3.8791635414504547`*^9, 3.879163541669219*^9}, {
  3.8791635894533253`*^9, 3.879163589924549*^9}, {3.885550134699168*^9, 
  3.885550134722946*^9}},
 CellLabel->
  "In[1351]:=",ExpressionUUID->"9f35302f-c214-413c-86d7-c60802dd3eaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Basetri", "  ", "=", 
   RowBox[{"makeTri", "[", 
    RowBox[{"0.02", ",", "0.91", ",", "0.02"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffbase", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<covsks/baseTrikeff.mtx\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87916348683456*^9, 3.8791634885132113`*^9}, {
   3.8792456482218533`*^9, 3.879245661477367*^9}, {3.879444136918521*^9, 
   3.8794441395896482`*^9}, {3.8794442276939983`*^9, 3.879444232498129*^9}, {
   3.879447658779847*^9, 3.879447661731332*^9}, 3.879463216120709*^9, {
   3.885497799936618*^9, 3.885497801174617*^9}, 3.893828120043347*^9, 
   3.893829905625834*^9, 3.895058202915635*^9},
 CellLabel->
  "In[1352]:=",ExpressionUUID->"1fb5bec9-2f36-4336-b57d-8fd5b4a30816"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bins", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Basetri", "//", "Flatten"}], "//", "DeleteDuplicates"}], "//", 
    "Sort"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.879245764667458*^9, 3.8792457698637447`*^9}, {
  3.8794441464211082`*^9, 3.879444146689913*^9}},
 CellLabel->
  "In[1354]:=",ExpressionUUID->"68890745-cfe4-4c2e-ad5e-1fa9a41f47ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Setkmax", "[", "kmax_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"Bins", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmax"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"goodTri", "[", "kmax_", "]"}], " ", ":=", " ", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "Basetri", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"Basetri", ",", 
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{"Bins", ",", 
                RowBox[{"Setkmax", "[", "kmax", "]"}]}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Complement", "[", 
              RowBox[{"Bins", ",", 
               RowBox[{"Setkmax", "[", "kmax", "]"}]}], "]"}], "]"}]}], 
           "}"}]}], "]"}], "//", "Flatten"}], "//", "DeleteDuplicates"}], "//",
       "Sort"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[1355]:=",ExpressionUUID->"1b361943-1e34-4190-afb8-ee4e0880b41e"],

Cell["Binning sizes", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781577058616667`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"677f4182-0e63-43f1-bac6-e3d3222507a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dkPMM", " ", "=", " ", 
   RowBox[{"dk", "->", "0.005"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dkBMM", "=", 
   RowBox[{"dk", "->", "0.02"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87841338734165*^9, 3.878413390596964*^9}, {
  3.878477111413334*^9, 3.878477113441815*^9}, {3.878895451541523*^9, 
  3.878895451695315*^9}, {3.879245800987814*^9, 3.87924580519803*^9}, {
  3.8794477453912983`*^9, 3.879447745659726*^9}},
 CellLabel->
  "In[1357]:=",ExpressionUUID->"fc6ce591-73e6-457e-974f-09002556d010"],

Cell["New kmax", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878396838288425*^9, 3.878396840811236*^9}, {
  3.887878940174028*^9, 3.88787895498912*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"917bdf5a-4d4e-4cba-874b-1bc68c17626c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcMMp1TNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "MMp1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcMMp2TNS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]TheoryTree", "[", 
     RowBox[{"k", ",", "MMp2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8883213342139587`*^9, 3.888321344542603*^9}, {
  3.8883222334019747`*^9, 3.8883222450217333`*^9}, {3.888325974577829*^9, 
  3.888326019377328*^9}, {3.88892202152687*^9, 3.888922022552058*^9}, {
  3.895474294947645*^9, 3.895474294948098*^9}},
 CellLabel->
  "In[1359]:=",ExpressionUUID->"fd78b392-ab85-47dc-90f9-7b05499ec148"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcMMp1NS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "MMp1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcMMp2NS", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory", "[", 
     RowBox[{"k", ",", "MMp2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8883259748935747`*^9, 3.888326019859079*^9}, {
  3.8889220227011223`*^9, 3.888922023733872*^9}, {3.895474294949358*^9, 
  3.895474294949823*^9}},
 CellLabel->
  "In[1361]:=",ExpressionUUID->"a91e39d3-07f5-403e-be8b-1186f537a1c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"funcMMp1NS2L", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory2L", "[", 
     RowBox[{"k", ",", "MMp1pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcMMp2NS2L", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Sigma]Theory2L", "[", 
     RowBox[{"k", ",", "MMp2pk"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"Get\[Sigma]", "[", 
         RowBox[{"ktabraw", ",", " ", 
          RowBox[{"GetFullzCovPInv", "[", 
           RowBox[{
           "ktabraw", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstochNS", ",", 
            RowBox[{"dk", "\[Rule]", "1"}]}], "]"}]}], "]"}], "[", "k", 
        "]"}]], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888325975224154*^9, 3.888326023551197*^9}, {
  3.888922023902899*^9, 3.8889220251759863`*^9}, {3.895474294951133*^9, 
  3.895474294951624*^9}},
 CellLabel->
  "In[1363]:=",ExpressionUUID->"965d7549-efb2-49e6-b39b-dc5f4d24b237"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxMMp1Tree", " ", "=", " ", 
  RowBox[{
   RowBox[{"GetkmaxT", "[", "funcMMp1TNS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxMMp2Tree", " ", "=", 
  RowBox[{
   RowBox[{"GetkmaxT", "[", "funcMMp2TNS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.88788945578306*^9, 3.887889469612871*^9}, {
  3.887889544719244*^9, 3.8878895541435833`*^9}, {3.888325038714127*^9, 
  3.8883250591134853`*^9}, {3.888325975510754*^9, 3.888325987901361*^9}, {
  3.888922025350709*^9, 3.888922025867949*^9}},
 CellLabel->
  "In[1365]:=",ExpressionUUID->"f2975c2b-f7c3-407b-9610-3d824c159aaf"],

Cell[BoxData["0.12330323186793983`"], "Output",
 CellChangeTimes->{3.8878895611407423`*^9, 3.8878915115109587`*^9, 
  3.888325083761134*^9, 3.8883269622203074`*^9, 3.888350879903104*^9, 
  3.8887581274255733`*^9, 3.8889221516119337`*^9, 3.889143310281436*^9, 
  3.893874315813964*^9, 3.895004048718934*^9, 3.895147797106402*^9, 
  3.895567494640699*^9, 3.895998894463849*^9, 3.896292490374015*^9, 
  3.8963148590475187`*^9, 3.896332286715541*^9, 3.8964209515156937`*^9},
 CellLabel->
  "Out[1365]=",ExpressionUUID->"63676712-3568-4a58-9ac2-d8bbcdaf59dc"],

Cell[BoxData["0.2074254251133778`"], "Output",
 CellChangeTimes->{3.8878895611407423`*^9, 3.8878915115109587`*^9, 
  3.888325083761134*^9, 3.8883269622203074`*^9, 3.888350879903104*^9, 
  3.8887581274255733`*^9, 3.8889221516119337`*^9, 3.889143310281436*^9, 
  3.893874315813964*^9, 3.895004048718934*^9, 3.895147797106402*^9, 
  3.895567494640699*^9, 3.895998894463849*^9, 3.896292490374015*^9, 
  3.8963148590475187`*^9, 3.896332286715541*^9, 3.896420969917107*^9},
 CellLabel->
  "Out[1366]=",ExpressionUUID->"8f9e2c8c-7ac6-4a97-b248-8b25c3e36346"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxMMp1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Getkmax", "[", "funcMMp1NS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxMMp2", " ", "=", 
  RowBox[{
   RowBox[{"Getkmax", "[", "funcMMp2NS", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8883259758435783`*^9, 3.8883259887268057`*^9}, {
  3.888922026042472*^9, 3.888922026534114*^9}},
 CellLabel->
  "In[1367]:=",ExpressionUUID->"d78a8c26-7ffc-4edc-b5bf-b641551781fa"],

Cell[BoxData["0.3076196071243152`"], "Output",
 CellChangeTimes->{3.888325096594342*^9, 3.888326991661993*^9, 
  3.888350907399737*^9, 3.888350939795477*^9, 3.8887581560689163`*^9, 
  3.888922180729006*^9, 3.889143340328932*^9, 3.893874351677751*^9, 
  3.895004085905414*^9, 3.8951478335856123`*^9, 3.8955675318073387`*^9, 
  3.895998930024321*^9, 3.896292529735631*^9, 3.896314895178788*^9, 
  3.896332323077551*^9, 3.896420987970529*^9},
 CellLabel->
  "Out[1367]=",ExpressionUUID->"dc814fa9-ecc4-4933-bf97-81fcbee8071e"],

Cell[BoxData["0.5667635490988593`"], "Output",
 CellChangeTimes->{3.888325096594342*^9, 3.888326991661993*^9, 
  3.888350907399737*^9, 3.888350939795477*^9, 3.8887581560689163`*^9, 
  3.888922180729006*^9, 3.889143340328932*^9, 3.893874351677751*^9, 
  3.895004085905414*^9, 3.8951478335856123`*^9, 3.8955675318073387`*^9, 
  3.895998930024321*^9, 3.896292529735631*^9, 3.896314895178788*^9, 
  3.896332323077551*^9, 3.896421003662022*^9},
 CellLabel->
  "Out[1368]=",ExpressionUUID->"7f98d48a-0d61-4b5f-a370-f2beb7351d62"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kmaxMMp12L", " ", "=", " ", 
  RowBox[{
   RowBox[{"Getkmax2L", "[", "funcMMp1NS2L", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kmaxMMp22L", " ", "=", 
  RowBox[{
   RowBox[{"Getkmax2L", "[", "funcMMp2NS2L", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.888325047070911*^9, 3.888325065946267*^9}, {
  3.888325144379429*^9, 3.888325147422266*^9}, {3.88832597700211*^9, 
  3.888325990369556*^9}, {3.8889220268757677`*^9, 3.888922028642111*^9}},
 CellLabel->
  "In[1369]:=",ExpressionUUID->"23586d55-cd11-4c3b-a89d-8f8d864fd363"],

Cell[BoxData["0.422857679611285`"], "Output",
 CellChangeTimes->{3.888922217583495*^9, 3.889143377547407*^9, 
  3.893874379175967*^9, 3.8950041149822598`*^9, 3.89514786011939*^9, 
  3.895567560611425*^9, 3.895998956304427*^9, 3.8962925588396683`*^9, 
  3.8963149219091253`*^9, 3.896332349992482*^9, 3.896421014659358*^9},
 CellLabel->
  "Out[1369]=",ExpressionUUID->"8cc48ed5-cd06-447a-9d7f-aad0f402a2af"],

Cell[BoxData["0.8355652573707493`"], "Output",
 CellChangeTimes->{3.888922217583495*^9, 3.889143377547407*^9, 
  3.893874379175967*^9, 3.8950041149822598`*^9, 3.89514786011939*^9, 
  3.895567560611425*^9, 3.895998956304427*^9, 3.8962925588396683`*^9, 
  3.8963149219091253`*^9, 3.896332349992482*^9, 3.8964210275078373`*^9},
 CellLabel->
  "Out[1370]=",ExpressionUUID->"9c1b1881-13e0-460e-a0f5-f2320fb55258"]
}, Closed]],

Cell["Get triangles and ktabs", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.878413323616858*^9, 
  3.878413329145935*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"90250f53-679b-4ff2-b0dc-78bb3a7666a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabMMp1", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxMMp1"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktabMMp2", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxMMp2"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878416313557293*^9, 3.878416313604795*^9}, {
   3.8784696138095818`*^9, 3.878469623177285*^9}, {3.8784732117419443`*^9, 
   3.878473212223881*^9}, 3.878477390328534*^9, 3.878477425150929*^9, {
   3.879456780662744*^9, 3.8794567812655153`*^9}},
 CellLabel->
  "In[1371]:=",ExpressionUUID->"ec0e2fd4-bf53-445d-907d-81d732a59a9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ktabMMp12L", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxMMp12L"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ktabMMp22L", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"ktabraw", ",", 
     RowBox[{
      RowBox[{"#", "<", "kmaxMMp22L"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8855857538881073`*^9, 3.885585757661599*^9}, {
  3.88892223284949*^9, 3.888922233005602*^9}},
 CellLabel->
  "In[1373]:=",ExpressionUUID->"41d40676-5e64-45ad-9c7b-f6ad181030e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keffMMp1", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp1", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffMMp2", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp2", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMptriangs1", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp1", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMptriangs2", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp2", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873468583303989*^9, 3.873468660291182*^9}, {
   3.87387514677607*^9, 3.873875146950919*^9}, {3.873964428032702*^9, 
   3.873964462207315*^9}, 3.8739665707698593`*^9, {3.87396675335675*^9, 
   3.8739667596310387`*^9}, {3.873971006821004*^9, 3.873971008067816*^9}, {
   3.8783319345931463`*^9, 3.878331935928195*^9}, {3.8784131133383417`*^9, 
   3.878413114721896*^9}, 3.878413177209508*^9, {3.87841329842533*^9, 
   3.8784133219391823`*^9}, {3.878413355587755*^9, 3.878413371590088*^9}, {
   3.878416309245821*^9, 3.8784163112058496`*^9}, {3.878469617381531*^9, 
   3.878469631412734*^9}, {3.878473212658925*^9, 3.87847321423339*^9}, {
   3.878477390776503*^9, 3.878477391109002*^9}, {3.8784774254291143`*^9, 
   3.8784774256897173`*^9}, {3.87884120614884*^9, 3.8788412130687733`*^9}, {
   3.879163625822709*^9, 3.879163630435944*^9}, {3.879245821196266*^9, 
   3.879245828485385*^9}, {3.87944795942017*^9, 3.87944796186674*^9}, {
   3.879456781442389*^9, 3.879456782994879*^9}, {3.884027474893203*^9, 
   3.884027475110073*^9}},
 CellLabel->
  "In[1375]:=",ExpressionUUID->"7b22d33d-ae94-4d0f-9d94-4b1a7258a345"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keffMMp1T", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp1Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keffMMp2T", " ", "=", " ", 
   RowBox[{"keffbase", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp2Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMptriangs1T", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp1Tree", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MMptriangs2T", " ", "=", " ", 
   RowBox[{"Basetri", "[", 
    RowBox[{"[", 
     RowBox[{"goodTri", "[", "kmaxMMp2Tree", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879447984383417*^9, 3.879448006416136*^9}, {
  3.879456783213738*^9, 3.879456786282455*^9}},
 CellLabel->
  "In[1379]:=",ExpressionUUID->"55ba0127-a077-41a9-914e-f47164ad20e2"],

Cell["Analytical Covariance with Full redshift", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427956193245*^9, 3.872427977688965*^9}, {
  3.873875096308608*^9, 3.873875100235161*^9}, {3.8738754101624393`*^9, 
  3.8738754215295963`*^9}, {3.878157683391191*^9, 3.8781576884852543`*^9}, {
  3.878383674525436*^9, 3.878383678474103*^9}, {3.878383729773546*^9, 
  3.87838373569448*^9}, {3.878383948812495*^9, 3.878383950482119*^9}, {
  3.878386152574986*^9, 3.8783861554874563`*^9}, {3.8783863995820503`*^9, 
  3.8783864090286303`*^9}, {3.878389253828569*^9, 3.878389261403257*^9}, {
  3.878389696132431*^9, 3.878389697083682*^9}, {3.878391368215104*^9, 
  3.878391370393168*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c7562e45-c43b-4903-a27e-8e8b25fb7f4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMp1P", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMp1", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMp2P", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMp2", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8852370364307337`*^9, 3.885237097953294*^9}, {
  3.885237145828494*^9, 3.885237186384832*^9}, {3.885238830302793*^9, 
  3.8852388644419117`*^9}, {3.885495275788561*^9, 3.885495301039796*^9}, {
  3.8854979708940268`*^9, 3.885497972091681*^9}, {3.895474294952939*^9, 
  3.89547429495329*^9}},
 CellLabel->
  "In[1383]:=",ExpressionUUID->"e6c6ed18-9321-4135-b404-f5ce1e0bda6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMp1P2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMp12L", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMp2P2L", "=", 
   RowBox[{"GetFullzCovPInv", "[", 
    RowBox[{
    "ktabMMp22L", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstoch", ",", 
     "dkPMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879887577258407*^9, 3.879887583136751*^9}, {
  3.880491273586534*^9, 3.880491273850292*^9}, {3.885238889182351*^9, 
  3.8852388900050173`*^9}, {3.8854952799963627`*^9, 3.885495309325123*^9}, {
  3.885497972260708*^9, 3.885497973493148*^9}, {3.8954742949542828`*^9, 
  3.895474294954623*^9}},
 CellLabel->
  "In[830]:=",ExpressionUUID->"38fe67bc-8a78-40b4-979e-5dd2dc37331e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMp1B", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMptriangs1", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMp2B", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMptriangs2", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879272884949*^9, 3.8792728949043427`*^9}, {
   3.885238888029283*^9, 3.8852388938708878`*^9}, {3.885495285091831*^9, 
   3.885495290166419*^9}, {3.88549532073311*^9, 3.885495327497261*^9}, {
   3.885497973674651*^9, 3.885497974950523*^9}, 3.889094344031866*^9, {
   3.893874147336821*^9, 3.893874149535634*^9}, 3.895003992216113*^9, {
   3.895474420615291*^9, 3.895474420615697*^9}, {3.8964266288546343`*^9, 
   3.896426630422063*^9}},ExpressionUUID->"aa0ebacc-d7cc-4a78-8cd7-\
1eaa725fa4f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"COVMMp1BTree", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMptriangs1T", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COVMMp2BTree", "=", 
   RowBox[{"GetFullzcovinvB", "[", 
    RowBox[{
    "MMptriangs2T", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstoch", ",", 
     "dkBMM"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879272884949*^9, 3.8792728949043427`*^9}, {
  3.8794481200222387`*^9, 3.8794481352803297`*^9}, {3.879448171284606*^9, 
  3.879448174363303*^9}, {3.885495346983404*^9, 3.885495348876062*^9}, {
  3.8854979769666452`*^9, 3.885497978315341*^9}, {3.895474420616889*^9, 
  3.8954744206173162`*^9}},
 CellLabel->
  "In[835]:=",ExpressionUUID->"7111cfb5-df57-4ee5-a147-ce6cfb62bb97"],

Cell["Powerspectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332301420657*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"391c4aa9-4280-41a6-92bc-01bbb5c76e36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMp1derivs", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMp1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMp1pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMp1", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMp1"}], "/.", "nbMMp1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMp2derivs", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMp2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMp2pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMp2", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMp2"}], "/.", "nbMMp2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873518998897326*^9, 3.873519007688743*^9}, {
   3.873519068623493*^9, 3.873519077607183*^9}, {3.873519615193363*^9, 
   3.873519620203136*^9}, {3.8735196572278223`*^9, 3.8735196641762877`*^9}, {
   3.873875798249857*^9, 3.873875813066736*^9}, {3.873966975417568*^9, 
   3.87396704163301*^9}, 3.873967115591464*^9, 3.878332335499425*^9, {
   3.878385477696348*^9, 3.878385485946587*^9}, {3.878469768836133*^9, 
   3.878469827807899*^9}, {3.87847322078467*^9, 3.878473222382102*^9}, {
   3.87847739485341*^9, 3.878477395351128*^9}, {3.878477429551351*^9, 
   3.87847743083393*^9}, {3.878841502314423*^9, 3.878841519159898*^9}, {
   3.8854979850998774`*^9, 3.885497987269849*^9}},
 CellLabel->
  "In[837]:=",ExpressionUUID->"8d901132-4f5c-401c-b6db-32d708a141a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMp1derivs2L", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMp12L", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMp1pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMp12L", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMp1"}], "/.", "nbMMp1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMp2derivs2L", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"P1Loopderivs", "[", 
          RowBox[{
           RowBox[{"ktabMMp22L", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "MMp2pk"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ktabMMp22L", "]"}]}], "}"}]}], "]"}], ",", 
       "i"}], "]"}], "/.", "coeffixMMp2"}], "/.", "nbMMp2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879887616598456*^9, 3.879887631545321*^9}, {
  3.88549798743631*^9, 3.88549798955759*^9}},
 CellLabel->
  "In[839]:=",ExpressionUUID->"851a902b-e717-449d-8901-58bc5fe8c4d5"],

Cell["Bispectrum Derivatives", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"3d7b14fd-726f-4db1-a116-e30f1d24b984"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BMMp1derivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"keffMMp1T", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMp1pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMp1", "]"}]}], "/.", "nbMMp1"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMp1T", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BMMp2derivsT", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BTreederivs", "[", 
           RowBox[{
            RowBox[{"keffMMp2T", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMp2pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMp2", "]"}]}], "/.", "nbMMp2"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMp2T", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.879245916889481*^9, 3.8792459222897463`*^9}, {
   3.879272284429164*^9, 3.879272308042398*^9}, {3.879273540000227*^9, 
   3.879273585850821*^9}, {3.879443765001204*^9, 3.879443801574843*^9}, {
   3.87944395577462*^9, 3.8794439612924356`*^9}, {3.879448260727165*^9, 
   3.879448310603842*^9}, {3.879614392098673*^9, 3.879614397485928*^9}, 
   3.885495482928049*^9, {3.885497989766282*^9, 3.885497991941112*^9}},
 CellLabel->
  "In[841]:=",ExpressionUUID->"42fefae8-b33a-4dd1-a390-a542acf45591"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.719559`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.879245994377934*^9, {3.879272298200151*^9, 3.8792723063282747`*^9}, 
   3.879272762779117*^9, 3.879275261969735*^9, 3.879582063505431*^9, 
   3.879614407775579*^9, 3.880027366766055*^9, 3.8840111809120207`*^9, 
   3.885239388786462*^9, 3.88524753521918*^9, 3.885390048357486*^9, 
   3.885588404752297*^9, 3.885622987905013*^9, 3.88892428921239*^9, 
   3.893886266844812*^9, 3.895004387003647*^9, 3.895148012819235*^9, 
   3.895567794346375*^9, 3.896292800028934*^9, 3.896332578349168*^9},
 CellLabel->
  "Out[841]=",ExpressionUUID->"90cf4fff-8a23-4485-ac42-980bf92bc872"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.558541`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.879245994377934*^9, {3.879272298200151*^9, 3.8792723063282747`*^9}, 
   3.879272762779117*^9, 3.879275261969735*^9, 3.879582063505431*^9, 
   3.879614407775579*^9, 3.880027366766055*^9, 3.8840111809120207`*^9, 
   3.885239388786462*^9, 3.88524753521918*^9, 3.885390048357486*^9, 
   3.885588404752297*^9, 3.885622987905013*^9, 3.88892428921239*^9, 
   3.893886266844812*^9, 3.895004387003647*^9, 3.895148012819235*^9, 
   3.895567794346375*^9, 3.896292800028934*^9, 3.896332594909566*^9},
 CellLabel->
  "Out[842]=",ExpressionUUID->"203f8a44-4c45-439a-86ad-cbbb7bca1986"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BMMp1derivspre", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"B1Loopderivs", "[", 
           RowBox[{
            RowBox[{"keffMMp1", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMp1pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMp1", "]"}]}], "/.", "nbMMp1"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMp1", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BMMp2derivspre", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"B1Loopderivs", "[", 
           RowBox[{
            RowBox[{"keffMMp2", "[", 
             RowBox[{"[", "si", "]"}], "]"}], ",", "MMp2pk"}], "]"}], "/.", 
          RowBox[{"Dispatch", "[", "coeffixMMp2", "]"}]}], "/.", "nbMMp2"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "keffMMp2", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8785521935616207`*^9, 3.8785522163665543`*^9}, {
   3.87884158011763*^9, 3.8788415890454407`*^9}, {3.878841624574361*^9, 
   3.878841628821933*^9}, {3.878841672075293*^9, 3.878841692043252*^9}, {
   3.879272382126865*^9, 3.879272382548891*^9}, 3.879272437352563*^9, {
   3.879273597040414*^9, 3.879273657311171*^9}, {3.879275535764578*^9, 
   3.879275542273411*^9}, {3.879443755201642*^9, 3.8794437586852493`*^9}, {
   3.879443950237886*^9, 3.879443953443111*^9}, {3.879448313090073*^9, 
   3.879448379609747*^9}, 3.8799013753959637`*^9, {3.879914066714028*^9, 
   3.879914066860073*^9}, {3.8853903374710903`*^9, 3.885390338196616*^9}, {
   3.8854954485459642`*^9, 3.8854954816649647`*^9}, {3.885497992362652*^9, 
   3.885497993574695*^9}, {3.8856262355953417`*^9, 3.885626239740032*^9}, {
   3.8856268950034857`*^9, 3.8856268962993402`*^9}, {3.888922275979664*^9, 
   3.888922277833638*^9}, {3.889094362587023*^9, 3.889094365721994*^9}, {
   3.893874275968811*^9, 3.8938742781865997`*^9}, 3.8950040859597588`*^9, {
   3.896298071344555*^9, 3.896298097396164*^9}, {3.8963268396106987`*^9, 
   3.896326845184441*^9}, {3.896426638229059*^9, 3.896426647380803*^9}, {
   3.896609666398162*^9, 
   3.896609668206973*^9}},ExpressionUUID->"e651dbb9-d5e1-45a3-a4bf-\
f61d09b34aab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoopsubMMp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BLoopsub", "[", "MMp1pk", "]"}], "/.", 
     RowBox[{"Dispatch", "[", "coeffixMMp1", "]"}]}], "/.", "nbMMp1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoopsubMMp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BLoopsub", "[", "MMp2pk", "]"}], "/.", 
     RowBox[{"Dispatch", "[", "coeffixMMp2", "]"}]}], "/.", "nbMMp2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.896605797446907*^9, 3.896605806574854*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"3c6fee3f-f2a6-43a8-9074-396e4534c021"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BMMp1derivs", "=", 
   RowBox[{"BMMp1derivspre", "-", 
    RowBox[{"Table", "[", 
     RowBox[{"LoopsubMMp1", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMp1", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMMp2derivs", "=", 
   RowBox[{"BMMp2derivspre", "-", 
    RowBox[{"Table", "[", 
     RowBox[{"LoopsubMMp2", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMp2", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.89660580676729*^9, 3.896605808867639*^9}},
 CellLabel->
  "In[497]:=",ExpressionUUID->"b3c72650-dc63-4edf-b963-edecb709f50f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fishers ", "Subsection",
 CellChangeTimes->{{3.8783910593521233`*^9, 3.8783910828550453`*^9}, {
   3.87841255670513*^9, 3.878412558622801*^9}, {3.87847106765874*^9, 
   3.878471075603257*^9}, 
   3.878472309210397*^9},ExpressionUUID->"0dfe60e8-df63-4292-b5af-\
18154edd1a6a"],

Cell["Reduce P-derivatives to monopole and quadrupole", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391400909933*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"73607e0a-daa2-40fb-814f-3ba2e08a10e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMp1monoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PMMp1derivs", "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMp2monoquad", "=", " ", 
   RowBox[{
    RowBox[{"removelg2", "[", "PMMp2derivs", "]"}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8783854974202147`*^9, {3.878391156242745*^9, 3.878391178604154*^9}, {
   3.87839131726943*^9, 3.8783913246578836`*^9}, {3.8784703488075943`*^9, 
   3.878470362719586*^9}, {3.878477399801289*^9, 3.8784774000930023`*^9}, {
   3.878477432649067*^9, 3.878477432799201*^9}, {3.885497995608622*^9, 
   3.885497995925082*^9}},
 CellLabel->
  "In[847]:=",ExpressionUUID->"af50f589-3778-492a-a518-327e774fc1d0"],

Cell["Powerspectrum Fishers monoquad", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471130667965*^9, 3.8784711318254747`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"33f75d73-7d72-425a-ac0e-9c25c7b68b29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPMMp1", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMp1monoquad", ",", "COVMMp1P"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPMMp2", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMp2monoquad", ",", "COVMMp2P"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877298767724556*^9, 3.8772987953889217`*^9}, {
  3.8783912080268583`*^9, 3.878391210249255*^9}, {3.878470369143877*^9, 
  3.878470402858488*^9}, {3.8784774004422607`*^9, 3.878477401367791*^9}, {
  3.8784774329677067`*^9, 3.878477433932514*^9}, {3.88547959938271*^9, 
  3.885479599383039*^9}, {3.88549799614876*^9, 3.885497996942657*^9}},
 CellLabel->
  "In[849]:=",ExpressionUUID->"32b622fd-18af-4ff7-89c8-6d107b54a0e0"],

Cell["Bispectrum Fishers - mono", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391430313566*^9}, {
  3.878409282105134*^9, 3.878409283129027*^9}, {3.8784711373327293`*^9, 
  3.878471138379108*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4b3166d9-0869-4a9e-8e2e-55870085d982"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBMMp1", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMp1derivs", ",", "COVMMp1B", ",", "Loopmastermono"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBMMp2", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMp2derivs", ",", "COVMMp2B", ",", "Loopmastermono"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.877299183948834*^9, 3.877299194957054*^9}, 
   3.878411016536647*^9, {3.878470406485463*^9, 3.878470430487794*^9}, {
   3.878477401900421*^9, 3.8784774026923637`*^9}, {3.878477434779148*^9, 
   3.878477436021389*^9}, {3.8854979970409307`*^9, 3.885497997591572*^9}},
 CellLabel->
  "In[851]:=",ExpressionUUID->"7aebcfc3-f093-4b17-b278-435cf7b5294b"],

Cell["Powerspectrum Fishers full \[Mu]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471134226358*^9}, {3.879448514674612*^9, 
  3.879448515671617*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0db37c28-60b5-4f0e-82b9-d1ec781d9faf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPMMp1mu", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMp1derivs", ",", "COVMMp1P"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPMMp2mu", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMp2derivs", ",", "COVMMp2P"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8784774035354643`*^9, 3.878477404409371*^9}, {
  3.878477437007348*^9, 3.878477438371073*^9}, {3.8788873307241793`*^9, 
  3.87888733154928*^9}, {3.885479599383809*^9, 3.885479599384107*^9}, {
  3.8854979976999283`*^9, 3.8854980030908623`*^9}},
 CellLabel->
  "In[853]:=",ExpressionUUID->"af4108cb-bf04-4e7e-a570-8d112eb72937"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPMMp1mu2L", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMp1derivs2L", ",", "COVMMp1P2L"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPMMp2mu2L", " ", "=", " ", 
   RowBox[{"GetFisherP", "[", 
    RowBox[{"PMMp2derivs2L", ",", "COVMMp2P2L"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879887646471279*^9, 3.879887658947791*^9}, {
  3.88547959938484*^9, 3.885479599385147*^9}, {3.885498003282042*^9, 
  3.8854980077996473`*^9}},
 CellLabel->
  "In[855]:=",ExpressionUUID->"808f630f-faa6-453e-9928-0bd6df3e5f0a"],

Cell["Bispectrum Fishers full \[Mu]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.879448521901677*^9, 
  3.87944852339006*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d63e2bdd-f1c1-4750-9459-9a5d718af0e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBMMp1mu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMp1derivs", ",", "COVMMp1B", ",", "Loopmaster"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBMMp2mu", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMp2derivs", ",", "COVMMp2B", ",", "Loopmaster"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878471150568904*^9, 3.8784711611799793`*^9}, {
  3.8784774048729*^9, 3.878477407951654*^9}, {3.878477446491733*^9, 
  3.87847744746169*^9}, {3.8854980079672318`*^9, 3.885498008978176*^9}},
 CellLabel->
  "In[857]:=",ExpressionUUID->"adb184b2-adf6-46f6-af92-25f818c984b1"],

Cell["Bispectrum Fishers full \[Mu] Tree", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
  3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
  3.878331988312262*^9, 3.8783319952643538`*^9}, {3.878332295486703*^9, 
  3.878332308687067*^9}, {3.878391391971486*^9, 3.878391412299303*^9}, {
  3.878471133515791*^9, 3.878471147386046*^9}, {3.8794439390888777`*^9, 
  3.8794439401353083`*^9}, {3.879443983047256*^9, 3.87944398400249*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"3d0b4c2c-4a06-43d5-bd66-28abdab60632"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FBMMp1muT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMp1derivsT", ",", "COVMMp1BTree", ",", "Loopmaster"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FBMMp2muT", " ", "=", " ", 
   RowBox[{"GetFisherB", "[", 
    RowBox[{"BMMp2derivsT", ",", "COVMMp2BTree", ",", "Loopmaster"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.878471150568904*^9, 3.8784711611799793`*^9}, {
  3.8784774048729*^9, 3.878477407951654*^9}, {3.878477446491733*^9, 
  3.87847744746169*^9}, {3.87944861150875*^9, 3.879448636279298*^9}, {
  3.879614303605589*^9, 3.8796143095599213`*^9}, {3.8854980091828547`*^9, 
  3.8854980102497807`*^9}},
 CellLabel->
  "In[859]:=",ExpressionUUID->"a41c6c7f-4335-45ab-954b-c6f2b1480578"]
}, Closed]],

Cell[CellGroupData[{

Cell["Perturbative Prior ", "Subsection",
 CellChangeTimes->{{3.895054428919343*^9, 3.895054448809629*^9}, {
   3.896346000953662*^9, 3.896346003061626*^9}, 
   3.8963817325327387`*^9},ExpressionUUID->"3f50b961-782b-4b58-9348-\
4866cdf368e0"],

Cell[CellGroupData[{

Cell["Powerspectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.88874151521391*^9}},ExpressionUUID->"4aaabbfe-0123-40fe-b632-\
83e29e26c681"],

Cell["scaling  bias  computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
   3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
   3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
   3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
   3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
   3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
   3.8887536509125*^9, 3.888753659481193*^9}, 3.894539283215518*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4e392f70-c850-42ec-b437-6539cc32c50f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMp1Loop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabMMp1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMp1pk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabMMp1", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixMMp1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMp2Loop", " ", "=", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PLoopscale", "[", 
         RowBox[{
          RowBox[{"ktabMMp2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMp2pk"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", 
          RowBox[{"Length", "[", "ktabMMp2", "]"}]}], "}"}]}], "]"}], ",", 
      "si"}], "]"}], "/.", "coeffixMMp2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741261612136*^9, 3.88874127220191*^9}, 
   3.88875333043812*^9, {3.8887533861313133`*^9, 3.888753396861267*^9}, {
   3.888754416678398*^9, 3.888754434715231*^9}, 3.8950549661329603`*^9, {
   3.895056052149311*^9, 3.895056119622072*^9}, {3.895056153206499*^9, 
   3.895056153902245*^9}, {3.8950570911583242`*^9, 3.89505709559973*^9}, {
   3.896346495790904*^9, 3.896346518137302*^9}},
 CellLabel->
  "In[1389]:=",ExpressionUUID->"6e34d967-d606-435a-b5b0-7dd2d04103c5"],

Cell["PTree computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
  3.888741162977934*^9, 3.888741164492325*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"edc90400-90bc-4039-884d-a41959093aa0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PMMp1Tree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabMMp1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMp1pk"}], "]"}], "/.", 
        "coeffixMMp1"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabMMp1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PMMp2Tree", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PTNS", "[", 
         RowBox[{
          RowBox[{"ktabMMp2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMp2pk"}], "]"}], "/.", 
        "coeffixMMp2"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "ktabMMp2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888677236439253*^9, 3.888677328937776*^9}, {
   3.888677833429311*^9, 3.888677892595318*^9}, {3.8886934808284693`*^9, 
   3.888693481930241*^9}, {3.888741178216148*^9, 3.888741205021223*^9}, 
   3.888745462695631*^9, 3.895054979145851*^9, {3.895056052652766*^9, 
   3.895056120544305*^9}, {3.895056154116026*^9, 3.895056154525999*^9}, {
   3.895057095807458*^9, 3.895057097743257*^9}},
 CellLabel->
  "In[1391]:=",ExpressionUUID->"ee1eb140-b607-47b3-88a5-c701e5a061a9"],

Cell["\[Sigma] computations", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.88867703097571*^9, 3.8886770334438677`*^9}, {
  3.888740413660467*^9, 3.8887404139676857`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"24aca406-8b44-4b67-9a64-409533006608"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcMMp1", "[", "k_", "]"}], "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{
        RowBox[{"GetFullzCovPInv", "[", 
         RowBox[{
         "ktabraw", ",", "MMp1pk", ",", "MMp1spec", ",", "bfixstoch", ",", 
          "dkPMM"}], "]"}], "/.", 
        RowBox[{"\[Mu]", "->", "0"}]}]}], "]"}], "[", "k", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]funcMMp2", "[", "k_", "]"}], "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{
     RowBox[{"Get\[Sigma]", "[", 
      RowBox[{"ktabraw", ",", 
       RowBox[{
        RowBox[{"GetFullzCovPInv", "[", 
         RowBox[{
         "ktabraw", ",", "MMp2pk", ",", "MMp2spec", ",", "bfixstoch", ",", 
          "dkPMM"}], "]"}], "/.", 
        RowBox[{"\[Mu]", "->", "0"}]}]}], "]"}], "[", "k", "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740432992057*^9, 3.888740457002887*^9}, {
   3.8887405566797333`*^9, 3.8887405983128567`*^9}, {3.888740634886725*^9, 
   3.88874063767188*^9}, {3.888741118670182*^9, 3.888741121830488*^9}, {
   3.888755168282782*^9, 3.888755168616124*^9}, {3.888755212474147*^9, 
   3.888755212892293*^9}, {3.8887553185172977`*^9, 3.888755333641263*^9}, {
   3.888755406547153*^9, 3.888755420384659*^9}, {3.8950560618360367`*^9, 
   3.8950561207028646`*^9}, 3.8950561547091007`*^9, {3.895056202374798*^9, 
   3.895056205924859*^9}, {3.895057097904983*^9, 3.895057098811837*^9}, {
   3.895300261495852*^9, 3.895300262477324*^9}, {3.89547429495597*^9, 
   3.895474294956389*^9}},
 CellLabel->
  "In[1393]:=",ExpressionUUID->"fe9b6dd0-9757-4371-b297-3687e8f5c2a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]MMp1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcMMp1", "[", 
      RowBox[{"ktabMMp1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabMMp1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]MMp2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Sigma]funcMMp2", "[", 
      RowBox[{"ktabMMp2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ktabMMp2", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888740435898135*^9, 3.888740464811185*^9}, {
  3.888755168799716*^9, 3.88875516936604*^9}, {3.888755213091127*^9, 
  3.88875521372425*^9}, {3.888755285292038*^9, 3.888755298575753*^9}, {
  3.895056062202775*^9, 3.895056121011249*^9}, {3.895056154896344*^9, 
  3.8950561551179647`*^9}, {3.895057098985035*^9, 3.895057100250959*^9}},
 CellLabel->
  "In[1395]:=",ExpressionUUID->"aef3d165-ebba-4088-ad4b-d0143a89bd3d"],

Cell["Get \[OpenCurlyDoubleQuote]correct\[CloseCurlyDoubleQuote] \
powerspectrum", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.8950518293200827`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"de6ee4c7-ee4e-4b2e-b087-766ca9f2a85b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1LCMMp1", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PMMp1Loop", ",", "\[Sigma]MMp1tab", ",", "PMMp1Tree"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1LCMMp2", "=", 
   RowBox[{"P1LC", "[", 
    RowBox[{"PMMp2Loop", ",", "\[Sigma]MMp2tab", ",", "PMMp2Tree"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.888753553372282*^9, 3.888753584704721*^9}, {
  3.895001710873721*^9, 3.895001711694565*^9}, {3.895051621578108*^9, 
  3.895051657499125*^9}, {3.895055012063528*^9, 3.895055026561247*^9}, {
  3.895056062611322*^9, 3.895056092527287*^9}, {3.895057100454508*^9, 
  3.895057101760633*^9}},
 CellLabel->
  "In[1397]:=",ExpressionUUID->"2a31322b-0a2b-4092-b320-6e2eb98fcb29"],

Cell["Get powerspectrum priors", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862314165543*^9}, {3.888047431826811*^9, 
  3.888047442736043*^9}, {3.888753543751992*^9, 3.888753576457271*^9}, {
  3.895051816904667*^9, 3.895051842826643*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"21d419f2-cb11-4365-b0cd-b3e50f638c70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPriorMMp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabMMp1", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabMMp1", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "MMp1pk", ",", " ", 
             RowBox[{"P1LCMMp1", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabMMp1", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", 
      RowBox[{"\[Mu]", "->", "0"}]}], "/.", "coeffixMMp1"}], "/.", 
    "nbMMp1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPriorMMp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "ktabMMp2", "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"MakePriorP", "[", 
            RowBox[{
             RowBox[{"ktabMMp2", "[", 
              RowBox[{"[", "si", "]"}], "]"}], ",", "MMp2pk", ",", " ", 
             RowBox[{"P1LCMMp2", "[", 
              RowBox[{"[", "si", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"si", ",", "1", ",", 
             RowBox[{"Length", "[", "ktabMMp2", "]"}]}], "}"}]}], "]"}]}], 
        ",", "si"}], "]"}], "/.", 
      RowBox[{"\[Mu]", "->", "0"}]}], "/.", "coeffixMMp2"}], "/.", 
    "nbMMp2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895055040761423*^9, 3.895055065971439*^9}, {
  3.89505606403668*^9, 3.895056121896224*^9}, {3.895056155737891*^9, 
  3.8950561570047493`*^9}, {3.895057101935473*^9, 3.8950571049686127`*^9}, {
  3.895147722371703*^9, 3.895147729405941*^9}, {3.895567413097488*^9, 
  3.895567419759717*^9}, {3.8955685796063547`*^9, 3.895568579931293*^9}},
 CellLabel->
  "In[1399]:=",ExpressionUUID->"f739503f-47c4-40bb-8e1c-cbaed1858144"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bispectrum", "Subsubsection",
 CellChangeTimes->{{3.886767320986817*^9, 3.88676733359942*^9}, {
  3.888741511320784*^9, 
  3.888741528575953*^9}},ExpressionUUID->"6f5f18e6-c6d8-498f-a3a0-\
d087dbfe9a97"],

Cell["Bispectrum - Background  Tree and Loop", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741616313279*^9, 3.8887416248599854`*^9}, {
  3.8887416567266483`*^9, 3.888741660704743*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a4c723f4-9b27-43f6-a5f3-c4f36679da20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BMMp1Loopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Bloopscale", "[", 
         RowBox[{
          RowBox[{"keffMMp1", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMp1pk"}], "]"}], "/.", 
        RowBox[{"Dispatch", "[", "coeffixMMp1", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMp1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMMp2Loopback", " ", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Bloopscale", "[", 
         RowBox[{
          RowBox[{"keffMMp2", "[", 
           RowBox[{"[", "si", "]"}], "]"}], ",", "MMp2pk"}], "]"}], "/.", 
        RowBox[{"Dispatch", "[", "coeffixMMp2", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMp2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887870506613146*^9, 3.887870526214724*^9}, {
   3.888045960956028*^9, 3.888045982568386*^9}, 3.8886762373468113`*^9, {
   3.888755179740827*^9, 3.888755180708872*^9}, {3.8887552242490683`*^9, 
   3.88875522526589*^9}, {3.888755320124936*^9, 3.8887553729582777`*^9}, {
   3.888755512955844*^9, 3.888755514140646*^9}, {3.8887555891094103`*^9, 
   3.8887556059686403`*^9}, {3.895056065594676*^9, 3.895056124684389*^9}, {
   3.895056160987278*^9, 3.895056162262398*^9}, 3.895056754844688*^9, {
   3.895057108668239*^9, 3.895057111168797*^9}, {3.8963465268886213`*^9, 
   3.896346547720665*^9}},
 CellLabel->
  "In[1401]:=",ExpressionUUID->"c1be1508-90fe-4629-814d-17e8c4980bdf"],

Cell["Bispectrum - Derivatives of Loop only", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c237f4b3-61fc-4a9d-bcd2-53385e5c6bdd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CorrectionMMp1", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"keffMMp1", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "MMp1pk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixMMp1", "]"}]}], "/.", "nbMMp1"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMp1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CorrectionMMp2", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BCorrection", "[", 
          RowBox[{
           RowBox[{"keffMMp2", "[", 
            RowBox[{"[", "si", "]"}], "]"}], ",", "MMp2pk"}], "]"}], "/.", 
         RowBox[{"Dispatch", "[", "coeffixMMp2", "]"}]}], "/.", "nbMMp2"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMp2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887869756685066*^9, 3.887869779195531*^9}, {
   3.888755180899663*^9, 3.888755181700437*^9}, {3.8887552254749537`*^9, 
   3.888755226283332*^9}, {3.8887553203424063`*^9, 3.888755373142469*^9}, {
   3.88875552243512*^9, 3.888755523704595*^9}, {3.888755589509716*^9, 
   3.888755606401744*^9}, {3.895056066361334*^9, 3.895056125224794*^9}, {
   3.895056162996407*^9, 3.895056163823646*^9}, 3.895056762840891*^9, {
   3.895057113131476*^9, 3.895057115360159*^9}, {3.895147739549128*^9, 
   3.895147740988056*^9}, 3.895148939572359*^9, {3.896346551180779*^9, 
   3.896346564000463*^9}, {3.896382736785776*^9, 3.8963827383549967`*^9}, 
   3.896383121740593*^9, {3.8964266533551083`*^9, 
   3.8964266550498734`*^9}},ExpressionUUID->"a7b62a8b-c3e8-4f0b-ab67-\
7575ca5455fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BMMp1ngcLoopderivs", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BMMp1derivs", "+", "CorrectionMMp1"}], ")"}], ".", 
    "Blooplistreal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMMp2ngcLoopderivs", "  ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"BMMp2derivs", "+", "CorrectionMMp2"}], ")"}], ".", 
    "Blooplistreal"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8868385093651257`*^9, 3.886838510201589*^9}, {
   3.886838918810886*^9, 3.886838923398671*^9}, 3.8868395694779863`*^9, 
   3.8868423371525383`*^9, {3.887869794724497*^9, 3.887869828310582*^9}, {
   3.887869867058724*^9, 3.8878698800661917`*^9}, {3.887961854062598*^9, 
   3.887961855134948*^9}, {3.888755181898987*^9, 3.888755182508569*^9}, {
   3.888755226499262*^9, 3.8887552271335783`*^9}, {3.888757711586331*^9, 
   3.888757731629743*^9}, {3.8950560669529123`*^9, 3.895056097147223*^9}, {
   3.8950571163757544`*^9, 3.895057117403319*^9}, {3.8951477667030907`*^9, 
   3.895147767810523*^9}, {3.89530009913127*^9, 3.895300110945168*^9}, {
   3.895300143397888*^9, 3.8953001472488956`*^9}},
 CellLabel->
  "In[1406]:=",ExpressionUUID->"6140aec5-7729-4349-9a6e-41dd9b807a4f"],

Cell["Symmetric P1LC", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.888047475222269*^9}, {3.888741639033925*^9, 3.888741643739499*^9}, {
  3.8950532854616213`*^9, 3.895053290570174*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"b97a5f76-59b1-484e-afeb-9eb6fbe69b1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PTtritabMMp1", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"keffMMp1", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "MMp1pk"}], "]"}], 
          "/.", "coeffixMMp1"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMp1", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PTtritabMMp2", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PLoopscale", "[", 
           RowBox[{
            RowBox[{"keffMMp2", "[", 
             RowBox[{"[", 
              RowBox[{"si", ",", "j"}], "]"}], "]"}], ",", "MMp2pk"}], "]"}], 
          "/.", "coeffixMMp2"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", "1", ",", 
         RowBox[{"Length", "[", "keffMMp2", "]"}]}], "}"}]}], "]"}], ",", 
     "si"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743170297797*^9, 3.888743178232419*^9}, {
   3.888743239420354*^9, 3.8887432774648733`*^9}, {3.888743593628655*^9, 
   3.888743613564752*^9}, {3.8887538943446207`*^9, 3.8887538992824593`*^9}, {
   3.8887539507915707`*^9, 3.8887540245086727`*^9}, {3.8887551896332703`*^9, 
   3.8887551904843197`*^9}, {3.888755234532494*^9, 3.888755235382784*^9}, {
   3.88875532097534*^9, 3.888755373342001*^9}, {3.888755540603545*^9, 
   3.88875554247409*^9}, {3.888755591236051*^9, 3.88875560833599*^9}, {
   3.8950560675529327`*^9, 3.895056125783257*^9}, {3.8950561648659267`*^9, 
   3.8950561657796164`*^9}, 3.895056856974148*^9, {3.89505711759371*^9, 
   3.895057119836184*^9}, {3.8963465749831667`*^9, 3.896346595215638*^9}},
 CellLabel->
  "In[1408]:=",ExpressionUUID->"b698745e-4dcc-487b-9c18-db0bf40df4bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PsymtabMMp1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"keffMMp1", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "MMp1pk", ",", 
        RowBox[{"PTtritabMMp1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMp1", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixMMp1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsymtabMMp2", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPsymT", "[", 
       RowBox[{
        RowBox[{"keffMMp2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "MMp2pk", ",", 
        RowBox[{"PTtritabMMp2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMp2", "]"}]}], "}"}]}], "]"}], "/.", 
    "coeffixMMp2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743595979177*^9, 3.8887436284098597`*^9}, {
  3.888753901299285*^9, 3.888753903432684*^9}, {3.888753952413186*^9, 
  3.888753953499566*^9}, {3.888753996437364*^9, 3.888753999316115*^9}, {
  3.8887551906743107`*^9, 3.888755191574905*^9}, {3.888755235591964*^9, 
  3.888755236449566*^9}, {3.888755321174719*^9, 3.888755336499699*^9}, {
  3.888755544908473*^9, 3.88875554625144*^9}, {3.888755591618659*^9, 
  3.8887556087439938`*^9}, {3.8950560681615267`*^9, 3.895056127472228*^9}, {
  3.8950561661780148`*^9, 3.895056167229443*^9}, {3.895057120851849*^9, 
  3.895057123107998*^9}},
 CellLabel->
  "In[1410]:=",ExpressionUUID->"76d39b5e-f06e-4bbf-8aff-3d8525cc8871"],

Cell["Bispectrum \[OpenCurlyQuote]correct\[CloseCurlyQuote]", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.89505326165967*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"41e54a55-7a0f-4e77-bc2c-6e4668a5c214"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B1LCMMp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BMMp1Loopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVMMp1B", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabMMp1", ",", 
        "PMMp1Loop", ",", "\[Sigma]MMp1tab", ",", "PMMp1Tree"}], "]"}], "/.", 
      "coeffixMMp1"}], "/.", "nbMMp1"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1LCMMp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"B1LC", "[", 
       RowBox[{"BMMp2Loopback", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"COVMMp2B", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], ",", "PsymtabMMp2", ",", 
        "PMMp2Loop", ",", "\[Sigma]MMp2tab", ",", "PMMp2Tree"}], "]"}], "/.", 
      "coeffixMMp2"}], "/.", "nbMMp2"}], "/.", 
    RowBox[{"\[Mu]", "->", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.888743598646628*^9, 3.888743598924089*^9}, {
  3.8887436318956842`*^9, 3.888743635015679*^9}, {3.888745932066663*^9, 
  3.888745933074651*^9}, {3.8887539075778713`*^9, 3.8887539557330914`*^9}, {
  3.888754032089074*^9, 3.888754068197426*^9}, {3.8887541078730497`*^9, 
  3.8887541151628428`*^9}, {3.888754160444756*^9, 3.8887541755244904`*^9}, {
  3.895053039641955*^9, 3.8950530471332006`*^9}, {3.895055231608708*^9, 
  3.895055263905095*^9}, {3.895055409690301*^9, 3.895055413803789*^9}, {
  3.8950560691394167`*^9, 3.895056102989215*^9}, {3.895057123321835*^9, 
  3.89505712673594*^9}},
 CellLabel->
  "In[1412]:=",ExpressionUUID->"3412a8ed-8d2c-4c5b-8ff2-65106bdad109"],

Cell["Bispectrum prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
  3.872305167102776*^9, 3.872305187510045*^9}, {3.8878611676136837`*^9, 
  3.887861175148695*^9}, {3.887861294912327*^9, 3.887861301779117*^9}, {
  3.8878614249541616`*^9, 3.887861441659824*^9}, {3.887862055971121*^9, 
  3.887862057849485*^9}, {3.8878621411156282`*^9, 3.887862141773574*^9}, {
  3.88786231314993*^9, 3.887862324191824*^9}, {3.888047471581594*^9, 
  3.8880474871413317`*^9}, {3.8887427888632708`*^9, 3.888742789319345*^9}, {
  3.8887538858020887`*^9, 3.888753890523934*^9}, {3.888753949262535*^9, 
  3.888753949433901*^9}, {3.895053259268331*^9, 3.895053268869812*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5dc988cb-cfbe-493b-b718-c4e55aaa3c5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BPriorMMp1", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "keffMMp1", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BMMp1ngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCMMp1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMp1", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BPriorMMp2", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Length", "[", "keffMMp2", "]"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Makeprior", "[", 
       RowBox[{
        RowBox[{"BMMp2ngcLoopderivs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"B1LCMMp2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keffMMp2", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.89505526942714*^9, 3.895055283404625*^9}, {
   3.895055376016219*^9, 3.895055378845052*^9}, {3.895056072412477*^9, 
   3.8950561285853662`*^9}, 3.895056169154029*^9, {3.895057052929665*^9, 
   3.895057053521905*^9}, {3.895057126925294*^9, 3.895057130597026*^9}, {
   3.895148212520206*^9, 3.895148217851667*^9}, {3.895300115278126*^9, 
   3.895300116101606*^9}},
 CellLabel->
  "In[1414]:=",ExpressionUUID->"e4017c98-0440-4d44-9b90-559085b7082c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exports", "Subsection",
 CellChangeTimes->{{3.878564059914957*^9, 3.8785640633698683`*^9}, {
  3.878564297799753*^9, 3.878564304515422*^9}, {3.878593003096862*^9, 
  3.878593005866235*^9}, {3.895000747572433*^9, 
  3.895000748507515*^9}},ExpressionUUID->"5512c158-965f-4248-a55e-\
c42b813ba90d"],

Cell["Analytical covariance with full redshift dependence,  w/o B", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"31158ecb-9fb2-48f0-8256-53fd0d45a70b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/Panafullz.mtx\>\"", ",", 
    RowBox[{"FPMMp1", "+", "FPMMp2", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/PBanafullz.mtx\>\"", ",", 
    RowBox[{
    "FPMMp1", "+", "FPMMp2", "+", "FBMMp1", "+", "FBMMp2", "+", "Priors"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQXcezdfORp28cbXI/bQfRTC7bFY8B6ZAt7Gog+jrH
NCsQrdGtaA+i9xVfK3J/9sZR4c1NMK24VlIhA0hXLJcD0yvktmu+B9ITzZ6A
6UtMUYFVz984bmGH0EElT+NA9L3PnPEgeknv1aOGH4DqXAWOgejUutrn/z+9
cZzSBKHvPFj/tvcnUF9y3jsQ/Sy8wO0OkA69UwqmU+SLy08wvXV8ogShjUqY
nB8D6evlEDrHe+FtRda3jgfaVO+A6OrInnAjtreOHrEQunLDWiNTID11dpYx
iE6bcsESRM+7X2YFohcsdd7cz/7WMavkxhYQ/fRdc9Z0IB32CUIDAEaGqmY=

  "],
 CellLabel->
  "In[1579]:=",ExpressionUUID->"c8104a8b-4041-4258-993f-317a8e7914ac"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles,  w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c9df72d5-9cdd-42c6-a5d9-afad086a69ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/Panamufullz.mtx\>\"", ",", 
    RowBox[{"FPMMp1mu", "+", "FPMMp2mu", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/PBanamufullz.mtx\>\"", ",", 
    RowBox[{
    "FPMMp1mu", "+", "FPMMp2mu", "+", "FBMMp1mu", "+", "FBMMp2mu", "+", 
     "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQXcezdfORp28cbXI/bQfRTC7bFY8B6dvnL2uDaHVf
eyMQ3bW7GUzzfzSxAdFi05bbg+gtUk+L3J+9cQye/AJMq9ToKGQAaQ82QzB9
976O1nsgHSCXAqanKEYFVj1/47hMBUJf4eOPB9E1n03BtH+p+THDD0BzLDLB
dN7C2uf/PwH1LYHQ72buf9f7842j57dfYFoso9rtDpDewdwIpp30i8tPML11
nGMEoa80Mjk/BtJTWiG0mXfIHUXWt47cpsVg2iG9J9yI7a3jlywI/arrsLEp
kK4wP2MCom8azrUC0XExx8C04Hbnzf3sbx1v1dzYAqLTfjRnTQfSx35DaADP
l6/g
  "],
 CellLabel->
  "In[1581]:=",ExpressionUUID->"c012c404-9724-4b9f-bb28-05c35b432aa2"],

Cell["\<\
Analytical covariance with full redshift dependence, all multipoles, Tree B \
w/o B\
\>", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878564165927361*^9, 3.878564168263877*^9}, {
   3.878564270615465*^9, 3.87856427222081*^9}, {3.8794571676476088`*^9, 
   3.879457175011805*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0f87db8b-621c-40df-9c51-f8781a48cb17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/PBanamufullzT.mtx\>\"", ",", 
    RowBox[{
    "FPMMp1mu", "+", "FPMMp2mu", "+", "FBMMp1muT", "+", "FBMMp2muT", "+", 
     "Priors"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.878561181657775*^9, 3.8785612155758343`*^9}, {
   3.8785641097270517`*^9, 3.878564190619123*^9}, {3.878564241978168*^9, 
   3.878564285680266*^9}, {3.878828949234503*^9, 3.8788289494509583`*^9}, {
   3.879164027812216*^9, 3.879164029618887*^9}, {3.879457177071039*^9, 
   3.879457210700491*^9}, 3.879457380313807*^9, {3.8794574840110407`*^9, 
   3.879457497751718*^9}, {3.8794575298616133`*^9, 3.879457530621674*^9}, 
   3.884027445225357*^9, 3.8854981719295588`*^9, {3.888934777042179*^9, 
   3.888934777103964*^9}, 3.889095220214282*^9, 3.893773243601365*^9, 
   3.893828120079938*^9, 3.8950049007276154`*^9, 3.8955629403891087`*^9, {
   3.895568808608101*^9, 3.895568811343092*^9}, 3.895568855603355*^9, {
   3.8962784261177187`*^9, 3.896278438765884*^9}, 3.8962942281251707`*^9},
 CellLabel->
  "In[1583]:=",ExpressionUUID->"29e099c6-0bbb-44a8-bf37-79c953248b95"],

Cell["Perturbative Prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878562694723263*^9, 3.878562699328602*^9}, {
   3.895054532385188*^9, 3.895054536060054*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"fc3dfdab-72d3-4dd3-a859-9500a0fb6fdd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/Ppertprior.mtx\>\"", ",", 
    RowBox[{"PPriorMMp1", "+", "PPriorMMp2"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/PBpertprior.mtx\>\"", ",", 
    RowBox[{
    "PPriorMMp1", "+", "PPriorMMp2", "+", "BPriorMMp1", "+", "BPriorMMp2"}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8950546527914953`*^9, 3.8950547352115717`*^9}, {
  3.895054790541091*^9, 3.895054856054175*^9}, {3.895055440260354*^9, 
  3.895055459519186*^9}, {3.895056936300846*^9, 3.8950569498250647`*^9}, {
  3.895057331660222*^9, 3.8950573423325863`*^9}, {3.895148222774967*^9, 
  3.895148224268936*^9}, {3.895300507134663*^9, 3.89530050924905*^9}, {
  3.8955629403902617`*^9, 3.895562940390655*^9}, {3.8955633812962017`*^9, 
  3.8955633812966423`*^9}, {3.89556881390766*^9, 3.895568844227971*^9}, {
  3.896278426118891*^9, 3.896278438766987*^9}, {3.8962942281258183`*^9, 
  3.896294228126267*^9}},
 CellLabel->
  "In[1421]:=",ExpressionUUID->"bc39e868-1f14-482a-a0dc-47aff43e9fca"],

Cell["Perturbative Prior", "Text",
 CellChangeTimes->{{3.872305094960354*^9, 3.8723051021447353`*^9}, {
   3.872305167102776*^9, 3.872305187510045*^9}, {3.872337564986854*^9, 
   3.87233758367675*^9}, {3.872427982864663*^9, 3.87242800756728*^9}, {
   3.8724280710250273`*^9, 3.872428074484048*^9}, {3.872428262793765*^9, 
   3.872428274295844*^9}, 3.8734687284786*^9, {3.873518990052896*^9, 
   3.873518992311718*^9}, 3.873875785449225*^9, {3.8783324566898203`*^9, 
   3.878332493951947*^9}, {3.87856048367796*^9, 3.878560496457304*^9}, {
   3.8785605562696342`*^9, 3.878560558510439*^9}, {3.8785606023290873`*^9, 
   3.878560616047999*^9}, {3.878561128297893*^9, 3.87856113548079*^9}, 
   3.8785612209281588`*^9, {3.878562694723263*^9, 3.878562699328602*^9}, {
   3.895054532385188*^9, 3.895054536060054*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"aa7e6bf9-0974-4641-b96c-8a93800a6787"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/Panamufullz2L.mtx\>\"", ",", 
    RowBox[{"FPMMp1mu2L", "+", "FPMMp2mu2L", "+", "Priors"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Fishers/MMp/PBanamufullz2L.mtx\>\"", ",", 
    RowBox[{
    "FPMMp1mu2L", "+", "FPMMp2mu2L", "+", "FBMMp1mu", "+", "FBMMp2mu", "+", 
     "Priors"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.896000894743222*^9, 3.896000905980782*^9}, {
  3.8962784261211367`*^9, 3.896278438767981*^9}, {3.896294228127039*^9, 
  3.896294228127437*^9}},
 CellLabel->
  "In[1586]:=",ExpressionUUID->"e1acf976-9337-4a57-aa75-18f1ce24cb35"]
}, Closed]]
}, Closed]]
},
WindowSize->{808, 737},
WindowMargins->{{324, Automatic}, {46, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f243e5f2-65f1-44ff-a14a-5e66d2da28f9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 854, 13, 30, "Input",ExpressionUUID->"823c1823-80bb-4317-9801-664ac87fa463"],
Cell[CellGroupData[{
Cell[1279, 30, 250, 4, 30, "Input",ExpressionUUID->"1c6ab6d1-11d7-4145-97be-f84f8b338dec"],
Cell[1532, 36, 1490, 21, 34, "Output",ExpressionUUID->"b25fa543-ed61-4240-acf2-70f45b057d4c"]
}, Closed]],
Cell[CellGroupData[{
Cell[3059, 62, 214, 4, 53, "Section",ExpressionUUID->"6da3f3ee-8d86-45eb-b6bc-d552c8ab1573"],
Cell[CellGroupData[{
Cell[3298, 70, 368, 5, 54, "Subsection",ExpressionUUID->"a5c007d7-7101-42fc-9b63-d15c58f3fd3a"],
Cell[3669, 77, 198, 3, 51, "Text",ExpressionUUID->"5b634a7e-33c7-4460-a438-9faf5a5eb844"],
Cell[3870, 82, 1205, 27, 157, "Input",ExpressionUUID->"74bf43fe-2a87-46b8-8c1a-75b72c0e3ad5"],
Cell[5078, 111, 815, 19, 120, "Input",ExpressionUUID->"6dc81fff-1d9b-44dd-972f-f57ac115d48d"],
Cell[5896, 132, 191, 3, 51, "Text",ExpressionUUID->"0e65e27b-0f3f-43db-a77f-2c15c3e8cc79"],
Cell[6090, 137, 1537, 27, 52, "Input",ExpressionUUID->"e3f884af-a3c9-481c-9f5b-3930a8fa1d0c"],
Cell[7630, 166, 187, 3, 51, "Text",ExpressionUUID->"0ea6c699-f0f9-4282-a52b-0c6755ac7849"],
Cell[7820, 171, 384, 9, 94, "Input",ExpressionUUID->"7f93c02c-fe83-4360-8823-8e36cfedbfab"],
Cell[8207, 182, 387, 10, 51, "Text",ExpressionUUID->"f86619d9-16b0-4ced-9734-1b42bc554395"],
Cell[8597, 194, 382, 9, 30, "Input",ExpressionUUID->"c781a137-383e-4181-97e0-cbf0a2127094"],
Cell[8982, 205, 381, 9, 30, "Input",ExpressionUUID->"34626481-4763-4a98-972f-a9d9b6154296"],
Cell[9366, 216, 359, 8, 30, "Input",ExpressionUUID->"6eb38468-5138-48ca-ace6-5345ef1863c7"]
}, Closed]],
Cell[CellGroupData[{
Cell[9762, 229, 254, 4, 38, "Subsection",ExpressionUUID->"7a5c0b7b-1376-4880-a1a7-1ad3d2f54d50"],
Cell[10019, 235, 239, 4, 51, "Text",ExpressionUUID->"b7f3a44d-bee4-485e-bf6d-864d4f02f2be"],
Cell[10261, 241, 1017, 17, 73, "Input",ExpressionUUID->"3c8fea00-2363-4327-a8d9-5ed95c59f1af"],
Cell[11281, 260, 294, 5, 51, "Text",ExpressionUUID->"638642a1-b797-4341-9fa6-c79bce52d216"],
Cell[11578, 267, 1923, 46, 115, "Input",ExpressionUUID->"64d369d8-b6c2-4ca1-9fa9-166acaa85eb4"],
Cell[13504, 315, 1205, 29, 94, "Input",ExpressionUUID->"727cb9d1-26bc-4813-9c41-e2f34fa2c6b4"],
Cell[14712, 346, 1203, 29, 94, "Input",ExpressionUUID->"0b136008-a9a4-458d-98c3-b3d459fbd43b"],
Cell[15918, 377, 1453, 30, 136, "Input",ExpressionUUID->"b9977b93-b479-4e9b-b062-18b6eb20b16d"],
Cell[17374, 409, 1390, 29, 136, "Input",ExpressionUUID->"efcd3ba2-779a-457b-b65d-122d6cb52eff"],
Cell[18767, 440, 679, 12, 74, "Text",ExpressionUUID->"ad7e2d75-ca1d-4691-a8b2-c742aa18e6b2"],
Cell[19449, 454, 843, 22, 82, "Input",ExpressionUUID->"7b252ab2-4250-4aa7-858e-47c795cb402d"],
Cell[20295, 478, 728, 20, 30, "Input",ExpressionUUID->"f5c006ec-597f-4983-82b5-4e581cec625a"]
}, Closed]],
Cell[CellGroupData[{
Cell[21060, 503, 404, 6, 38, "Subsection",ExpressionUUID->"25c66ec3-ab31-460d-89cd-dfa993773da1"],
Cell[CellGroupData[{
Cell[21489, 513, 175, 3, 45, "Subsubsection",ExpressionUUID->"bb0fc1a5-4674-4140-8484-e851d4cf3e0d"],
Cell[21667, 518, 179, 4, 30, "Input",ExpressionUUID->"c5daa864-2799-4c5b-bca9-c9a3a2bf8039"],
Cell[21849, 524, 206, 3, 30, "Input",ExpressionUUID->"2166fd91-f669-4e58-baae-5ebee4562eeb"],
Cell[22058, 529, 4268, 118, 333, "Input",ExpressionUUID->"40ec03f4-4193-47d4-8ae3-436df527e70b"],
Cell[26329, 649, 3025, 87, 239, "Input",ExpressionUUID->"4c01172d-5400-4a12-be24-cb5ced6f6d81"],
Cell[29357, 738, 2122, 52, 98, "Input",ExpressionUUID->"9e9c9915-7089-46b9-96f3-b8bebf75ac25"],
Cell[31482, 792, 278, 5, 30, "Input",ExpressionUUID->"8c706810-1ced-4b31-b3e6-8efba3b2c1be"],
Cell[31763, 799, 7550, 180, 539, "Input",ExpressionUUID->"025e2b7c-0e12-411d-b136-57cbfc91bda0"],
Cell[39316, 981, 7151, 170, 587, "Input",ExpressionUUID->"087b3902-363d-46ba-bdd6-11d0b22c97a8"],
Cell[46470, 1153, 806, 21, 52, "Input",ExpressionUUID->"832a8e5c-9dd4-463f-ae95-3bde02f1e5ff"],
Cell[47279, 1176, 1078, 26, 33, "Input",ExpressionUUID->"a6c67862-6e88-4288-8d15-c527c81faf38"]
}, Closed]],
Cell[CellGroupData[{
Cell[48394, 1207, 220, 4, 37, "Subsubsection",ExpressionUUID->"3039824a-f227-4973-80ef-d4712df34e8a"],
Cell[48617, 1213, 152, 3, 30, "Input",ExpressionUUID->"022de9d9-d67e-45fd-9f6d-d39caffb7427"],
Cell[48772, 1218, 3774, 103, 374, "Input",ExpressionUUID->"a718dae9-6737-4e1d-9aa2-4879431916b3"],
Cell[52549, 1323, 1422, 39, 172, "Input",ExpressionUUID->"846845d4-6b35-4ec3-aa42-14dedbba4aaf"],
Cell[53974, 1364, 472, 8, 52, "Input",ExpressionUUID->"5efc2e92-0dc2-430b-bd71-a655509da29b"],
Cell[54449, 1374, 7596, 180, 812, "Input",ExpressionUUID->"37bda897-8074-4e62-b0d0-0d1462883c15"],
Cell[62048, 1556, 2754, 74, 280, "Input",ExpressionUUID->"108a6c3b-4f5c-48d0-abe0-1fe4939b49c1"]
}, Closed]],
Cell[CellGroupData[{
Cell[64839, 1635, 173, 3, 37, "Subsubsection",ExpressionUUID->"d6e8842f-9194-4129-8ebb-9251138433ae"],
Cell[65015, 1640, 3778, 86, 388, "Input",ExpressionUUID->"978fd682-eb7b-4061-96b9-9bde6a1cd8a2"],
Cell[68796, 1728, 8353, 178, 493, "Input",ExpressionUUID->"3ec26ec5-6300-4218-9b6e-0cf284f7ffe9"],
Cell[77152, 1908, 3844, 82, 325, "Input",ExpressionUUID->"3082cd77-ee39-49f1-a19f-ed7442109d3b"],
Cell[80999, 1992, 1169, 31, 94, "Input",ExpressionUUID->"2ec6ae8b-766d-478d-9451-9abe21d4fcdc"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[82217, 2029, 335, 5, 54, "Subsection",ExpressionUUID->"f5ef098b-14ed-49ea-b5bb-36d9a9e38e5b"],
Cell[82555, 2036, 312, 5, 51, "Text",ExpressionUUID->"6d425349-4653-488a-8975-4d3dedc11822"],
Cell[82870, 2043, 559, 13, 52, "Input",ExpressionUUID->"971acab8-3339-4403-9a92-6b6224297a3e"],
Cell[83432, 2058, 298, 5, 51, "Text",ExpressionUUID->"778730d1-7ef0-4a06-a5cb-5e932df12504"],
Cell[83733, 2065, 1502, 42, 73, "Input",ExpressionUUID->"6e8705e9-d0b9-4db9-94df-db9dd3c646a3"],
Cell[85238, 2109, 255, 4, 51, "Text",ExpressionUUID->"85b386b8-c8b0-440f-8d3d-edf72889261b"],
Cell[85496, 2115, 237, 5, 30, "Input",ExpressionUUID->"bb411e9d-1ed1-47be-b99f-49f5a7b8f470"],
Cell[85736, 2122, 752, 20, 30, "Input",ExpressionUUID->"1c5bccdb-f8fc-49f3-85d0-cfbbde85c284"],
Cell[86491, 2144, 704, 18, 52, "Input",ExpressionUUID->"58e3843d-655b-4d60-826c-c880a23fd6d1"],
Cell[87198, 2164, 434, 11, 30, "Input",ExpressionUUID->"b1052b42-2912-4ca8-9b7a-57230b4e7eb6"],
Cell[87635, 2177, 403, 11, 30, "Input",ExpressionUUID->"d6023fac-4807-4957-9d82-68c450c2ecc0"],
Cell[88041, 2190, 1387, 32, 115, "Input",ExpressionUUID->"85e2a7ba-b144-4623-9e70-7bdcaae4dd80"],
Cell[89431, 2224, 352, 5, 51, "Text",ExpressionUUID->"74e5c31e-109c-451d-8381-75c901ee6b94"],
Cell[89786, 2231, 3681, 94, 298, "Input",ExpressionUUID->"6b4b0f06-913c-4d0f-8c18-0d3eccf81b59"],
Cell[93470, 2327, 6356, 166, 635, "Input",ExpressionUUID->"06d3e33c-7879-49d7-8184-4c3c07d5e128"],
Cell[99829, 2495, 1119, 29, 132, "Input",ExpressionUUID->"79c162f1-920e-4f1f-9a56-289e0fa881d8"],
Cell[100951, 2526, 356, 5, 51, "Text",ExpressionUUID->"d20b1ac4-cb64-4f44-8a0b-bd393efdb593"],
Cell[101310, 2533, 1225, 40, 99, "Input",ExpressionUUID->"ff7c2431-fbfe-4c01-ad27-2d9197d1a0d1"],
Cell[102538, 2575, 384, 11, 30, "Input",ExpressionUUID->"af17259b-5cfa-49cc-91de-6d9292a79614"],
Cell[102925, 2588, 580, 10, 51, "Text",ExpressionUUID->"60dffee5-611f-402a-8813-1c82412b2275"],
Cell[103508, 2600, 2505, 65, 255, "Input",ExpressionUUID->"81e1afc6-e286-4f5c-89cb-2aba061bee3c"],
Cell[106016, 2667, 465, 7, 51, "Text",ExpressionUUID->"a8cc46e0-b9b4-493d-841a-8030145167b9"],
Cell[106484, 2676, 381, 8, 30, "Input",ExpressionUUID->"4af7fa3a-bad6-494f-9bfd-ebce401c425b"],
Cell[106868, 2686, 335, 7, 30, "Input",ExpressionUUID->"eee4da9b-1ecc-439f-b792-17eb08006ea0"],
Cell[107206, 2695, 6329, 159, 558, "Input",ExpressionUUID->"8435758a-33a9-4500-8ee7-eb8cf94c8f50"],
Cell[113538, 2856, 1573, 43, 121, "Text",ExpressionUUID->"619b7472-2da0-4ae2-b05c-ba44563bc9cf"],
Cell[115114, 2901, 669, 19, 36, "Input",ExpressionUUID->"a2c753d7-1155-4e7a-9acd-aa1a5e097904"],
Cell[115786, 2922, 651, 16, 50, "Input",ExpressionUUID->"716c90bd-d319-423e-b094-8421cb83fd06"],
Cell[116440, 2940, 1033, 26, 96, "Input",ExpressionUUID->"7b7febd2-eea0-41ef-bfc2-a9bbc3f56a52"],
Cell[117476, 2968, 566, 13, 51, "Input",ExpressionUUID->"999fa4ac-711b-4561-ae19-a61f9562706a"],
Cell[118045, 2983, 724, 19, 51, "Input",ExpressionUUID->"79cf17b6-7609-49cd-81e8-ba259ef6f352"],
Cell[118772, 3004, 397, 11, 52, "Input",ExpressionUUID->"bcb67c7c-09a6-43ff-a8f4-948a4e7e6258"],
Cell[119172, 3017, 1792, 48, 94, "Input",ExpressionUUID->"d1af40fc-a3aa-42d1-9d29-289cc38a77f5"],
Cell[120967, 3067, 5546, 171, 273, "Input",ExpressionUUID->"d2c79a09-6a0a-4339-974d-778ea2fd1869"],
Cell[126516, 3240, 3716, 96, 157, "Input",ExpressionUUID->"0ca32de3-28db-466c-9136-d672ca48fb55"],
Cell[130235, 3338, 471, 7, 51, "Text",ExpressionUUID->"e916508c-dd8a-476e-80f9-a8e69bd2768a"],
Cell[130709, 3347, 376, 8, 30, "Input",ExpressionUUID->"c49c3e5a-8382-48ad-b12e-b325105ad884"],
Cell[131088, 3357, 527, 15, 30, "Input",ExpressionUUID->"1ec008f5-718c-4fb5-8f9a-69081c56f0e3"],
Cell[131618, 3374, 393, 11, 30, "Input",ExpressionUUID->"97e8837d-dcac-4282-8afa-06c0234e727e"],
Cell[132014, 3387, 720, 18, 73, "Input",ExpressionUUID->"a30843de-1e4e-4461-bd26-646868ee535b"],
Cell[132737, 3407, 535, 15, 52, "Input",ExpressionUUID->"338c8c5b-0578-4fc9-b3db-c38444b671d3"],
Cell[133275, 3424, 765, 16, 30, "Input",ExpressionUUID->"8e68517c-5fca-47b6-89de-67398ddbf20a"],
Cell[134043, 3442, 348, 9, 33, "Input",ExpressionUUID->"cf22dfb5-1624-47eb-871b-1fc2f093ac7f"],
Cell[134394, 3453, 1495, 45, 96, "Input",ExpressionUUID->"c1569188-8903-4b57-9af0-1da2378502a5"],
Cell[135892, 3500, 953, 28, 52, "Input",ExpressionUUID->"6d8f9654-fc31-4693-8f4a-54482e0251f3"],
Cell[136848, 3530, 1521, 46, 96, "Input",ExpressionUUID->"6d400552-7ff6-451c-9af6-4acc0c6a9c1f"]
}, Closed]],
Cell[CellGroupData[{
Cell[138406, 3581, 330, 5, 38, "Subsection",ExpressionUUID->"7e9fea05-58dd-498a-91e5-90a2af6bc953"],
Cell[138739, 3588, 576, 10, 51, "Text",ExpressionUUID->"8e7ee30e-3f09-44a0-9aab-b7e392f62c61"],
Cell[139318, 3600, 266, 6, 30, "Input",ExpressionUUID->"e589d87f-4d2b-4ced-bb56-368bb2316e35"],
Cell[139587, 3608, 1911, 37, 131, "Input",ExpressionUUID->"6e6ad3fd-3027-4efe-aad9-489166cdb6dc"],
Cell[141501, 3647, 2177, 41, 139, "Input",ExpressionUUID->"d8e728df-dcbe-4674-9faa-681d79bac729"],
Cell[CellGroupData[{
Cell[143703, 3692, 392, 7, 30, "Input",ExpressionUUID->"85cbd5c8-367d-4703-9998-a27437e25120"],
Cell[144098, 3701, 226, 4, 70, "Output",ExpressionUUID->"dfb8cfad-730d-4822-a05c-2837520c270a"]
}, Closed]],
Cell[CellGroupData[{
Cell[144361, 3710, 183, 3, 30, "Input",ExpressionUUID->"062d1f52-579b-4d34-a0c2-89d3f1dc7427"],
Cell[144547, 3715, 203, 3, 70, "Output",ExpressionUUID->"5417008b-dccd-4c83-9f35-40ea7c04f5b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[144787, 3723, 179, 3, 30, "Input",ExpressionUUID->"98c5eee4-2fc1-4ad8-a3a9-b01c4ac1dbed"],
Cell[144969, 3728, 251, 4, 70, "Output",ExpressionUUID->"3e30b754-02d2-4c05-9556-4e7cac908c74"]
}, Closed]],
Cell[145235, 3735, 532, 8, 51, "Text",ExpressionUUID->"026e7d0f-0a78-4f78-a015-84a7542894b4"],
Cell[145770, 3745, 841, 24, 73, "Input",ExpressionUUID->"1e4f7bea-c99e-4d0d-9f4a-954b4f4d13a0"],
Cell[146614, 3771, 1122, 24, 56, "Input",ExpressionUUID->"83029c53-5fba-487a-bc3c-ba1b1732111e"],
Cell[147739, 3797, 1031, 24, 94, "Input",ExpressionUUID->"6e5789f9-6c64-4e40-9f81-de27a1da9b73"],
Cell[148773, 3823, 2222, 56, 214, "Input",ExpressionUUID->"852a7693-b4af-46a5-bca8-68776dcf7ba5"],
Cell[150998, 3881, 412, 9, 30, "Input",ExpressionUUID->"65ed3252-ec1b-4459-93b4-80750f6214b3"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[151459, 3896, 164, 3, 53, "Section",ExpressionUUID->"00b26582-c588-4834-9a8c-1703cc1bec56"],
Cell[CellGroupData[{
Cell[151648, 3903, 234, 4, 54, "Subsection",ExpressionUUID->"b779b216-13ad-447b-b266-ba4041cc7c94"],
Cell[151885, 3909, 203, 3, 51, "Text",ExpressionUUID->"143e2293-4a92-4f40-bae2-3b43d1cfc047"],
Cell[152091, 3914, 3526, 78, 117, "Input",ExpressionUUID->"9796360f-e760-486e-9003-cb4d3a77e2cd"],
Cell[155620, 3994, 1089, 21, 30, "Input",ExpressionUUID->"f26bed4d-91fa-45c2-8ac6-545f1575cb3f"],
Cell[156712, 4017, 361, 9, 30, "Input",ExpressionUUID->"b41c5220-a2cd-4b4a-9650-48fe001b51ef"],
Cell[157076, 4028, 206, 3, 51, "Text",ExpressionUUID->"33bf4e33-8438-4ec7-8e1d-50873ed97486"],
Cell[157285, 4033, 1335, 23, 94, "Input",ExpressionUUID->"0ae28508-d84d-44f5-bede-7fbecd4eef9c"],
Cell[158623, 4058, 501, 13, 30, "Input",ExpressionUUID->"9ef83cde-5298-4633-8cfa-89006bd2a275"],
Cell[159127, 4073, 504, 13, 52, "Input",ExpressionUUID->"e58ac727-bcc3-48c8-9a7d-c86b0ba519b5"],
Cell[159634, 4088, 832, 17, 52, "Input",ExpressionUUID->"67632711-2db4-4629-9025-64d7909ad89f"],
Cell[160469, 4107, 766, 17, 52, "Input",ExpressionUUID->"e825a6da-26b5-4668-8402-2486341b330b"],
Cell[161238, 4126, 261, 7, 30, "Input",ExpressionUUID->"d95c04f1-6976-4fe1-97a8-5aea802e451b"],
Cell[161502, 4135, 1367, 29, 52, "Input",ExpressionUUID->"c2de7523-6917-4ae2-b362-d37626324ba9"],
Cell[162872, 4166, 1073, 25, 52, "Input",ExpressionUUID->"1f0ac6e4-4b71-4ae6-b07a-88e9f74b0cae"],
Cell[163948, 4193, 1044, 34, 94, "Input",ExpressionUUID->"8a9500e4-5e27-454b-9230-f56e73a2083f"],
Cell[164995, 4229, 1102, 16, 30, "Input",ExpressionUUID->"d7e98747-9c33-4193-af1f-6b3ff72c6810"],
Cell[166100, 4247, 1994, 50, 136, "Input",ExpressionUUID->"60a1d0cf-8815-4025-88ec-62df55e2f189"],
Cell[168097, 4299, 547, 14, 52, "Input",ExpressionUUID->"238f672d-5a20-466b-afab-0b64f2c6530a"],
Cell[168647, 4315, 434, 11, 51, "Text",ExpressionUUID->"fd17723e-204a-4f59-9fe0-a015aa1acae8"],
Cell[169084, 4328, 948, 26, 60, "Input",ExpressionUUID->"f002eac3-2d1e-4eb4-95e2-5dd8e21d8108"],
Cell[170035, 4356, 1021, 29, 73, "Input",ExpressionUUID->"a07da269-ee19-40a0-ae72-f80b7eecece2"]
}, Closed]],
Cell[CellGroupData[{
Cell[171093, 4390, 242, 4, 54, "Subsection",ExpressionUUID->"816000c8-012c-4b8e-9dbe-a4508edc0e25"],
Cell[171338, 4396, 247, 4, 51, "Text",ExpressionUUID->"66d50b1c-2f4e-4e2f-ab0a-85522688b257"],
Cell[171588, 4402, 3160, 75, 122, "Input",ExpressionUUID->"98e39fdc-89c9-46a8-b61a-501cf97f19ac"],
Cell[174751, 4479, 3008, 80, 227, "Input",ExpressionUUID->"5304d4fb-e9d1-4796-b574-6d78340a2622"],
Cell[177762, 4561, 248, 4, 51, "Text",ExpressionUUID->"0e63b1cf-3b95-4502-8484-3ac421fcf19f"],
Cell[178013, 4567, 4129, 88, 123, "Input",ExpressionUUID->"06f25064-487f-4eba-ae11-79c3a764cd16"],
Cell[182145, 4657, 3073, 81, 207, "Input",ExpressionUUID->"b8cd1ea9-14a4-4cf6-81c9-eafb8684975a"],
Cell[185221, 4740, 294, 5, 51, "Text",ExpressionUUID->"187c7b9c-5917-4d8c-8eb4-e891156897d5"],
Cell[185518, 4747, 10097, 177, 207, "Input",ExpressionUUID->"ff622c39-80c5-4dfd-ba35-82583834364b"],
Cell[195618, 4926, 4482, 118, 335, "Input",ExpressionUUID->"d651b22c-4fb0-4eb3-800a-3df0eaeddc0d"],
Cell[200103, 5046, 439, 11, 51, "Text",ExpressionUUID->"f51974f7-dd55-4110-90e0-833a9dfb0ede"],
Cell[200545, 5059, 2264, 46, 73, "Input",ExpressionUUID->"5e0d1e2b-1af2-4617-8399-7e016095483e"],
Cell[202812, 5107, 252, 4, 51, "Text",ExpressionUUID->"d9be7222-a543-4ffd-8fa2-70d89d83e68c"],
Cell[203067, 5113, 923, 24, 73, "Input",ExpressionUUID->"4a13301e-c83c-4bed-a0c3-0b17b4bffc28"],
Cell[203993, 5139, 944, 24, 73, "Input",ExpressionUUID->"cf6ae302-e02b-404b-934f-d50924d9ae0a"]
}, Closed]],
Cell[CellGroupData[{
Cell[204974, 5168, 158, 3, 38, "Subsection",ExpressionUUID->"a5429fc0-2b11-4863-aff0-30133bfe0b63"],
Cell[205135, 5173, 311, 5, 51, "Text",ExpressionUUID->"15e6540c-63a2-41ba-afe2-743869dd62bd"],
Cell[205449, 5180, 1242, 26, 48, "Input",ExpressionUUID->"0f0e5298-5fe4-4737-83c1-3511a8bbb389"],
Cell[206694, 5208, 1310, 37, 78, "Input",ExpressionUUID->"72dc809b-3549-4efc-8a81-4aa70e486c80"],
Cell[208007, 5247, 962, 25, 52, "Input",ExpressionUUID->"4d7fa0d1-a71b-4a5f-a509-a52357064b28"],
Cell[208972, 5274, 907, 21, 52, "Input",ExpressionUUID->"2902ebc7-e022-48d5-a57a-c5b44250bb8a"]
}, Closed]],
Cell[CellGroupData[{
Cell[209916, 5300, 211, 4, 38, "Subsection",ExpressionUUID->"d4596cea-1bc3-4949-b44f-1392b33a9c8d"],
Cell[210130, 5306, 386, 6, 51, "Text",ExpressionUUID->"9c2498f0-5d67-49d9-832a-1378f3fca788"],
Cell[210519, 5314, 1130, 29, 30, "Input",ExpressionUUID->"af6562c7-0617-41c9-96dd-b40c10aba6d0"],
Cell[211652, 5345, 691, 16, 49, "Input",ExpressionUUID->"b128058f-57af-470d-b495-38ea9f842386"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[212392, 5367, 161, 3, 53, "Section",ExpressionUUID->"bbbfab1c-ea48-4e9f-80f8-8aaf0e7b2a7a"],
Cell[CellGroupData[{
Cell[212578, 5374, 177, 3, 54, "Subsection",ExpressionUUID->"164fe5e2-168a-449d-8d47-0e988c75358f"],
Cell[212758, 5379, 398, 6, 51, "Text",ExpressionUUID->"e38a07d3-7c17-4b2d-b673-73812cdbc2de"],
Cell[213159, 5387, 2084, 52, 157, "Input",ExpressionUUID->"69066abc-71f9-4402-9ad7-75eeffc1e262"],
Cell[215246, 5441, 368, 6, 51, "Text",ExpressionUUID->"e15b6dbc-89cd-4528-9b7a-d9e079999e69"],
Cell[215617, 5449, 2027, 52, 157, "Input",ExpressionUUID->"fd13622b-e967-4988-a646-881a81b42b72"],
Cell[217647, 5503, 400, 6, 51, "Text",ExpressionUUID->"17a5fae5-1824-428d-a942-ebb272e75fa2"],
Cell[218050, 5511, 2552, 64, 178, "Input",ExpressionUUID->"d163c88a-dc2d-4481-9b8c-818911358d3a"],
Cell[220605, 5577, 486, 7, 51, "Text",ExpressionUUID->"61e57361-55b3-4f1e-8024-c881e518ddcf"],
Cell[221094, 5586, 160, 4, 30, "Input",ExpressionUUID->"e8eef5c0-a360-4100-ba04-ec5019197d15"],
Cell[221257, 5592, 310, 8, 30, "Input",ExpressionUUID->"0743e738-58fd-4eed-868f-7532d33ab8a5"],
Cell[221570, 5602, 447, 11, 52, "Input",ExpressionUUID->"5eae9468-0dd3-40c7-b05a-72355c9142bb"],
Cell[222020, 5615, 470, 10, 30, "Input",ExpressionUUID->"2f494f15-2a14-417f-92b7-55b664fa7f0c"]
}, Closed]],
Cell[CellGroupData[{
Cell[222527, 5630, 187, 3, 54, "Subsection",ExpressionUUID->"d9b52e95-387f-41ac-b95e-66a9adc55bc6"],
Cell[222717, 5635, 295, 5, 51, "Text",ExpressionUUID->"96ad5bac-91d9-4013-8a37-af1b80f601b1"],
Cell[223015, 5642, 798, 24, 51, "Input",ExpressionUUID->"2b7d5043-6406-4148-81a8-7c3dbaf9c171"],
Cell[223816, 5668, 249, 4, 51, "Text",ExpressionUUID->"5342e184-95a8-4080-bd7a-51595e2f006c"],
Cell[224068, 5674, 1036, 20, 30, "Input",ExpressionUUID->"4117c101-afbb-4352-9eb8-62cb0b48f801"],
Cell[225107, 5696, 693, 15, 52, "Input",ExpressionUUID->"ac2b902c-cb2a-41ea-80f6-63319157bad7"],
Cell[225803, 5713, 203, 3, 51, "Text",ExpressionUUID->"95d78b4e-0149-4845-bf37-cdf1f7fd22ab"],
Cell[226009, 5718, 772, 14, 30, "Input",ExpressionUUID->"e784f08d-1a72-4046-8b27-5dd17bdd4dc0"],
Cell[226784, 5734, 747, 16, 94, "Input",ExpressionUUID->"4fb5ab4e-5e46-4a3d-8783-3967e4e96aab"],
Cell[227534, 5752, 1389, 31, 94, "Input",ExpressionUUID->"c7e3e15a-5572-44f9-bcf9-b75a9fd08619"],
Cell[228926, 5785, 584, 8, 51, "Text",ExpressionUUID->"c584b5f8-2bbf-4f80-8491-909de779c10e"],
Cell[229513, 5795, 1561, 38, 94, "Input",ExpressionUUID->"bf74b555-004b-4aa5-bc24-52b3b5f5c04d"],
Cell[231077, 5835, 5698, 154, 283, "Input",ExpressionUUID->"7a7bfb55-37f4-482d-a5a0-864c9846aa6a"],
Cell[236778, 5991, 1518, 44, 94, "Input",ExpressionUUID->"9a4370b9-0c4f-47a1-81fb-6a9e361bcd5b"],
Cell[238299, 6037, 831, 16, 51, "Text",ExpressionUUID->"db8717c5-3043-4e73-bc81-78ec74cd8b02"],
Cell[239133, 6055, 4061, 124, 270, "Input",ExpressionUUID->"8ecdd776-4a04-48fd-b1fc-f2155b66b033"],
Cell[243197, 6181, 1193, 24, 52, "Input",ExpressionUUID->"36578b07-a9e6-4d62-8435-8e80751596a5"],
Cell[244393, 6207, 1415, 37, 98, "Input",ExpressionUUID->"70633310-4b28-4269-bcd8-ae88194c95b0"]
}, Closed]],
Cell[CellGroupData[{
Cell[245845, 6249, 373, 6, 38, "Subsection",ExpressionUUID->"be273922-cf85-48f2-b567-ce8e49ed9c91"],
Cell[246221, 6257, 247, 4, 51, "Text",ExpressionUUID->"3984dd4c-7f2f-40b8-ae20-e359e0eb5d8f"],
Cell[246471, 6263, 2903, 74, 216, "Input",ExpressionUUID->"b622d883-6d9b-45d0-9810-47745c169763"],
Cell[249377, 6339, 3862, 102, 312, "Input",ExpressionUUID->"e6a243a5-8a37-46f8-be32-6bf25f8d1464"],
Cell[253242, 6443, 301, 5, 51, "Text",ExpressionUUID->"e6c09c1f-29e5-4d4f-9ed9-1aead7ed35cb"],
Cell[253546, 6450, 3014, 75, 237, "Input",ExpressionUUID->"8b2a2d83-7ec1-4a1f-9bfd-aee6ac296186"],
Cell[256563, 6527, 3836, 98, 354, "Input",ExpressionUUID->"fcf42c47-435b-44fb-8da2-fcaf6ea79522"],
Cell[260402, 6627, 301, 5, 51, "Text",ExpressionUUID->"49713e2d-5320-4ff4-a829-e95b2c940041"],
Cell[260706, 6634, 2857, 73, 237, "Input",ExpressionUUID->"9d2f7f1b-158d-4188-b2d1-682e240262c1"],
Cell[263566, 6709, 244, 4, 51, "Text",ExpressionUUID->"abb50693-07d9-4fac-9bc0-b1a210de49e6"],
Cell[263813, 6715, 13193, 264, 468, "Input",ExpressionUUID->"2a9c5658-5b6c-4d01-a8bf-614b7f748fc6"],
Cell[277009, 6981, 226, 5, 30, "Input",ExpressionUUID->"991bf284-d7a3-43c6-8e1e-1da67e8b0835"],
Cell[277238, 6988, 567, 16, 52, "Input",ExpressionUUID->"79821132-7a28-46d9-a39e-3f09563aa485"],
Cell[277808, 7006, 3132, 80, 292, "Input",ExpressionUUID->"590e8144-7138-4a04-8a27-2e5b6a368784"],
Cell[280943, 7088, 438, 11, 51, "Text",ExpressionUUID->"dac10884-28f4-4fb2-8d09-c5a57c55c012"],
Cell[281384, 7101, 1749, 43, 94, "Input",ExpressionUUID->"94a05fc9-0e94-49db-8e61-5afa6f698758"],
Cell[283136, 7146, 301, 5, 51, "Text",ExpressionUUID->"810f947c-f552-45ea-a938-88f91048db49"],
Cell[283440, 7153, 735, 18, 52, "Input",ExpressionUUID->"165fa182-9d60-4e48-8a36-f7f5fb3a8f6f"],
Cell[284178, 7173, 773, 18, 73, "Input",ExpressionUUID->"39077c17-6683-4dd6-a52d-30a7c4559f31"],
Cell[284954, 7193, 634, 16, 52, "Input",ExpressionUUID->"86537da6-3e93-459d-9520-d1a506950393"]
}, Closed]],
Cell[CellGroupData[{
Cell[285625, 7214, 158, 3, 38, "Subsection",ExpressionUUID->"99f28e4a-e57c-4773-bbca-cebf32e88197"],
Cell[285786, 7219, 323, 5, 51, "Text",ExpressionUUID->"c3bb5283-1117-490b-ae74-8d70551b250e"],
Cell[286112, 7226, 816, 14, 30, "Input",ExpressionUUID->"7412adde-b56f-43e7-a583-32bc21223add"],
Cell[286931, 7242, 1254, 36, 133, "Input",ExpressionUUID->"f26fc93a-5cf3-4fbc-959d-8888d2e26f7e"],
Cell[288188, 7280, 2973, 76, 303, "Input",ExpressionUUID->"5a5831d3-b960-4146-9dba-1181de52411a"],
Cell[291164, 7358, 1183, 29, 73, "Input",ExpressionUUID->"8fc212e2-7337-453f-9aee-744cb115b18d"],
Cell[292350, 7389, 911, 22, 73, "Input",ExpressionUUID->"a61dffc7-bf11-4d0d-b140-23e175a0e46f"]
}, Closed]],
Cell[CellGroupData[{
Cell[293298, 7416, 185, 3, 38, "Subsection",ExpressionUUID->"4fe3de66-21b3-4c5a-be9f-707276117855"],
Cell[293486, 7421, 707, 17, 53, "Text",ExpressionUUID->"2babe7ef-2dd0-47f4-995f-410a2875583c"],
Cell[294196, 7440, 3835, 114, 98, "Input",ExpressionUUID->"4df8506e-58f6-4746-bc48-1f271c86a2ba"],
Cell[298034, 7556, 1709, 50, 56, "Input",ExpressionUUID->"fbc44887-2a75-4662-af80-df82392ccb8a"],
Cell[299746, 7608, 28892, 871, 686, "Input",ExpressionUUID->"55a41371-4021-46f1-9644-af34136f58d0"],
Cell[328641, 8481, 346, 5, 51, "Text",ExpressionUUID->"ec6cb975-2ed7-4bae-9021-eb27018da57d"],
Cell[328990, 8488, 2055, 66, 135, "Input",ExpressionUUID->"d6479bbd-7f25-420c-91ee-0c832c2489ca"],
Cell[331048, 8556, 369, 5, 51, "Text",ExpressionUUID->"74d801be-62c0-4b83-b796-d338240e759b"],
Cell[331420, 8563, 454, 11, 52, "Input",ExpressionUUID->"323dc9b6-dd27-488d-ab9c-98c3cd4c92f3"],
Cell[331877, 8576, 639, 14, 52, "Input",ExpressionUUID->"10674e12-38db-46ed-afa5-9c3b3c3f7f8a"],
Cell[332519, 8592, 426, 11, 30, "Input",ExpressionUUID->"71b280ad-a3a5-42aa-93a0-a3d7df1bca81"],
Cell[332948, 8605, 357, 5, 51, "Text",ExpressionUUID->"9736a62d-ed9f-4a14-8e61-b896d6cfd8bc"],
Cell[333308, 8612, 863, 20, 73, "Input",ExpressionUUID->"f8f2b696-f4d4-4f82-9d83-41f2bedee38f"]
}, Closed]],
Cell[CellGroupData[{
Cell[334208, 8637, 163, 3, 38, "Subsection",ExpressionUUID->"33d2b6cf-e331-4a8a-b16b-04f358671ac8"],
Cell[334374, 8642, 355, 5, 51, "Text",ExpressionUUID->"28d15ee9-25f6-4b9d-85d0-a0c5212dc392"],
Cell[334732, 8649, 1138, 25, 95, "Input",ExpressionUUID->"e3aab1b7-e4bd-4849-928e-50d6fac3553d"],
Cell[335873, 8676, 355, 5, 51, "Text",ExpressionUUID->"887afaf2-2039-4194-9e4d-70e46346e643"],
Cell[336231, 8683, 1552, 35, 94, "Input",ExpressionUUID->"5ecb1ffc-348c-400d-84bc-423bc8ac67d6"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[337832, 8724, 165, 3, 53, "Section",ExpressionUUID->"37e06d60-ed39-4764-9d3f-af8b6361fdfd"],
Cell[338000, 8729, 590, 10, 97, "Text",ExpressionUUID->"30609e82-d5bc-4d38-b8db-b160b29e1767"],
Cell[338593, 8741, 392, 11, 30, "Input",ExpressionUUID->"7febd96f-2bb1-41c2-90a6-a8a66aa1f01c"],
Cell[CellGroupData[{
Cell[339010, 8756, 235, 4, 54, "Subsection",ExpressionUUID->"4d9b7026-2b06-49ab-84b2-b79eeb996566"],
Cell[339248, 8762, 301, 5, 51, "Text",ExpressionUUID->"8d50c7c3-4c27-482c-a02f-5839f4cba3b1"],
Cell[339552, 8769, 3612, 67, 115, "Input",ExpressionUUID->"1ff3e4cf-d700-40c6-a76a-49a95d67beee"],
Cell[343167, 8838, 347, 5, 51, "Text",ExpressionUUID->"0b8e8337-7119-45c5-a554-e602644305d3"],
Cell[343517, 8845, 9304, 152, 178, "Input",ExpressionUUID->"cf6d3a69-b5dd-420c-96f8-2a1e465cdedd"],
Cell[352824, 8999, 252, 4, 51, "Text",ExpressionUUID->"71e5f4f0-1091-4d45-90f5-c80700feb71b"],
Cell[353079, 9005, 787, 20, 52, "Input",ExpressionUUID->"517d0b99-8a7d-4884-921f-7e1cecd67caf"],
Cell[353869, 9027, 405, 6, 51, "Text",ExpressionUUID->"5a469737-41b2-4ae9-a36d-cdaccd6561ef"],
Cell[354277, 9035, 1274, 23, 30, "Input",ExpressionUUID->"c0c07320-c04c-4774-b27a-d7028156be50"],
Cell[355554, 9060, 667, 10, 51, "Text",ExpressionUUID->"80bbe19c-ff6c-471d-8f0a-d53ecfcf9f32"],
Cell[356224, 9072, 445, 14, 30, "Input",ExpressionUUID->"c079a9c3-8794-4a15-ac91-d754d7cb0df5"],
Cell[356672, 9088, 799, 11, 51, "Text",ExpressionUUID->"e4547cb3-2bba-4016-bb65-6fede9eeb8c8"],
Cell[357474, 9101, 720, 19, 53, "Input",ExpressionUUID->"caa0405e-10ae-4f4c-8dc4-e63e7d2a4ab3"]
}, Closed]],
Cell[CellGroupData[{
Cell[358231, 9125, 158, 3, 38, "Subsection",ExpressionUUID->"e68f8153-e855-44de-baa3-cb042808f833"],
Cell[358392, 9130, 279, 8, 30, "Input",ExpressionUUID->"ebd61ba3-34d7-463f-8cfc-931fe63e7166"],
Cell[358674, 9140, 563, 10, 51, "Text",ExpressionUUID->"edf20ab2-8bfc-48a5-91c7-473977fcf81a"],
Cell[359240, 9152, 2648, 70, 237, "Input",ExpressionUUID->"c959aa41-70a8-4f3c-8042-86b6dff61097"],
Cell[361891, 9224, 737, 18, 52, "Input",ExpressionUUID->"4710148e-890f-4dbf-b487-8da361e88b86"],
Cell[362631, 9244, 747, 11, 51, "Text",ExpressionUUID->"7efb0c1e-264f-49e0-b42d-5e8258b69cfb"],
Cell[363381, 9257, 1359, 37, 51, "Input",ExpressionUUID->"96bcac3e-a9f2-499d-9273-aaa54eb40e4c"],
Cell[364743, 9296, 451, 7, 51, "Text",ExpressionUUID->"3507cf5b-4222-4cc0-90ee-f79eebe67fbe"],
Cell[365197, 9305, 1138, 32, 76, "Input",ExpressionUUID->"e83a5ef4-bafe-45f6-8842-c489975aaf5f"]
}, Closed]],
Cell[CellGroupData[{
Cell[366372, 9342, 165, 3, 38, "Subsection",ExpressionUUID->"f332b2c4-be8f-43ac-85b3-fa1d991f17d7"],
Cell[366540, 9347, 630, 15, 30, "Input",ExpressionUUID->"c4eea684-4e5f-4fd2-a5b3-0f00da893254"],
Cell[367173, 9364, 1609, 46, 100, "Input",ExpressionUUID->"41d9f9ff-74f2-4397-9c29-c6473a928169"],
Cell[368785, 9412, 3424, 102, 307, "Input",ExpressionUUID->"b782efce-9198-4d77-9940-8e44a0f22a91"],
Cell[372212, 9516, 1235, 24, 52, "Input",ExpressionUUID->"9dd45791-9dcc-4c58-98cb-be888977b03e"],
Cell[373450, 9542, 1200, 25, 52, "Input",ExpressionUUID->"37b38672-fb30-472b-998e-8f637283a8cf"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[374699, 9573, 236, 4, 53, "Section",ExpressionUUID->"43470e4e-35d6-4714-829a-9b87beef6ae7"],
Cell[374938, 9579, 549, 8, 51, "Text",ExpressionUUID->"cd2b709a-fe4f-4880-99f6-39b0cb34d662"],
Cell[375490, 9589, 287, 7, 30, "Input",ExpressionUUID->"e38dd6f6-4eff-4bbe-8fc7-d32717e12738"],
Cell[375780, 9598, 2228, 49, 262, "Input",ExpressionUUID->"dc492109-3ff0-4e4a-9a9c-5d399f71ffc2"],
Cell[378011, 9649, 222, 5, 30, "Input",ExpressionUUID->"706fb54c-f943-40ad-b804-5f8f16dec01c"],
Cell[378236, 9656, 652, 9, 51, "Text",ExpressionUUID->"b5977868-6052-4f67-a1d7-d0d798f3adc3"],
Cell[378891, 9667, 809, 21, 52, "Input",ExpressionUUID->"5134f262-8a10-4a7b-9005-8568dd65c9e3"],
Cell[379703, 9690, 361, 8, 52, "Input",ExpressionUUID->"816c5707-7b97-4d97-9edf-6af61edc98a6"],
Cell[380067, 9700, 1092, 20, 52, "Input",ExpressionUUID->"8f93862b-2aec-4857-b458-d01860a449ff"],
Cell[381162, 9722, 602, 9, 51, "Text",ExpressionUUID->"51a92a31-c177-4949-93f7-bddb56287a71"],
Cell[381767, 9733, 2313, 68, 271, "Input",ExpressionUUID->"590edee1-8e89-41d4-b02a-d71f2e484c06"],
Cell[384083, 9803, 358, 5, 51, "Text",ExpressionUUID->"3013b7ce-c56d-428e-9816-ac0b3569435a"],
Cell[384444, 9810, 337, 8, 30, "Input",ExpressionUUID->"dd3749b2-efb7-4aef-b1ed-de66d51987b6"],
Cell[384784, 9820, 362, 10, 30, "Input",ExpressionUUID->"07807f35-1bb4-47e3-bca4-c1303bc156be"],
Cell[385149, 9832, 757, 17, 52, "Input",ExpressionUUID->"6f4588a5-c34b-417b-b7bc-edbaaf4d306b"],
Cell[385909, 9851, 693, 19, 52, "Input",ExpressionUUID->"0808e19e-fd16-4db4-874f-cd44889c9f28"],
Cell[386605, 9872, 452, 7, 51, "Text",ExpressionUUID->"5dc46418-18b4-45bf-8dd6-bfb41d5094fb"],
Cell[387060, 9881, 622, 21, 50, "Input",ExpressionUUID->"4d3579a2-0ef6-4a3a-ad61-96c042ca8a29"],
Cell[387685, 9904, 921, 27, 50, "Input",ExpressionUUID->"d312235d-68f3-4da5-99e8-440cdad4b03c"],
Cell[388609, 9933, 455, 7, 51, "Text",ExpressionUUID->"113ec7de-ab24-4c3d-abd6-ae8843c05550"],
Cell[389067, 9942, 671, 15, 30, "Input",ExpressionUUID->"f1336859-d967-42bd-b74b-53b0e41e8b63"],
Cell[389741, 9959, 868, 18, 52, "Input",ExpressionUUID->"8b91c026-fd5c-47f1-80de-d52f62f925ec"],
Cell[390612, 9979, 395, 10, 30, "Input",ExpressionUUID->"2ef8e66b-bc1a-49a7-b486-e62b2c2e89bd"],
Cell[391010, 9991, 1510, 43, 73, "Input",ExpressionUUID->"ac169eaf-46b9-49a6-8dc2-05e54af4af3c"],
Cell[392523, 10036, 402, 6, 51, "Text",ExpressionUUID->"e1934989-8077-4581-8950-6ef7acb03b7f"],
Cell[392928, 10044, 743, 22, 50, "Input",ExpressionUUID->"43e7ebe2-ca3a-4fcd-91c4-38bdb082ef08"],
Cell[393674, 10068, 566, 15, 48, "Input",ExpressionUUID->"6b73722a-25af-4247-a37b-65f1520ece16"],
Cell[394243, 10085, 2309, 67, 99, "Input",ExpressionUUID->"c2f37409-7ff9-4556-a900-92417adf5ded"],
Cell[396555, 10154, 1352, 37, 52, "Input",ExpressionUUID->"7d39743f-e385-45cc-b88e-923ae2acfffc"],
Cell[397910, 10193, 1608, 33, 34, "Input",ExpressionUUID->"dc62c375-d232-4cb7-8008-4a23e13f68c8"],
Cell[399521, 10228, 819, 23, 34, "Input",ExpressionUUID->"ca5cd71a-99ac-47d9-adc4-d5603ae31de5"],
Cell[400343, 10253, 821, 23, 34, "Input",ExpressionUUID->"99b729fc-fd2b-4818-8058-330be67ebe62"],
Cell[401167, 10278, 767, 22, 33, "Input",ExpressionUUID->"57dac530-c9c2-4b18-ba4f-f3632521a6fb"],
Cell[401937, 10302, 836, 23, 33, "Input",ExpressionUUID->"fd23a89b-b267-4e10-a38d-917255c8e2e4"],
Cell[CellGroupData[{
Cell[402798, 10329, 739, 21, 33, "Input",ExpressionUUID->"5523fdd4-c344-4516-83be-86d1c6f64fab"],
Cell[403540, 10352, 832, 14, 70, "Output",ExpressionUUID->"5ae786c5-748b-45f3-99fa-14d102a12b63"]
}, Closed]],
Cell[404387, 10369, 938, 26, 29, "Input",ExpressionUUID->"94e9a900-9941-4d1f-bb21-33c864a0d6bb"]
}, Closed]],
Cell[CellGroupData[{
Cell[405362, 10400, 526, 8, 53, "Section",ExpressionUUID->"3225b65f-519d-4c0c-b83b-5075d593e841"],
Cell[CellGroupData[{
Cell[405913, 10412, 294, 4, 54, "Subsection",ExpressionUUID->"071c2664-f748-4df6-ad2a-d35e37b2c6ff"],
Cell[406210, 10418, 636, 11, 51, "Text",ExpressionUUID->"669f2252-f240-427b-a1b1-1d9ceff761cd"],
Cell[CellGroupData[{
Cell[406871, 10433, 1256, 29, 55, "Input",ExpressionUUID->"fd328fbc-9a30-4cbe-84ec-63e949efd9e1"],
Cell[408130, 10464, 698, 12, 34, "Output",ExpressionUUID->"9d70af71-e4ee-43c0-aa37-d3d95362feac"]
}, Closed]],
Cell[CellGroupData[{
Cell[408865, 10481, 968, 25, 55, "Input",ExpressionUUID->"29f6852d-47ae-4d70-8130-f70b4dbc7adc"],
Cell[409836, 10508, 574, 10, 34, "Output",ExpressionUUID->"20a30d95-8d5a-433b-8abd-3d27bb724a9a"]
}, Closed]],
Cell[410425, 10521, 383, 6, 51, "Text",ExpressionUUID->"d728f643-7bde-4f05-b1aa-9d7b5aaf1d43"],
Cell[410811, 10529, 1490, 34, 178, "Input",ExpressionUUID->"7c4ba6ac-c497-4bd6-b4b5-88514e4596e0"],
Cell[412304, 10565, 586, 15, 52, "Input",ExpressionUUID->"4bd29d90-5c7f-4c92-9ef8-ed92c92f77e5"],
Cell[412893, 10582, 669, 16, 52, "Input",ExpressionUUID->"1c91f8ed-c2c0-4082-9497-da446e9a300b"],
Cell[413565, 10600, 459, 11, 52, "Input",ExpressionUUID->"30571f7b-5a50-4544-acff-7b3bb86e9190"],
Cell[414027, 10613, 461, 11, 52, "Input",ExpressionUUID->"8239a810-885a-45cd-9827-d183390d06b4"],
Cell[414491, 10626, 486, 7, 51, "Text",ExpressionUUID->"2af02326-1674-41d7-85aa-e81dc4afd9c2"],
Cell[414980, 10635, 406, 11, 73, "Input",ExpressionUUID->"ef045e86-fd40-48f6-8106-8d9c74d817d2"],
Cell[415389, 10648, 904, 13, 51, "Text",ExpressionUUID->"9c81425c-01e7-46b9-85e4-12e2aaee0aee"],
Cell[416296, 10663, 736, 17, 52, "Input",ExpressionUUID->"fc4f5322-c130-4e0e-abf1-f834db71cc2c"],
Cell[417035, 10682, 775, 18, 52, "Input",ExpressionUUID->"0bd2f8c1-abf9-4c6c-83a6-8fc25b049409"],
Cell[417813, 10702, 607, 15, 52, "Input",ExpressionUUID->"9c6ec5de-1bbc-4dcd-9226-5bb1ecf6b13d"],
Cell[418423, 10719, 967, 13, 51, "Text",ExpressionUUID->"75431f4d-d52f-411e-81f5-e7fbd0f31ac3"],
Cell[419393, 10734, 744, 17, 52, "Input",ExpressionUUID->"0a992fdc-9990-4023-b4ad-b15d69dc4a3c"],
Cell[420140, 10753, 836, 18, 52, "Input",ExpressionUUID->"07c11a4d-0ada-4728-82c0-0779a5299284"],
Cell[420979, 10773, 447, 7, 51, "Text",ExpressionUUID->"5e7161e4-8219-46db-8980-5105f3d8a6d6"],
Cell[421429, 10782, 3299, 82, 94, "Input",ExpressionUUID->"1861a821-987b-4a16-9ac0-1e30eb191c2b"],
Cell[424731, 10866, 501, 7, 51, "Text",ExpressionUUID->"c6ee5498-36e9-43d1-989d-56977445ce0d"],
Cell[425235, 10875, 3407, 86, 94, "Input",ExpressionUUID->"20c3bd50-87ac-453b-81b0-fb850c4426cc"],
Cell[428645, 10963, 502, 7, 51, "Text",ExpressionUUID->"68f4c5ac-7289-4b31-918a-9c52845206ef"],
Cell[429150, 10972, 915, 27, 73, "Input",ExpressionUUID->"0bb4794a-7f51-4490-9612-c6626f6ebfa3"],
Cell[430068, 11001, 2512, 71, 94, "Input",ExpressionUUID->"8912f5ab-f424-4ad3-bb1d-401c6fbc684b"],
Cell[432583, 11074, 694, 17, 52, "Input",ExpressionUUID->"53042cb9-557a-420c-b959-65a143c41fad"],
Cell[433280, 11093, 754, 17, 52, "Input",ExpressionUUID->"c570841a-ae08-4945-a3c2-ed30c7bb3811"],
Cell[434037, 11112, 444, 7, 51, "Text",ExpressionUUID->"e982ec4d-75ee-474e-a58e-e66af0548039"],
Cell[CellGroupData[{
Cell[434506, 11123, 865, 22, 30, "Input",ExpressionUUID->"53c4ef06-8460-48ac-b9f9-12d0f564e7b7"],
Cell[435374, 11147, 231, 4, 34, "Output",ExpressionUUID->"e2a8cf18-ecb4-4efb-8c15-36f3c47753eb"]
}, Closed]],
Cell[CellGroupData[{
Cell[435642, 11156, 953, 23, 30, "Input",ExpressionUUID->"aacf9bd8-9533-4ae1-a61d-b9c17d82421b"],
Cell[436598, 11181, 549, 10, 34, "Output",ExpressionUUID->"ac8709e2-7604-4cdf-a496-6fbfc8a70106"]
}, Closed]],
Cell[CellGroupData[{
Cell[437184, 11196, 1645, 42, 48, "Input",ExpressionUUID->"526b1490-b2ad-4f2a-b86a-a3a22175621f"],
Cell[438832, 11240, 989, 16, 34, "Output",ExpressionUUID->"368a7946-9a75-47d5-a12b-b27068feea97"],
Cell[439824, 11258, 987, 16, 34, "Output",ExpressionUUID->"4d25b230-0503-49c0-a582-088b105c925b"]
}, Closed]],
Cell[440826, 11277, 500, 12, 52, "Input",ExpressionUUID->"efa9e400-85ea-4f66-b927-ace5d1a73be8"],
Cell[441329, 11291, 714, 17, 52, "Input",ExpressionUUID->"ee0b1541-9c8d-4dbd-af75-2d2296553ccc"],
Cell[442046, 11310, 1104, 26, 52, "Input",ExpressionUUID->"627cea80-632b-4711-b4e4-380d3dc029ae"],
Cell[443153, 11338, 1016, 25, 52, "Input",ExpressionUUID->"02a76096-dd69-4800-b2ee-9b0b7379301a"],
Cell[444172, 11365, 1110, 26, 52, "Input",ExpressionUUID->"57588a01-cf26-441d-814c-3fb6682819de"],
Cell[445285, 11393, 1026, 25, 52, "Input",ExpressionUUID->"81b1f74f-d090-4018-98b1-56eb58a4edc6"]
}, Closed]],
Cell[CellGroupData[{
Cell[446348, 11423, 447, 7, 38, "Subsection",ExpressionUUID->"2a8d907d-906f-43e7-8436-1cbe1be557d8"],
Cell[446798, 11432, 647, 11, 51, "Text",ExpressionUUID->"89c5f5da-2d88-404e-ad74-08779ead8d22"],
Cell[447448, 11445, 1293, 33, 94, "Input",ExpressionUUID->"513adf81-072c-4099-a59d-b09733335702"],
Cell[448744, 11480, 1165, 30, 94, "Input",ExpressionUUID->"b47e8bc4-7299-416c-bd2d-642e6ec56524"],
Cell[449912, 11512, 434, 7, 51, "Text",ExpressionUUID->"432e0d09-afd8-491f-af6f-ececd4cb2ed0"],
Cell[450349, 11521, 1027, 23, 94, "Input",ExpressionUUID->"071a26df-14d5-46b1-afb9-49c6163798c3"],
Cell[451379, 11546, 563, 8, 51, "Text",ExpressionUUID->"6ba684cf-47eb-4a02-ac55-d9458e0fb255"],
Cell[451945, 11556, 2686, 64, 178, "Input",ExpressionUUID->"a779d2f1-05ca-4afe-a2ab-56ec7d4eba79"],
Cell[454634, 11622, 2269, 59, 178, "Input",ExpressionUUID->"68c44258-5c7a-4b39-a2b3-98155310d943"]
}, Closed]],
Cell[CellGroupData[{
Cell[456940, 11686, 392, 6, 38, "Subsection",ExpressionUUID->"a4bb627d-24c7-4668-852c-e4379e093569"],
Cell[457335, 11694, 620, 9, 51, "Text",ExpressionUUID->"56ee3f27-bc02-4aa0-b820-acd1b3eff5b2"],
Cell[457958, 11705, 989, 23, 94, "Input",ExpressionUUID->"17e8dbe0-9e5a-4d3a-b6de-442977ed23a5"],
Cell[458950, 11730, 772, 19, 94, "Input",ExpressionUUID->"2534790b-eb69-4836-8b1b-b5c3069638a1"],
Cell[459725, 11751, 619, 9, 51, "Text",ExpressionUUID->"2fcf3089-9b84-4afa-ad65-5d0e14941795"],
Cell[460347, 11762, 1147, 32, 94, "Input",ExpressionUUID->"72e1d168-d7cd-4a6c-b021-bdacf564575b"],
Cell[461497, 11796, 942, 26, 94, "Input",ExpressionUUID->"a9bd2f3a-d868-46d3-bb27-32f1fae248ac"],
Cell[462442, 11824, 434, 7, 51, "Text",ExpressionUUID->"cea83e78-1547-45fc-bd2d-029c2eead01a"],
Cell[462879, 11833, 992, 23, 94, "Input",ExpressionUUID->"49d67d3e-fcc0-48ce-ae0d-1290c641f811"],
Cell[463874, 11858, 563, 8, 51, "Text",ExpressionUUID->"d9a350d3-4e95-45a6-972a-ef83bc61f04f"],
Cell[464440, 11868, 1060, 22, 49, "Input",ExpressionUUID->"d28b32bd-0e5e-4e5a-a221-f7d7d7b08771"],
Cell[465503, 11892, 860, 19, 49, "Input",ExpressionUUID->"236bac65-7bc2-4b1d-ba60-7d7e474dc354"],
Cell[466366, 11913, 1102, 22, 49, "Input",ExpressionUUID->"c5d24df6-202e-4f0c-8088-8941b30599e2"],
Cell[467471, 11937, 850, 19, 49, "Input",ExpressionUUID->"82b5fbcb-a55e-4781-bb63-9d8e218b896d"]
}, Closed]],
Cell[CellGroupData[{
Cell[468358, 11961, 293, 7, 38, "Subsection",ExpressionUUID->"70066169-bea3-4ecb-bbbb-274a05cdeb10"],
Cell[468654, 11970, 443, 7, 51, "Text",ExpressionUUID->"558ce4f1-9a5a-4c8f-9627-0f087e763499"],
Cell[469100, 11979, 2336, 67, 232, "Input",ExpressionUUID->"e6e2729f-1078-40ee-9388-5fc724302390"],
Cell[471439, 12048, 581, 10, 51, "Text",ExpressionUUID->"b5cd6402-6b66-4ce6-b904-f90e9e11ba8d"],
Cell[472023, 12060, 856, 18, 52, "Input",ExpressionUUID->"84203322-ee57-4494-8b1b-1d2658d56da5"],
Cell[472882, 12080, 871, 18, 52, "Input",ExpressionUUID->"2adcde90-56bf-415c-a5de-264377fa388a"],
Cell[473756, 12100, 855, 18, 52, "Input",ExpressionUUID->"88787f6b-9029-4e84-b8ef-6159d188e69b"],
Cell[474614, 12120, 860, 18, 52, "Input",ExpressionUUID->"f05ba65a-842d-4ed0-9a8d-58f598d210a7"],
Cell[475477, 12140, 466, 7, 51, "Text",ExpressionUUID->"1b53ee00-4332-4f3b-a0b5-62867d6794e3"],
Cell[475946, 12149, 1063, 25, 94, "Input",ExpressionUUID->"cae05d46-8ba2-4a0e-9709-0eac7624773e"],
Cell[477012, 12176, 583, 9, 51, "Text",ExpressionUUID->"e8235f35-5bed-4cc0-bbff-17de6fc9553d"],
Cell[477598, 12187, 1487, 31, 94, "Input",ExpressionUUID->"ec1a228d-64c1-4e68-8adf-12f71be45dd3"]
}, Closed]],
Cell[CellGroupData[{
Cell[479122, 12223, 226, 5, 38, "Subsection",ExpressionUUID->"9bf5df29-0e24-4fb4-b06e-febf86b4e668"],
Cell[479351, 12230, 515, 7, 51, "Text",ExpressionUUID->"9a626645-8a2d-41d1-9863-3c031c4b7966"],
Cell[479869, 12239, 645, 16, 52, "Input",ExpressionUUID->"16fdc1c1-e436-4092-8a9a-1055d076923d"],
Cell[480517, 12257, 502, 13, 52, "Input",ExpressionUUID->"6ed023a8-8347-429c-b585-420b7e0a7886"],
Cell[481022, 12272, 489, 7, 51, "Text",ExpressionUUID->"626f2b3e-3609-4cde-90ff-daebbf83e359"],
Cell[481514, 12281, 654, 15, 52, "Input",ExpressionUUID->"2f86e7e1-2227-4e7c-933f-f4549eb90a47"],
Cell[482171, 12298, 508, 13, 52, "Input",ExpressionUUID->"459ff7dc-8e8a-4d70-a427-e17147392436"],
Cell[482682, 12313, 535, 8, 51, "Text",ExpressionUUID->"61ef3067-f5a5-45e4-841b-52c077aacd7d"],
Cell[483220, 12323, 647, 16, 52, "Input",ExpressionUUID->"295a44f2-b7ca-4f95-8f5e-3488658e7fc6"],
Cell[483870, 12341, 577, 15, 52, "Input",ExpressionUUID->"ff9280d6-0d7a-44cb-a5a0-8eba248fa11c"]
}, Closed]],
Cell[CellGroupData[{
Cell[484484, 12361, 375, 7, 38, "Subsection",ExpressionUUID->"bb81c3f2-cf1e-4a3b-8ad5-788bd4209c75"],
Cell[CellGroupData[{
Cell[484884, 12372, 191, 3, 45, "Subsubsection",ExpressionUUID->"8c411473-9b2c-4e9c-b777-8889ea5f5edf"],
Cell[485078, 12377, 489, 7, 51, "Text",ExpressionUUID->"e7f1689e-8f71-45fe-9c63-d489a26a5ef4"],
Cell[485570, 12386, 786, 16, 52, "Input",ExpressionUUID->"69ba23dc-ffda-49aa-8167-5cb34d8f9c95"],
Cell[486359, 12404, 498, 12, 52, "Input",ExpressionUUID->"9bd54bd9-97ed-4113-b038-0e32d7ec86e9"],
Cell[486860, 12418, 535, 8, 51, "Text",ExpressionUUID->"05c94940-067b-46fe-9a66-12ace8807ea5"],
Cell[487398, 12428, 774, 16, 52, "Input",ExpressionUUID->"c0373fa4-91e5-4193-bdc6-68640b165a42"],
Cell[488175, 12446, 566, 14, 52, "Input",ExpressionUUID->"d27c1d8d-f4de-4eb3-9f2e-39bc01221369"]
}, Closed]],
Cell[CellGroupData[{
Cell[488778, 12465, 278, 4, 45, "Subsubsection",ExpressionUUID->"1ccc7dff-e74e-4bf3-9573-2054b438bff7"],
Cell[CellGroupData[{
Cell[489081, 12473, 1565, 43, 73, "Input",ExpressionUUID->"29925e31-e1b1-464e-8994-37eab8d33413"],
Cell[490649, 12518, 660, 11, 70, "Output",ExpressionUUID->"0a34115a-cb65-4bfc-a065-728b08f32f7c"],
Cell[491312, 12531, 658, 11, 70, "Output",ExpressionUUID->"20719f4b-53d6-4d1c-9e34-d510ce9cc223"]
}, Closed]],
Cell[491985, 12545, 489, 7, 51, "Text",ExpressionUUID->"7486d97d-2b7e-40c9-a88e-ac358251b62d"],
Cell[492477, 12554, 917, 19, 52, "Input",ExpressionUUID->"93783339-71cc-4b2c-8f51-405934bbdf5b"]
}, Closed]],
Cell[CellGroupData[{
Cell[493431, 12578, 247, 4, 45, "Subsubsection",ExpressionUUID->"d6c1f0d0-9c70-4b4f-a393-e7917eea5358"],
Cell[493681, 12584, 489, 7, 51, "Text",ExpressionUUID->"feb5cfb9-917c-4085-8200-da73ab765609"],
Cell[494173, 12593, 651, 14, 52, "Input",ExpressionUUID->"78a2b32a-9e2e-4a7b-b9ff-87ec8cba6b06"],
Cell[494827, 12609, 612, 15, 52, "Input",ExpressionUUID->"b739d108-9c1d-4ad0-98f2-87d6847b8fe0"]
}, Closed]],
Cell[CellGroupData[{
Cell[495476, 12629, 223, 4, 45, "Subsubsection",ExpressionUUID->"4ecbf95c-6be9-4ca5-a781-d81103504f65"],
Cell[495702, 12635, 489, 7, 51, "Text",ExpressionUUID->"95828652-0195-4a7b-aa4c-ebf2afeef242"],
Cell[496194, 12644, 916, 18, 52, "Input",ExpressionUUID->"f052b4b9-d4b8-4d92-83e0-6538456289af"],
Cell[497113, 12664, 535, 8, 51, "Text",ExpressionUUID->"e3298f59-f7cb-4e27-94d2-686f9bc47807"],
Cell[497651, 12674, 879, 19, 52, "Input",ExpressionUUID->"e697abc9-23b1-42f0-a3b7-bbd1f45c70d6"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[498579, 12699, 242, 4, 38, "Subsection",ExpressionUUID->"58df8d0c-c54a-4621-89d1-3e0dc8c0f4a0"],
Cell[CellGroupData[{
Cell[498846, 12707, 211, 4, 45, "Subsubsection",ExpressionUUID->"b82a3c8f-99ac-41f1-95fa-39b153ccf0a1"],
Cell[499060, 12713, 723, 10, 51, "Text",ExpressionUUID->"e6a81cfa-395e-4f3f-bea1-c16556f4d766"],
Cell[499786, 12725, 1565, 38, 52, "Input",ExpressionUUID->"90b9df09-ca2d-479e-9894-540c50d2d71f"],
Cell[501354, 12765, 687, 10, 51, "Text",ExpressionUUID->"2a993a3e-e82d-4d03-861c-9be62880bf1f"],
Cell[502044, 12777, 1361, 38, 52, "Input",ExpressionUUID->"14f1694f-8616-4c52-b934-205e786f2417"],
Cell[503408, 12817, 1409, 37, 53, "Input",ExpressionUUID->"b7f9dd05-b9fc-426c-a9e1-7d659c3fc5fd"],
Cell[504820, 12856, 883, 25, 52, "Input",ExpressionUUID->"d3e1976d-cade-44fa-92e1-47325ad7fe48"],
Cell[505706, 12883, 742, 11, 51, "Text",ExpressionUUID->"4079fe18-dfb1-4003-a9fc-4263f02c27cf"],
Cell[506451, 12896, 606, 15, 52, "Input",ExpressionUUID->"56acd9c9-627c-4c20-856a-b640b3740351"],
Cell[507060, 12913, 690, 10, 51, "Text",ExpressionUUID->"d629c382-50d1-44dd-ac01-a529e5776e4e"],
Cell[507753, 12925, 2624, 60, 94, "Input",ExpressionUUID->"b3467087-6e47-49f4-b6b6-e35cb8a046c8"]
}, Closed]],
Cell[CellGroupData[{
Cell[510414, 12990, 209, 4, 37, "Subsubsection",ExpressionUUID->"5b318cdc-694a-46a8-a539-7e243052c9e9"],
Cell[510626, 12996, 708, 10, 51, "Text",ExpressionUUID->"4206dd99-3ee3-4971-8e0f-fca7fbcd19a6"],
Cell[511337, 13008, 1552, 41, 136, "Input",ExpressionUUID->"0f9b33ab-99bb-4c33-993e-e714a8cfa5cb"],
Cell[512892, 13051, 654, 9, 51, "Text",ExpressionUUID->"ae7a58d4-6847-45e8-9457-ec6843c75f9b"],
Cell[513549, 13062, 1451, 40, 136, "Input",ExpressionUUID->"28ea7775-aa9d-470f-975b-f1611291c114"],
Cell[515003, 13104, 938, 20, 52, "Input",ExpressionUUID->"f934b733-cce3-4ba5-a259-b0d2e4d96d60"],
Cell[515944, 13126, 682, 10, 51, "Text",ExpressionUUID->"0c3b3c0c-c0a4-4afe-9fba-46fc510de72d"],
Cell[516629, 13138, 1902, 49, 136, "Input",ExpressionUUID->"94abd2a1-df70-4c0f-9cf8-54276577b3ce"],
Cell[518534, 13189, 1344, 35, 136, "Input",ExpressionUUID->"ee5e943a-01dd-47ec-bd5f-720becd84784"],
Cell[519881, 13226, 819, 11, 51, "Text",ExpressionUUID->"63bdd8ab-01f0-4af2-9f24-b9c79e505831"],
Cell[520703, 13239, 1712, 42, 144, "Input",ExpressionUUID->"0d1dfa8e-43b9-4a8d-93f3-4493aa3e27ab"],
Cell[522418, 13283, 783, 11, 51, "Text",ExpressionUUID->"c6323821-19bf-422a-9507-3bb40fbbab63"],
Cell[523204, 13296, 1792, 44, 139, "Input",ExpressionUUID->"29f1517f-4eee-4f54-bc68-b310da3a72b9"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[525045, 13346, 208, 4, 38, "Subsection",ExpressionUUID->"f1cf552d-ccab-4d42-9d8b-c7a299445aca"],
Cell[525256, 13352, 775, 11, 51, "Text",ExpressionUUID->"8a67f2da-d9dc-46a3-ad8b-4c5afac37bda"],
Cell[526034, 13365, 2067, 37, 52, "Input",ExpressionUUID->"37dba326-65af-4d26-b164-a1ad89e1e956"],
Cell[528104, 13404, 702, 10, 51, "Text",ExpressionUUID->"5f76c01c-6f03-4af7-adf3-68705ca399f9"],
Cell[528809, 13416, 1215, 28, 52, "Input",ExpressionUUID->"b5b26d45-7d33-458f-a27f-b68364d8263f"],
Cell[530027, 13446, 831, 13, 51, "Text",ExpressionUUID->"37b75b25-e553-400d-bfea-d3c56e625ed0"],
Cell[530861, 13461, 1938, 36, 52, "Input",ExpressionUUID->"d3238f69-5d6e-4c32-9b6d-4171d1ad4664"],
Cell[532802, 13499, 1449, 32, 115, "Input",ExpressionUUID->"91b0e828-3b75-49c9-b1de-24b8e9337e22"],
Cell[534254, 13533, 870, 12, 51, "Text",ExpressionUUID->"d3d9b3ed-2eb6-41e2-9db2-73d8cd50bbed"],
Cell[535127, 13547, 672, 13, 30, "Input",ExpressionUUID->"bc6814a5-fec0-4473-a699-eecabe68e84b"],
Cell[535802, 13562, 851, 12, 51, "Text",ExpressionUUID->"96f144a7-b42f-410f-af72-61653cd1744d"],
Cell[536656, 13576, 944, 22, 52, "Input",ExpressionUUID->"5822b4d3-f6a2-49ec-b34b-b6824cf48774"],
Cell[537603, 13600, 888, 18, 52, "Input",ExpressionUUID->"b23f17ce-2881-431f-a5e2-5d620a7dbc49"],
Cell[538494, 13620, 982, 16, 51, "Text",ExpressionUUID->"12256e2f-acd8-46f7-a4c0-5aece70337e6"],
Cell[539479, 13638, 950, 22, 52, "Input",ExpressionUUID->"67e7c3f8-5337-4010-93c6-0ec9439fd52e"],
Cell[540432, 13662, 924, 14, 51, "Text",ExpressionUUID->"4d053112-6265-4848-93de-b3efcc95df7f"],
Cell[541359, 13678, 921, 21, 52, "Input",ExpressionUUID->"5d4f376a-c9eb-4feb-96c4-71ac681e444c"],
Cell[542283, 13701, 906, 13, 51, "Text",ExpressionUUID->"24afd76d-9632-47f0-a03d-f0fc70aedf72"],
Cell[543192, 13716, 907, 19, 52, "Input",ExpressionUUID->"cf360b77-bd79-43c8-91f8-e536d95d9d41"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[544148, 13741, 451, 7, 53, "Section",ExpressionUUID->"9dc04e7d-2286-41d6-b255-e32bdb1eb20f"],
Cell[CellGroupData[{
Cell[544624, 13752, 396, 6, 54, "Subsection",ExpressionUUID->"e24b793c-dcc7-434b-8553-e45a2ce63b97"],
Cell[545023, 13760, 596, 9, 51, "Text",ExpressionUUID->"9d114d1d-c15c-452d-a233-426b1543282b"],
Cell[545622, 13771, 283, 7, 30, "Input",ExpressionUUID->"cdc36615-81d6-4783-9871-f7d68c2eb144"],
Cell[545908, 13780, 3006, 61, 388, "Input",ExpressionUUID->"ebc1873c-3297-4227-95ca-674e0864e580"],
Cell[548917, 13843, 324, 7, 30, "Input",ExpressionUUID->"cb03ec05-67eb-44a2-bed7-55d63236e263"],
Cell[549244, 13852, 652, 9, 51, "Text",ExpressionUUID->"7684840b-5063-42b2-ba7e-a6b0c71fc10f"],
Cell[549899, 13863, 858, 22, 52, "Input",ExpressionUUID->"ad045768-9dbc-4c9b-8acf-1c5e11ef52d4"],
Cell[550760, 13887, 407, 9, 52, "Input",ExpressionUUID->"300402dd-b2d6-4e55-823c-67d534b7a5d5"],
Cell[CellGroupData[{
Cell[551192, 13900, 956, 18, 52, "Input",ExpressionUUID->"bf49c247-3fd5-41ed-8817-172892ed057c"],
Cell[552151, 13920, 160, 3, 34, "Output",ExpressionUUID->"74eb7c64-fe4f-4ed6-9ad6-02ecfab2c475"],
Cell[552314, 13925, 160, 3, 34, "Output",ExpressionUUID->"e77eecb1-7eac-464b-9868-56b12481de27"]
}, Closed]],
Cell[552489, 13931, 722, 12, 47, "Text",ExpressionUUID->"03d88bcd-1a9d-476a-b75e-49c6b819a78b"],
Cell[553214, 13945, 813, 16, 52, "Input",ExpressionUUID->"d24b71c7-6919-4b75-9781-02ba20b9b380"],
Cell[554030, 13963, 679, 10, 51, "Text",ExpressionUUID->"147c90f9-715a-43da-b6fa-0897a1be95bf"],
Cell[CellGroupData[{
Cell[554734, 13977, 1308, 30, 52, "Input",ExpressionUUID->"669feba5-22fd-4ccf-abc2-da44dae88455"],
Cell[556045, 14009, 1021, 16, 34, "Output",ExpressionUUID->"c0207e09-e0d6-4352-a0f4-148c43dfe79b"],
Cell[557069, 14027, 1022, 16, 34, "Output",ExpressionUUID->"317d1da6-de22-43bd-afb3-232fd88a97b1"]
}, Closed]],
Cell[558106, 14046, 635, 11, 47, "Text",ExpressionUUID->"46c8be11-5b6a-4662-b143-c8c5d6924101"],
Cell[558744, 14059, 487, 14, 30, "Input",ExpressionUUID->"4fcf7cdb-7b5f-429a-9577-3bc085e0de06"],
Cell[559234, 14075, 663, 16, 52, "Input",ExpressionUUID->"ea010dae-35df-475e-a878-a2a956cbf13d"],
Cell[559900, 14093, 575, 14, 52, "Input",ExpressionUUID->"87f1b74a-856f-48dd-92c9-161fc5aa9214"],
Cell[560478, 14109, 622, 18, 52, "Input",ExpressionUUID->"ce00a6d4-1e7f-4fd7-b2db-b79cbd26280b"],
Cell[561103, 14129, 486, 7, 51, "Text",ExpressionUUID->"f9e4aeed-5db0-4d23-9b66-d54ede36857b"],
Cell[561592, 14138, 506, 11, 52, "Input",ExpressionUUID->"232912b2-3d6b-4db3-bfaa-087868dedffc"],
Cell[562101, 14151, 524, 8, 51, "Text",ExpressionUUID->"7f80fef4-c35d-4017-b22d-49b58ec98d3a"],
Cell[562628, 14161, 1476, 41, 133, "Input",ExpressionUUID->"487d68f5-d8d0-4f1c-aeb9-0368ab107c03"],
Cell[564107, 14204, 1364, 39, 175, "Input",ExpressionUUID->"88009036-0dc9-4235-9499-2d85267b895d"],
Cell[565474, 14245, 1370, 39, 175, "Input",ExpressionUUID->"1a91335e-80e5-4f97-b755-002d2148a75e"],
Cell[CellGroupData[{
Cell[566869, 14288, 626, 15, 52, "Input",ExpressionUUID->"4369a36a-1e7d-4cf2-a14d-cfb50eb4e6d2"],
Cell[567498, 14305, 501, 8, 34, "Output",ExpressionUUID->"a0ba9e80-22b8-4162-85ca-0e384b87d9be"],
Cell[568002, 14315, 501, 8, 34, "Output",ExpressionUUID->"35c719c2-f0c6-4909-89c8-d11c1d75b54b"]
}, Closed]],
Cell[CellGroupData[{
Cell[568540, 14328, 447, 12, 48, "Input",ExpressionUUID->"5b57d09d-9be6-492b-ab54-0639bbed06ca"],
Cell[568990, 14342, 449, 7, 34, "Output",ExpressionUUID->"764f1401-1613-4265-8132-56318c02b371"],
Cell[569442, 14351, 449, 7, 34, "Output",ExpressionUUID->"c052401c-ef5e-4fd4-856c-93edea8f056f"]
}, Closed]],
Cell[CellGroupData[{
Cell[569928, 14363, 574, 14, 48, "Input",ExpressionUUID->"2bfd14c5-5673-46aa-b434-9af90fe6ca69"],
Cell[570505, 14379, 477, 7, 34, "Output",ExpressionUUID->"097b6933-a611-434c-99e6-24f4103ffbd8"],
Cell[570985, 14388, 476, 7, 34, "Output",ExpressionUUID->"13050e8d-28de-4d79-a625-fe5203eb58ff"]
}, Closed]],
Cell[571476, 14398, 444, 7, 47, "Text",ExpressionUUID->"b459a432-99dd-4f0a-a33b-50711b20077a"],
Cell[571923, 14407, 612, 17, 52, "Input",ExpressionUUID->"63d5f455-69c8-4e76-b000-b112fc6cf649"],
Cell[572538, 14426, 616, 17, 52, "Input",ExpressionUUID->"bd946261-6582-43d5-a07b-7cfd643a3178"],
Cell[573157, 14445, 1488, 34, 94, "Input",ExpressionUUID->"a0dc2caf-42d8-486b-b6c0-76d154ef45ac"],
Cell[574648, 14481, 942, 27, 94, "Input",ExpressionUUID->"64d79caf-c8ca-4974-ac73-4907a1c66abd"],
Cell[575593, 14510, 931, 13, 51, "Text",ExpressionUUID->"10ef4e9f-e56a-41cb-9e6c-b7e59d2c5f47"],
Cell[576527, 14525, 675, 17, 52, "Input",ExpressionUUID->"80f78020-7985-47a8-bc7a-ddac7aa8f245"],
Cell[577205, 14544, 731, 17, 52, "Input",ExpressionUUID->"109a8bd2-fc0d-4f42-8f3a-15e9135e5c80"],
Cell[577939, 14563, 781, 18, 52, "Input",ExpressionUUID->"fc5a314f-7058-4193-beeb-77bc3e94ac1c"],
Cell[578723, 14583, 690, 17, 52, "Input",ExpressionUUID->"175a5ae1-bcbf-4d0e-9d02-9a5910b3405b"],
Cell[579416, 14602, 967, 13, 51, "Text",ExpressionUUID->"2fe4f3ca-47bc-48c2-9a80-2c3b05cd7b75"],
Cell[580386, 14617, 727, 17, 52, "Input",ExpressionUUID->"0f946115-eebb-4f7f-86b9-4caabd1c060e"],
Cell[581116, 14636, 879, 19, 52, "Input",ExpressionUUID->"88038be2-c7df-4c4c-83fd-0a9267457bde"],
Cell[581998, 14657, 447, 7, 51, "Text",ExpressionUUID->"6ee912e9-2be6-4fba-a41a-d7fdbe58ca20"],
Cell[582448, 14666, 1511, 37, 136, "Input",ExpressionUUID->"e3de954a-76d9-4750-a916-3aabd0e360ed"],
Cell[583962, 14705, 1130, 31, 136, "Input",ExpressionUUID->"8bfac2f6-3470-45a9-a932-e94974886974"],
Cell[585095, 14738, 444, 7, 51, "Text",ExpressionUUID->"ced054ce-f201-43aa-bef6-c5c3c87ffb89"],
Cell[CellGroupData[{
Cell[585564, 14749, 1723, 43, 136, "Input",ExpressionUUID->"60b9f31d-ee0d-4152-a17f-53d559da6b38"],
Cell[587290, 14794, 786, 14, 34, "Output",ExpressionUUID->"9054a439-a155-48f3-944b-69f2639497ab"],
Cell[588079, 14810, 784, 14, 34, "Output",ExpressionUUID->"10d6d91f-aa02-4476-8c91-0cb0701c950b"]
}, Closed]],
Cell[CellGroupData[{
Cell[588900, 14829, 1945, 46, 132, "Input",ExpressionUUID->"78c4a38b-0a7a-49bd-88c2-578d1d029185"],
Cell[590848, 14877, 829, 14, 34, "Output",ExpressionUUID->"77e33e00-bc1e-4c60-b37c-d78e8a4f9268"],
Cell[591680, 14893, 827, 14, 34, "Output",ExpressionUUID->"f68d8144-9720-4169-a1f9-4b7caf1a3bbf"]
}, Closed]],
Cell[592522, 14910, 647, 18, 48, "Input",ExpressionUUID->"61b927ce-9135-48da-a044-8ccd867ff4e2"],
Cell[593172, 14930, 881, 23, 52, "Input",ExpressionUUID->"f279a0c1-c595-43f1-ae03-cdccaa3cd839"]
}, Closed]],
Cell[CellGroupData[{
Cell[594090, 14958, 281, 5, 54, "Subsection",ExpressionUUID->"78ee43c8-7e61-449e-b398-91c46b25552f"],
Cell[594374, 14965, 515, 7, 51, "Text",ExpressionUUID->"cafaed17-883c-45b4-be64-ccc1d210a0db"],
Cell[594892, 14974, 604, 16, 52, "Input",ExpressionUUID->"45fca56e-c8b2-4172-a3c1-dd0a1d9234af"],
Cell[595499, 14992, 549, 8, 51, "Text",ExpressionUUID->"cbc1a5bb-e882-45d3-8287-6629a63658bd"],
Cell[596051, 15002, 616, 14, 52, "Input",ExpressionUUID->"f1aec65b-c276-4278-a0b7-559555cb7683"],
Cell[596670, 15018, 593, 9, 51, "Text",ExpressionUUID->"f870e263-3aa8-4f1d-b827-c872e700fe23"],
Cell[597266, 15029, 588, 14, 52, "Input",ExpressionUUID->"736dbbd3-1f6c-4310-91be-fec87bd01984"],
Cell[597857, 15045, 597, 9, 51, "Text",ExpressionUUID->"58f09e68-1e82-41db-9ed6-ffff1e8dbe38"],
Cell[598457, 15056, 468, 12, 52, "Input",ExpressionUUID->"821d8f5c-062c-4af8-996f-c3bbaa9a9895"],
Cell[598928, 15070, 606, 9, 51, "Text",ExpressionUUID->"2dd8b46d-b186-4a8f-8576-981c53ee7c1b"],
Cell[599537, 15081, 530, 13, 52, "Input",ExpressionUUID->"be711ebb-402f-4d6c-a9a3-469cc5a020df"],
Cell[600070, 15096, 599, 9, 51, "Text",ExpressionUUID->"f8707dbd-1ef6-44bf-88e3-05a9b80e9425"],
Cell[600672, 15107, 514, 13, 52, "Input",ExpressionUUID->"081fa105-d7df-47e7-bc2a-59989ac4d568"],
Cell[601189, 15122, 649, 9, 51, "Text",ExpressionUUID->"bc615f89-509a-46bb-b43e-c0db79590353"],
Cell[601841, 15133, 573, 14, 52, "Input",ExpressionUUID->"116cd257-5c7b-42a6-bc3f-af3fe7cf7a76"],
Cell[602417, 15149, 595, 9, 51, "Text",ExpressionUUID->"bfe78f5b-575e-460a-882e-86015a9cb24e"],
Cell[603015, 15160, 573, 14, 52, "Input",ExpressionUUID->"bf361b9f-e4c5-430f-9e5b-86879142d6b9"],
Cell[603591, 15176, 592, 9, 51, "Text",ExpressionUUID->"7ab15b8d-6618-420d-9045-2af5aa9b0cdb"],
Cell[604186, 15187, 624, 15, 52, "Input",ExpressionUUID->"fe911d3f-9329-4dfb-82f8-906094c05c99"]
}, Closed]],
Cell[CellGroupData[{
Cell[604847, 15207, 240, 4, 38, "Subsection",ExpressionUUID->"12cc2de2-8291-4b38-b1a4-55d6a2cb4c0a"],
Cell[CellGroupData[{
Cell[605112, 15215, 211, 4, 45, "Subsubsection",ExpressionUUID->"2b77721a-e427-4071-91a5-d8b8e9a7c9d5"],
Cell[605326, 15221, 723, 10, 51, "Text",ExpressionUUID->"d74c8d4a-f8f0-490a-b7ca-9dbfba9a1937"],
Cell[606052, 15233, 1638, 39, 52, "Input",ExpressionUUID->"0819d358-2f22-4560-9fbb-195385f2a4af"],
Cell[607693, 15274, 687, 10, 51, "Text",ExpressionUUID->"9f9a0971-c9b7-4b5a-9d75-353e938ea538"],
Cell[608383, 15286, 1377, 38, 52, "Input",ExpressionUUID->"95b9eb6f-271a-4a75-a2de-4925c194dc1d"],
Cell[609763, 15326, 692, 10, 51, "Text",ExpressionUUID->"4588ef0d-d9a8-4d5c-be18-219616c9058f"],
Cell[610458, 15338, 1492, 37, 58, "Input",ExpressionUUID->"b02153a8-115a-473f-bfc4-fb1a9a89a11b"],
Cell[611953, 15377, 1017, 27, 52, "Input",ExpressionUUID->"960fc354-2f16-4eb9-9169-c28056910a9f"],
Cell[612973, 15406, 742, 11, 51, "Text",ExpressionUUID->"7c4b4194-c8c0-40c7-b0da-10ea62cf48bc"],
Cell[613718, 15419, 629, 15, 52, "Input",ExpressionUUID->"350d0903-37e1-4b1b-978c-11b7a32f806f"],
Cell[614350, 15436, 690, 10, 51, "Text",ExpressionUUID->"0c4a10db-27c3-4121-b5f1-537cfe066b79"],
Cell[615043, 15448, 1923, 53, 94, "Input",ExpressionUUID->"6e4ef88f-391a-4e24-af15-afaf4a435f38"]
}, Closed]],
Cell[CellGroupData[{
Cell[617003, 15506, 209, 4, 37, "Subsubsection",ExpressionUUID->"460fb067-8a60-4e7d-a184-d7faa34c819f"],
Cell[617215, 15512, 708, 10, 51, "Text",ExpressionUUID->"bacf80bc-87af-465c-853e-6dc9b790d231"],
Cell[617926, 15524, 1700, 41, 136, "Input",ExpressionUUID->"054fc2f6-78e8-4808-922b-9c31c3c54419"],
Cell[619629, 15567, 654, 9, 51, "Text",ExpressionUUID->"043dbad9-e00d-4009-9650-ae72ea097bf4"],
Cell[620286, 15578, 1590, 41, 136, "Input",ExpressionUUID->"f9cfb1fd-fb5e-4665-8fc1-eae58631d19d"],
Cell[621879, 15621, 1048, 22, 52, "Input",ExpressionUUID->"82490c3e-ed5b-47a2-bea7-75a8d409ab70"],
Cell[622930, 15645, 682, 10, 51, "Text",ExpressionUUID->"439441bd-a0f7-46bf-8f4d-e6949df6a120"],
Cell[623615, 15657, 2074, 52, 136, "Input",ExpressionUUID->"b247d58a-d483-42b7-a63c-c9d07369c59b"],
Cell[625692, 15711, 1566, 39, 136, "Input",ExpressionUUID->"41754a08-88c8-40a4-9523-393907cbccd1"],
Cell[627261, 15752, 819, 11, 51, "Text",ExpressionUUID->"088c5eed-7e9e-4f06-86ed-62914e028c10"],
Cell[628083, 15765, 1749, 43, 140, "Input",ExpressionUUID->"89108ce5-4184-48c7-b900-ddf6f287e590"],
Cell[629835, 15810, 783, 11, 51, "Text",ExpressionUUID->"ef199d57-56de-426c-8c1f-be4bd2748cbe"],
Cell[630621, 15823, 1400, 39, 139, "Input",ExpressionUUID->"ca9815c2-bdae-44a7-b373-aac81dbee11b"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[632070, 15868, 162, 3, 38, "Subsection",ExpressionUUID->"ee286689-c987-4068-ba15-c19507256eda"],
Cell[632235, 15873, 851, 12, 51, "Text",ExpressionUUID->"5174cacd-f9ac-4809-981b-8fc67ea10c89"],
Cell[633089, 15887, 1393, 25, 52, "Input",ExpressionUUID->"7f15b574-f94c-4893-b374-39855b7cffc1"],
Cell[634485, 15914, 921, 14, 51, "Text",ExpressionUUID->"53a1c2a2-b217-43b1-94fd-1484f19ff916"],
Cell[635409, 15930, 912, 22, 52, "Input",ExpressionUUID->"0e327cc9-270f-4c98-90c7-330e4c4d9ac9"],
Cell[636324, 15954, 979, 16, 51, "Text",ExpressionUUID->"8b105f5a-e2e3-48b6-8ca0-b82322bc234c"],
Cell[637306, 15972, 930, 22, 52, "Input",ExpressionUUID->"ea934540-4500-462f-90f2-6a07c5a24922"],
Cell[638239, 15996, 1030, 17, 51, "Text",ExpressionUUID->"aff3c40e-68f2-4799-8dbc-b89095b8ae49"],
Cell[639272, 16015, 1099, 19, 30, "Input",ExpressionUUID->"6e00337b-8cbc-47e2-bab3-d6338a9a6212"],
Cell[640374, 16036, 1026, 17, 51, "Text",ExpressionUUID->"6e3a1749-60ea-45cf-b90e-144a0a5a7c9d"],
Cell[641403, 16055, 962, 22, 52, "Input",ExpressionUUID->"dcfb474e-6fac-4871-9044-f16dff05f916"],
Cell[642368, 16079, 906, 13, 51, "Text",ExpressionUUID->"1584ee36-673e-408a-9002-06567143a7f7"],
Cell[643277, 16094, 1037, 20, 52, "Input",ExpressionUUID->"b1992beb-df07-4778-a06c-8dea0875d976"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[644363, 16120, 499, 7, 53, "Section",ExpressionUUID->"64e897b7-4288-4a27-a308-ca0e744fefdd"],
Cell[CellGroupData[{
Cell[644887, 16131, 441, 6, 54, "Subsection",ExpressionUUID->"8e6029c3-674b-407e-b9b8-4006e4ff5404"],
Cell[645331, 16139, 817, 14, 51, "Text",ExpressionUUID->"5e3ab161-0bd1-452a-82a8-ad717b0cca0a"],
Cell[646151, 16155, 283, 7, 30, "Input",ExpressionUUID->"36de0879-e261-4941-a708-6f44e7b18851"],
Cell[646437, 16164, 2225, 53, 203, "Input",ExpressionUUID->"2a45666b-8553-4051-a745-eb02f9f64a06"],
Cell[648665, 16219, 515, 9, 30, "Input",ExpressionUUID->"dc7f48a3-4410-49f9-9e4c-37ce4b5f6a8d"],
Cell[649183, 16230, 652, 9, 51, "Text",ExpressionUUID->"660a92f4-d8aa-4475-ba7c-5a81c7cf03ed"],
Cell[CellGroupData[{
Cell[649860, 16243, 386, 7, 30, "Input",ExpressionUUID->"eea233f6-eda1-4913-a3d9-22fba7d19de8"],
Cell[650249, 16252, 1654, 25, 34, "Output",ExpressionUUID->"2e3c58b1-a39f-45f9-b5e1-8d727a661249"]
}, Closed]],
Cell[651918, 16280, 958, 23, 48, "Input",ExpressionUUID->"1feddf25-a946-40e6-b8ce-41acf8df776e"],
Cell[652879, 16305, 408, 9, 52, "Input",ExpressionUUID->"d590fae2-59ad-4ec7-afe2-7235692c1dab"],
Cell[653290, 16316, 1045, 19, 52, "Input",ExpressionUUID->"33537ee4-c096-44c2-a174-7fd26e730775"],
Cell[654338, 16337, 722, 12, 51, "Text",ExpressionUUID->"bd2546bf-5327-43e0-ae94-67008e725db5"],
Cell[CellGroupData[{
Cell[655085, 16353, 244, 5, 30, "Input",ExpressionUUID->"4903dd6e-4fda-45fa-aec2-b93538404633"],
Cell[655332, 16360, 762, 16, 34, "Output",ExpressionUUID->"1bd67681-2401-4925-88c0-f120ee847553"]
}, Closed]],
Cell[656109, 16379, 766, 15, 48, "Input",ExpressionUUID->"376cc508-2889-4b1f-897d-53d62672a9f3"],
Cell[656878, 16396, 679, 10, 51, "Text",ExpressionUUID->"9a4cb599-3a68-48bb-a00c-81026eedd739"],
Cell[CellGroupData[{
Cell[657582, 16410, 1360, 31, 52, "Input",ExpressionUUID->"f73eb374-6289-4811-9ce9-010c9ec4ab97"],
Cell[658945, 16443, 1414, 22, 34, "Output",ExpressionUUID->"3529c984-872f-4798-91c2-0244a843e8f4"],
Cell[660362, 16467, 1414, 22, 34, "Output",ExpressionUUID->"c51fe0ad-3686-48e5-affb-0014d4d6a3aa"]
}, Closed]],
Cell[661791, 16492, 733, 12, 47, "Text",ExpressionUUID->"a87c4527-1f3c-4fd0-9dea-3f0332fefe7c"],
Cell[662527, 16506, 486, 14, 30, "Input",ExpressionUUID->"6b473312-a3eb-432f-9380-cf251775c7fd"],
Cell[CellGroupData[{
Cell[663038, 16524, 278, 6, 30, "Input",ExpressionUUID->"50cae36e-775e-4b24-8c7d-0d07e2589aeb"],
Cell[663319, 16532, 869, 14, 34, "Output",ExpressionUUID->"45763b4f-9477-406a-bfea-422bc4e25d00"]
}, Closed]],
Cell[664203, 16549, 521, 14, 48, "Input",ExpressionUUID->"9a72dbbb-e889-4673-920a-c3010d153fd4"],
Cell[664727, 16565, 644, 15, 52, "Input",ExpressionUUID->"6b3b3103-314e-46e8-8b60-b23206eb5dfb"],
Cell[665374, 16582, 486, 7, 51, "Text",ExpressionUUID->"039bc322-ab77-4695-bd57-fe3dab778bbd"],
Cell[665863, 16591, 556, 12, 52, "Input",ExpressionUUID->"d71ab4e3-225e-4384-8f8e-ec877b64a2da"],
Cell[666422, 16605, 524, 8, 51, "Text",ExpressionUUID->"df45c135-c1df-42f3-836a-d247bac563b4"],
Cell[666949, 16615, 1550, 41, 146, "Input",ExpressionUUID->"1735f659-c333-4b51-8c1b-eb89da4b8a1f"],
Cell[668502, 16658, 1442, 40, 188, "Input",ExpressionUUID->"c4367df5-56a4-478c-80d9-68f6e442b5d1"],
Cell[669947, 16700, 1447, 40, 188, "Input",ExpressionUUID->"237b93c8-f379-4a2e-aa65-be589f599019"],
Cell[CellGroupData[{
Cell[671419, 16744, 680, 15, 52, "Input",ExpressionUUID->"2d5060dc-c0bc-44aa-b527-e8be30424c44"],
Cell[672102, 16761, 722, 11, 34, "Output",ExpressionUUID->"ca68273a-1d0a-4e3b-b404-aec8a0b22acc"],
Cell[672827, 16774, 722, 11, 34, "Output",ExpressionUUID->"43b786bb-0b30-4221-9020-908bbab4f4ad"]
}, Closed]],
Cell[CellGroupData[{
Cell[673586, 16790, 525, 13, 48, "Input",ExpressionUUID->"f994bcd7-30eb-40c5-a777-14c9fb58d948"],
Cell[674114, 16805, 682, 10, 34, "Output",ExpressionUUID->"9d912502-5364-491f-8582-594b456d93f3"],
Cell[674799, 16817, 679, 10, 34, "Output",ExpressionUUID->"7f51bc3c-9ad8-4391-9bb2-45096fc7f44d"]
}, Closed]],
Cell[CellGroupData[{
Cell[675515, 16832, 630, 15, 48, "Input",ExpressionUUID->"0ff52f5f-08aa-425e-aa3f-ba641bcc1ad2"],
Cell[676148, 16849, 682, 10, 34, "Output",ExpressionUUID->"84b1b3a2-209d-4e0e-83c2-7055514d6fd1"],
Cell[676833, 16861, 682, 10, 34, "Output",ExpressionUUID->"8ec7f2d4-776b-43b8-8511-4e1c67e17a1d"]
}, Closed]],
Cell[677530, 16874, 444, 7, 47, "Text",ExpressionUUID->"9cec99f9-769e-49fd-8d2d-b041d866c561"],
Cell[677977, 16883, 711, 18, 52, "Input",ExpressionUUID->"1dc0925c-83ae-47da-bc32-13b8d96be112"],
Cell[678691, 16903, 564, 16, 52, "Input",ExpressionUUID->"39c9d17d-fada-4fe6-a294-c831f024f32e"],
Cell[679258, 16921, 1859, 40, 94, "Input",ExpressionUUID->"88c3af0a-90cf-4bb6-a528-5446e8fae155"],
Cell[681120, 16963, 946, 27, 94, "Input",ExpressionUUID->"79d400e0-df6a-422c-bb49-dfeab15de456"],
Cell[682069, 16992, 904, 13, 51, "Text",ExpressionUUID->"ed624cde-d2f9-4f25-9cff-0e630d13e76f"],
Cell[682976, 17007, 804, 18, 52, "Input",ExpressionUUID->"1e829e00-a739-4a48-9e88-db5017c51792"],
Cell[683783, 17027, 785, 18, 52, "Input",ExpressionUUID->"fa02e27e-628a-4e43-b5c8-8a243a8b5bf3"],
Cell[684571, 17047, 909, 20, 52, "Input",ExpressionUUID->"04269b6e-e323-4ce1-92b5-327dc037060e"],
Cell[685483, 17069, 849, 19, 52, "Input",ExpressionUUID->"50c9bbc2-2cab-41eb-b683-dd3c839ad446"],
Cell[686335, 17090, 967, 13, 51, "Text",ExpressionUUID->"ed7c620f-e245-46a5-8529-161e2a429b59"],
Cell[687305, 17105, 1027, 21, 52, "Input",ExpressionUUID->"71a51fba-3308-48b6-9ae6-bf9937b2f8e8"],
Cell[688335, 17128, 745, 17, 52, "Input",ExpressionUUID->"f7258f6d-c7fc-4622-a8cb-42d0a2950b2a"],
Cell[689083, 17147, 1457, 27, 52, "Input",ExpressionUUID->"92353e13-41bf-4485-919d-bc4924859739"],
Cell[690543, 17176, 447, 7, 51, "Text",ExpressionUUID->"fb3679b2-54b7-48fa-8700-a39ded94e98f"],
Cell[690993, 17185, 1880, 45, 136, "Input",ExpressionUUID->"4bf7698c-a944-42af-9d66-995bd1866309"],
Cell[692876, 17232, 1310, 37, 136, "Input",ExpressionUUID->"b9965a87-2010-450b-9ca5-6f05b61628b3"],
Cell[694189, 17271, 444, 7, 51, "Text",ExpressionUUID->"6a83ea96-777f-4198-9aa8-235b075368e0"],
Cell[CellGroupData[{
Cell[694658, 17282, 1795, 46, 136, "Input",ExpressionUUID->"f27341e1-0821-4bf4-8395-0aa27ae2062d"],
Cell[696456, 17330, 711, 13, 70, "Output",ExpressionUUID->"02fb1cd5-5bba-44db-bcde-c10a70edc4d4"],
Cell[697170, 17345, 710, 13, 70, "Output",ExpressionUUID->"68e29abb-0949-4e69-9236-5f05b4f38ffe"]
}, Closed]],
Cell[697895, 17361, 2789, 59, 132, "Input",ExpressionUUID->"2eb4e522-76bb-4636-a9a6-b5573aea1b79"],
Cell[700687, 17422, 706, 19, 52, "Input",ExpressionUUID->"bd3e69cc-cc9d-43b5-9859-a5c7170a3f8e"],
Cell[701396, 17443, 942, 24, 52, "Input",ExpressionUUID->"800cde81-117a-4faa-a8cf-c16cebc1c40d"]
}, Closed]],
Cell[CellGroupData[{
Cell[702375, 17472, 281, 5, 54, "Subsection",ExpressionUUID->"e3546dad-f61d-4d1b-be1d-3541ca0e04fd"],
Cell[702659, 17479, 515, 7, 51, "Text",ExpressionUUID->"9ababc24-1e10-4637-99dc-a75f4c60ac75"],
Cell[703177, 17488, 710, 17, 52, "Input",ExpressionUUID->"5bd1dc5a-0dd4-4d07-86b6-c9aa5f49f0b0"],
Cell[703890, 17507, 549, 8, 51, "Text",ExpressionUUID->"bc583427-5930-48c1-8dfa-2873006153d5"],
Cell[704442, 17517, 727, 16, 52, "Input",ExpressionUUID->"8070f488-ec3a-43c0-9bff-cc2998147602"],
Cell[705172, 17535, 593, 9, 51, "Text",ExpressionUUID->"94486964-1887-4219-abdf-ab76519ce540"],
Cell[705768, 17546, 702, 16, 52, "Input",ExpressionUUID->"25855e8d-7dd6-4a59-8795-5c40e99c822c"],
Cell[706473, 17564, 598, 9, 51, "Text",ExpressionUUID->"0af05373-6cbd-4b3d-b547-6fca504d86b9"],
Cell[707074, 17575, 625, 14, 52, "Input",ExpressionUUID->"d7e8bab2-962c-4844-8b90-c353f7af1455"],
Cell[707702, 17591, 538, 13, 52, "Input",ExpressionUUID->"6f8a9b42-524a-4e9f-8a3e-bff0149f0ec8"],
Cell[708243, 17606, 594, 9, 51, "Text",ExpressionUUID->"a50e7990-997d-4a79-b921-73c276a275ab"],
Cell[708840, 17617, 621, 15, 52, "Input",ExpressionUUID->"986f2849-101f-4085-82ed-2fcfcd3bce75"],
Cell[709464, 17634, 649, 9, 51, "Text",ExpressionUUID->"9f580b19-12ea-4f55-ba3e-f8fb4551438e"],
Cell[710116, 17645, 729, 16, 52, "Input",ExpressionUUID->"41e8c784-fc12-4e84-92eb-15c7d93cfacf"],
Cell[710848, 17663, 595, 9, 51, "Text",ExpressionUUID->"8a58e4e2-04bc-4393-b778-d1e03d5d28c3"],
Cell[711446, 17674, 778, 16, 52, "Input",ExpressionUUID->"6ca2e0a6-243e-422d-924a-8e66374c1d85"],
Cell[712227, 17692, 592, 9, 51, "Text",ExpressionUUID->"0b999aa3-e750-4ad0-b3ea-eab074f90d38"],
Cell[712822, 17703, 632, 15, 52, "Input",ExpressionUUID->"e01999fc-a8d8-492a-ad5b-71a9c0e10c4d"]
}, Closed]],
Cell[CellGroupData[{
Cell[713491, 17723, 240, 4, 38, "Subsection",ExpressionUUID->"21cbaf8f-dea8-4d8e-b8f9-f1ede6f22f0d"],
Cell[CellGroupData[{
Cell[713756, 17731, 211, 4, 45, "Subsubsection",ExpressionUUID->"0a8b2234-2436-4fd0-8549-2f803bcffaa0"],
Cell[713970, 17737, 723, 10, 51, "Text",ExpressionUUID->"2c0e4fca-021d-4a49-a851-749b80b3647c"],
Cell[714696, 17749, 1635, 39, 136, "Input",ExpressionUUID->"b9c4f656-1ccf-4770-8458-822cf1a31b53"],
Cell[716334, 17790, 687, 10, 51, "Text",ExpressionUUID->"a10c18a8-5631-4d17-bdf2-f5340f0e17da"],
Cell[717024, 17802, 1475, 39, 94, "Input",ExpressionUUID->"f6310f9d-e508-4471-9a42-4af4490a8f62"],
Cell[718502, 17843, 692, 10, 51, "Text",ExpressionUUID->"776de225-6618-4c19-a633-12434a422b02"],
Cell[719197, 17855, 1660, 39, 136, "Input",ExpressionUUID->"389c75b4-9b50-4f53-993e-d8f267c7aeec"],
Cell[720860, 17896, 1121, 29, 52, "Input",ExpressionUUID->"7127806b-c16c-4bf1-8e10-1d3a075f6f0b"],
Cell[721984, 17927, 742, 11, 51, "Text",ExpressionUUID->"bd11d1c2-7e90-4df0-a34a-e1ba1c321de5"],
Cell[722729, 17940, 694, 16, 52, "Input",ExpressionUUID->"8cd91344-7b24-4cc6-8a06-fb88a3d34696"],
Cell[723426, 17958, 690, 10, 51, "Text",ExpressionUUID->"031536cb-d8af-4717-bb8a-afac3d37a8b2"],
Cell[724119, 17970, 2026, 54, 193, "Input",ExpressionUUID->"4a46de51-0d03-4608-ac80-bf87a106e9e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[726182, 18029, 209, 4, 37, "Subsubsection",ExpressionUUID->"ac61c198-0815-400d-ba96-352aa72d5cba"],
Cell[726394, 18035, 708, 10, 51, "Text",ExpressionUUID->"aa6e7294-75cc-4ddb-a719-af713a7c863d"],
Cell[727105, 18047, 1772, 42, 136, "Input",ExpressionUUID->"aefb0dfd-7861-4e41-a2bf-4bf69d9bc1c4"],
Cell[728880, 18091, 654, 9, 51, "Text",ExpressionUUID->"cffdf7e9-cf7f-4a8f-a5f1-403a95fa4949"],
Cell[729537, 18102, 1904, 47, 136, "Input",ExpressionUUID->"69b93b05-aa47-47b6-993e-fcb605e0cbe1"],
Cell[731444, 18151, 1164, 23, 52, "Input",ExpressionUUID->"612eee63-d1c9-4a90-a020-39f568ad3bcd"],
Cell[732611, 18176, 682, 10, 51, "Text",ExpressionUUID->"7be4eff3-d21c-43e3-8226-103ff7c43356"],
Cell[733296, 18188, 2213, 54, 136, "Input",ExpressionUUID->"8e97559a-a66f-422d-a245-960efdb1b65e"],
Cell[735512, 18244, 1671, 40, 136, "Input",ExpressionUUID->"f98471a0-982d-471f-9b15-2900944593c2"],
Cell[737186, 18286, 819, 11, 51, "Text",ExpressionUUID->"4c7b1b84-0254-4ccf-8acc-d78261337a03"],
Cell[738008, 18299, 1838, 44, 144, "Input",ExpressionUUID->"f7745b6c-8969-47b0-9a4a-f620bceb02ca"],
Cell[739849, 18345, 783, 11, 51, "Text",ExpressionUUID->"123e92a0-e5d3-475d-85d0-17f89096ad96"],
Cell[740635, 18358, 1575, 42, 182, "Input",ExpressionUUID->"ef181199-05b9-42cb-8c5a-df1b557a2297"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[742259, 18406, 232, 4, 38, "Subsection",ExpressionUUID->"1770809b-e0f7-47f4-8d18-4cacbb401027"],
Cell[742494, 18412, 851, 12, 51, "Text",ExpressionUUID->"7667791b-b4ac-4604-acfa-3878e3a8812d"],
Cell[743348, 18426, 975, 23, 52, "Input",ExpressionUUID->"add6f0fa-2d1f-4886-bb7f-1f9ae7b87d9f"],
Cell[744326, 18451, 921, 14, 51, "Text",ExpressionUUID->"1943440b-fc2b-457c-8efe-4bb021a3d933"],
Cell[745250, 18467, 989, 23, 52, "Input",ExpressionUUID->"309d4e2a-e206-41cd-92c5-1ce0e62d6e17"],
Cell[746242, 18492, 1030, 17, 51, "Text",ExpressionUUID->"c0dd1e24-2e08-42c5-bce7-54e955bf6478"],
Cell[747275, 18511, 1230, 21, 52, "Input",ExpressionUUID->"ba3e3a65-ec76-403b-a5e5-49338298ae84"],
Cell[748508, 18534, 976, 15, 51, "Text",ExpressionUUID->"4ff60dc5-37c0-43b4-b4ba-f52c05efc987"],
Cell[749487, 18551, 1009, 23, 73, "Input",ExpressionUUID->"be0e2cc4-a134-4188-bb4b-1d9f236ff0e4"],
Cell[750499, 18576, 906, 13, 51, "Text",ExpressionUUID->"9c01328f-3294-45fc-ad17-55b74a980330"],
Cell[751408, 18591, 1137, 22, 52, "Input",ExpressionUUID->"f77ff0d5-03a0-427c-962f-9772a9bf3b25"],
Cell[752548, 18615, 940, 14, 51, "Text",ExpressionUUID->"ee44d842-8ba3-4201-8b1b-a77a3f1fa308"],
Cell[753491, 18631, 691, 16, 73, "Input",ExpressionUUID->"01850a3a-ddbc-48b1-9a2b-2ad92c03a784"],
Cell[754185, 18649, 152, 3, 30, "Input",ExpressionUUID->"494ac08f-fd16-4d3c-a51c-6be8d48ff8cf"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[754386, 18658, 600, 9, 53, "Section",ExpressionUUID->"19f61ac9-51db-46db-8f82-362ba5a0a13a"],
Cell[CellGroupData[{
Cell[755011, 18671, 490, 7, 54, "Subsection",ExpressionUUID->"157101cd-0cb1-4b6d-9f46-05116d7a415e"],
Cell[755504, 18680, 849, 14, 51, "Text",ExpressionUUID->"809867a1-c880-4ddb-8147-4cce34254cd6"],
Cell[756356, 18696, 204, 5, 30, "Input",ExpressionUUID->"d5752fef-6c59-4b51-89df-982aa4d46869"],
Cell[756563, 18703, 1810, 42, 140, "Input",ExpressionUUID->"45db2d66-0d71-4a96-8f90-bb7675b10776"],
Cell[758376, 18747, 565, 10, 30, "Input",ExpressionUUID->"5562da08-84bb-473f-b1c2-4f02cb14e4c6"],
Cell[758944, 18759, 652, 9, 51, "Text",ExpressionUUID->"45fd71d8-be0b-4940-925c-5fc539c90688"],
Cell[CellGroupData[{
Cell[759621, 18772, 435, 8, 30, "Input",ExpressionUUID->"183b580f-5ebc-4f51-8534-64c0acc98468"],
Cell[760059, 18782, 1043, 16, 34, "Output",ExpressionUUID->"7d9c04ec-eccc-4740-b022-1bf9ae5d0038"]
}, Closed]],
Cell[761117, 18801, 1005, 24, 48, "Input",ExpressionUUID->"57c4676a-6e19-491d-8860-43129c56ab13"],
Cell[762125, 18827, 509, 10, 52, "Input",ExpressionUUID->"9e53871d-301c-44ad-ac82-adeb8406a45a"],
Cell[762637, 18839, 1100, 20, 52, "Input",ExpressionUUID->"4044638f-56b0-470c-bf92-cf9cb93b55a1"],
Cell[763740, 18861, 722, 12, 51, "Text",ExpressionUUID->"dc15d66f-9b29-4ebd-9c7b-2051205f0f12"],
Cell[CellGroupData[{
Cell[764487, 18877, 294, 6, 30, "Input",ExpressionUUID->"54dc31e0-8879-40a6-8aea-459285a62592"],
Cell[764784, 18885, 776, 14, 34, "Output",ExpressionUUID->"db7de1e2-c943-4d83-b52b-05aedef3a62b"]
}, Closed]],
Cell[765575, 18902, 864, 16, 48, "Input",ExpressionUUID->"0b3e89c6-da06-454f-85e2-12343b53427a"],
Cell[766442, 18920, 679, 10, 51, "Text",ExpressionUUID->"5a18e548-7ef2-4af2-b5e6-9ca181edd5a7"],
Cell[767124, 18932, 817, 25, 73, "Input",ExpressionUUID->"9114a757-c63b-491b-a66f-7675fdbb4686"],
Cell[CellGroupData[{
Cell[767966, 18961, 1407, 31, 52, "Input",ExpressionUUID->"0fd6fcf7-3a2b-4727-8a97-aaebd714317f"],
Cell[769376, 18994, 677, 11, 34, "Output",ExpressionUUID->"7c1f4882-4b62-4fe9-bda6-cc4aef9f6a90"],
Cell[770056, 19007, 674, 11, 34, "Output",ExpressionUUID->"c826a449-b4bc-40b1-b52c-5a6cd5aa5065"]
}, Closed]],
Cell[770745, 19021, 756, 12, 47, "Text",ExpressionUUID->"fd8c1716-1505-4fdc-8d3b-f1a275652f2d"],
Cell[771504, 19035, 841, 27, 52, "Input",ExpressionUUID->"8ac81315-3b1d-4757-af79-50312d97f6db"],
Cell[CellGroupData[{
Cell[772370, 19066, 519, 13, 52, "Input",ExpressionUUID->"cbc40ab1-a9e0-4e51-bd12-ed96b4559433"],
Cell[772892, 19081, 529, 8, 34, "Output",ExpressionUUID->"ef01db97-5ab8-4e6a-bf57-36ff6be1f542"],
Cell[773424, 19091, 528, 8, 34, "Output",ExpressionUUID->"60c4a646-51bd-420d-bb72-844aeaaa28ce"]
}, Closed]],
Cell[773967, 19102, 765, 17, 48, "Input",ExpressionUUID->"f9f0f214-0c6a-4632-b600-189217849493"],
Cell[774735, 19121, 691, 15, 52, "Input",ExpressionUUID->"70529bd7-c52c-4832-a98a-168309ecbb58"],
Cell[775429, 19138, 455, 7, 51, "Text",ExpressionUUID->"a27abde6-d95f-43df-863f-38f843b14b1e"],
Cell[775887, 19147, 670, 15, 30, "Input",ExpressionUUID->"9f35302f-c214-413c-86d7-c60802dd3eaa"],
Cell[776560, 19164, 809, 17, 52, "Input",ExpressionUUID->"1fb5bec9-2f36-4336-b57d-8fd5b4a30816"],
Cell[777372, 19183, 396, 10, 30, "Input",ExpressionUUID->"68890745-cfe4-4c2e-ad5e-1fa9a41f47ec"],
Cell[777771, 19195, 1511, 43, 115, "Input",ExpressionUUID->"1b361943-1e34-4190-afb8-ee4e0880b41e"],
Cell[779285, 19240, 486, 7, 51, "Text",ExpressionUUID->"677f4182-0e63-43f1-bac6-e3d3222507a9"],
Cell[779774, 19249, 557, 12, 52, "Input",ExpressionUUID->"fc6ce591-73e6-457e-974f-09002556d010"],
Cell[780334, 19263, 524, 8, 51, "Text",ExpressionUUID->"917bdf5a-4d4e-4cba-874b-1bc68c17626c"],
Cell[780861, 19273, 1575, 42, 91, "Input",ExpressionUUID->"fd78b392-ab85-47dc-90f9-7b05499ec148"],
Cell[782439, 19317, 1469, 41, 112, "Input",ExpressionUUID->"a91e39d3-07f5-403e-be8b-1186f537a1c6"],
Cell[783911, 19360, 1475, 41, 112, "Input",ExpressionUUID->"965d7549-efb2-49e6-b39b-dc5f4d24b237"],
Cell[CellGroupData[{
Cell[785411, 19405, 730, 16, 52, "Input",ExpressionUUID->"f2975c2b-f7c3-407b-9610-3d824c159aaf"],
Cell[786144, 19423, 554, 8, 34, "Output",ExpressionUUID->"63676712-3568-4a58-9ac2-d8bbcdaf59dc"],
Cell[786701, 19433, 551, 8, 34, "Output",ExpressionUUID->"8f9e2c8c-7ac6-4a97-b248-8b25c3e36346"]
}, Closed]],
Cell[CellGroupData[{
Cell[787289, 19446, 575, 14, 48, "Input",ExpressionUUID->"d78a8c26-7ffc-4edc-b5bf-b641551781fa"],
Cell[787867, 19462, 523, 8, 34, "Output",ExpressionUUID->"dc814fa9-ecc4-4933-bf97-81fcbee8071e"],
Cell[788393, 19472, 523, 8, 34, "Output",ExpressionUUID->"7f98d48a-0d61-4b5f-a370-f2beb7351d62"]
}, Closed]],
Cell[CellGroupData[{
Cell[788953, 19485, 679, 15, 48, "Input",ExpressionUUID->"23586d55-cd11-4c3b-a89d-8f8d864fd363"],
Cell[789635, 19502, 405, 6, 34, "Output",ExpressionUUID->"8cc48ed5-cd06-447a-9d7f-aad0f402a2af"],
Cell[790043, 19510, 408, 6, 34, "Output",ExpressionUUID->"9c1b1881-13e0-460e-a0f5-f2320fb55258"]
}, Closed]],
Cell[790466, 19519, 444, 7, 47, "Text",ExpressionUUID->"90250f53-679b-4ff2-b0dc-78bb3a7666a9"],
Cell[790913, 19528, 764, 19, 52, "Input",ExpressionUUID->"ec0e2fd4-bf53-445d-907d-81d732a59a9f"],
Cell[791680, 19549, 622, 17, 52, "Input",ExpressionUUID->"41d40676-5e64-45ad-9c7b-f6ad181030e7"],
Cell[792305, 19568, 1912, 41, 94, "Input",ExpressionUUID->"7b22d33d-ae94-4d0f-9d94-4b1a7258a345"],
Cell[794220, 19611, 996, 28, 94, "Input",ExpressionUUID->"55ba0127-a077-41a9-914e-f47164ad20e2"],
Cell[795219, 19641, 904, 13, 51, "Text",ExpressionUUID->"c7562e45-c43b-4903-a27e-8e8b25fb7f4e"],
Cell[796126, 19656, 828, 19, 52, "Input",ExpressionUUID->"e6c6ed18-9321-4135-b404-f5ce1e0bda6d"],
Cell[796957, 19677, 836, 19, 52, "Input",ExpressionUUID->"38fe67bc-8a78-40b4-979e-5dd2dc37331e"],
Cell[797796, 19698, 952, 20, 52, "Input",ExpressionUUID->"aa0ebacc-d7cc-4a78-8cd7-1eaa725fa4f3"],
Cell[798751, 19720, 845, 19, 52, "Input",ExpressionUUID->"7111cfb5-df57-4ee5-a147-ce6cfb62bb97"],
Cell[799599, 19741, 447, 7, 51, "Text",ExpressionUUID->"391c4aa9-4280-41a6-92bc-01bbb5c76e36"],
Cell[800049, 19750, 1932, 46, 136, "Input",ExpressionUUID->"8d901132-4f5c-401c-b6db-32d708a141a1"],
Cell[801984, 19798, 1357, 38, 136, "Input",ExpressionUUID->"851a902b-e717-449d-8901-58bc5fe8c4d5"],
Cell[803344, 19838, 444, 7, 51, "Text",ExpressionUUID->"3d7b14fd-726f-4db1-a116-e30f1d24b984"],
Cell[CellGroupData[{
Cell[803813, 19849, 1841, 46, 136, "Input",ExpressionUUID->"42fefae8-b33a-4dd1-a390-a542acf45591"],
Cell[805657, 19897, 680, 12, 34, "Output",ExpressionUUID->"90cf4fff-8a23-4485-ac42-980bf92bc872"],
Cell[806340, 19911, 681, 12, 34, "Output",ExpressionUUID->"203f8a44-4c45-439a-86ad-cbbb7bca1986"]
}, Closed]],
Cell[807036, 19926, 2623, 57, 132, "Input",ExpressionUUID->"e651dbb9-d5e1-45a3-a4bf-f61d09b34aab"],
Cell[809662, 19985, 606, 17, 52, "Input",ExpressionUUID->"3c6fee3f-f2a6-43a8-9074-396e4534c021"],
Cell[810271, 20004, 747, 21, 52, "Input",ExpressionUUID->"b3c72650-dc63-4edf-b963-edecb709f50f"]
}, Closed]],
Cell[CellGroupData[{
Cell[811055, 20030, 281, 5, 38, "Subsection",ExpressionUUID->"0dfe60e8-df63-4292-b5af-18154edd1a6a"],
Cell[811339, 20037, 515, 7, 51, "Text",ExpressionUUID->"73607e0a-daa2-40fb-814f-3ba2e08a10e2"],
Cell[811857, 20046, 760, 18, 52, "Input",ExpressionUUID->"af50f589-3778-492a-a518-327e774fc1d0"],
Cell[812620, 20066, 549, 8, 51, "Text",ExpressionUUID->"33f75d73-7d72-425a-ac0e-9c25c7b68b29"],
Cell[813172, 20076, 772, 16, 52, "Input",ExpressionUUID->"32b622fd-18af-4ff7-89c8-6d107b54a0e0"],
Cell[813947, 20094, 593, 9, 51, "Text",ExpressionUUID->"4b3166d9-0869-4a9e-8e2e-55870085d982"],
Cell[814543, 20105, 750, 16, 52, "Input",ExpressionUUID->"7aebcfc3-f093-4b17-b278-435cf7b5294b"],
Cell[815296, 20123, 598, 9, 51, "Text",ExpressionUUID->"0db37c28-60b5-4f0e-82b9-d1ec781d9faf"],
Cell[815897, 20134, 678, 15, 52, "Input",ExpressionUUID->"af4108cb-bf04-4e7e-a570-8d112eb72937"],
Cell[816578, 20151, 589, 14, 52, "Input",ExpressionUUID->"808f630f-faa6-453e-9928-0bd6df3e5f0a"],
Cell[817170, 20167, 594, 9, 51, "Text",ExpressionUUID->"d63e2bdd-f1c1-4750-9459-9a5d718af0e1"],
Cell[817767, 20178, 669, 15, 52, "Input",ExpressionUUID->"adb184b2-adf6-46f6-af92-25f818c984b1"],
Cell[818439, 20195, 649, 9, 51, "Text",ExpressionUUID->"3d0b4c2c-4a06-43d5-bd66-28abdab60632"],
Cell[819091, 20206, 782, 17, 52, "Input",ExpressionUUID->"a41c6c7f-4335-45ab-954b-c6f2b1480578"]
}, Closed]],
Cell[CellGroupData[{
Cell[819910, 20228, 242, 4, 38, "Subsection",ExpressionUUID->"3f50b961-782b-4b58-9348-4866cdf368e0"],
Cell[CellGroupData[{
Cell[820177, 20236, 211, 4, 45, "Subsubsection",ExpressionUUID->"4aaabbfe-0123-40fe-b632-83e29e26c681"],
Cell[820391, 20242, 723, 10, 51, "Text",ExpressionUUID->"4e392f70-c850-42ec-b437-6539cc32c50f"],
Cell[821117, 20254, 1686, 40, 136, "Input",ExpressionUUID->"6e34d967-d606-435a-b5b0-7dd2d04103c5"],
Cell[822806, 20296, 687, 10, 51, "Text",ExpressionUUID->"edc90400-90bc-4039-884d-a41959093aa0"],
Cell[823496, 20308, 1525, 40, 94, "Input",ExpressionUUID->"ee1eb140-b607-47b3-88a5-c701e5a061a9"],
Cell[825024, 20350, 692, 10, 51, "Text",ExpressionUUID->"24aca406-8b44-4b67-9a64-409533006608"],
Cell[825719, 20362, 1705, 40, 136, "Input",ExpressionUUID->"fe9b6dd0-9757-4371-b297-3687e8f5c2a5"],
Cell[827427, 20404, 1167, 29, 52, "Input",ExpressionUUID->"aef3d165-ebba-4088-ad4b-d0143a89bd3d"],
Cell[828597, 20435, 742, 11, 51, "Text",ExpressionUUID->"de6ee4c7-ee4e-4b2e-b087-766ca9f2a85b"],
Cell[829342, 20448, 743, 17, 52, "Input",ExpressionUUID->"2a31322b-0a2b-4092-b320-6e2eb98fcb29"],
Cell[830088, 20467, 690, 10, 51, "Text",ExpressionUUID->"21d419f2-cb11-4365-b0cd-b3e50f638c70"],
Cell[830781, 20479, 2126, 55, 193, "Input",ExpressionUUID->"f739503f-47c4-40bb-8e1c-cbaed1858144"]
}, Closed]],
Cell[CellGroupData[{
Cell[832944, 20539, 209, 4, 45, "Subsubsection",ExpressionUUID->"6f5f18e6-c6d8-498f-a3a0-d087dbfe9a97"],
Cell[833156, 20545, 708, 10, 51, "Text",ExpressionUUID->"a4c723f4-9b27-43f6-a5f3-c4f36679da20"],
Cell[833867, 20557, 1824, 43, 136, "Input",ExpressionUUID->"c1be1508-90fe-4629-814d-17e8c4980bdf"],
Cell[835694, 20602, 654, 9, 51, "Text",ExpressionUUID->"c237f4b3-61fc-4a9d-bcd2-53385e5c6bdd"],
Cell[836351, 20613, 2007, 48, 136, "Input",ExpressionUUID->"a7b62a8b-c3e8-4f0b-ab67-7575ca5455fb"],
Cell[838361, 20663, 1211, 24, 52, "Input",ExpressionUUID->"6140aec5-7729-4349-9a6e-41dd9b807a4f"],
Cell[839575, 20689, 682, 10, 51, "Text",ExpressionUUID->"b97a5f76-59b1-484e-afeb-9eb6fbe69b1b"],
Cell[840260, 20701, 2258, 54, 136, "Input",ExpressionUUID->"b698745e-4dcc-487b-9c18-db0bf40df4bc"],
Cell[842521, 20757, 1720, 41, 136, "Input",ExpressionUUID->"76d39b5e-f06e-4bbf-8aff-3d8525cc8871"],
Cell[844244, 20800, 819, 11, 51, "Text",ExpressionUUID->"41e54a55-7a0f-4e77-bc2c-6e4668a5c214"],
Cell[845066, 20813, 1886, 45, 144, "Input",ExpressionUUID->"3412a8ed-8d2c-4c5b-8ff2-65106bdad109"],
Cell[846955, 20860, 783, 11, 51, "Text",ExpressionUUID->"5dc988cb-cfbe-493b-b718-c4e55aaa3c5d"],
Cell[847741, 20873, 1578, 42, 182, "Input",ExpressionUUID->"e4017c98-0440-4d44-9b90-559085b7082c"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[849368, 20921, 301, 5, 54, "Subsection",ExpressionUUID->"5512c158-965f-4248-a55e-c42b813ba90d"],
Cell[849672, 20928, 851, 12, 51, "Text",ExpressionUUID->"31158ecb-9fb2-48f0-8256-53fd0d45a70b"],
Cell[850526, 20942, 906, 22, 52, "Input",ExpressionUUID->"c8104a8b-4041-4258-993f-317a8e7914ac"],
Cell[851435, 20966, 921, 14, 51, "Text",ExpressionUUID->"c9df72d5-9cdd-42c6-a5d9-afad086a69ba"],
Cell[852359, 20982, 928, 22, 52, "Input",ExpressionUUID->"c012c404-9724-4b9f-bb28-05c35b432aa2"],
Cell[853290, 21006, 1030, 17, 51, "Text",ExpressionUUID->"0f87db8b-621c-40df-9c51-f8781a48cb17"],
Cell[854323, 21025, 1128, 19, 52, "Input",ExpressionUUID->"29e099c6-0bbb-44a8-bf37-79c953248b95"],
Cell[855454, 21046, 906, 13, 51, "Text",ExpressionUUID->"fc3dfdab-72d3-4dd3-a859-9500a0fb6fdd"],
Cell[856363, 21061, 1102, 22, 52, "Input",ExpressionUUID->"bc39e868-1f14-482a-a0dc-47aff43e9fca"],
Cell[857468, 21085, 906, 13, 51, "Text",ExpressionUUID->"aa7e6bf9-0974-4641-b96c-8a93800a6787"],
Cell[858377, 21100, 692, 16, 73, "Input",ExpressionUUID->"e1acf976-9337-4a57-aa75-18f1ce24cb35"]
}, Closed]]
}, Closed]]
}
]
*)

